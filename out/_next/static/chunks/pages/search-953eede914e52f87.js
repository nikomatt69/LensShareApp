(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9603,3463],{4896:function(e,t,r){"use strict";function i(e){return e}function n(e){let t={subscribe(t){let r=null,i=!1,n=!1,s=!1;function a(){if(null===r){s=!0;return}!n&&(n=!0,"function"==typeof r?r():r&&r.unsubscribe())}return r=e({next(e){i||t.next?.(e)},error(e){i||(i=!0,t.error?.(e),a())},complete(){i||(i=!0,t.complete?.(),a())}}),s&&a(),{unsubscribe:a}},pipe:(...e)=>(0===e.length?i:1===e.length?e[0]:function(t){return e.reduce((e,t)=>t(e),t)})(t)};return t}r.d(t,{Y_:function(){return eW},XY:function(){return eZ}});class s extends Error{constructor(e){super(e),this.name="ObservableAbortError",Object.setPrototypeOf(this,s.prototype)}}class a extends Error{static from(e,t={}){return e instanceof Error?e instanceof a||"TRPCClientError"===e.name?(t.meta&&(e.meta={...e.meta,...t.meta}),e):new a(e.message,{...t,cause:e,result:null}):new a(e.error.message??"",{...t,cause:void 0,result:e})}constructor(e,t){let r=t?.cause;super(e,{cause:r}),this.meta=t?.meta,this.cause=r,this.shape=t?.result?.error,this.data=t?.result?.error.data,this.name="TRPCClientError",Object.setPrototypeOf(this,a.prototype)}}function o(e){let t=Object.create(null);for(let r in e){let i=e[r];t[i]=r}return t}let l={PARSE_ERROR:-32700,BAD_REQUEST:-32600,INTERNAL_SERVER_ERROR:-32603,UNAUTHORIZED:-32001,FORBIDDEN:-32003,NOT_FOUND:-32004,METHOD_NOT_SUPPORTED:-32005,TIMEOUT:-32008,CONFLICT:-32009,PRECONDITION_FAILED:-32012,PAYLOAD_TOO_LARGE:-32013,UNPROCESSABLE_CONTENT:-32022,TOO_MANY_REQUESTS:-32029,CLIENT_CLOSED_REQUEST:-32099};o(l),o(l);let c=()=>{},d=e=>(function e(t,r){let i=new Proxy(c,{get(i,n){if("string"==typeof n&&"then"!==n)return e(t,[...r,n])},apply(e,i,n){let s="apply"===r[r.length-1];return t({args:s?n.length>=2?n[1]:[]:n,path:s?r.slice(0,-1):r})}});return i})(e,[]),u=e=>new Proxy(c,{get(t,r){if("string"==typeof r&&"then"!==r)return e(r)}}),p=e=>"function"==typeof e;function h(e){var t;return{url:e.url,fetch:e.fetch,AbortController:(t=e.AbortController)?t:"undefined"!=typeof window&&window.AbortController?window.AbortController:"undefined"!=typeof globalThis&&globalThis.AbortController?globalThis.AbortController:null}}let m={query:"GET",mutation:"POST"};function f(e){return"input"in e?e.runtime.transformer.serialize(e.input):function(e){let t={};for(let r=0;r<e.length;r++){let i=e[r];t[r]=i}return t}(e.inputs.map(t=>e.runtime.transformer.serialize(t)))}let g=e=>{let t=e.url+"/"+e.path,r=[];if("inputs"in e&&r.push("batch=1"),"query"===e.type){let i=f(e);void 0!==i&&r.push(`input=${encodeURIComponent(JSON.stringify(i))}`)}return r.length&&(t+="?"+r.join("&")),t},v=e=>{if("query"===e.type)return;let t=f(e);return void 0!==t?JSON.stringify(t):void 0},y=e=>w({...e,contentTypeHeader:"application/json",getUrl:g,getBody:v});async function b(e,t){let r=e.getUrl(e),i=e.getBody(e),{type:n}=e,s=await e.headers();if("subscription"===n)throw Error("Subscriptions should use wsLink");let a={...e.contentTypeHeader?{"content-type":e.contentTypeHeader}:{},...e.batchModeHeader?{"trpc-batch-mode":e.batchModeHeader}:{},...s};return(function(e){if(e)return e;if("undefined"!=typeof window&&p(window.fetch))return window.fetch;if("undefined"!=typeof globalThis&&p(globalThis.fetch))return globalThis.fetch;throw Error("No fetch implementation found")})(e.fetch)(r,{method:m[n],signal:t?.signal,body:i,headers:a})}function w(e){let t=e.AbortController?new e.AbortController:null,r={},i=new Promise((i,n)=>{b(e,t).then(e=>(r.response=e,e.json())).then(e=>{r.responseJSON=e,i({json:e,meta:r})}).catch(e=>{n(a.from(e,{meta:r}))})}),n=()=>{t?.abort()};return{promise:i,cancel:n}}function _(e){return!!e&&!Array.isArray(e)&&"object"==typeof e}class S extends Error{constructor(){super("Unable to transform response from server")}}function x(e,t){let r;try{r=function(e,t){if("error"in e){let r=t.transformer.deserialize(e.error);return{ok:!1,error:{...e,error:r}}}let i={...e.result,...(!e.result.type||"data"===e.result.type)&&{type:"data",data:t.transformer.deserialize(e.result.data)}};return{ok:!0,result:i}}(e,t)}catch(i){throw new S}if(!r.ok&&(!_(r.error.error)||"number"!=typeof r.error.error.code)||r.ok&&!_(r.result))throw new S;return r}let C=()=>{throw Error("Something went wrong. Please submit an issue at https://github.com/trpc/trpc/issues/new")};function T(e){let t=null,r=null,i=()=>{clearTimeout(r),r=null,t=null};function n(){let r=function(t){let r=[[]],i=0;for(;;){let n=t[i];if(!n)break;let s=r[r.length-1];if(n.aborted){n.reject?.(Error("Aborted")),i++;continue}let a=e.validate(s.concat(n).map(e=>e.key));if(a){s.push(n),i++;continue}if(0===s.length){n.reject?.(Error("Input is too big for a single dispatch")),i++;continue}r.push([])}return r}(t);for(let n of(i(),r)){if(!n.length)continue;let s={items:n,cancel:C};for(let a of n)a.batch=s;let o=(e,t)=>{let r=s.items[e];r.resolve?.(t),r.batch=null,r.reject=null,r.resolve=null},{promise:l,cancel:c}=e.fetch(s.items.map(e=>e.key),o);s.cancel=c,l.then(e=>{for(let t=0;t<e.length;t++){let r=e[t];o(t,r)}for(let i of s.items)i.reject?.(Error("Missing result")),i.batch=null}).catch(e=>{for(let t of s.items)t.reject?.(e),t.batch=null})}}return{load:function(e){let i={aborted:!1,key:e,batch:null,resolve:C,reject:C},s=new Promise((e,r)=>{i.reject=r,i.resolve=e,t||(t=[]),t.push(i)});r||(r=setTimeout(n));let a=()=>{i.aborted=!0,i.batch?.items.every(e=>e.aborted)&&(i.batch.cancel(),i.batch=null)};return{promise:s,cancel:a}}}}function k(e){return function(t){let r=h(t),i=t.maxURLLength??1/0;return s=>{let o=n=>{let a=e=>{if(i===1/0)return!0;let t=e.map(e=>e.path).join(","),a=e.map(e=>e.input),o=g({...r,runtime:s,type:n,path:t,inputs:a});return o.length<=i},o=e({...r,runtime:s,type:n,opts:t});return{validate:a,fetch:o}},l=T(o("query")),c=T(o("mutation")),d=T(o("subscription")),u={query:l,subscription:d,mutation:c};return({op:e})=>n(t=>{let r;let i=u[e.type],{promise:n,cancel:o}=i.load(e);return n.then(e=>{r=e;let i=x(e.json,s);if(!i.ok){t.error(a.from(i.error,{meta:e.meta}));return}t.next({context:e.meta,result:i.result}),t.complete()}).catch(e=>{t.error(a.from(e,{meta:r?.meta}))}),()=>{o()}})}}}let R=e=>t=>{let r=t.map(e=>e.path).join(","),i=t.map(e=>e.input),{promise:n,cancel:s}=y({...e,path:r,inputs:i,headers:()=>e.opts.headers?"function"==typeof e.opts.headers?e.opts.headers({opList:t}):e.opts.headers:{}});return{promise:n.then(e=>{let r=Array.isArray(e.json)?e.json:t.map(()=>e.json),i=r.map(t=>({meta:e.meta,json:t}));return i}),cancel:s}},E=k(R);function P(e){return t=>{let r=h(t);return i=>({op:s})=>n(n=>{let o;let{path:l,input:c,type:d}=s,{promise:u,cancel:p}=e.requester({...r,runtime:i,type:d,path:l,input:c,headers:()=>t.headers?"function"==typeof t.headers?t.headers({op:s}):t.headers:{}});return u.then(e=>{o=e.meta;let t=x(e.json,i);if(!t.ok){n.error(a.from(t.error,{meta:o}));return}n.next({context:e.meta,result:t.result}),n.complete()}).catch(e=>{n.error(a.from(e,{meta:o}))}),()=>{p()}})}}P({requester:y});class D{$request({type:e,input:t,path:r,context:i={}}){var s;let a=(s={links:this.links,op:{id:++this.requestId,type:e,path:r,input:t,context:i}},n(e=>{let t=function e(t=0,r=s.op){let i=s.links[t];if(!i)throw Error("No more links to execute - did you forget to add an ending link?");let n=i({op:r,next(r){let i=e(t+1,r);return i}});return n}();return t.subscribe(e)}));return a.pipe(e=>{let t=0,r=null,i=[];return{subscribe:n=>(t++,i.push(n),r||(r=e.subscribe({next(e){for(let t of i)t.next?.(e)},error(e){for(let t of i)t.error?.(e)},complete(){for(let e of i)e.complete?.()}})),{unsubscribe(){t--,function(){if(0===t&&r){let e=r;r=null,e.unsubscribe()}}();let e=i.findIndex(e=>e===n);e>-1&&i.splice(e,1)}})}})}requestAsPromise(e){let t=this.$request(e),{promise:r,abort:i}=function(e){let t;let r=new Promise((r,i)=>{let n=!1;function a(){n||(n=!0,i(new s("This operation was aborted.")),o.unsubscribe())}let o=e.subscribe({next(e){n=!0,r(e),a()},error(e){n=!0,i(e),a()},complete(){n=!0,a()}});t=a});return{promise:r,abort:t}}(t),n=new Promise((t,n)=>{e.signal?.addEventListener("abort",i),r.then(e=>{t(e.result.data)}).catch(e=>{n(a.from(e))})});return n}query(e,t,r){return this.requestAsPromise({type:"query",path:e,input:t,context:r?.context,signal:r?.signal})}mutation(e,t,r){return this.requestAsPromise({type:"mutation",path:e,input:t,context:r?.context,signal:r?.signal})}subscription(e,t,r){let i=this.$request({type:"subscription",path:e,input:t,context:r?.context});return i.subscribe({next(e){"started"===e.result.type?r.onStarted?.():"stopped"===e.result.type?r.onStopped?.():r.onData?.(e.result.data)},error(e){r.onError?.(e)},complete(){r.onComplete?.()}})}constructor(e){this.requestId=0;let t=(()=>{let t=e.transformer;return t?"input"in t?e.transformer:{input:t,output:t}:{input:{serialize:e=>e,deserialize:e=>e},output:{serialize:e=>e,deserialize:e=>e}}})();this.runtime={transformer:{serialize:e=>t.input.serialize(e),deserialize:e=>t.output.deserialize(e)},combinedTransformer:t},this.links=e.links.map(e=>e(this.runtime))}}let L={query:"query",mutate:"mutation",subscribe:"subscription"},I=e=>L[e];async function M(e){let t=e.parse??JSON.parse,r=r=>{if(e.signal?.aborted||!r||"}"===r)return;let i=r.indexOf(":"),n=r.substring(2,i-1),s=r.substring(i+1);e.onSingle(Number(n),t(s))};await j(e.readableStream,r,e.textDecoder)}async function j(e,t,r){let i="",n=e=>{let n=r.decode(e),s=n.split("\n");if(1===s.length)i+=s[0];else if(s.length>1){t(i+s[0]);for(let a=1;a<s.length-1;a++)t(s[a]);i=s[s.length-1]}};"getReader"in e?await O(e,n):await new Promise(t=>{e.on("data",n),e.on("end",t)}),t(i)}async function O(e,t){let r=e.getReader(),i=await r.read();for(;!i.done;)t(i.value),i=await r.read()}let A=(e,t)=>{let r=e.AbortController?new e.AbortController:null,i=b({...e,contentTypeHeader:"application/json",batchModeHeader:"stream",getUrl:g,getBody:v},r),n=()=>r?.abort(),s=i.then(async i=>{if(!i.body)throw Error("Received response without body");let n={response:i};return M({readableStream:i.body,onSingle:t,parse:e=>({json:JSON.parse(e),meta:n}),signal:r?.signal,textDecoder:e.textDecoder})});return{cancel:n,promise:s}},N=e=>{let t=function(e){if(e)return e;if("undefined"!=typeof window&&window.TextDecoder)return new window.TextDecoder;if("undefined"!=typeof globalThis&&globalThis.TextDecoder)return new globalThis.TextDecoder;throw Error("No TextDecoder implementation found")}(e.opts.textDecoder);return(r,i)=>{let n=r.map(e=>e.path).join(","),s=r.map(e=>e.input),{cancel:a,promise:o}=A({...e,textDecoder:t,path:n,inputs:s,headers:()=>e.opts.headers?"function"==typeof e.opts.headers?e.opts.headers({opList:r}):e.opts.headers:{}},(e,t)=>{i(e,t)});return{promise:o.then(()=>[]),cancel:a}}};k(N);let F=e=>{if("input"in e){if(!(e.input instanceof FormData))throw Error("Input is not FormData");return e.input}},q=e=>{if("mutation"!==e.type)throw Error("We only handle mutations with formdata");return w({...e,getUrl:()=>`${e.url}/${e.path}`,getBody:F})};P({requester:q});var B,U,H,z=r(6154),V=function(){function e(){this.keyToValue=new Map,this.valueToKey=new Map}return e.prototype.set=function(e,t){this.keyToValue.set(e,t),this.valueToKey.set(t,e)},e.prototype.getByKey=function(e){return this.keyToValue.get(e)},e.prototype.getByValue=function(e){return this.valueToKey.get(e)},e.prototype.clear=function(){this.keyToValue.clear(),this.valueToKey.clear()},e}(),$=function(){function e(e){this.generateIdentifier=e,this.kv=new V}return e.prototype.register=function(e,t){this.kv.getByValue(e)||(t||(t=this.generateIdentifier(e)),this.kv.set(t,e))},e.prototype.clear=function(){this.kv.clear()},e.prototype.getIdentifier=function(e){return this.kv.getByValue(e)},e.prototype.getValue=function(e){return this.kv.getByKey(e)},e}(),Z=(B=function(e,t){return(B=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}B(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),W=function(e){function t(){var t=e.call(this,function(e){return e.name})||this;return t.classToAllowedProps=new Map,t}return Z(t,e),t.prototype.register=function(t,r){"object"==typeof r?(r.allowProps&&this.classToAllowedProps.set(t,r.allowProps),e.prototype.register.call(this,t,r.identifier)):e.prototype.register.call(this,t,r)},t.prototype.getAllowedProps=function(e){return this.classToAllowedProps.get(e)},t}($),K=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(o){n={error:o}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a};function G(e,t){Object.entries(e).forEach(function(e){var r=K(e,2),i=r[0];return t(r[1],i)})}function Q(e,t){return -1!==e.indexOf(t)}function Y(e,t){for(var r=0;r<e.length;r++){var i=e[r];if(t(i))return i}}var J=function(){function e(){this.transfomers={}}return e.prototype.register=function(e){this.transfomers[e.name]=e},e.prototype.findApplicable=function(e){return function(e,t){var r=function(e){if("values"in Object)return Object.values(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t}(e);if("find"in r)return r.find(t);for(var i=0;i<r.length;i++){var n=r[i];if(t(n))return n}}(this.transfomers,function(t){return t.isApplicable(e)})},e.prototype.findByName=function(e){return this.transfomers[e]},e}(),X=function(e){return void 0===e},ee=function(e){return"object"==typeof e&&null!==e&&e!==Object.prototype&&(null===Object.getPrototypeOf(e)||Object.getPrototypeOf(e)===Object.prototype)},et=function(e){return ee(e)&&0===Object.keys(e).length},er=function(e){return Array.isArray(e)},ei=function(e){return e instanceof Map},en=function(e){return e instanceof Set},es=function(e){return"Symbol"===Object.prototype.toString.call(e).slice(8,-1)},ea=function(e){return"number"==typeof e&&isNaN(e)},eo=function(e){return"boolean"==typeof e||null===e||X(e)||"number"==typeof e&&!isNaN(e)||"string"==typeof e||es(e)},el=function(e){return e.replace(/\./g,"\\.")},ec=function(e){return e.map(String).map(el).join(".")},ed=function(e){for(var t=[],r="",i=0;i<e.length;i++){var n=e.charAt(i);if("\\"===n&&"."===e.charAt(i+1)){r+=".",i++;continue}if("."===n){t.push(r),r="";continue}r+=n}var s=r;return t.push(s),t},eu=function(){return(eu=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},ep=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(o){n={error:o}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a},eh=function(e,t){for(var r=0,i=t.length,n=e.length;r<i;r++,n++)e[n]=t[r];return e};function em(e,t,r,i){return{isApplicable:e,annotation:t,transform:r,untransform:i}}var ef=[em(X,"undefined",function(){return null},function(){}),em(function(e){return"bigint"==typeof e},"bigint",function(e){return e.toString()},function(e){return"undefined"!=typeof BigInt?BigInt(e):(console.error("Please add a BigInt polyfill."),e)}),em(function(e){return e instanceof Date&&!isNaN(e.valueOf())},"Date",function(e){return e.toISOString()},function(e){return new Date(e)}),em(function(e){return e instanceof Error},"Error",function(e,t){var r={name:e.name,message:e.message};return t.allowedErrorProps.forEach(function(t){r[t]=e[t]}),r},function(e,t){var r=Error(e.message);return r.name=e.name,r.stack=e.stack,t.allowedErrorProps.forEach(function(t){r[t]=e[t]}),r}),em(function(e){return e instanceof RegExp},"regexp",function(e){return""+e},function(e){return RegExp(e.slice(1,e.lastIndexOf("/")),e.slice(e.lastIndexOf("/")+1))}),em(en,"set",function(e){return eh([],ep(e.values()))},function(e){return new Set(e)}),em(ei,"map",function(e){return eh([],ep(e.entries()))},function(e){return new Map(e)}),em(function(e){var t;return ea(e)||(t=e)===1/0||t===-1/0},"number",function(e){return ea(e)?"NaN":e>0?"Infinity":"-Infinity"},Number),em(function(e){return 0===e&&1/e==-1/0},"number",function(){return"-0"},Number),em(function(e){return e instanceof URL},"URL",function(e){return e.toString()},function(e){return new URL(e)})];function eg(e,t,r,i){return{isApplicable:e,annotation:t,transform:r,untransform:i}}var ev=eg(function(e,t){return!!es(e)&&!!t.symbolRegistry.getIdentifier(e)},function(e,t){return["symbol",t.symbolRegistry.getIdentifier(e)]},function(e){return e.description},function(e,t,r){var i=r.symbolRegistry.getValue(t[1]);if(!i)throw Error("Trying to deserialize unknown symbol");return i}),ey=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce(function(e,t){return e[t.name]=t,e},{}),eb=eg(function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},function(e){return["typed-array",e.constructor.name]},function(e){return eh([],ep(e))},function(e,t){var r=ey[t[1]];if(!r)throw Error("Trying to deserialize unknown typed array");return new r(e)});function ew(e,t){return null!=e&&!!e.constructor&&!!t.classRegistry.getIdentifier(e.constructor)}var e_=eg(ew,function(e,t){return["class",t.classRegistry.getIdentifier(e.constructor)]},function(e,t){var r=t.classRegistry.getAllowedProps(e.constructor);if(!r)return eu({},e);var i={};return r.forEach(function(t){i[t]=e[t]}),i},function(e,t,r){var i=r.classRegistry.getValue(t[1]);if(!i)throw Error("Trying to deserialize unknown class - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564");return Object.assign(Object.create(i.prototype),e)}),eS=eg(function(e,t){return!!t.customTransformerRegistry.findApplicable(e)},function(e,t){return["custom",t.customTransformerRegistry.findApplicable(e).name]},function(e,t){return t.customTransformerRegistry.findApplicable(e).serialize(e)},function(e,t,r){var i=r.customTransformerRegistry.findByName(t[1]);if(!i)throw Error("Trying to deserialize unknown custom value");return i.deserialize(e)}),ex=[e_,ev,eS,eb],eC=function(e,t){var r=Y(ex,function(r){return r.isApplicable(e,t)});if(r)return{value:r.transform(e,t),type:r.annotation(e,t)};var i=Y(ef,function(r){return r.isApplicable(e,t)});if(i)return{value:i.transform(e,t),type:i.annotation}},eT={};ef.forEach(function(e){eT[e.annotation]=e});var ek=function(e,t,r){if(er(t))switch(t[0]){case"symbol":return ev.untransform(e,t,r);case"class":return e_.untransform(e,t,r);case"custom":return eS.untransform(e,t,r);case"typed-array":return eb.untransform(e,t,r);default:throw Error("Unknown transformation: "+t)}else{var i=eT[t];if(!i)throw Error("Unknown transformation: "+t);return i.untransform(e,r)}},eR=function(e,t){for(var r=e.keys();t>0;)r.next(),t--;return r.next().value};function eE(e){if(Q(e,"__proto__"))throw Error("__proto__ is not allowed as a property");if(Q(e,"prototype"))throw Error("prototype is not allowed as a property");if(Q(e,"constructor"))throw Error("constructor is not allowed as a property")}var eP=function(e,t){eE(t);for(var r=0;r<t.length;r++){var i=t[r];if(en(e))e=eR(e,+i);else if(ei(e)){var n=+i,s=0==+t[++r]?"key":"value",a=eR(e,n);switch(s){case"key":e=a;break;case"value":e=e.get(a)}}else e=e[i]}return e},eD=function(e,t,r){if(eE(t),0===t.length)return r(e);for(var i=e,n=0;n<t.length-1;n++){var s=t[n];if(er(i))i=i[+s];else if(ee(i))i=i[s];else if(en(i)){var a=+s;i=eR(i,a)}else if(ei(i)){if(n===t.length-2)break;var a=+s,o=0==+t[++n]?"key":"value",l=eR(i,a);switch(o){case"key":i=l;break;case"value":i=i.get(l)}}}var c=t[t.length-1];if(er(i)?i[+c]=r(i[+c]):ee(i)&&(i[c]=r(i[c])),en(i)){var d=eR(i,+c),u=r(d);d!==u&&(i.delete(d),i.add(u))}if(ei(i)){var a=+t[t.length-2],p=eR(i,a),o=0==+c?"key":"value";switch(o){case"key":var h=r(p);i.set(h,i.get(p)),h!==p&&i.delete(p);break;case"value":i.set(p,r(i.get(p)))}}return e},eL=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(o){n={error:o}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a},eI=function(e,t){for(var r=0,i=t.length,n=e.length;r<i;r++,n++)e[n]=t[r];return e},eM=function(e,t,r,i,n){if(void 0===i&&(i=[]),void 0===n&&(n=[]),eo(e)||(s=e,a=i,(l=(o=t).get(s))?l.push(a):o.set(s,[a])),!(ee(e)||er(e)||ei(e)||en(e)||ew(e,r))){var s,a,o,l,c,d=eC(e,r);return d?{transformedValue:d.value,annotations:[d.type]}:{transformedValue:e}}if(Q(n,e))return{transformedValue:null};var u=eC(e,r),p=null!==(c=null==u?void 0:u.value)&&void 0!==c?c:e;eo(e)||(n=eI(eI([],eL(n)),[e]));var h=er(p)?[]:{},m={};return(G(p,function(e,s){var a=eM(e,t,r,eI(eI([],eL(i)),[s]),n);h[s]=a.transformedValue,er(a.annotations)?m[s]=a.annotations:ee(a.annotations)&&G(a.annotations,function(e,t){m[el(s)+"."+t]=e})}),et(m))?{transformedValue:h,annotations:u?[u.type]:void 0}:{transformedValue:h,annotations:u?[u.type,m]:m}};function ej(e){return Object.prototype.toString.call(e).slice(8,-1)}function eO(e){return"Array"===ej(e)}var eA=function(){return(eA=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},eN=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(o){n={error:o}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a},eF=function(e,t){for(var r=0,i=t.length,n=e.length;r<i;r++,n++)e[n]=t[r];return e},eq=function(){function e(){this.classRegistry=new W,this.symbolRegistry=new $(function(e){var t;return null!==(t=e.description)&&void 0!==t?t:""}),this.customTransformerRegistry=new J,this.allowedErrorProps=[]}return e.prototype.serialize=function(e){var t,r,i=new Map,n=eM(e,i,this),s={json:n.transformedValue};n.annotations&&(s.meta=eA(eA({},s.meta),{values:n.annotations}));var a=(t={},r=void 0,(i.forEach(function(e){if(!(e.length<=1)){var i=eL(e.map(function(e){return e.map(String)}).sort(function(e,t){return e.length-t.length})),n=i[0],s=i.slice(1);0===n.length?r=s.map(ec):t[ec(n)]=s.map(ec)}}),r)?et(t)?[r]:[r,t]:et(t)?void 0:t);return a&&(s.meta=eA(eA({},s.meta),{referentialEqualities:a})),s},e.prototype.deserialize=function(e){var t,r,i,n=e.json,s=e.meta,a=function e(t,r={}){if(eO(t))return t.map(t=>e(t,r));if(!function(e){if("Object"!==ej(e))return!1;let t=Object.getPrototypeOf(e);return!!t&&t.constructor===Object&&t===Object.prototype}(t))return t;let i=Object.getOwnPropertyNames(t),n=Object.getOwnPropertySymbols(t);return[...i,...n].reduce((i,n)=>{if(eO(r.props)&&!r.props.includes(n))return i;let s=t[n],a=e(s,r);return function(e,t,r,i,n){let s=({}).propertyIsEnumerable.call(i,t)?"enumerable":"nonenumerable";"enumerable"===s&&(e[t]=r),n&&"nonenumerable"===s&&Object.defineProperty(e,t,{value:r,enumerable:!1,writable:!0,configurable:!0})}(i,n,a,t,r.nonenumerable),i},{})}(n);return(null==s?void 0:s.values)&&(t=a,r=s.values,i=this,function e(t,r,i){if(void 0===i&&(i=[]),t){if(!er(t)){G(t,function(t,n){return e(t,r,eI(eI([],eL(i)),eL(ed(n))))});return}var n=eL(t,2),s=n[0],a=n[1];a&&G(a,function(t,n){e(t,r,eI(eI([],eL(i)),eL(ed(n))))}),r(s,i)}}(r,function(e,r){t=eD(t,r,function(t){return ek(t,e,i)})}),a=t),(null==s?void 0:s.referentialEqualities)&&(a=function(e,t){function r(t,r){var i=eP(e,ed(r));t.map(ed).forEach(function(t){e=eD(e,t,function(){return i})})}if(er(t)){var i=eL(t,2),n=i[0],s=i[1];n.forEach(function(t){e=eD(e,ed(t),function(){return e})}),s&&G(s,r)}else G(t,r);return e}(a,s.referentialEqualities)),a},e.prototype.stringify=function(e){return JSON.stringify(this.serialize(e))},e.prototype.parse=function(e){return this.deserialize(JSON.parse(e))},e.prototype.registerClass=function(e,t){this.classRegistry.register(e,t)},e.prototype.registerSymbol=function(e,t){this.symbolRegistry.register(e,t)},e.prototype.registerCustom=function(e,t){this.customTransformerRegistry.register(eA({name:t},e))},e.prototype.allowErrorProps=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this.allowedErrorProps).push.apply(e,eF([],eN(t)))},e.defaultInstance=new e,e.serialize=e.defaultInstance.serialize.bind(e.defaultInstance),e.deserialize=e.defaultInstance.deserialize.bind(e.defaultInstance),e.stringify=e.defaultInstance.stringify.bind(e.defaultInstance),e.parse=e.defaultInstance.parse.bind(e.defaultInstance),e.registerClass=e.defaultInstance.registerClass.bind(e.defaultInstance),e.registerSymbol=e.defaultInstance.registerSymbol.bind(e.defaultInstance),e.registerCustom=e.defaultInstance.registerCustom.bind(e.defaultInstance),e.allowErrorProps=e.defaultInstance.allowErrorProps.bind(e.defaultInstance),e}();eq.serialize,eq.deserialize,eq.stringify,eq.parse,eq.registerClass,eq.registerCustom,eq.registerSymbol,eq.allowErrorProps;var eB=r(1604);function eU(){eU=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(c){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var s,a,o=Object.create((t&&t.prototype instanceof h?t:h).prototype);return i(o,"_invoke",{value:(s=new C(n||[]),a="suspendedStart",function(t,i){if("executing"===a)throw Error("Generator is already running");if("completed"===a){if("throw"===t)throw i;return k()}for(s.method=t,s.arg=i;;){var n=s.delegate;if(n){var o=function e(t,r){var i=r.method,n=t.iterator[i];if(void 0===n)return r.delegate=null,"throw"===i&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+i+"' method")),p;var s=u(n,t.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,p;var a=s.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):a:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,p)}(n,s);if(o){if(o===p)continue;return o}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";var l=u(e,r,s);if("normal"===l.type){if(a=s.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:s.done}}"throw"===l.type&&(a="completed",s.method="throw",s.arg=l.arg)}})}),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(i){return{type:"throw",arg:i}}}e.wrap=d;var p={};function h(){}function m(){}function f(){}var g={};l(g,s,function(){return this});var v=Object.getPrototypeOf,y=v&&v(v(T([])));y&&y!==t&&r.call(y,s)&&(g=y);var b=f.prototype=h.prototype=Object.create(g);function w(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function _(e,t){var n;i(this,"_invoke",{value:function(i,s){function a(){return new t(function(n,a){!function i(n,s,a,o){var l=u(e[n],e,s);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,a,o)},function(e){i("throw",e,a,o)}):t.resolve(d).then(function(e){c.value=e,a(c)},function(e){return i("throw",e,a,o)})}o(l.arg)}(i,s,n,a)})}return n=n?n.then(a,a):a()}})}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function T(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return m.prototype=f,i(b,"constructor",{value:f,configurable:!0}),i(f,"constructor",{value:m,configurable:!0}),m.displayName=l(f,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,o,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},w(_.prototype),l(_.prototype,a,function(){return this}),e.AsyncIterator=_,e.async=function(t,r,i,n,s){void 0===s&&(s=Promise);var a=new _(d(t,r,i,n),s);return e.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},w(b),l(b,o,"Generator"),l(b,s,function(){return this}),l(b,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return a.type="throw",a.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(o&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;x(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},e}function eH(e,t,r,i,n,s,a){try{var o=e[s](a),l=o.value}catch(c){r(c);return}o.done?t(l):Promise.resolve(l).then(i,n)}function ez(e){return function(){var t=this,r=arguments;return new Promise(function(i,n){var s=e.apply(t,r);function a(e){eH(s,i,n,a,o,"next",e)}function o(e){eH(s,i,n,a,o,"throw",e)}a(void 0)})}}var eV=eB.z.object({data:eB.z.object({challenge:eB.z.object({text:eB.z.string()})})}),e$=function(e){let t=new D(e),r=u(e=>t.hasOwnProperty(e)?t[e]:"__untypedClient"===e?t:d(({path:r,args:i})=>{let n=[e,...r],s=I(n.pop()),a=n.join(".");return t[s](a,...i)}));return r}({transformer:eq,links:[E({url:"https://sdk-iriko.huddle01.com/trpc"})]}),eZ=(U=ez(eU().mark(function e(t){var r,i;return eU().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.Z.request({method:"POST",url:"https://api.lens.dev/",headers:{"Content-Type":"application/json"},data:{query:"query Challenge($request: ChallengeRequest!) {\n                challenge(request: $request) { text }\n              }",variables:{request:{address:t}}}});case 2:return r=e.sent.data,i=eV.parse(r).data.challenge.text,e.abrupt("return",{message:i});case 6:case"end":return e.stop()}},e)})),function(e){return U.apply(this,arguments)}),eW=(H=ez(eU().mark(function e(t,r){var i,n,s;return eU().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=function(){var e=ez(eU().mark(function e(){return eU().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.Z.request({method:"POST",url:"https://api.lens.dev/",headers:{"Content-Type":"application/json"},data:{query:"mutation ($request: SignedAuthChallenge!) { \n            authenticate(request: $request) {\n              accessToken\n              refreshToken\n            }\n          }",variables:{request:{address:r,signature:t}}}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),e.next=4,i();case 4:return n=e.sent,e.next=7,e$.auth.login.mutate({address:r,chain:"lens",accessToken:n.data.data.authenticate.accessToken,walletName:"lens"});case 7:return s=e.sent,e.abrupt("return",{accessToken:s.accessToken});case 11:throw e.prev=11,e.t0=e.catch(0),Error("Error getting lens access token");case 14:case"end":return e.stop()}},e,null,[[0,11]])})),function(e,t){return H.apply(this,arguments)})},64985:function(e,t,r){"use strict";r.d(t,{y:function(){return l}});var i=r(3407),n=r(62810),s=r(67294),a=r(94464),o=["roomState"],l=function(){var e=(0,i.u)(),t=(0,n._)(e,2),r=t[0],l=r.roomState,c=(0,n.a)(r,o),d=t[1],u=(0,s.useState)(""),p=(0,n._)(u,2),h=p[0],m=p[1],f=(0,s.useState)(!1),g=(0,n._)(f,2),v=g[0],y=g[1],b=(0,i.a)(),w=(0,n._)(b,2),_=w[0],S=w[1],x=function(e){y(!0);try{"ROOM"===l&&(a.m.setDisplayName(e),console.log("DisplayName Broadcasted to everyone")),d((0,i._)((0,i._)({},c),{},{roomState:l})),S(function(t){return(0,i._)((0,i._)({},t),{},{displayName:e})})}catch(t){throw m(t),Error(t)}finally{y(!1)}};return x.isCallable="ROOM"===l,{setDisplayName:x,error:h,isLoading:v,displayName:_.displayName}}},93053:function(e,t,r){"use strict";r.d(t,{B:function(){return l}});var i=r(33786),n=r(62810),s=r(67294);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r(94464);var o=["peerId","track","debug"],l=function(e){var t=e.peerId,r=e.track,l=e.debug,c=(0,n.a)(e,o),d=(0,s.useRef)(null),u=(0,i.u)(t).peer,p=function(e){var t=new MediaStream;return t.addTrack(e),t};return(0,s.useEffect)(function(){var e=r||(null==u?void 0:u.mic),t=d.current;t&&e&&(t.srcObject=p(e),t.onloadedmetadata=(0,i._)((0,i.a)().mark(function e(){return(0,i.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("audioCard() | Metadata loaded..."),e.prev=1,e.next=4,t.play();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:case"end":return e.stop()}},e,null,[[1,6]])})),t.onerror=function(){console.error("audioCard() | Error is hapenning...")})},[]),s.createElement(s.Fragment,null,l&&s.createElement("div",null,t),s.createElement("audio",a({},c,{ref:d}),"Audio"))}},3407:function(e,t,r){"use strict";r.d(t,{_:function(){return l},a:function(){return p},c:function(){return a},d:function(){return s},u:function(){return d}});var i=r(48583),n=r(15103);function s(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t,r){return(t=s(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var c=(0,n.cn)({roomState:"IDLE",roomId:""}),d=function(){return(0,i.KO)(c)},u=(0,n.cn)({meId:"",displayName:"",role:""}),p=function(){return(0,i.KO)(u)}},62810:function(e,t,r){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=s.call(r)).done)&&(o.push(i.value),o.length!==t);l=!0);}catch(d){c=!0,n=d}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}r.d(t,{_:function(){return n},a:function(){return s}})},33786:function(e,t,r){"use strict";r.d(t,{_:function(){return l},a:function(){return a},u:function(){return c}});var i=r(62810),n=r(67294),s=r(94464);function a(){a=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",l=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(d){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var s,a,o=Object.create((t&&t.prototype instanceof m?t:m).prototype);return i(o,"_invoke",{value:(s=new T(n||[]),a="suspendedStart",function(t,i){if("executing"===a)throw Error("Generator is already running");if("completed"===a){if("throw"===t)throw i;return R()}for(s.method=t,s.arg=i;;){var n=s.delegate;if(n){var o=function e(t,r){var i=r.method,n=t.iterator[i];if(void 0===n)return r.delegate=null,"throw"===i&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+i+"' method")),h;var s=p(n,t.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,h;var a=s.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):a:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,h)}(n,s);if(o){if(o===h)continue;return o}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";var l=p(e,r,s);if("normal"===l.type){if(a=s.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:s.done}}"throw"===l.type&&(a="completed",s.method="throw",s.arg=l.arg)}})}),o}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(i){return{type:"throw",arg:i}}}e.wrap=u;var h={};function m(){}function f(){}function g(){}var v={};c(v,s,function(){return this});var y=Object.getPrototypeOf,b=y&&y(y(k([])));b&&b!==t&&r.call(b,s)&&(v=b);var w=g.prototype=m.prototype=Object.create(v);function _(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function S(e,t){var n;i(this,"_invoke",{value:function(i,s){function a(){return new t(function(n,a){!function i(n,s,a,o){var l=p(e[n],e,s);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,a,o)},function(e){i("throw",e,a,o)}):t.resolve(d).then(function(e){c.value=e,a(c)},function(e){return i("throw",e,a,o)})}o(l.arg)}(i,s,n,a)})}return n=n?n.then(a,a):a()}})}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function k(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=g,i(w,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:f,configurable:!0}),f.displayName=c(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},_(S.prototype),c(S.prototype,o,function(){return this}),e.AsyncIterator=S,e.async=function(t,r,i,n,s){void 0===s&&(s=Promise);var a=new S(u(t,r,i,n),s);return e.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},_(w),c(w,l,"Generator"),c(w,s,function(){return this}),c(w,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=k,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return a.type="throw",a.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(o&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}function o(e,t,r,i,n,s,a){try{var o=e[s](a),l=o.value}catch(c){r(c);return}o.done?t(l):Promise.resolve(l).then(i,n)}function l(e){return function(){var t=this,r=arguments;return new Promise(function(i,n){var s=e.apply(t,r);function a(e){o(s,i,n,a,l,"next",e)}function l(e){o(s,i,n,a,l,"throw",e)}a(void 0)})}}var c=function(e){var t=(0,n.useState)(null),r=(0,i._)(t,2),a=r[0],o=r[1],l=(0,n.useState)({audio:null,video:null}),c=(0,i._)(l,2),d=c[0],u=c[1],p={peerId:e,role:null==a?void 0:a.role,mic:d.audio,cam:d.video,displayName:null==a?void 0:a.displayName};return(0,n.useEffect)(function(){var t=s.m.getPeer(e),r=s.m.getPeerTracks(e);o(t),u(r)},[]),{peer:p,error:null}}},88037:function(e,t,r){"use strict";r.d(t,{QV:function(){return m},LV:function(){return p},m6:function(){return f},P0:function(){return g},NW:function(){return v}});var i=r(3407),n=r(33786),s=r(62810),a=r(67294),o=r(94464),l=r(15103),c=r(48583),d=(0,l.cn)({}),u=["roomState"];function p(){var e=(0,i.u)(),t=(0,s._)(e,2),r=t[0],n=r.roomState,l=(0,s.a)(r,u),c=t[1],d=(0,i.a)(),p=(0,s._)(d,2),h=p[0],m=p[1],f=function(e){o.m.initialize(e);var t=o.m.getMeId();m(function(e){return(0,i._)((0,i._)({},e),{},{meId:t})})},g="IDLE"!==n;return f.isCallable=!g,(0,a.useEffect)(function(){o.m.on("app:initialized",function(){c((0,i._)((0,i._)({},l),{},{roomState:"INIT"}))}),o.m.on("room:me-role-update",function(e){m(function(t){return(0,i._)((0,i._)({},t),{},{role:e})})})},[]),{initialize:f,isInitialized:g,roomState:n,me:h}}var h=function(e,t){(0,a.useEffect)(function(){return o.m.on(e,t),function(){o.m.off(e,t)}},[])},m=function(){var e,t,r,l,c,d=(0,a.useState)(""),u=(0,s._)(d,2),p=u[0],h=u[1],m=(0,a.useState)(!1),f=(0,s._)(m,2),g=f[0],v=f[1],y=(0,a.useState)(null),b=(0,s._)(y,2),w=b[0],_=b[1],S=(0,a.useState)(!1),x=(0,s._)(S,2),C=x[0],T=x[1],k=(0,i.u)(),R=(0,s._)(k,1)[0],E=(0,a.useState)([]),P=(0,s._)(E,2),D=P[0],L=P[1],I=(e=(0,n._)((0,n.a)().mark(function e(t){var r;return(0,n.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.prev=1,e.next=4,o.m.fetchAudioStream(t);case 4:return r=e.sent,v(!1),_(r),e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(1),v(!1),h(e.t0),e.abrupt("return");case 15:return e.prev=15,v(!1),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[1,10,15,18]])})),function(t){return e.apply(this,arguments)}),M=function(){v(!0);try{o.m.stopAudioStream(),v(!1),_(null),T(!1)}catch(e){v(!1),h(e)}},j=(t=(0,n._)((0,n.a)().mark(function e(t){return(0,n.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(v(!0),e.prev=1,t){e.next=4;break}throw Error("No audio stream");case 4:o.m.produceAudio(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),v(!1),h(e.t0);case 11:case"end":return e.stop()}},e,null,[[1,7]])})),function(e){return t.apply(this,arguments)}),O=function(){v(!0);try{o.m.stopProducingAudio(),T(!1),v(!1)}catch(e){v(!1),h(e)}},A=(r=(0,n._)((0,n.a)().mark(function e(t){return(0,n.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.prev=1,e.next=4,o.m.createMicConsumer(t);case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),v(!1),h(e.t0);case 10:case"end":return e.stop()}},e,null,[[1,6]])})),function(e){return r.apply(this,arguments)}),N=(l=(0,n._)((0,n.a)().mark(function e(t){return(0,n.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:v(!0);try{o.m.closeMicConsumer(t)}catch(r){v(!1),h(r)}case 2:case"end":return e.stop()}},e)})),function(e){return l.apply(this,arguments)}),F=(c=(0,n._)((0,n.a)().mark(function e(){var t;return(0,n.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.m.enumerateMicDevices();case 2:return L(t=e.sent),e.abrupt("return",t);case 5:case"end":return e.stop()}},e)})),function(){return c.apply(this,arguments)});return F.isCallable=!0,I.isCallable=!g,j.isCallable="ROOM"===R.roomState,O.isCallable=C,M.isCallable=w||C,A.isCallable=!0,N.isCallable=!0,(0,a.useEffect)(function(){o.m.on("room:mic-produce-start",function(){v(!1),T(!0)}),o.m.on("room:mic-produce-stop",function(){v(!1),T(!1)})},[]),{stream:w,isLoading:g,isProducing:C,fetchAudioStream:I,produceAudio:j,stopProducingAudio:O,stopAudioStream:M,createMicConsumer:A,closeMicConsumer:N,error:p,micDevices:D,enumerateMicDevices:F}},f=function(){var e,t=(0,i.u)(),r=(0,s._)(t,2),l=r[0],c=r[1],d=(0,a.useState)(!1),u=(0,s._)(d,2),p=u[0],h=u[1],m=(0,a.useState)(null),f=(0,s._)(m,2),g=f[0],v=f[1],y=(e=(0,n._)((0,n.a)().mark(function e(t,r){return(0,n.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h(!0),o.m.joinLobby(t,r);case 2:case"end":return e.stop()}},e)})),function(t,r){return e.apply(this,arguments)}),b=function(){o.m.leaveLobby(),c({roomState:"INIT",roomId:""})};return y.isCallable="INIT"===l.roomState,b.isCallable="LOBBY"===l.roomState,(0,a.useEffect)(function(){o.m.on("lobby:joined",function(e){h(!1),c({roomState:"LOBBY",roomId:e})}),o.m.on("lobby:failed",function(e){h(!1),v(e)})},[]),{isLoading:p,isLobbyJoined:"LOBBY"===l.roomState||"ROOM"===l.roomState,joinLobby:y,leaveLobby:b,error:g}},g=function(){var e=(0,c.KO)(d),t=(0,s._)(e,2),r=t[0],n=t[1];return(0,a.useEffect)(function(){o.m.on("room:joined",function(e){var t={};Object.values(Object.fromEntries(e)).forEach(function(e){t[e.peerId]={peerId:e.peerId,role:e.role,mic:null,cam:null,displayName:e.displayName}}),n(t)}),o.m.on("room:peer-joined",function(e){var t=e.peerId,r=e.role,s=e.displayName;console.log("@huddle01/react | room:peer-left");var a={peerId:t,role:r,mic:null,cam:null,displayName:s};n(function(e){return(0,i._)((0,i._)({},e),{},(0,i.c)({},t,a))})}),o.m.on("room:peer-produce-start",function(e){var t=e.peerId,r=e.mediaType,a=e.track;console.log("@huddle01/react | room:peer-produce-start"),n(function(e){var n=e[t],o=(0,s.a)(e,[t].map(i.d));return(0,i._)((0,i._)({},o),{},(0,i.c)({},t,(0,i._)((0,i._)({},n),{},(0,i.c)({},r,a))))})}),o.m.on("room:peer-produce-stop",function(e){var t=e.peerId,r=e.mediaType;console.log("@huddle01/react | room:peer-produce-stop"),n(function(e){var n=e[t],a=(0,s.a)(e,[t].map(i.d));return(0,i._)((0,i._)({},a),{},(0,i.c)({},t,(0,i._)((0,i._)({},n),{},(0,i.c)({},r,null))))})}),o.m.on("room:peer-left",function(e){console.log("@huddle01/react | room:peer-left"),n(function(t){var r=(0,i._)({},t);return delete r[e],r})})},[]),h("room:peer-name-update",function(e,t){n(function(r){return(0,i._)((0,i._)({},r),{},(0,i.c)({},e,(0,i._)((0,i._)({},r[e]),{},{displayName:t})))})}),{peers:r}},v=function(){var e=(0,a.useState)(null),t=(0,s._)(e,2),r=t[0],n=t[1],l=(0,a.useState)(!1),c=(0,s._)(l,2),d=c[0],u=c[1],p=(0,i.u)(),h=(0,s._)(p,2),m=h[0],f=m.roomId,g=m.roomState,v=h[1],y=function(){u(!0),o.m.joinRoom()},b=function(){o.m.leaveRoom(),v(function(e){return(0,i._)((0,i._)({},e),{},{roomState:"INIT"})})};return y.isCallable="LOBBY"===g,b.isCallable="ROOM"===g,(0,a.useEffect)(function(){o.m.on("room:joined",function(){u(!1),v(function(e){return(0,i._)((0,i._)({},e),{},{roomState:"ROOM"})})}),o.m.on("room:failed",function(e){u(!1),n(e)})},[]),{roomId:f,isLoading:d,isRoomJoined:b.isCallable,joinRoom:y,leaveRoom:b,error:r}}},35385:function(e,t,r){"use strict";let i,n,s;r.d(t,{e:function(){return sA}});var a,o,l,c,d,u,p,h,m,f=r(69753),g=r(67294),v=r.t(g,2),y=r(18607);function b(){let e=(0,y.g)();return e.provider}var w=r(61688);let _=w.useSyncExternalStore;var S=r(32161),x=r(89886),C=r(30081),T=r(33989);class k extends T.l{constructor(e,t){super(),this.client=e,this.setOptions(t),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.client.defaultMutationOptions(e),(0,S.VS)(t,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this})}onUnsubscribe(){if(!this.listeners.length){var e;null==(e=this.currentMutation)||e.removeObserver(this)}}onMutationUpdate(e){this.updateResult();let t={listeners:!0};"success"===e.type?t.onSuccess=!0:"error"===e.type&&(t.onError=!0),this.notify(t)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:void 0!==e?e:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){let e=this.currentMutation?this.currentMutation.state:(0,x.R)(),t={...e,isLoading:"loading"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset};this.currentResult=t}notify(e){C.V.batch(()=>{if(this.mutateOptions&&this.hasListeners()){var t,r,i,n,s,a,o,l;e.onSuccess?(null==(t=(r=this.mutateOptions).onSuccess)||t.call(r,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(i=(n=this.mutateOptions).onSettled)||i.call(n,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)):e.onError&&(null==(s=(a=this.mutateOptions).onError)||s.call(a,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(o=(l=this.mutateOptions).onSettled)||o.call(l,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context))}e.listeners&&this.listeners.forEach(e=>{e(this.currentResult)})})}}var R=r(51098);function E(e,t){return"function"==typeof e?e(...t):!!e}function P(){}var D=r(15761),L=r(72379);class I extends T.l{constructor(e,t){super(),this.client=e,this.options=t,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(t)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.length&&(this.currentQuery.addObserver(this),M(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.listeners.length||this.destroy()}shouldFetchOnReconnect(){return j(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return j(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=[],this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(e,t){let r=this.options,i=this.currentQuery;if(this.options=this.client.defaultQueryOptions(e),(0,S.VS)(r,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled)throw Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=r.queryKey),this.updateQuery();let n=this.hasListeners();n&&O(this.currentQuery,i,this.options,r)&&this.executeFetch(),this.updateResult(t),n&&(this.currentQuery!==i||this.options.enabled!==r.enabled||this.options.staleTime!==r.staleTime)&&this.updateStaleTimeout();let s=this.computeRefetchInterval();n&&(this.currentQuery!==i||this.options.enabled!==r.enabled||s!==this.currentRefetchInterval)&&this.updateRefetchInterval(s)}getOptimisticResult(e){let t=this.client.getQueryCache().build(this.client,e);return this.createResult(t,e)}getCurrentResult(){return this.currentResult}trackResult(e){let t={};return Object.keys(e).forEach(r=>{Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(r),e[r])})}),t}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:e,...t}={}){return this.fetch({...t,meta:{refetchPage:e}})}fetchOptimistic(e){let t=this.client.defaultQueryOptions(e),r=this.client.getQueryCache().build(this.client,t);return r.isFetchingOptimistic=!0,r.fetch().then(()=>this.createResult(r,t))}fetch(e){var t;return this.executeFetch({...e,cancelRefetch:null==(t=e.cancelRefetch)||t}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(e){this.updateQuery();let t=this.currentQuery.fetch(this.options,e);return null!=e&&e.throwOnError||(t=t.catch(S.ZT)),t}updateStaleTimeout(){if(this.clearStaleTimeout(),S.sk||this.currentResult.isStale||!(0,S.PN)(this.options.staleTime))return;let e=(0,S.Kp)(this.currentResult.dataUpdatedAt,this.options.staleTime);this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},e+1)}computeRefetchInterval(){var e;return"function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.currentResult.data,this.currentQuery):null!=(e=this.options.refetchInterval)&&e}updateRefetchInterval(e){this.clearRefetchInterval(),this.currentRefetchInterval=e,!S.sk&&!1!==this.options.enabled&&(0,S.PN)(this.currentRefetchInterval)&&0!==this.currentRefetchInterval&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||D.j.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(e,t){let r;let i=this.currentQuery,n=this.options,s=this.currentResult,a=this.currentResultState,o=this.currentResultOptions,l=e!==i,c=l?e.state:this.currentQueryInitialState,d=l?this.currentResult:this.previousQueryResult,{state:u}=e,{dataUpdatedAt:p,error:h,errorUpdatedAt:m,fetchStatus:f,status:g}=u,v=!1,y=!1;if(t._optimisticResults){let b=this.hasListeners(),w=!b&&M(e,t),_=b&&O(e,i,t,n);(w||_)&&(f=(0,L.Kw)(e.options.networkMode)?"fetching":"paused",p||(g="loading")),"isRestoring"===t._optimisticResults&&(f="idle")}if(t.keepPreviousData&&!u.dataUpdatedAt&&null!=d&&d.isSuccess&&"error"!==g)r=d.data,p=d.dataUpdatedAt,g=d.status,v=!0;else if(t.select&&void 0!==u.data){if(s&&u.data===(null==a?void 0:a.data)&&t.select===this.selectFn)r=this.selectResult;else try{this.selectFn=t.select,r=t.select(u.data),r=(0,S.oE)(null==s?void 0:s.data,r,t),this.selectResult=r,this.selectError=null}catch(x){this.selectError=x}}else r=u.data;if(void 0!==t.placeholderData&&void 0===r&&"loading"===g){let C;if(null!=s&&s.isPlaceholderData&&t.placeholderData===(null==o?void 0:o.placeholderData))C=s.data;else if(C="function"==typeof t.placeholderData?t.placeholderData():t.placeholderData,t.select&&void 0!==C)try{C=t.select(C),this.selectError=null}catch(T){this.selectError=T}void 0!==C&&(g="success",r=(0,S.oE)(null==s?void 0:s.data,C,t),y=!0)}this.selectError&&(h=this.selectError,r=this.selectResult,m=Date.now(),g="error");let k="fetching"===f,R="loading"===g,E="error"===g,P={status:g,fetchStatus:f,isLoading:R,isSuccess:"success"===g,isError:E,isInitialLoading:R&&k,data:r,dataUpdatedAt:p,error:h,errorUpdatedAt:m,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>c.dataUpdateCount||u.errorUpdateCount>c.errorUpdateCount,isFetching:k,isRefetching:k&&!R,isLoadingError:E&&0===u.dataUpdatedAt,isPaused:"paused"===f,isPlaceholderData:y,isPreviousData:v,isRefetchError:E&&0!==u.dataUpdatedAt,isStale:A(e,t),refetch:this.refetch,remove:this.remove};return P}updateResult(e){let t=this.currentResult,r=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,(0,S.VS)(r,t))return;this.currentResult=r;let i={cache:!0};(null==e?void 0:e.listeners)!==!1&&(()=>{if(!t)return!0;let{notifyOnChangeProps:e}=this.options;if("all"===e||!e&&!this.trackedProps.size)return!0;let r=new Set(null!=e?e:this.trackedProps);return this.options.useErrorBoundary&&r.add("error"),Object.keys(this.currentResult).some(e=>{let i=this.currentResult[e]!==t[e];return i&&r.has(e)})})()&&(i.listeners=!0),this.notify({...i,...e})}updateQuery(){let e=this.client.getQueryCache().build(this.client,this.options);if(e===this.currentQuery)return;let t=this.currentQuery;this.currentQuery=e,this.currentQueryInitialState=e.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(null==t||t.removeObserver(this),e.addObserver(this))}onQueryUpdate(e){let t={};"success"===e.type?t.onSuccess=!e.manual:"error"!==e.type||(0,L.DV)(e.error)||(t.onError=!0),this.updateResult(t),this.hasListeners()&&this.updateTimers()}notify(e){C.V.batch(()=>{var t,r,i,n,s,a,o,l;e.onSuccess?(null==(t=(r=this.options).onSuccess)||t.call(r,this.currentResult.data),null==(i=(n=this.options).onSettled)||i.call(n,this.currentResult.data,null)):e.onError&&(null==(s=(a=this.options).onError)||s.call(a,this.currentResult.error),null==(o=(l=this.options).onSettled)||o.call(l,void 0,this.currentResult.error)),e.listeners&&this.listeners.forEach(e=>{e(this.currentResult)}),e.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function M(e,t){return!1!==t.enabled&&!e.state.dataUpdatedAt&&!("error"===e.state.status&&!1===t.retryOnMount)||e.state.dataUpdatedAt>0&&j(e,t,t.refetchOnMount)}function j(e,t,r){if(!1!==t.enabled){let i="function"==typeof r?r(e):r;return"always"===i||!1!==i&&A(e,t)}return!1}function O(e,t,r,i){return!1!==r.enabled&&(e!==t||!1===i.enabled)&&(!r.suspense||"error"!==e.state.status)&&A(e,r)}function A(e,t){return e.isStaleByTime(t.staleTime)}let N=g.createContext((n=!1,{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n})),F=()=>g.useContext(N),q=g.createContext(!1),B=()=>g.useContext(q);q.Provider;let U=(e,t)=>{(e.suspense||e.useErrorBoundary)&&!t.isReset()&&(e.retryOnMount=!1)},H=e=>{g.useEffect(()=>{e.clearReset()},[e])},z=({result:e,errorResetBoundary:t,useErrorBoundary:r,query:i})=>e.isError&&!t.isReset()&&!e.isFetching&&E(r,[e.error,i]),V=e=>{e.suspense&&"number"!=typeof e.staleTime&&(e.staleTime=1e3)},$=(e,t)=>e.isLoading&&e.isFetching&&!t,Z=(e,t,r)=>(null==e?void 0:e.suspense)&&$(t,r),W=(e,t,r)=>t.fetchOptimistic(e).then(({data:t})=>{null==e.onSuccess||e.onSuccess(t),null==e.onSettled||e.onSettled(t,null)}).catch(t=>{r.clearReset(),null==e.onError||e.onError(t),null==e.onSettled||e.onSettled(void 0,t)});var K=r(45216),G=r(38934);let Q=["cacheTime","networkMode","onError","onMutate","onSettled","onSuccess","retry","retryDelay","useErrorBoundary","meta"],Y=["cacheTime","enabled","networkMode","initialData","initialDataUpdatedAt","isDataEqual","keepPreviousData","meta","notifyOnChangeProps","onError","onSettled","onSuccess","placeholderData","refetchInterval","refetchIntervalInBackground","refetchOnMount","refetchOnReconnect","refetchOnWindowFocus","retry","retryOnMount","retryDelay","select","staleTime","structuralSharing","suspense","useErrorBoundary"];function J(e){let{data:t,dataUpdatedAt:r,error:i,errorUpdatedAt:n,failureCount:s,isError:a,isFetched:o,isFetchedAfterMount:l,isFetching:c,isPaused:d,isLoadingError:u,isPlaceholderData:p,isPreviousData:h,isRefetchError:m,isRefetching:f,isStale:v,isSuccess:y,refetch:b,remove:w,status:x,fetchStatus:T}=function(e,t,r){let i=(0,S._v)(e,void 0,void 0);return function(e,t){let r=(0,R.NL)({context:e.context}),i=B(),n=F(),s=r.defaultQueryOptions(e);s._optimisticResults=i?"isRestoring":"optimistic",s.onError&&(s.onError=C.V.batchCalls(s.onError)),s.onSuccess&&(s.onSuccess=C.V.batchCalls(s.onSuccess)),s.onSettled&&(s.onSettled=C.V.batchCalls(s.onSettled)),V(s),U(s,n),H(n);let[a]=g.useState(()=>new t(r,s)),o=a.getOptimisticResult(s);if(_(g.useCallback(e=>i?()=>void 0:a.subscribe(C.V.batchCalls(e)),[a,i]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),g.useEffect(()=>{a.setOptions(s,{listeners:!1})},[s,a]),Z(s,o,i))throw W(s,a,n);if(z({result:o,errorResetBoundary:n,useErrorBoundary:s.useErrorBoundary,query:a.getCurrentQuery()}))throw o.error;return s.notifyOnChangeProps?o:a.trackResult(o)}(i,I)}({...e,context:G.Q}),k=(0,g.useMemo)(()=>"loading"===x&&"idle"===T?"idle":x,[x,T]),E=(0,g.useMemo)(()=>"idle"===k,[k]),P=(0,g.useMemo)(()=>"loading"===k&&"fetching"===T,[k,T]);return{data:t,error:i,isError:a,isFetched:o,isFetching:c,isIdle:E,isLoading:P,isRefetching:f,isSuccess:y,refetch:b,status:k,internal:{fetchStatus:T,dataUpdatedAt:r,errorUpdatedAt:n,failureCount:s,isFetchedAfterMount:l,isLoadingError:u,isPaused:d,isPlaceholderData:p,isPreviousData:h,isRefetchError:m,isStale:v,remove:w}}}var X=r(3255),ee=r(52798);function et(){return(0,ee.useSyncExternalStoreWithSelector)(e=>(function(e){let t=(0,y.g)(),r=async()=>e(b()),i=t.subscribe(({provider:e})=>e,r);return i})(e),()=>b(),()=>b(),e=>e)}let er=(e,t)=>[{entity:"getPlaybackInfo",args:e,config:t}],ei=(e,t,r,i,n)=>{let s=g.useMemo(()=>e?t??r:i??n,[e,t,r,i,n]);return g.useMemo(()=>g.isValidElement(s)?g.cloneElement(s):null,[s])},en=(e,t)=>g.useMemo(()=>e&&g.isValidElement(e)?g.cloneElement(e):t,[e,t]);var es=r(84688),ea=r(5947),eo=r(85893);let el=({streamKey:e,children:t,controls:r,theme:i,title:n,onError:s,aspectRatio:a="16to9",objectFit:o="contain",mediaElementRef:l,onPlaybackStatusUpdate:c,playbackStatusSelector:d,renderChildrenOutsideContainer:u})=>{let p=et(),h=g.useMemo(()=>{let t=p.getConfig().webrtcIngestBaseUrl;return e&&t?`${t}/${e}`:null},[e,p]),[m,f]=g.useState(null),[v,y]=g.useState(null),b=g.useCallback(e=>{let t=e?{type:(0,es.Qi)(e)?"access-control":(0,es.kN)(e)?"offline":"unknown",message:e?.message??"Error with playback."}:null;return y(t),e&&(console.warn(e),s?.(e)),e},[s]);g.useEffect(()=>{e&&y(null)},[e]);let w=g.useCallback(e=>{e&&(f(e),l?.(e))},[l]),_=g.useMemo(()=>({ref:w,ingestUrl:h,objectFit:o,options:r,broadcastError:v,onBroadcastError:b,onPlaybackStatusUpdate:c,playbackStatusSelector:d}),[v,w,r,h,o,b,c,d]),S=g.useMemo(()=>({autoPlay:!1,playbackId:void 0,muted:!1,priority:!1,ingestUrl:h??void 0}),[h]),x=g.useMemo(()=>({hidePosterOnPlayed:!0,showLoadingSpinner:!0,loadingText:null,showUploadingIndicator:!1,error:v}),[v]),C=g.useMemo(()=>({ingestUrl:h,children:t,controls:r,theme:i,title:n,aspectRatio:a,objectFit:o,onBroadcastError:b,onPlaybackStatusUpdate:c,renderChildrenOutsideContainer:u}),[h,a,t,r,o,i,n,b,c,u]);return{mediaElement:m,broadcastProps:_,mediaControllerProps:S,controlsContainerProps:x,props:C}},ec=e=>{let[t,r]=g.useState(null),{onChange:i,thumbIcon:n,defaultThumbIcon:s,sliderWidth:a,ariaName:o,isActive:l,leftCss:c,middleCss:d,rightCss:u,thumbCss:p}=e,h=l||null!==t,m=g.useCallback(async(e,t)=>{if(a){let n=Math.min(Math.max(0,e/a),1);t?(await i?.(n),r(null)):r(n)}},[i,a]),{value:f,middleValue:v}=g.useMemo(()=>{let r=null!==t?t:isNaN(e.value)?0:e.value,i=null!==t?0:!e.secondaryValue||isNaN(e.value)||isNaN(e.secondaryValue)?0:e.secondaryValue-e.value;return{value:r,middleValue:i>0?i:0}},[t,e.value,e.secondaryValue]),y=g.useMemo(()=>({css:{...p,zIndex:1},size:h?"active":"default"}),[p,h]),b=en(n,g.cloneElement(s,y)),w=g.useMemo(()=>1-(f+v),[f,v]),_=g.useMemo(()=>Math.round(100*f),[f]);return{title:`${_}% ${o}`,value:_,active:h,handle:b,sliderProps:{onUpdate:m},sliderLeftTrackProps:{shown:f>.001,rounded:1!==f||h?"left":"full",css:{...c,flex:f}},sliderMiddleTrackProps:{shown:(v??0)>0,rounded:1===v?h?"right":"full":f<=.001?"left":0===w?"right":"none",css:{...d,flex:v}},sliderRightTrackProps:{shown:(w??0)>0,rounded:f<=.001&&!h?"full":"right",css:{...u,flex:w}}}},ed=e=>{let{togglePlay:t,canPlay:r,buffered:i,isBroadcast:n,_updateLastInteraction:s}=e,a=g.useMemo(()=>r||0!==i,[r,i]),o=g.useCallback(()=>{a&&(n?s():t())},[t,a,n,s]);return{isLoaded:a,containerProps:{onPress:o}}},eu=e=>{let{enterIcon:t,exitIcon:r,onPress:i,fullscreen:n,pictureInPicture:s,requestToggleFullscreen:a,defaultEnterIcon:o,defaultExitIcon:l,...c}=e,d=g.useCallback(async()=>{await i?.(),await a()},[i,a]),u=ei(n,r,l,t,o),p=g.useMemo(()=>n?"Exit full screen (f)":"Full screen (f)",[n]);return{title:p,buttonProps:s?null:{onPress:d,children:u,...c}}},ep=e=>{let{playIcon:t,pauseIcon:r,onPress:i,togglePlay:n,playing:s,defaultPauseIcon:a,defaultPlayIcon:o,...l}=e,c=async()=>{await i?.(),await n()},d=ei(s,r,a,t,o),u=g.useMemo(()=>s?"Pause (k)":"Play (k)",[s]);return{title:u,buttonProps:{onPress:c,children:d,...l}}},eh=e=>{let{duration:t,progress:r,requestSeek:i,buffered:n,live:s,...a}=e,[o,l,c]=g.useMemo(()=>[0,t&&!isNaN(t)?t:0,r&&!isNaN(r)?r:0],[t,r]),d=g.useMemo(()=>c/(l-o),[o,l,c]),u=g.useMemo(()=>n/(l-o),[o,l,n]),p=g.useCallback(async t=>{let r=t*(l-o);await e?.onSeek?.(r),i(r)},[l,o,i,e]),h=g.useMemo(()=>(t/60).toFixed(1),[t]);return{isVisible:!s,title:`progress of ${h} minutes`,progressProps:{onChange:p,value:d,secondaryValue:u,leftCss:{backgroundColor:"$progressLeft"},middleCss:{backgroundColor:"$progressMiddle"},rightCss:{backgroundColor:"$progressRight"},thumbCss:{backgroundColor:"$progressThumb"},...a}}},em=e=>{if(null!=e&&!isNaN(e)&&isFinite(e)){let t=Math.round(e),r=Math.floor(t/3600),i=Math.floor(t%60);return r>0?`${r}:${Math.floor(t%3600/60).toString().padStart(2,"0")}:${i<10?"0":""}${i}`:`${Math.floor(t/60)}:${i.toString().padStart(2,"0")}`}return"0:00"},ef=e=>{let{duration:t,progress:r,live:i}=e,n=g.useMemo(()=>em(r??null),[r]),s=g.useMemo(()=>em(t??null),[t]),a=g.useMemo(()=>i?n:`${n} / ${s}`,[n,s,i]);return{title:a,live:i}},eg=e=>{let{unmutedIcon:t,mutedIcon:r,onPress:i,showSlider:n=!0,defaultUnmutedIcon:s,defaultMutedIcon:a,requestVolume:o,requestToggleMute:l,isVolumeChangeSupported:c,muted:d,...u}=e,p=g.useCallback(async()=>{await i?.(),l()},[i,l]),h=ei(!d,t,s,r,a),m=g.useMemo(()=>d?"Unmute (m)":"Mute (m)",[d]),f=g.useCallback(async e=>{o(e)},[o]);return{title:m,buttonProps:{onPress:p,children:h,...u},progressProps:{shown:c&&n,onChange:f,leftCss:{backgroundColor:"$volumeLeft"},middleCss:{backgroundColor:"$volumeMiddle"},rightCss:{backgroundColor:"$volumeRight"},thumbCss:{backgroundColor:"$volumeThumb"}}}},ev=({decentralizedSrcOrPlaybackId:e,playbackId:t,refetchPlaybackInfoInterval:r,autoUrlUpload:i,onAssetStatusChange:n})=>{let{mutate:s,status:a,progress:o}=function(e){let t=et(),[r,i]=(0,g.useState)(void 0),n=function(e,t,r){let{data:i,error:n,isError:s,isIdle:a,isLoading:o,isSuccess:l,mutate:c,mutateAsync:d,reset:u,variables:p,status:h}=function(e,t,r){let i=(0,S.lV)(e,t,void 0),n=(0,R.NL)({context:i.context}),[s]=g.useState(()=>new k(n,i));g.useEffect(()=>{s.setOptions(i)},[s,i]);let a=_(g.useCallback(e=>s.subscribe(C.V.batchCalls(e)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),o=g.useCallback((e,t)=>{s.mutate(e,t).catch(P)},[s]);if(a.error&&E(s.options.useErrorBoundary,[a.error]))throw a.error;return{...a,mutate:o,mutateAsync:a.mutate}}(t,{context:G.Q,mutationKey:r,..."object"==typeof e?.mutationConfig?(0,K.p)(e.mutationConfig,...Q):{},useErrorBoundary:!1});return(0,g.useMemo)(()=>({data:i,error:n,isError:s,isIdle:a,isLoading:o,isSuccess:l,mutate:e?()=>c({...e,config:void 0}):void 0,mutateAsync:()=>e?d({...e,config:void 0}):void 0,variables:p,status:h,internal:{reset:u}}),[i,n,s,a,o,l,c,d,u,p,h,e])}(e,async e=>(function(e){let t=b();return t.createAsset(e)})({...e,onProgress:e=>i(e)}),[{entity:"createAsset",livepeerProvider:t}]);return(0,g.useMemo)(()=>({...n,progress:r}),[n,r])}(e?{sources:[{name:e.id,url:e.url}]}:null);g.useEffect(()=>{o?.[0]&&n(o[0])},[o,n]);let{data:l,error:c}=function(e){let t=et();return J(function(e,t){let r="string"==typeof e?e:{playbackId:e?.playbackId??""};return{clearClient:e.clearClient,queryKey:er(r,t.getConfig()),queryFn:async()=>(function(e){let t=b();return t.getPlaybackInfo(e)})(e),enabled:Boolean("string"==typeof e?e:e?.playbackId),..."object"==typeof e?(0,X.ei)(e,...Y):{}}}(e,t))}({playbackId:e?.id??t??void 0,staleTime:864e5,refetchInterval:e=>!e&&r}),d=g.useMemo(()=>c?.code,[c]);return g.useEffect(()=>{i&&s&&"idle"===a&&404===d&&s()},[i,d,s,a]),l},ey="https://w3s.link",eb="https://arweave.net",ew=({src:e,playbackId:t,jwt:r,refetchPlaybackInfoInterval:i,autoUrlUpload:n={fallback:!0},playbackInfo:s,screenWidth:a,accessKey:o,onAccessKeyRequest:l})=>{let[c,d]=g.useState(null),u=g.useCallback(e=>{d(e)},[d]),p=g.useMemo(()=>t?(0,X.lV)(t)??(0,X.qv)(t):Array.isArray(e)?null:(0,X.lV)(e)??(0,X.qv)(e),[t,e]),h=ev({decentralizedSrcOrPlaybackId:p,playbackId:t,refetchPlaybackInfoInterval:i,autoUrlUpload:n,onAssetStatusChange:u}),m=g.useMemo(()=>s??h,[s,h]),f=g.useCallback(async()=>{if(o)return o;if(m?.meta?.playbackPolicy?.type==="webhook"){let e=await l?.(m.meta.playbackPolicy);return e??null}return null},[o,l,m]),{data:v}=J({queryKey:[m,l,o],queryFn:f,enabled:Boolean(m||o),staleTime:1/0}),[y,b]=g.useState([]);g.useEffect(()=>{let e=(a??1280)*2.5,t=(s??h)?.meta?.source?.map(t=>({url:t?.url,screenWidthDelta:t?.width?Math.abs(e-t.width):t?.url.includes("static360p")||t?.url.includes("low-bitrate")?Math.abs(e-480):t?.url.includes("static720p")?Math.abs(e-1280):t?.url.includes("static1080p")?Math.abs(e-1920):t?.url.includes("static2160p")?Math.abs(e-3840):null}))??null;t&&b(t)},[s,h,a]);let w=g.useMemo(()=>{if(p&&n){let t="boolean"!=typeof n?{arweaveGateway:n.arweaveGateway??eb,ipfsGateway:n.ipfsGateway??ey}:{arweaveGateway:eb,ipfsGateway:ey};if(p.url.startsWith("ar://")){let{host:r}=new URL(t.arweaveGateway),i={type:"video",mime:"video/mp4",src:`https://${r}/${p.id}`};return i}if(!p.url.startsWith("ipfs://"))return{type:"video",mime:"video/mp4",src:e};{let{host:s}=new URL(t.ipfsGateway),a={type:"video",mime:"video/mp4",src:`https://${s}/ipfs/${p.id}`};return a}}return null},[n,p,e]),[_,S]=g.useMemo(()=>{let t=["none",null],i=y.length>0?y.map(e=>e.url):"string"==typeof e?[e]:e;if(!i)return t;let n=i.map(e=>{if(r){let t=new URL(e);return t.searchParams.append("jwt",r),t.toString()}if(v){let i=new URL(e);return i.searchParams.append("accessKey",v),i.toString()}return e}),s=n.map(e=>"string"==typeof e?(0,ea.g)(e):null).filter(e=>e);return s?.[0]?.type==="audio"?["audio",s.filter(e=>"audio"===e.type)]:s?.[0]?.type==="video"||s?.[0]?.type==="hls"||s?.[0]?.type==="webrtc"?["video",s.filter(e=>"video"===e.type||"hls"===e.type||"webrtc"===e.type)]:t},[y,e,r,v]),x=g.useMemo(()=>{if(!S&&w)return[w];if("video"===_){let e=[...S];return e.sort((e,t)=>{if("video"===e.type&&"video"===t.type){let r=y.find(t=>t.url===e.src),i=y.find(e=>e.url===t.src);return i?.screenWidthDelta&&r?.screenWidthDelta?r.screenWidthDelta-i.screenWidthDelta:1}return"video"===e.type&&("hls"===t.type||"webrtc"===t.type)||"webrtc"===e.type&&"hls"===t.type?-1:1})}return S},[S,_,w,y]);return{source:x,uploadStatus:c}},e_=({autoPlay:e,children:t,controls:r,muted:i,playbackId:n,src:s,playbackInfo:a,theme:o,title:l,poster:c,loop:d,onStreamStatusChange:u,onAccessControlError:p,onError:h,onSourceUpdated:m,jwt:f,viewerId:v,refetchPlaybackInfoInterval:y=5e3,autoUrlUpload:b=!0,accessKey:w,onAccessKeyRequest:_,showLoadingSpinner:S=!0,showUploadingIndicator:x=!0,showTitle:C=!0,priority:T,aspectRatio:k="16to9",objectFit:R="contain",mediaElementRef:E,_isCurrentlyShown:P,onPlaybackStatusUpdate:D,playbackStatusSelector:L,renderChildrenOutsideContainer:I},{_screenWidth:M})=>{let[j,O]=g.useState(null),{source:A,uploadStatus:N}=ew({src:s,playbackId:n,jwt:f,refetchPlaybackInfoInterval:y,autoUrlUpload:b,screenWidth:M,playbackInfo:a,accessKey:w,onAccessKeyRequest:_}),[F,q]=g.useState(null),B=g.useCallback(e=>{let t=e?{type:(0,es.Qi)(e)?"access-control":(0,es.kN)(e)?"offline":"unknown",message:e?.message??"Error with playback."}:null;q(t);try{t&&console.log(t),e?t?.type==="offline"?u?.(!1):t?.type==="access-control"?p?.(Error(t.message)):t?.message&&h?.(Error(t.message)):u?.(!0)}catch(r){}return t},[p,u,h]);g.useEffect(()=>{A&&(m?.(A),q(null))},[A,m]);let[U,H]=g.useState(!1),z=g.useMemo(()=>T||P||U,[T,P,U]);g.useEffect(()=>{P&&!U&&H(!0)},[P,U]);let V=g.useMemo(()=>Array.isArray(A)&&A?.[0]?.type!=="audio"||void 0,[A]),$=g.useCallback(e=>{e&&(O(e),E?.(e))},[E]),Z=g.useMemo(()=>x?N?.phase==="processing"&&(0,X.hj)(N?.progress)?`Processing: ${(100*Number(N?.progress)).toFixed(0)}%`:N?.phase==="failed"?"Upload Failed":null:null,[N,x]),W=g.useMemo(()=>({ref:$,autoPlay:e,playbackId:n,muted:i,poster:c,loop:d,objectFit:R,options:r,priority:T,playbackError:F,onPlaybackError:B,isCurrentlyShown:P,viewerId:v,onPlaybackStatusUpdate:D,playbackStatusSelector:L}),[$,n,e,i,c,d,R,r,T,F,B,P,v,D,L]),K=g.useMemo(()=>({autoPlay:e,playbackId:n??void 0,muted:i,priority:T,viewerId:v}),[e,n,i,T,v]),G=g.useMemo(()=>({hidePosterOnPlayed:V,showLoadingSpinner:S,loadingText:Z,showUploadingIndicator:x,error:F}),[V,S,Z,x,F]),Q=g.useMemo(()=>({autoPlay:e,children:t,controls:r,playbackId:n,src:s,theme:o,title:l,poster:c,loop:d,jwt:f,refetchPlaybackInfoInterval:y,autoUrlUpload:b,showTitle:C,aspectRatio:k,objectFit:R,renderChildrenOutsideContainer:I}),[e,t,r,n,s,o,l,c,d,f,y,b,C,k,R,I]),Y=g.useMemo(()=>z?A:null,[z,A]);return{mediaElement:j,source:Y,uploadStatus:N,playerProps:W,mediaControllerProps:K,controlsContainerProps:G,props:Q}};r(41539),r(39714);var eS=r(51115),ex=r(24270),eC=r(88462);r(4480),r(21249),r(23157),r(47042),r(66992),r(78783),r(33948),r(60285),r(41637),r(88674);var eT=r(54098),ek=r.n(eT),eR=r(4792);r(74916),r(15306),r(26699),r(32023);var eE=function(){if(!(0,eR.i)())return!1;var e,t,r,i,n,s,a,o,l,c,d,u,p=!!(null!==(e=window)&&void 0!==e&&e.RTCPeerConnection||null!==(t=window)&&void 0!==t&&t.webkitRTCPeerConnection||null!==(r=window)&&void 0!==r&&r.mozRTCPeerConnection),h=!!(null!==(i=navigator)&&void 0!==i&&i.getUserMedia||null!==(n=navigator)&&void 0!==n&&null!==(s=n.mediaDevices)&&void 0!==s&&s.getUserMedia||null!==(a=navigator)&&void 0!==a&&a.webkitGetUserMedia||null!==(o=navigator)&&void 0!==o&&o.mozGetUserMedia||null!==(l=navigator)&&void 0!==l&&l.msGetUserMedia),m=!!(null!==(c=window)&&void 0!==c&&c.RTCDataChannel||null!==(d=window)&&void 0!==d&&d.webkitRTCDataChannel||null!==(u=window)&&void 0!==u&&u.mozRTCDataChannel);return p&&h&&m};function eP(e){var t,r,i,n=(null===(t=window)||void 0===t?void 0:t.RTCPeerConnection)||(null===(r=window)||void 0===r?void 0:r.webkitRTCPeerConnection)||(null===(i=window)||void 0===i?void 0:i.mozRTCPeerConnection);return n?new n({iceServers:e?[{urls:"stun:".concat(e)},{urls:"turn:".concat(e),username:"livepeer",credential:"livepeer"}]:[]}):null}function eD(e,t,r,i){return eL.apply(this,arguments)}function eL(){return(eL=(0,ex._)((0,ex.a)().mark(function e(t,r,i,n){var s,a,o;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&r&&i)){e.next=20;break}return e.next=3,function(e,t,r){return ej.apply(this,arguments)}(r,i.sdp,n);case 3:if(!(s=e.sent).ok){e.next=14;break}return e.next=7,s.text();case 7:return a=e.sent,e.next=10,t.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:a}));case 10:return o=s.headers.get("Link"),e.abrupt("return",function(e){try{var t,r=null==e?void 0:e.split(", ").map(function(e){var t,r=e.split("; "),i={urls:""},n=(0,eC.b)(r);try{for(n.s();!(t=n.n()).done;){var s=t.value;s.startsWith("stun:")||s.startsWith("turn:")?i.urls=s:s.startsWith("username=")?i.username=s.slice(10,-1):s.startsWith("credential=")&&(i.credential=s.slice(12,-1))}}catch(a){n.e(a)}finally{n.f()}return i}).filter(function(e){return e.urls});return r&&(null!==(t=null==r?void 0:r.length)&&void 0!==t?t:0)>0?r:null}catch(i){console.error(i)}return null}(o));case 14:return e.next=16,s.text();case 16:throw Error(e.sent);case 18:e.next=21;break;case 20:throw Error("Peer connection not defined.");case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}function eI(e,t){return eM.apply(this,arguments)}function eM(){return(eM=(0,ex._)((0,ex.a)().mark(function e(t,r){var i,n;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&r)){e.next=12;break}return e.next=3,t.createOffer();case 3:return i=e.sent,e.next=6,t.setLocalDescription(i);case 6:return e.next=8,function(e){return eN.apply(this,arguments)}(t);case 8:if(n=e.sent){e.next=11;break}throw Error("failed to gather ICE candidates for offer");case 11:return e.abrupt("return",n);case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ej(){return(ej=(0,ex._)((0,ex.a)().mark(function e(t,r,i){var n,s,a;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new AbortController,s=setTimeout(function(){return n.abort()},null!=i?i:1e4),e.next=4,ek()(t,{method:"POST",mode:"cors",headers:{"content-type":"application/sdp"},body:r,signal:n.signal});case 4:return a=e.sent,clearTimeout(s),e.abrupt("return",a);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function eO(e,t,r){return eA.apply(this,arguments)}function eA(){return(eA=(0,ex._)((0,ex.a)().mark(function e(t,r,i){var n,s,a;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=setTimeout(function(){return r.abort()},null!=i?i:1e4),e.prev=1,e.next=4,ek()(t,{method:"HEAD",signal:r.signal});case 4:return s=e.sent,clearTimeout(n),a=new URL(s.url),e.abrupt("return",a);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",null);case 13:case"end":return e.stop()}},e,null,[[1,10]])}))).apply(this,arguments)}function eN(){return(eN=(0,ex._)((0,ex.a)().mark(function e(t){return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){setTimeout(function(){e(t.localDescription)},5e3),t.onicegatheringstatechange=function(r){"complete"===t.iceGatheringState&&e(t.localDescription)}}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var eF=function(e,t,r,i){var n=!1,s=new AbortController,a=null,o=new MediaStream;return eO(e,s,null==i?void 0:i.sdpTimeout).then(function(e){if(!n&&e){var s,l,c,d=e.toString();(a=eP(e.host))&&(a.addTransceiver("video",{direction:"recvonly"}),a.addTransceiver("audio",{direction:"recvonly"}),a.ontrack=(s=(0,ex._)((0,ex.a)().mark(function e(t){var i,n,s,a,l;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!o){e.next=18;break}i=t.track,s=(n=o.getTracks()).some(function(e){return"video"===e.kind}),a=n.some(function(e){return"audio"===e.kind}),e.t0=i.kind,e.next="video"===e.t0?9:"audio"===e.t0?13:17;break;case 9:if(!s){e.next=11;break}return e.abrupt("break",18);case 11:case 15:return o.addTrack(i),e.abrupt("break",18);case 13:if(!a){e.next=15;break}return e.abrupt("break",18);case 17:console.log("got unknown track "+i);case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(0),null==r||null===(l=r.onError)||void 0===l||l.call(r,e.t1);case 23:case"end":return e.stop()}},e,null,[[0,20]])})),function(e){return s.apply(this,arguments)}),a.addEventListener("connectionstatechange",(l=(0,ex._)((0,ex.a)().mark(function e(i){var n,s,l,c;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(null===(n=a)||void 0===n?void 0:n.connectionState)!=="failed"){e.next=3;break}throw Error("Failed to connect to peer.");case 3:(null===(s=a)||void 0===s?void 0:s.connectionState)!=="connected"||t.srcObject||(t.srcObject=o,null==r||null===(l=r.onConnected)||void 0===l||l.call(r)),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),null==r||null===(c=r.onError)||void 0===c||c.call(r,e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])})),function(e){return l.apply(this,arguments)})),a.addEventListener("negotiationneeded",(c=(0,ex._)((0,ex.a)().mark(function e(t){var n,s;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,eI(a,d);case 3:return n=e.sent,e.next=6,eD(a,d,n,null==i?void 0:i.sdpTimeout);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),null==r||null===(s=r.onError)||void 0===s||s.call(r,e.t0);case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return c.apply(this,arguments)})))}}).catch(function(e){var t;return null==r?void 0:null===(t=r.onError)||void 0===t?void 0:t.call(r,e)}),{destroy:function(){var e,r,i;n=!0,null==s||null===(e=s.abort)||void 0===e||e.call(s),t&&(t.srcObject=null),null===(r=a)||void 0===r||null===(i=r.close)||void 0===i||i.call(r)}}};function eq(e){return(eq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var eB=function(e,t,r,i,n){var s=!1,a=new AbortController,o=null,l=null,c=null,d=null,u=null;return eO(e,a,null==n?void 0:n.sdpTimeout).then(function(e){if(!s&&e){var a,p,h,m=e.toString().replace("video+","");(o=eP(e.host))&&(o.addEventListener("negotiationneeded",(a=(0,ex._)((0,ex.a)().mark(function e(t){var r,s;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,eI(o,m);case 3:return r=e.sent,e.next=6,eD(o,m,r,null==n?void 0:n.sdpTimeout);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),null==i||null===(s=i.onError)||void 0===s||s.call(i,e.t0);case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return a.apply(this,arguments)})),o.addEventListener("connectionstatechange",(p=(0,ex._)((0,ex.a)().mark(function e(r){var n,s,a,u;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(null===(n=o)||void 0===n?void 0:n.connectionState)!=="failed"){e.next=3;break}throw Error("Failed to connect to peer.");case 3:(null===(s=o)||void 0===s?void 0:s.connectionState)==="connected"&&l&&d&&c&&(t.srcObject=l,null==i||null===(a=i.onConnected)||void 0===a||a.call(i,{stream:l,videoTransceiver:c,audioTransceiver:d})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),null==i||null===(u=i.onError)||void 0===u||u.call(i,e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])})),function(e){return p.apply(this,arguments)})),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((h=(0,ex._)((0,ex.a)().mark(function e(t){var i,n,s,a,u,p,h,m,f,g,v,y;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h=null!==(i=null==t?void 0:null===(n=t.getVideoTracks)||void 0===n?void 0:null===(s=n.call(t))||void 0===s?void 0:s[0])&&void 0!==i?i:null,m=null!==(a=null==t?void 0:null===(u=t.getAudioTracks)||void 0===u?void 0:null===(p=u.call(t))||void 0===p?void 0:p[0])&&void 0!==a?a:null,!h){e.next=6;break}return e.next=5,h.applyConstraints(e$(null!=r?r:"16to9"));case 5:c=null!==(f=null===(g=o)||void 0===g?void 0:g.addTransceiver(h,{direction:"sendonly"}))&&void 0!==f?f:null;case 6:m&&(d=null!==(v=null===(y=o)||void 0===y?void 0:y.addTransceiver(m,{direction:"sendonly"}))&&void 0!==v?v:null),l=t;case 8:case"end":return e.stop()}},e)})),function(e){return h.apply(this,arguments)})).catch(function(e){var t;return null==i?void 0:null===(t=i.onError)||void 0===t?void 0:t.call(i,e)}),u=function(){ek()(m,{method:"DELETE",mode:"cors"}).catch(function(e){var t;return null==i?void 0:null===(t=i.onError)||void 0===t?void 0:t.call(i,e)})})}}).catch(function(e){var t;return null==i?void 0:null===(t=i.onError)||void 0===t?void 0:t.call(i,e)}),{destroy:function(){null===(e=u)||void 0===e||e(),s=!0,null==a||null===(r=a.abort)||void 0===r||r.call(a),t&&(t.srcObject=null),null===(i=o)||void 0===i||null===(n=i.close)||void 0===n||n.call(i);var e,r,i,n,c,d,p,h,m=null!==(c=null===(d=l)||void 0===d?void 0:null===(p=d.getTracks)||void 0===p?void 0:p.call(d))&&void 0!==c?c:[],f=(0,eC.b)(m);try{for(f.s();!(h=f.n()).done;){var g,v=h.value;null==v||null===(g=v.stop)||void 0===g||g.call(v)}}catch(y){f.e(y)}finally{f.f()}}}},eU=(a=(0,ex._)((0,ex.a)().mark(function e(t){var r,i,n,s,a,o,l,c,d,u,p,h,m,f,g,v,y,b,w,_,S,x,C,T,k;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m=t.newMediaStream,f=t.prevMediaStream,g=t.aspectRatio,v=t.element,y=t.onConnected,b=t.videoTransceiver,w=t.audioTransceiver,_=null!==(r=null==f?void 0:null===(i=f.getVideoTracks)||void 0===i?void 0:null===(n=i.call(f))||void 0===n?void 0:n[0])&&void 0!==r?r:null,S=null!==(s=null==f?void 0:null===(a=f.getAudioTracks)||void 0===a?void 0:null===(o=a.call(f))||void 0===o?void 0:o[0])&&void 0!==s?s:null,x=null!==(l=null==m?void 0:null===(c=m.getVideoTracks)||void 0===c?void 0:null===(d=c.call(m))||void 0===d?void 0:d[0])&&void 0!==l?l:null,C=null!==(u=null==m?void 0:null===(p=m.getAudioTracks)||void 0===p?void 0:null===(h=p.call(m))||void 0===h?void 0:h[0])&&void 0!==u?u:null,!x){e.next=11;break}return e.next=8,x.applyConstraints(e$(g));case 8:return e.next=10,b.sender.replaceTrack(x);case 10:x.enabled=null===(T=null==_?void 0:_.enabled)||void 0===T||T;case 11:if(!C){e.next=15;break}return e.next=14,w.sender.replaceTrack(C);case 14:C.enabled=null===(k=null==S?void 0:S.enabled)||void 0===k||k;case 15:v.srcObject=m,y({stream:m,videoTransceiver:b,audioTransceiver:w});case 17:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)}),eH=(o=(0,ex._)((0,ex.a)().mark(function e(t){var r,i,n,s,a,o,l,c;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.source,e.prev=1,e.next=4,null===(i=navigator)||void 0===i?void 0:null===(n=i.mediaDevices)||void 0===n?void 0:n.getUserMedia((0,ex.b)((0,ex.b)({},"object"===eq(r.streamConstraints)?r.streamConstraints:{}),{},{video:(0,ex.b)((0,ex.b)({},"boolean"!=typeof(null===(s=r.streamConstraints)||void 0===s?void 0:s.video)?null===(a=r.streamConstraints)||void 0===a?void 0:a.video:{}),null!=r&&r.videoDeviceId?{deviceId:null==r?void 0:r.videoDeviceId}:{}),audio:(0,ex.b)((0,ex.b)({},"boolean"!=typeof(null===(o=r.streamConstraints)||void 0===o?void 0:o.audio)?null===(l=r.streamConstraints)||void 0===l?void 0:l.audio:{}),null!=r&&r.audioDeviceId?{deviceId:null==r?void 0:r.audioDeviceId}:{})}));case 4:return c=e.sent,e.abrupt("return",null!=c?c:null);case 8:return e.prev=8,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",null);case 12:case"end":return e.stop()}},e,null,[[1,8]])})),function(e){return o.apply(this,arguments)}),ez=function(e){var t,r;if("undefined"!=typeof navigator&&null!==(t=navigator)&&void 0!==t&&null!==(r=t.mediaDevices)&&void 0!==r&&r.enumerateDevices){var i=function(){navigator.mediaDevices.enumerateDevices().then(function(t){return e(t)})};return navigator.mediaDevices.addEventListener("devicechange",i),i(),function(){navigator.mediaDevices.removeEventListener("devicechange",i)}}return function(){}},eV=(l=(0,ex._)((0,ex.a)().mark(function e(t){var r,i,n;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!("undefined"!=typeof navigator&&null!==(r=navigator)&&void 0!==r&&null!==(i=r.mediaDevices)&&void 0!==i&&i.getDisplayMedia)){e.next=6;break}return e.next=4,navigator.mediaDevices.getDisplayMedia(t);case 4:return n=e.sent,e.abrupt("return",n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return l.apply(this,arguments)}),e$=function(e){return{width:{ideal:1280},height:{ideal:720},aspectRatio:{ideal:"9to16"===e?9/16:"1to1"===e?1:"21to9"===e?21/9:"4to5"===e?.8:16/9}}},eZ=r(36135),eW=r(87462);function eK(e,t,{checkForDefaultPrevented:r=!0}={}){return function(i){if(null==e||e(i),!1===r||!i.defaultPrevented)return null==t?void 0:t(i)}}function eG(...e){return t=>e.forEach(e=>{var r;"function"==typeof(r=e)?r(t):null!=r&&(r.current=t)})}function eQ(...e){return(0,g.useCallback)(eG(...e),e)}function eY(e,t=[]){let r=[],i=()=>{let t=r.map(e=>(0,g.createContext)(e));return function(r){let i=(null==r?void 0:r[e])||t;return(0,g.useMemo)(()=>({[`__scope${e}`]:{...r,[e]:i}}),[r,i])}};return i.scopeName=e,[function(t,i){let n=(0,g.createContext)(i),s=r.length;function a(t){let{scope:r,children:i,...a}=t,o=(null==r?void 0:r[e][s])||n,l=(0,g.useMemo)(()=>a,Object.values(a));return(0,g.createElement)(o.Provider,{value:l},i)}return r=[...r,i],a.displayName=t+"Provider",[a,function(r,a){let o=(null==a?void 0:a[e][s])||n,l=(0,g.useContext)(o);if(l)return l;if(void 0!==i)return i;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let i=r.reduce((t,{useScope:r,scopeName:i})=>{let n=r(e),s=n[`__scope${i}`];return{...t,...s}},{});return(0,g.useMemo)(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}(i,...t)]}let eJ=Boolean(null==globalThis?void 0:globalThis.document)?g.useLayoutEffect:()=>{},eX=v["useId".toString()]||(()=>void 0),e0=0;function e1(e){let[t,r]=g.useState(eX());return eJ(()=>{e||r(e=>null!=e?e:String(e0++))},[e]),e||(t?`radix-${t}`:"")}function e2(e){let t=(0,g.useRef)(e);return(0,g.useEffect)(()=>{t.current=e}),(0,g.useMemo)(()=>(...e)=>{var r;return null===(r=t.current)||void 0===r?void 0:r.call(t,...e)},[])}function e5({prop:e,defaultProp:t,onChange:r=()=>{}}){let[i,n]=function({defaultProp:e,onChange:t}){let r=(0,g.useState)(e),[i]=r,n=(0,g.useRef)(i),s=e2(t);return(0,g.useEffect)(()=>{n.current!==i&&(s(i),n.current=i)},[i,n,s]),r}({defaultProp:t,onChange:r}),s=void 0!==e,a=e2(r),o=(0,g.useCallback)(t=>{if(s){let r="function"==typeof t?t(e):t;r!==e&&a(r)}else n(t)},[s,e,n,a]);return[s?e:i,o]}var e4=r(73935);let e6=(0,g.forwardRef)((e,t)=>{let{children:r,...i}=e,n=g.Children.toArray(r),s=n.find(e8);if(s){let a=s.props.children,o=n.map(e=>e!==s?e:g.Children.count(a)>1?g.Children.only(null):(0,g.isValidElement)(a)?a.props.children:null);return(0,g.createElement)(e3,(0,eW.Z)({},i,{ref:t}),(0,g.isValidElement)(a)?(0,g.cloneElement)(a,void 0,o):null)}return(0,g.createElement)(e3,(0,eW.Z)({},i,{ref:t}),r)});e6.displayName="Slot";let e3=(0,g.forwardRef)((e,t)=>{let{children:r,...i}=e;return(0,g.isValidElement)(r)?(0,g.cloneElement)(r,{...function(e,t){let r={...t};for(let i in t){let n=e[i],s=t[i],a=/^on[A-Z]/.test(i);a?n&&s?r[i]=(...e)=>{s(...e),n(...e)}:n&&(r[i]=n):"style"===i?r[i]={...n,...s}:"className"===i&&(r[i]=[n,s].filter(Boolean).join(" "))}return{...e,...r}}(i,r.props),ref:t?eG(t,r.ref):r.ref}):g.Children.count(r)>1?g.Children.only(null):null});e3.displayName="SlotClone";let e9=({children:e})=>(0,g.createElement)(g.Fragment,null,e);function e8(e){return(0,g.isValidElement)(e)&&e.type===e9}let e7=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=(0,g.forwardRef)((e,r)=>{let{asChild:i,...n}=e,s=i?e6:t;return(0,g.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,g.createElement)(s,(0,eW.Z)({},n,{ref:r}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),te="dismissableLayer.update",tt=(0,g.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),tr=(0,g.forwardRef)((e,t)=>{var r;let{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...d}=e,u=(0,g.useContext)(tt),[p,h]=(0,g.useState)(null),m=null!==(r=null==p?void 0:p.ownerDocument)&&void 0!==r?r:null==globalThis?void 0:globalThis.document,[,f]=(0,g.useState)({}),v=eQ(t,e=>h(e)),y=Array.from(u.layers),[b]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=y.indexOf(b),_=p?y.indexOf(p):-1,S=u.layersWithOutsidePointerEventsDisabled.size>0,x=_>=w,C=function(e,t=null==globalThis?void 0:globalThis.document){let r=e2(e),i=(0,g.useRef)(!1),n=(0,g.useRef)(()=>{});return(0,g.useEffect)(()=>{let e=e=>{if(e.target&&!i.current){let s={originalEvent:e};function a(){tn("dismissableLayer.pointerDownOutside",r,s,{discrete:!0})}"touch"===e.pointerType?(t.removeEventListener("click",n.current),n.current=a,t.addEventListener("click",n.current,{once:!0})):a()}i.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",e),t.removeEventListener("click",n.current)}},[t,r]),{onPointerDownCapture:()=>i.current=!0}}(e=>{let t=e.target,r=[...u.branches].some(e=>e.contains(t));!x||r||(null==a||a(e),null==l||l(e),e.defaultPrevented||null==c||c())},m),T=function(e,t=null==globalThis?void 0:globalThis.document){let r=e2(e),i=(0,g.useRef)(!1);return(0,g.useEffect)(()=>{let e=e=>{e.target&&!i.current&&tn("dismissableLayer.focusOutside",r,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,r]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}(e=>{let t=e.target,r=[...u.branches].some(e=>e.contains(t));r||(null==o||o(e),null==l||l(e),e.defaultPrevented||null==c||c())},m);return!function(e,t=null==globalThis?void 0:globalThis.document){let r=e2(e);(0,g.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r(e)};return t.addEventListener("keydown",e),()=>t.removeEventListener("keydown",e)},[r,t])}(e=>{let t=_===u.layers.size-1;t&&(null==s||s(e),!e.defaultPrevented&&c&&(e.preventDefault(),c()))},m),(0,g.useEffect)(()=>{if(p)return n&&(0===u.layersWithOutsidePointerEventsDisabled.size&&(i=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(p)),u.layers.add(p),ti(),()=>{n&&1===u.layersWithOutsidePointerEventsDisabled.size&&(m.body.style.pointerEvents=i)}},[p,m,n,u]),(0,g.useEffect)(()=>()=>{p&&(u.layers.delete(p),u.layersWithOutsidePointerEventsDisabled.delete(p),ti())},[p,u]),(0,g.useEffect)(()=>{let e=()=>f({});return document.addEventListener(te,e),()=>document.removeEventListener(te,e)},[]),(0,g.createElement)(e7.div,(0,eW.Z)({},d,{ref:v,style:{pointerEvents:S?x?"auto":"none":void 0,...e.style},onFocusCapture:eK(e.onFocusCapture,T.onFocusCapture),onBlurCapture:eK(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:eK(e.onPointerDownCapture,C.onPointerDownCapture)}))});function ti(){let e=new CustomEvent(te);document.dispatchEvent(e)}function tn(e,t,r,{discrete:i}){let n=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});(t&&n.addEventListener(e,t,{once:!0}),i)?n&&(0,e4.flushSync)(()=>n.dispatchEvent(s)):n.dispatchEvent(s)}let ts="focusScope.autoFocusOnMount",ta="focusScope.autoFocusOnUnmount",to={bubbles:!1,cancelable:!0},tl=(0,g.forwardRef)((e,t)=>{let{loop:r=!1,trapped:i=!1,onMountAutoFocus:n,onUnmountAutoFocus:s,...a}=e,[o,l]=(0,g.useState)(null),c=e2(n),d=e2(s),u=(0,g.useRef)(null),p=eQ(t,e=>l(e)),h=(0,g.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,g.useEffect)(()=>{if(i){function e(e){if(h.paused||!o)return;let t=e.target;o.contains(t)?u.current=t:tu(u.current,{select:!0})}function t(e){if(h.paused||!o)return;let t=e.relatedTarget;null===t||o.contains(t)||tu(u.current,{select:!0})}document.addEventListener("focusin",e),document.addEventListener("focusout",t);let r=new MutationObserver(function(e){let t=document.activeElement;for(let r of e)r.removedNodes.length>0&&!(null!=o&&o.contains(t))&&tu(o)});return o&&r.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),r.disconnect()}}},[i,o,h.paused]),(0,g.useEffect)(()=>{if(o){tp.add(h);let e=document.activeElement,t=o.contains(e);if(!t){let r=new CustomEvent(ts,to);o.addEventListener(ts,c),o.dispatchEvent(r),r.defaultPrevented||(function(e,{select:t=!1}={}){let r=document.activeElement;for(let i of e)if(tu(i,{select:t}),document.activeElement!==r)return}(tc(o).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&tu(o))}return()=>{o.removeEventListener(ts,c),setTimeout(()=>{let t=new CustomEvent(ta,to);o.addEventListener(ta,d),o.dispatchEvent(t),t.defaultPrevented||tu(null!=e?e:document.body,{select:!0}),o.removeEventListener(ta,d),tp.remove(h)},0)}}},[o,c,d,h]);let m=(0,g.useCallback)(e=>{if(!r&&!i||h.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){let s=e.currentTarget,[a,o]=function(e){let t=tc(e),r=td(t,e),i=td(t.reverse(),e);return[r,i]}(s);a&&o?e.shiftKey||n!==o?e.shiftKey&&n===a&&(e.preventDefault(),r&&tu(o,{select:!0})):(e.preventDefault(),r&&tu(a,{select:!0})):n===s&&e.preventDefault()}},[r,i,h.paused]);return(0,g.createElement)(e7.div,(0,eW.Z)({tabIndex:-1},a,{ref:p,onKeyDown:m}))});function tc(e){let t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function td(e,t){for(let r of e)if(!function(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(r,{upTo:t}))return r}function tu(e,{select:t=!1}={}){if(e&&e.focus){var r;let i=document.activeElement;e.focus({preventScroll:!0}),e!==i&&(r=e)instanceof HTMLInputElement&&"select"in r&&t&&e.select()}}let tp=(s=[],{add(e){let t=s[0];e!==t&&(null==t||t.pause()),(s=th(s,e)).unshift(e)},remove(e){var t;null===(t=(s=th(s,e))[0])||void 0===t||t.resume()}});function th(e,t){let r=[...e],i=r.indexOf(t);return -1!==i&&r.splice(i,1),r}let tm=(0,g.forwardRef)((e,t)=>{var r;let{container:i=null==globalThis?void 0:null===(r=globalThis.document)||void 0===r?void 0:r.body,...n}=e;return i?e4.createPortal((0,g.createElement)(e7.div,(0,eW.Z)({},n,{ref:t})),i):null}),tf=e=>{let{present:t,children:r}=e,i=function(e){var t;let[r,i]=(0,g.useState)(),n=(0,g.useRef)({}),s=(0,g.useRef)(e),a=(0,g.useRef)("none"),[o,l]=(t={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},(0,g.useReducer)((e,r)=>{let i=t[e][r];return null!=i?i:e},e?"mounted":"unmounted"));return(0,g.useEffect)(()=>{let e=tg(n.current);a.current="mounted"===o?e:"none"},[o]),eJ(()=>{let t=n.current,r=s.current;if(r!==e){let i=a.current,o=tg(t);e?l("MOUNT"):"none"===o||(null==t?void 0:t.display)==="none"?l("UNMOUNT"):r&&i!==o?l("ANIMATION_OUT"):l("UNMOUNT"),s.current=e}},[e,l]),eJ(()=>{if(r){let e=e=>{let t=tg(n.current),i=t.includes(e.animationName);e.target===r&&i&&(0,e4.flushSync)(()=>l("ANIMATION_END"))},t=e=>{e.target===r&&(a.current=tg(n.current))};return r.addEventListener("animationstart",t),r.addEventListener("animationcancel",e),r.addEventListener("animationend",e),()=>{r.removeEventListener("animationstart",t),r.removeEventListener("animationcancel",e),r.removeEventListener("animationend",e)}}l("ANIMATION_END")},[r,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:(0,g.useCallback)(e=>{e&&(n.current=getComputedStyle(e)),i(e)},[])}}(t),n="function"==typeof r?r({present:i.isPresent}):g.Children.only(r),s=eQ(i.ref,n.ref);return"function"==typeof r||i.isPresent?(0,g.cloneElement)(n,{ref:s}):null};function tg(e){return(null==e?void 0:e.animationName)||"none"}tf.displayName="Presence";let tv=0;function ty(){(0,g.useEffect)(()=>{var e,t;let r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=r[0])&&void 0!==e?e:tb()),document.body.insertAdjacentElement("beforeend",null!==(t=r[1])&&void 0!==t?t:tb()),tv++,()=>{1===tv&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),tv--}},[])}function tb(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var tw=r(97582),t_="right-scroll-bar-position",tS="width-before-scroll-bar",tx=(void 0===c&&(c={}),(void 0===d&&(d=function(e){return e}),u=[],p=!1,h={read:function(){if(p)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return u.length?u[u.length-1]:null},useMedium:function(e){var t=d(e,p);return u.push(t),function(){u=u.filter(function(e){return e!==t})}},assignSyncMedium:function(e){for(p=!0;u.length;){var t=u;u=[],t.forEach(e)}u={push:function(t){return e(t)},filter:function(){return u}}},assignMedium:function(e){p=!0;var t=[];if(u.length){var r=u;u=[],r.forEach(e),t=u}var i=function(){var r=t;t=[],r.forEach(e)},n=function(){return Promise.resolve().then(i)};n(),u={push:function(e){t.push(e),n()},filter:function(e){return t=t.filter(e),u}}}}).options=(0,tw.pi)({async:!0,ssr:!1},c),h),tC=function(){},tT=g.forwardRef(function(e,t){var r,i,n,s=g.useRef(null),a=g.useState({onScrollCapture:tC,onWheelCapture:tC,onTouchMoveCapture:tC}),o=a[0],l=a[1],c=e.forwardProps,d=e.children,u=e.className,p=e.removeScrollBar,h=e.enabled,m=e.shards,f=e.sideCar,v=e.noIsolation,y=e.inert,b=e.allowPinchZoom,w=e.as,_=(0,tw._T)(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),S=(r=[s,t],i=function(e){return r.forEach(function(t){var r;return"function"==typeof(r=t)?r(e):r&&(r.current=e),r})},(n=(0,g.useState)(function(){return{value:null,callback:i,facade:{get current(){return n.value},set current(value){var e=n.value;e!==value&&(n.value=value,n.callback(value,e))}}}})[0]).callback=i,n.facade),x=(0,tw.pi)((0,tw.pi)({},_),o);return g.createElement(g.Fragment,null,h&&g.createElement(f,{sideCar:tx,removeScrollBar:p,shards:m,noIsolation:v,inert:y,setCallbacks:l,allowPinchZoom:!!b,lockRef:s}),c?g.cloneElement(g.Children.only(d),(0,tw.pi)((0,tw.pi)({},x),{ref:S})):g.createElement(void 0===w?"div":w,(0,tw.pi)({},x,{className:u,ref:S}),d))});tT.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},tT.classNames={fullWidth:tS,zeroRight:t_};var tk=function(e){var t=e.sideCar,r=(0,tw._T)(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw Error("Sidecar medium not found");return g.createElement(i,(0,tw.pi)({},r))};tk.isSideCarExport=!0;var tR=function(){var e=0,t=null;return{add:function(i){if(0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=m||r.nc;return t&&e.setAttribute("nonce",t),e}())){var n,s;(n=t).styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i)),s=t,(document.head||document.getElementsByTagName("head")[0]).appendChild(s)}e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},tE=function(){var e=tR();return function(t,r){g.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},tP=function(){var e=tE();return function(t){return e(t.styles,t.dynamic),null}},tD={left:0,top:0,right:0,gap:0},tL=function(e){return parseInt(e||"",10)||0},tI=function(e){var t=window.getComputedStyle(document.body),r=t["padding"===e?"paddingLeft":"marginLeft"],i=t["padding"===e?"paddingTop":"marginTop"],n=t["padding"===e?"paddingRight":"marginRight"];return[tL(r),tL(i),tL(n)]},tM=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return tD;var t=tI(e),r=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-r+t[2]-t[0])}},tj=tP(),tO=function(e,t,r,i){var n=e.left,s=e.top,a=e.right,o=e.gap;return void 0===r&&(r="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(i,";\n   padding-right: ").concat(o,"px ").concat(i,";\n  }\n  body {\n    overflow: hidden ").concat(i,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(i,";"),"margin"===r&&"\n    padding-left: ".concat(n,"px;\n    padding-top: ").concat(s,"px;\n    padding-right: ").concat(a,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(o,"px ").concat(i,";\n    "),"padding"===r&&"padding-right: ".concat(o,"px ").concat(i,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(t_," {\n    right: ").concat(o,"px ").concat(i,";\n  }\n  \n  .").concat(tS," {\n    margin-right: ").concat(o,"px ").concat(i,";\n  }\n  \n  .").concat(t_," .").concat(t_," {\n    right: 0 ").concat(i,";\n  }\n  \n  .").concat(tS," .").concat(tS," {\n    margin-right: 0 ").concat(i,";\n  }\n  \n  body {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(o,"px;\n  }\n")},tA=function(e){var t=e.noRelative,r=e.noImportant,i=e.gapMode,n=void 0===i?"margin":i,s=g.useMemo(function(){return tM(n)},[n]);return g.createElement(tj,{styles:tO(s,!t,n,r?"":"!important")})},tN=!1;if("undefined"!=typeof window)try{var tF=Object.defineProperty({},"passive",{get:function(){return tN=!0,!0}});window.addEventListener("test",tF,tF),window.removeEventListener("test",tF,tF)}catch(tq){tN=!1}var tB=!!tN&&{passive:!1},tU=function(e,t){var r=window.getComputedStyle(e);return"hidden"!==r[t]&&!(r.overflowY===r.overflowX&&"TEXTAREA"!==e.tagName&&"visible"===r[t])},tH=function(e,t){var r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),tz(e,r)){var i=tV(e,r);if(i[1]>i[2])return!0}r=r.parentNode}while(r&&r!==document.body);return!1},tz=function(e,t){return"v"===e?tU(t,"overflowY"):tU(t,"overflowX")},tV=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},t$=function(e,t,r,i,n){var s,a=(s=window.getComputedStyle(t).direction,"h"===e&&"rtl"===s?-1:1),o=a*i,l=r.target,c=t.contains(l),d=!1,u=o>0,p=0,h=0;do{var m=tV(e,l),f=m[0],g=m[1]-m[2]-a*f;(f||g)&&tz(e,l)&&(p+=g,h+=f),l=l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return u&&(n&&0===p||!n&&o>p)?d=!0:!u&&(n&&0===h||!n&&-o>h)&&(d=!0),d},tZ=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},tW=function(e){return[e.deltaX,e.deltaY]},tK=function(e){return e&&"current"in e?e.current:e},tG=0,tQ=[],tY=(tx.useMedium(function(e){var t=g.useRef([]),r=g.useRef([0,0]),i=g.useRef(),n=g.useState(tG++)[0],s=g.useState(function(){return tP()})[0],a=g.useRef(e);g.useEffect(function(){a.current=e},[e]),g.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(n));var t=(0,tw.ev)([e.lockRef.current],(e.shards||[]).map(tK),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(n))}),function(){document.body.classList.remove("block-interactivity-".concat(n)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(n))})}}},[e.inert,e.lockRef.current,e.shards]);var o=g.useCallback(function(e,t){if("touches"in e&&2===e.touches.length)return!a.current.allowPinchZoom;var n,s=tZ(e),o=r.current,l="deltaX"in e?e.deltaX:o[0]-s[0],c="deltaY"in e?e.deltaY:o[1]-s[1],d=e.target,u=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===u&&"range"===d.type)return!1;var p=tH(u,d);if(!p)return!0;if(p?n=u:(n="v"===u?"h":"v",p=tH(u,d)),!p)return!1;if(!i.current&&"changedTouches"in e&&(l||c)&&(i.current=n),!n)return!0;var h=i.current||n;return t$(h,t,e,"h"===h?l:c,!0)},[]),l=g.useCallback(function(e){if(tQ.length&&tQ[tQ.length-1]===s){var r="deltaY"in e?tW(e):tZ(e),i=t.current.filter(function(t){var i;return t.name===e.type&&t.target===e.target&&(i=t.delta)[0]===r[0]&&i[1]===r[1]})[0];if(i&&i.should){e.cancelable&&e.preventDefault();return}if(!i){var n=(a.current.shards||[]).map(tK).filter(Boolean).filter(function(t){return t.contains(e.target)});(n.length>0?o(e,n[0]):!a.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),c=g.useCallback(function(e,r,i,n){var s={name:e,delta:r,target:i,should:n};t.current.push(s),setTimeout(function(){t.current=t.current.filter(function(e){return e!==s})},1)},[]),d=g.useCallback(function(e){r.current=tZ(e),i.current=void 0},[]),u=g.useCallback(function(t){c(t.type,tW(t),t.target,o(t,e.lockRef.current))},[]),p=g.useCallback(function(t){c(t.type,tZ(t),t.target,o(t,e.lockRef.current))},[]);g.useEffect(function(){return tQ.push(s),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:p}),document.addEventListener("wheel",l,tB),document.addEventListener("touchmove",l,tB),document.addEventListener("touchstart",d,tB),function(){tQ=tQ.filter(function(e){return e!==s}),document.removeEventListener("wheel",l,tB),document.removeEventListener("touchmove",l,tB),document.removeEventListener("touchstart",d,tB)}},[]);var h=e.removeScrollBar,m=e.inert;return g.createElement(g.Fragment,null,m?g.createElement(s,{styles:"\n  .block-interactivity-".concat(n," {pointer-events: none;}\n  .allow-interactivity-").concat(n," {pointer-events: all;}\n")}):null,h?g.createElement(tA,{gapMode:"margin"}):null)}),tk),tJ=g.forwardRef(function(e,t){return g.createElement(tT,(0,tw.pi)({},e,{ref:t,sideCar:tY}))});tJ.classNames=tT.classNames;var tX=new WeakMap,t0=new WeakMap,t1={},t2=0,t5=function(e){return e&&(e.host||t5(e.parentNode))},t4=function(e,t,r,i){var n=(Array.isArray(e)?e:[e]).map(function(e){if(t.contains(e))return e;var r=t5(e);return r&&t.contains(r)?r:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(e){return Boolean(e)});t1[r]||(t1[r]=new WeakMap);var s=t1[r],a=[],o=new Set,l=new Set(n),c=function(e){!e||o.has(e)||(o.add(e),c(e.parentNode))};n.forEach(c);var d=function(e){!e||l.has(e)||Array.prototype.forEach.call(e.children,function(e){if(o.has(e))d(e);else{var t=e.getAttribute(i),n=null!==t&&"false"!==t,l=(tX.get(e)||0)+1,c=(s.get(e)||0)+1;tX.set(e,l),s.set(e,c),a.push(e),1===l&&n&&t0.set(e,!0),1===c&&e.setAttribute(r,"true"),n||e.setAttribute(i,"true")}})};return d(t),o.clear(),t2++,function(){a.forEach(function(e){var t=tX.get(e)-1,n=s.get(e)-1;tX.set(e,t),s.set(e,n),t||(t0.has(e)||e.removeAttribute(i),t0.delete(e)),n||e.removeAttribute(r)}),--t2||(tX=new WeakMap,tX=new WeakMap,t0=new WeakMap,t1={})}},t6=function(e,t,r){void 0===r&&(r="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),n=t||("undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body);return n?(i.push.apply(i,Array.from(n.querySelectorAll("[aria-live]"))),t4(i,n,r,"aria-hidden")):function(){return null}};let t3="Dialog",[t9,t8]=eY(t3),[t7,re]=t9(t3),rt=e=>{let{__scopeDialog:t,children:r,open:i,defaultOpen:n,onOpenChange:s,modal:a=!0}=e,o=(0,g.useRef)(null),l=(0,g.useRef)(null),[c=!1,d]=e5({prop:i,defaultProp:n,onChange:s});return(0,g.createElement)(t7,{scope:t,triggerRef:o,contentRef:l,contentId:e1(),titleId:e1(),descriptionId:e1(),open:c,onOpenChange:d,onOpenToggle:(0,g.useCallback)(()=>d(e=>!e),[d]),modal:a},r)},rr=(0,g.forwardRef)((e,t)=>{let{__scopeDialog:r,...i}=e,n=re("DialogTrigger",r),s=eQ(t,n.triggerRef);return(0,g.createElement)(e7.button,(0,eW.Z)({type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":ry(n.open)},i,{ref:s,onClick:eK(e.onClick,n.onOpenToggle)}))}),ri="DialogPortal",[rn,rs]=t9(ri,{forceMount:void 0}),ra=e=>{let{__scopeDialog:t,forceMount:r,children:i,container:n}=e,s=re(ri,t);return(0,g.createElement)(rn,{scope:t,forceMount:r},g.Children.map(i,e=>(0,g.createElement)(tf,{present:r||s.open},(0,g.createElement)(tm,{asChild:!0,container:n},e))))},ro="DialogOverlay",rl=(0,g.forwardRef)((e,t)=>{let r=rs(ro,e.__scopeDialog),{forceMount:i=r.forceMount,...n}=e,s=re(ro,e.__scopeDialog);return s.modal?(0,g.createElement)(tf,{present:i||s.open},(0,g.createElement)(rc,(0,eW.Z)({},n,{ref:t}))):null}),rc=(0,g.forwardRef)((e,t)=>{let{__scopeDialog:r,...i}=e,n=re(ro,r);return(0,g.createElement)(tJ,{as:e6,allowPinchZoom:!0,shards:[n.contentRef]},(0,g.createElement)(e7.div,(0,eW.Z)({"data-state":ry(n.open)},i,{ref:t,style:{pointerEvents:"auto",...i.style}})))}),rd="DialogContent",ru=(0,g.forwardRef)((e,t)=>{let r=rs(rd,e.__scopeDialog),{forceMount:i=r.forceMount,...n}=e,s=re(rd,e.__scopeDialog);return(0,g.createElement)(tf,{present:i||s.open},s.modal?(0,g.createElement)(rp,(0,eW.Z)({},n,{ref:t})):(0,g.createElement)(rh,(0,eW.Z)({},n,{ref:t})))}),rp=(0,g.forwardRef)((e,t)=>{let r=re(rd,e.__scopeDialog),i=(0,g.useRef)(null),n=eQ(t,r.contentRef,i);return(0,g.useEffect)(()=>{let e=i.current;if(e)return t6(e)},[]),(0,g.createElement)(rm,(0,eW.Z)({},e,{ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:eK(e.onCloseAutoFocus,e=>{var t;e.preventDefault(),null===(t=r.triggerRef.current)||void 0===t||t.focus()}),onPointerDownOutside:eK(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey,i=2===t.button||r;i&&e.preventDefault()}),onFocusOutside:eK(e.onFocusOutside,e=>e.preventDefault())}))}),rh=(0,g.forwardRef)((e,t)=>{let r=re(rd,e.__scopeDialog),i=(0,g.useRef)(!1),n=(0,g.useRef)(!1);return(0,g.createElement)(rm,(0,eW.Z)({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var s,a;null===(s=e.onCloseAutoFocus)||void 0===s||s.call(e,t),t.defaultPrevented||(i.current||null===(a=r.triggerRef.current)||void 0===a||a.focus(),t.preventDefault()),i.current=!1,n.current=!1},onInteractOutside:t=>{var s,a;null===(s=e.onInteractOutside)||void 0===s||s.call(e,t),t.defaultPrevented||(i.current=!0,"pointerdown"!==t.detail.originalEvent.type||(n.current=!0));let o=t.target,l=null===(a=r.triggerRef.current)||void 0===a?void 0:a.contains(o);l&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&n.current&&t.preventDefault()}}))}),rm=(0,g.forwardRef)((e,t)=>{let{__scopeDialog:r,trapFocus:i,onOpenAutoFocus:n,onCloseAutoFocus:s,...a}=e,o=re(rd,r),l=(0,g.useRef)(null),c=eQ(t,l);return ty(),(0,g.createElement)(g.Fragment,null,(0,g.createElement)(tl,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:n,onUnmountAutoFocus:s},(0,g.createElement)(tr,(0,eW.Z)({role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":ry(o.open)},a,{ref:c,onDismiss:()=>o.onOpenChange(!1)}))),!1)}),rf="DialogTitle",rg=(0,g.forwardRef)((e,t)=>{let{__scopeDialog:r,...i}=e,n=re(rf,r);return(0,g.createElement)(e7.h2,(0,eW.Z)({id:n.titleId},i,{ref:t}))}),rv=(0,g.forwardRef)((e,t)=>{let{__scopeDialog:r,...i}=e,n=re("DialogClose",r);return(0,g.createElement)(e7.button,(0,eW.Z)({type:"button"},i,{ref:t,onClick:eK(e.onClick,()=>n.onOpenChange(!1))}))});function ry(e){return e?"open":"closed"}let[rb,rw]=function(e,t){let r=(0,g.createContext)(t);function i(e){let{children:t,...i}=e,n=(0,g.useMemo)(()=>i,Object.values(i));return(0,g.createElement)(r.Provider,{value:n},t)}return i.displayName=e+"Provider",[i,function(i){let n=(0,g.useContext)(r);if(n)return n;if(void 0!==t)return t;throw Error(`\`${i}\` must be used within \`${e}\``)}]}("DialogTitleWarning",{contentName:rd,titleName:rf,docsSlug:"dialog"});function r_(e,[t,r]){return Math.min(r,Math.max(t,e))}r(92222);let rS=(0,g.createContext)(void 0);function rx(e){return e.split("-")[1]}function rC(e){return"y"===e?"height":"width"}function rT(e){return e.split("-")[0]}function rk(e){return["top","bottom"].includes(rT(e))?"x":"y"}function rR(e,t,r){let i,{reference:n,floating:s}=e,a=n.x+n.width/2-s.width/2,o=n.y+n.height/2-s.height/2,l=rk(t),c=rC(l),d=n[c]/2-s[c]/2,u="x"===l;switch(rT(t)){case"top":i={x:a,y:n.y-s.height};break;case"bottom":i={x:a,y:n.y+n.height};break;case"right":i={x:n.x+n.width,y:o};break;case"left":i={x:n.x-s.width,y:o};break;default:i={x:n.x,y:n.y}}switch(rx(t)){case"start":i[l]-=d*(r&&u?-1:1);break;case"end":i[l]+=d*(r&&u?-1:1)}return i}let rE=async(e,t,r)=>{let{placement:i="bottom",strategy:n="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),l=await (null==a.isRTL?void 0:a.isRTL(t)),c=await a.getElementRects({reference:e,floating:t,strategy:n}),{x:d,y:u}=rR(c,i,l),p=i,h={},m=0;for(let f=0;f<o.length;f++){let{name:g,fn:v}=o[f],{x:y,y:b,data:w,reset:_}=await v({x:d,y:u,initialPlacement:i,placement:p,strategy:n,middlewareData:h,rects:c,platform:a,elements:{reference:e,floating:t}});d=null!=y?y:d,u=null!=b?b:u,h={...h,[g]:{...h[g],...w}},_&&m<=50&&(m++,"object"==typeof _&&(_.placement&&(p=_.placement),_.rects&&(c=!0===_.rects?await a.getElementRects({reference:e,floating:t,strategy:n}):_.rects),{x:d,y:u}=rR(c,p,l)),f=-1)}return{x:d,y:u,placement:p,strategy:n,middlewareData:h}};function rP(e,t){return"function"==typeof e?e(t):e}function rD(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function rL(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function rI(e,t){var r;void 0===t&&(t={});let{x:i,y:n,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:p=!1,padding:h=0}=rP(t,e),m=rD(h),f=o[p?"floating"===u?"reference":"floating":u],g=rL(await s.getClippingRect({element:null==(r=await (null==s.isElement?void 0:s.isElement(f)))||r?f:f.contextElement||await (null==s.getDocumentElement?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:d,strategy:l})),v="floating"===u?{...a.floating,x:i,y:n}:a.reference,y=await (null==s.getOffsetParent?void 0:s.getOffsetParent(o.floating)),b=await (null==s.isElement?void 0:s.isElement(y))&&await (null==s.getScale?void 0:s.getScale(y))||{x:1,y:1},w=rL(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-w.top+m.top)/b.y,bottom:(w.bottom-g.bottom+m.bottom)/b.y,left:(g.left-w.left+m.left)/b.x,right:(w.right-g.right+m.right)/b.x}}let rM=Math.min,rj=Math.max,rO=e=>({name:"arrow",options:e,async fn(t){let{x:r,y:i,placement:n,rects:s,platform:a,elements:o}=t,{element:l,padding:c=0}=rP(e,t)||{};if(null==l)return{};let d=rD(c),u={x:r,y:i},p=rk(n),h=rC(p),m=await a.getDimensions(l),f="y"===p,g=f?"clientHeight":"clientWidth",v=s.reference[h]+s.reference[p]-u[p]-s.floating[h],y=u[p]-s.reference[p],b=await (null==a.getOffsetParent?void 0:a.getOffsetParent(l)),w=b?b[g]:0;w&&await (null==a.isElement?void 0:a.isElement(b))||(w=o.floating[g]||s.floating[h]);let _=w/2-m[h]/2-1,S=rM(d[f?"top":"left"],_),x=rM(d[f?"bottom":"right"],_),C=w-m[h]-x,T=w/2-m[h]/2+(v/2-y/2),k=rj(S,rM(T,C)),R=null!=rx(n)&&T!=k&&s.reference[h]/2-(T<S?S:x)-m[h]/2<0?T<S?S-T:C-T:0;return{[p]:u[p]-R,data:{[p]:k,centerOffset:T-k+R}}}}),rA=["top","right","bottom","left"],rN=(rA.reduce((e,t)=>e.concat(t,t+"-start",t+"-end"),[]),{left:"right",right:"left",bottom:"top",top:"bottom"});function rF(e){return e.replace(/left|right|bottom|top/g,e=>rN[e])}let rq={start:"end",end:"start"};function rB(e){return e.replace(/start|end/g,e=>rq[e])}function rU(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function rH(e){return rA.some(t=>e[t]>=0)}function rz(e){return"x"===e?"y":"x"}function rV(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function r$(e){return rV(e).getComputedStyle(e)}function rZ(e){return e instanceof rV(e).Node}function rW(e){return rZ(e)?(e.nodeName||"").toLowerCase():"#document"}function rK(e){return e instanceof HTMLElement||e instanceof rV(e).HTMLElement}function rG(e){return"undefined"!=typeof ShadowRoot&&(e instanceof rV(e).ShadowRoot||e instanceof ShadowRoot)}function rQ(e){let{overflow:t,overflowX:r,overflowY:i,display:n}=r$(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+r)&&!["inline","contents"].includes(n)}function rY(e){let t=rJ(),r=r$(e);return"none"!==r.transform||"none"!==r.perspective||!!r.containerType&&"normal"!==r.containerType||!t&&!!r.backdropFilter&&"none"!==r.backdropFilter||!t&&!!r.filter&&"none"!==r.filter||["transform","perspective","filter"].some(e=>(r.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(r.contain||"").includes(e))}function rJ(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function rX(e){return["html","body","#document"].includes(rW(e))}let r0=Math.min,r1=Math.max,r2=Math.round,r5=Math.floor,r4=e=>({x:e,y:e});function r6(e){let t=r$(e),r=parseFloat(t.width)||0,i=parseFloat(t.height)||0,n=rK(e),s=n?e.offsetWidth:r,a=n?e.offsetHeight:i,o=r2(r)!==s||r2(i)!==a;return o&&(r=s,i=a),{width:r,height:i,$:o}}function r3(e){return e instanceof Element||e instanceof rV(e).Element}function r9(e){return r3(e)?e:e.contextElement}function r8(e){let t=r9(e);if(!rK(t))return r4(1);let r=t.getBoundingClientRect(),{width:i,height:n,$:s}=r6(t),a=(s?r2(r.width):r.width)/i,o=(s?r2(r.height):r.height)/n;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}let r7=r4(0);function ie(e){let t=rV(e);return rJ()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:r7}function it(e,t,r,i){var n;void 0===t&&(t=!1),void 0===r&&(r=!1);let s=e.getBoundingClientRect(),a=r9(e),o=r4(1);t&&(i?r3(i)&&(o=r8(i)):o=r8(e));let l=(void 0===(n=r)&&(n=!1),!(!i||n&&i!==rV(a))&&n)?ie(a):r4(0),c=(s.left+l.x)/o.x,d=(s.top+l.y)/o.y,u=s.width/o.x,p=s.height/o.y;if(a){let h=rV(a),m=i&&r3(i)?rV(i):i,f=h.frameElement;for(;f&&i&&m!==h;){let g=r8(f),v=f.getBoundingClientRect(),y=getComputedStyle(f),b=v.left+(f.clientLeft+parseFloat(y.paddingLeft))*g.x,w=v.top+(f.clientTop+parseFloat(y.paddingTop))*g.y;c*=g.x,d*=g.y,u*=g.x,p*=g.y,c+=b,d+=w,f=rV(f).frameElement}}return rL({width:u,height:p,x:c,y:d})}function ir(e){return r3(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function ii(e){var t;return null==(t=(rZ(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function is(e){return it(ii(e)).left+ir(e).scrollLeft}function ia(e){if("html"===rW(e))return e;let t=e.assignedSlot||e.parentNode||rG(e)&&e.host||ii(e);return rG(t)?t.host:t}function io(e,t){var r;void 0===t&&(t=[]);let i=function e(t){let r=ia(t);return rX(r)?t.ownerDocument?t.ownerDocument.body:t.body:rK(r)&&rQ(r)?r:e(r)}(e),n=i===(null==(r=e.ownerDocument)?void 0:r.body),s=rV(i);return n?t.concat(s,s.visualViewport||[],rQ(i)?i:[]):t.concat(i,io(i))}function il(e,t,r){let i;if("viewport"===t)i=function(e,t){let r=rV(e),i=ii(e),n=r.visualViewport,s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(n){s=n.width,a=n.height;let c=rJ();(!c||c&&"fixed"===t)&&(o=n.offsetLeft,l=n.offsetTop)}return{width:s,height:a,x:o,y:l}}(e,r);else if("document"===t)i=function(e){let t=ii(e),r=ir(e),i=e.ownerDocument.body,n=r1(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=r1(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight),a=-r.scrollLeft+is(e),o=-r.scrollTop;return"rtl"===r$(i).direction&&(a+=r1(t.clientWidth,i.clientWidth)-n),{width:n,height:s,x:a,y:o}}(ii(e));else if(r3(t))i=function(e,t){let r=it(e,!0,"fixed"===t),i=r.top+e.clientTop,n=r.left+e.clientLeft,s=rK(e)?r8(e):r4(1);return{width:e.clientWidth*s.x,height:e.clientHeight*s.y,x:n*s.x,y:i*s.y}}(t,r);else{let n=ie(e);i={...t,x:t.x-n.x,y:t.y-n.y}}return rL(i)}function ic(e,t){return rK(e)&&"fixed"!==r$(e).position?t?t(e):e.offsetParent:null}function id(e,t){let r=rV(e);if(!rK(e))return r;let i=ic(e,t);for(;i&&["table","td","th"].includes(rW(i))&&"static"===r$(i).position;)i=ic(i,t);return i&&("html"===rW(i)||"body"===rW(i)&&"static"===r$(i).position&&!rY(i))?r:i||function(e){let t=ia(e);for(;rK(t)&&!rX(t);){if(rY(t))return t;t=ia(t)}return null}(e)||r}let iu={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:r,strategy:i}=e,n=rK(r),s=ii(r);if(r===s)return t;let a={scrollLeft:0,scrollTop:0},o=r4(1),l=r4(0);if((n||!n&&"fixed"!==i)&&(("body"!==rW(r)||rQ(s))&&(a=ir(r)),rK(r))){let c=it(r);o=r8(r),l.x=c.x+r.clientLeft,l.y=c.y+r.clientTop}return{width:t.width*o.x,height:t.height*o.y,x:t.x*o.x-a.scrollLeft*o.x+l.x,y:t.y*o.y-a.scrollTop*o.y+l.y}},getDocumentElement:ii,getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:i,strategy:n}=e,s=[..."clippingAncestors"===r?function(e,t){let r=t.get(e);if(r)return r;let i=io(e).filter(e=>r3(e)&&"body"!==rW(e)),n=null,s="fixed"===r$(e).position,a=s?ia(e):e;for(;r3(a)&&!rX(a);){let o=r$(a),l=rY(a);l||"fixed"!==o.position||(n=null),(s?!l&&!n:!l&&"static"===o.position&&n&&["absolute","fixed"].includes(n.position)||rQ(a)&&!l&&function e(t,r){let i=ia(t);return!(i===r||!r3(i)||rX(i))&&("fixed"===r$(i).position||e(i,r))}(e,a))?i=i.filter(e=>e!==a):n=o,a=ia(a)}return t.set(e,i),i}(t,this._c):[].concat(r),i],a=s[0],o=s.reduce((e,r)=>{let i=il(t,r,n);return e.top=r1(i.top,e.top),e.right=r0(i.right,e.right),e.bottom=r0(i.bottom,e.bottom),e.left=r1(i.left,e.left),e},il(t,a,n));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:id,getElementRects:async function(e){let{reference:t,floating:r,strategy:i}=e,n=this.getOffsetParent||id,s=this.getDimensions;return{reference:function(e,t,r){let i=rK(t),n=ii(t),s="fixed"===r,a=it(e,!0,s,t),o={scrollLeft:0,scrollTop:0},l=r4(0);if(i||!i&&!s){if(("body"!==rW(t)||rQ(n))&&(o=ir(t)),rK(t)){let c=it(t,!0,s,t);l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}else n&&(l.x=is(n))}return{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}(t,await n(r),i),floating:{x:0,y:0,...await s(r)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){return r6(e)},getScale:r8,isElement:r3,isRTL:function(e){return"rtl"===getComputedStyle(e).direction}};function ip(e,t,r,i){void 0===i&&(i={});let{ancestorScroll:n=!0,ancestorResize:s=!0,elementResize:a="function"==typeof ResizeObserver,layoutShift:o="function"==typeof IntersectionObserver,animationFrame:l=!1}=i,c=r9(e),d=n||s?[...c?io(c):[],...io(t)]:[];d.forEach(e=>{n&&e.addEventListener("scroll",r,{passive:!0}),s&&e.addEventListener("resize",r)});let u=c&&o?function(e,t){let r,i=null,n=ii(e);function s(){clearTimeout(r),i&&i.disconnect(),i=null}return function a(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),s();let{left:c,top:d,width:u,height:p}=e.getBoundingClientRect();if(o||t(),!u||!p)return;let h={rootMargin:-r5(d)+"px "+-r5(n.clientWidth-(c+u))+"px "+-r5(n.clientHeight-(d+p))+"px "+-r5(c)+"px",threshold:r1(0,r0(1,l))||1},m=!0;function f(e){let t=e[0].intersectionRatio;if(t!==l){if(!m)return a();t?a(!1,t):r=setTimeout(()=>{a(!1,1e-7)},100)}m=!1}try{i=new IntersectionObserver(f,{...h,root:n.ownerDocument})}catch(g){i=new IntersectionObserver(f,h)}i.observe(e)}(!0),s}(c,r):null,p,h=-1,m=null;a&&(m=new ResizeObserver(e=>{let[i]=e;i&&i.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{m&&m.observe(t)})),r()}),c&&!l&&m.observe(c),m.observe(t));let f=l?it(e):null;return l&&function t(){let i=it(e);f&&(i.x!==f.x||i.y!==f.y||i.width!==f.width||i.height!==f.height)&&r(),f=i,p=requestAnimationFrame(t)}(),r(),()=>{d.forEach(e=>{n&&e.removeEventListener("scroll",r),s&&e.removeEventListener("resize",r)}),u&&u(),m&&m.disconnect(),m=null,l&&cancelAnimationFrame(p)}}let ih=(e,t,r)=>{let i=new Map,n={platform:iu,...r},s={...n.platform,_c:i};return rE(e,t,{...n,platform:s})},im=e=>({name:"arrow",options:e,fn(t){let{element:r,padding:i}="function"==typeof e?e(t):e;if(r&&({}).hasOwnProperty.call(r,"current")){if(null!=r.current)return rO({element:r.current,padding:i}).fn(t)}else if(r)return rO({element:r,padding:i}).fn(t);return{}}});var ig="undefined"!=typeof document?g.useLayoutEffect:g.useEffect;function iv(e,t){let r,i,n;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((r=e.length)!=t.length)return!1;for(i=r;0!=i--;)if(!iv(e[i],t[i]))return!1;return!0}if((r=(n=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(i=r;0!=i--;)if(!({}).hasOwnProperty.call(t,n[i]))return!1;for(i=r;0!=i--;){let s=n[i];if(("_owner"!==s||!e.$$typeof)&&!iv(e[s],t[s]))return!1}return!0}return e!=e&&t!=t}function iy(e){if("undefined"==typeof window)return 1;let t=e.ownerDocument.defaultView||window;return t.devicePixelRatio||1}function ib(e,t){let r=iy(e);return Math.round(t*r)/r}function iw(e){let t=g.useRef(e);return ig(()=>{t.current=e}),t}let i_=(0,g.forwardRef)((e,t)=>{let{children:r,width:i=10,height:n=5,...s}=e;return(0,g.createElement)(e7.svg,(0,eW.Z)({},s,{ref:t,width:i,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?r:(0,g.createElement)("polygon",{points:"0,0 30,0 15,10"}))}),iS="Popper",[ix,iC]=eY(iS),[iT,ik]=ix(iS),iR=e=>{let{__scopePopper:t,children:r}=e,[i,n]=(0,g.useState)(null);return(0,g.createElement)(iT,{scope:t,anchor:i,onAnchorChange:n},r)},iE=(0,g.forwardRef)((e,t)=>{let{__scopePopper:r,virtualRef:i,...n}=e,s=ik("PopperAnchor",r),a=(0,g.useRef)(null),o=eQ(t,a);return(0,g.useEffect)(()=>{s.onAnchorChange((null==i?void 0:i.current)||a.current)}),i?null:(0,g.createElement)(e7.div,(0,eW.Z)({},n,{ref:o}))}),iP="PopperContent",[iD,iL]=ix(iP),iI=(0,g.forwardRef)((e,t)=>{var r,i,n,s,a,o,l,c,d,u,p,h,m,f;let{__scopePopper:v,side:y="bottom",sideOffset:b=0,align:w="center",alignOffset:_=0,arrowPadding:S=0,collisionBoundary:x=[],collisionPadding:C=0,sticky:T="partial",hideWhenDetached:k=!1,avoidCollisions:R=!0,onPlaced:E,...P}=e,D=ik(iP,v),[L,I]=(0,g.useState)(null),M=eQ(t,e=>I(e)),[j,O]=(0,g.useState)(null),A=function(e){let[t,r]=(0,g.useState)(void 0);return eJ(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let i,n;if(!Array.isArray(t)||!t.length)return;let s=t[0];if("borderBoxSize"in s){let a=s.borderBoxSize,o=Array.isArray(a)?a[0]:a;i=o.inlineSize,n=o.blockSize}else i=e.offsetWidth,n=e.offsetHeight;r({width:i,height:n})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}(j),N=null!==(r=null==A?void 0:A.width)&&void 0!==r?r:0,F=null!==(i=null==A?void 0:A.height)&&void 0!==i?i:0,q="number"==typeof C?C:{top:0,right:0,bottom:0,left:0,...C},B=Array.isArray(x)?x:[x],U=B.length>0,H={padding:q,boundary:B.filter(ij),altBoundary:U},{refs:z,floatingStyles:V,placement:$,isPositioned:Z,middlewareData:W}=function(e){void 0===e&&(e={});let{placement:t="bottom",strategy:r="absolute",middleware:i=[],platform:n,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[d,u]=g.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[p,h]=g.useState(i);iv(p,i)||h(i);let[m,f]=g.useState(null),[v,y]=g.useState(null),b=g.useCallback(e=>{e!=x.current&&(x.current=e,f(e))},[f]),w=g.useCallback(e=>{e!==C.current&&(C.current=e,y(e))},[y]),_=s||m,S=a||v,x=g.useRef(null),C=g.useRef(null),T=g.useRef(d),k=iw(l),R=iw(n),E=g.useCallback(()=>{if(!x.current||!C.current)return;let e={placement:t,strategy:r,middleware:p};R.current&&(e.platform=R.current),ih(x.current,C.current,e).then(e=>{let t={...e,isPositioned:!0};P.current&&!iv(T.current,t)&&(T.current=t,e4.flushSync(()=>{u(t)}))})},[p,t,r,R]);ig(()=>{!1===c&&T.current.isPositioned&&(T.current.isPositioned=!1,u(e=>({...e,isPositioned:!1})))},[c]);let P=g.useRef(!1);ig(()=>(P.current=!0,()=>{P.current=!1}),[]),ig(()=>{if(_&&(x.current=_),S&&(C.current=S),_&&S){if(k.current)return k.current(_,S,E);E()}},[_,S,E,k]);let D=g.useMemo(()=>({reference:x,floating:C,setReference:b,setFloating:w}),[b,w]),L=g.useMemo(()=>({reference:_,floating:S}),[_,S]),I=g.useMemo(()=>{let e={position:r,left:0,top:0};if(!L.floating)return e;let t=ib(L.floating,d.x),i=ib(L.floating,d.y);return o?{...e,transform:"translate("+t+"px, "+i+"px)",...iy(L.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:i}},[r,o,L.floating,d.x,d.y]);return g.useMemo(()=>({...d,update:E,refs:D,elements:L,floatingStyles:I}),[d,E,D,L,I])}({strategy:"fixed",placement:y+("center"!==w?"-"+w:""),whileElementsMounted:ip,elements:{reference:D.anchor},middleware:[{name:"offset",options:d={mainAxis:b+F,alignmentAxis:_},async fn(e){let{x:t,y:r}=e,i=await async function(e,t){let{placement:r,platform:i,elements:n}=e,s=await (null==i.isRTL?void 0:i.isRTL(n.floating)),a=rT(r),o=rx(r),l="x"===rk(r),c=["left","top"].includes(a)?-1:1,d=s&&l?-1:1,u=rP(t,e),{mainAxis:p,crossAxis:h,alignmentAxis:m}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...u};return o&&"number"==typeof m&&(h="end"===o?-1*m:m),l?{x:h*d,y:p*c}:{x:p*c,y:h*d}}(e,d);return{x:t+i.x,y:r+i.y,data:i}}},R&&{name:"shift",options:p={mainAxis:!0,crossAxis:!1,limiter:"partial"===T?(void 0===u&&(u={}),{options:u,fn(e){let{x:t,y:r,placement:i,rects:n,middlewareData:s}=e,{offset:a=0,mainAxis:o=!0,crossAxis:l=!0}=rP(u,e),c={x:t,y:r},d=rk(i),p=rz(d),h=c[d],m=c[p],f=rP(a,e),g="number"==typeof f?{mainAxis:f,crossAxis:0}:{mainAxis:0,crossAxis:0,...f};if(o){let v="y"===d?"height":"width",y=n.reference[d]-n.floating[v]+g.mainAxis,b=n.reference[d]+n.reference[v]-g.mainAxis;h<y?h=y:h>b&&(h=b)}if(l){var w,_;let S="y"===d?"width":"height",x=["top","left"].includes(rT(i)),C=n.reference[p]-n.floating[S]+(x&&(null==(w=s.offset)?void 0:w[p])||0)+(x?0:g.crossAxis),T=n.reference[p]+n.reference[S]+(x?0:(null==(_=s.offset)?void 0:_[p])||0)-(x?g.crossAxis:0);m<C?m=C:m>T&&(m=T)}return{[d]:h,[p]:m}}}):void 0,...H},async fn(e){let{x:t,y:r,placement:i}=e,{mainAxis:n=!0,crossAxis:s=!1,limiter:a={fn:e=>{let{x:t,y:r}=e;return{x:t,y:r}}},...o}=rP(p,e),l={x:t,y:r},c=await rI(e,o),d=rk(rT(i)),u=rz(d),h=l[d],m=l[u];n&&(h=rj(h+c["y"===d?"top":"left"],rM(h,h-c["y"===d?"bottom":"right"]))),s&&(m=rj(m+c["y"===u?"top":"left"],rM(m,m-c["y"===u?"bottom":"right"])));let f=a.fn({...e,[d]:h,[u]:m});return{...f,data:{x:f.x-t,y:f.y-r}}}},R&&{name:"flip",options:h={...H},async fn(e){var t,r,i,n;let{placement:s,middlewareData:a,rects:o,initialPlacement:l,platform:c,elements:d}=e,{mainAxis:u=!0,crossAxis:p=!0,fallbackPlacements:m,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0,...y}=rP(h,e),b=rT(s),w=rT(l)===l,_=await (null==c.isRTL?void 0:c.isRTL(d.floating)),S=m||(w||!v?[rF(l)]:function(e){let t=rF(e);return[rB(e),t,rB(t)]}(l));m||"none"===g||S.push(...function(e,t,r,i){let n=rx(e),s=function(e,t,r){let i=["left","right"],n=["right","left"];switch(e){case"top":case"bottom":return r?t?n:i:t?i:n;case"left":case"right":return t?["top","bottom"]:["bottom","top"];default:return[]}}(rT(e),"start"===r,i);return n&&(s=s.map(e=>e+"-"+n),t&&(s=s.concat(s.map(rB)))),s}(l,v,g,_));let x=[l,...S],C=await rI(e,y),T=[],k=(null==(t=a.flip)?void 0:t.overflows)||[];if(u&&T.push(C[b]),p){let{main:R,cross:E}=function(e,t,r){void 0===r&&(r=!1);let i=rx(e),n=rk(e),s=rC(n),a="x"===n?i===(r?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=rF(a)),{main:a,cross:rF(a)}}(s,o,_);T.push(C[R],C[E])}if(k=[...k,{placement:s,overflows:T}],!T.every(e=>e<=0)){let P=((null==(r=a.flip)?void 0:r.index)||0)+1,D=x[P];if(D)return{data:{index:P,overflows:k},reset:{placement:D}};let L=null==(i=k.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:i.placement;if(!L)switch(f){case"bestFit":{let I=null==(n=k.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:n[0];I&&(L=I);break}case"initialPlacement":L=l}if(s!==L)return{reset:{placement:L}}}return{}}},{name:"size",options:m={...H,apply:({elements:e,rects:t,availableWidth:r,availableHeight:i})=>{let{width:n,height:s}=t.reference,a=e.floating.style;a.setProperty("--radix-popper-available-width",`${r}px`),a.setProperty("--radix-popper-available-height",`${i}px`),a.setProperty("--radix-popper-anchor-width",`${n}px`),a.setProperty("--radix-popper-anchor-height",`${s}px`)}},async fn(e){let t,r;let{placement:i,rects:n,platform:s,elements:a}=e,{apply:o=()=>{},...l}=rP(m,e),c=await rI(e,l),d=rT(i),u=rx(i),p="x"===rk(i),{width:h,height:f}=n.floating;"top"===d||"bottom"===d?(t=d,r=u===(await (null==s.isRTL?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(r=d,t="end"===u?"top":"bottom");let g=f-c[t],v=h-c[r],y=!e.middlewareData.shift,b=g,w=v;if(p){let _=h-c.left-c.right;w=u||y?rM(v,_):_}else{let S=f-c.top-c.bottom;b=u||y?rM(g,S):S}if(y&&!u){let x=rj(c.left,0),C=rj(c.right,0),T=rj(c.top,0),k=rj(c.bottom,0);p?w=h-2*(0!==x||0!==C?x+C:rj(c.left,c.right)):b=f-2*(0!==T||0!==k?T+k:rj(c.top,c.bottom))}await o({...e,availableWidth:w,availableHeight:b});let R=await s.getDimensions(a.floating);return h!==R.width||f!==R.height?{reset:{rects:!0}}:{}}},j&&im({element:j,padding:S}),iO({arrowWidth:N,arrowHeight:F}),k&&{name:"hide",options:f={strategy:"referenceHidden"},async fn(e){let{rects:t}=e,{strategy:r="referenceHidden",...i}=rP(f,e);switch(r){case"referenceHidden":{let n=rU(await rI(e,{...i,elementContext:"reference"}),t.reference);return{data:{referenceHiddenOffsets:n,referenceHidden:rH(n)}}}case"escaped":{let s=rU(await rI(e,{...i,altBoundary:!0}),t.floating);return{data:{escapedOffsets:s,escaped:rH(s)}}}default:return{}}}}]}),[K,G]=iA($),Q=e2(E);eJ(()=>{Z&&(null==Q||Q())},[Z,Q]);let Y=null===(n=W.arrow)||void 0===n?void 0:n.x,J=null===(s=W.arrow)||void 0===s?void 0:s.y,X=(null===(a=W.arrow)||void 0===a?void 0:a.centerOffset)!==0,[ee,et]=(0,g.useState)();return eJ(()=>{L&&et(window.getComputedStyle(L).zIndex)},[L]),(0,g.createElement)("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...V,transform:Z?V.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ee,"--radix-popper-transform-origin":[null===(o=W.transformOrigin)||void 0===o?void 0:o.x,null===(l=W.transformOrigin)||void 0===l?void 0:l.y].join(" ")},dir:e.dir},(0,g.createElement)(iD,{scope:v,placedSide:K,onArrowChange:O,arrowX:Y,arrowY:J,shouldHideArrow:X},(0,g.createElement)(e7.div,(0,eW.Z)({"data-side":K,"data-align":G},P,{ref:M,style:{...P.style,animation:Z?void 0:"none",opacity:null!==(c=W.hide)&&void 0!==c&&c.referenceHidden?0:void 0}}))))}),iM={top:"bottom",right:"left",bottom:"top",left:"right"};function ij(e){return null!==e}let iO=e=>({name:"transformOrigin",options:e,fn(t){var r,i,n,s,a;let{placement:o,rects:l,middlewareData:c}=t,d=(null===(r=c.arrow)||void 0===r?void 0:r.centerOffset)!==0,u=d?0:e.arrowWidth,p=d?0:e.arrowHeight,[h,m]=iA(o),f={start:"0%",center:"50%",end:"100%"}[m],g=(null!==(i=null===(n=c.arrow)||void 0===n?void 0:n.x)&&void 0!==i?i:0)+u/2,v=(null!==(s=null===(a=c.arrow)||void 0===a?void 0:a.y)&&void 0!==s?s:0)+p/2,y="",b="";return"bottom"===h?(y=d?f:`${g}px`,b=`${-p}px`):"top"===h?(y=d?f:`${g}px`,b=`${l.floating.height+p}px`):"right"===h?(y=`${-p}px`,b=d?f:`${v}px`):"left"===h&&(y=`${l.floating.width+p}px`,b=d?f:`${v}px`),{data:{x:y,y:b}}}});function iA(e){let[t,r="center"]=e.split("-");return[t,r]}let iN=(0,g.forwardRef)((e,t)=>(0,g.createElement)(e7.span,(0,eW.Z)({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}))),iF=[" ","Enter","ArrowUp","ArrowDown"],iq=[" ","Enter"],iB="Select",[iU,iH,iz]=function(e){let t=e+"CollectionProvider",[r,i]=eY(t),[n,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),a=e=>{let{scope:t,children:r}=e,i=g.useRef(null),s=g.useRef(new Map).current;return g.createElement(n,{scope:t,itemMap:s,collectionRef:i},r)},o=e+"CollectionSlot",l=g.forwardRef((e,t)=>{let{scope:r,children:i}=e,n=s(o,r),a=eQ(t,n.collectionRef);return g.createElement(e6,{ref:a},i)}),c=e+"CollectionItemSlot",d="data-radix-collection-item",u=g.forwardRef((e,t)=>{let{scope:r,children:i,...n}=e,a=g.useRef(null),o=eQ(t,a),l=s(c,r);return g.useEffect(()=>(l.itemMap.set(a,{ref:a,...n}),()=>void l.itemMap.delete(a))),g.createElement(e6,{[d]:"",ref:o},i)});return[{Provider:a,Slot:l,ItemSlot:u},function(t){let r=s(e+"CollectionConsumer",t),i=g.useCallback(()=>{let e=r.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${d}]`)),i=Array.from(r.itemMap.values()),n=i.sort((e,r)=>t.indexOf(e.ref.current)-t.indexOf(r.ref.current));return n},[r.collectionRef,r.itemMap]);return i},i]}(iB),[iV,i$]=eY(iB,[iz,iC]),iZ=iC(),[iW,iK]=iV(iB),[iG,iQ]=iV(iB),iY=e=>{let{__scopeSelect:t,children:r,open:i,defaultOpen:n,onOpenChange:s,value:a,defaultValue:o,onValueChange:l,dir:c,name:d,autoComplete:u,disabled:p,required:h}=e,m=iZ(t),[f,v]=(0,g.useState)(null),[y,b]=(0,g.useState)(null),[w,_]=(0,g.useState)(!1),S=function(e){let t=(0,g.useContext)(rS);return e||t||"ltr"}(c),[x=!1,C]=e5({prop:i,defaultProp:n,onChange:s}),[T,k]=e5({prop:a,defaultProp:o,onChange:l}),R=(0,g.useRef)(null),E=!f||Boolean(f.closest("form")),[P,D]=(0,g.useState)(new Set),L=Array.from(P).map(e=>e.props.value).join(";");return(0,g.createElement)(iR,m,(0,g.createElement)(iW,{required:h,scope:t,trigger:f,onTriggerChange:v,valueNode:y,onValueNodeChange:b,valueNodeHasChildren:w,onValueNodeHasChildrenChange:_,contentId:e1(),value:T,onValueChange:k,open:x,onOpenChange:C,dir:S,triggerPointerDownPosRef:R,disabled:p},(0,g.createElement)(iU.Provider,{scope:t},(0,g.createElement)(iG,{scope:e.__scopeSelect,onNativeOptionAdd:(0,g.useCallback)(e=>{D(t=>new Set(t).add(e))},[]),onNativeOptionRemove:(0,g.useCallback)(e=>{D(t=>{let r=new Set(t);return r.delete(e),r})},[])},r)),E?(0,g.createElement)(nh,{key:L,"aria-hidden":!0,required:h,tabIndex:-1,name:d,autoComplete:u,value:T,onChange:e=>k(e.target.value),disabled:p},void 0===T?(0,g.createElement)("option",{value:""}):null,Array.from(P)):null))},iJ=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,disabled:i=!1,...n}=e,s=iZ(r),a=iK("SelectTrigger",r),o=a.disabled||i,l=eQ(t,a.onTriggerChange),c=iH(r),[d,u,p]=nm(e=>{let t=c().filter(e=>!e.disabled),r=t.find(e=>e.value===a.value),i=nf(t,e,r);void 0!==i&&a.onValueChange(i.value)}),h=()=>{o||(a.onOpenChange(!0),p())};return(0,g.createElement)(iE,(0,eW.Z)({asChild:!0},s),(0,g.createElement)(e7.button,(0,eW.Z)({type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":void 0===a.value?"":void 0},n,{ref:l,onClick:eK(n.onClick,e=>{e.currentTarget.focus()}),onPointerDown:eK(n.onPointerDown,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&(h(),a.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)},e.preventDefault())}),onKeyDown:eK(n.onKeyDown,e=>{let t=""!==d.current,r=e.ctrlKey||e.altKey||e.metaKey;r||1!==e.key.length||u(e.key),(!t||" "!==e.key)&&iF.includes(e.key)&&(h(),e.preventDefault())})})))}),iX=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,className:i,style:n,children:s,placeholder:a,...o}=e,l=iK("SelectValue",r),{onValueNodeHasChildrenChange:c}=l,d=void 0!==s,u=eQ(t,l.onValueNodeChange);return eJ(()=>{c(d)},[c,d]),(0,g.createElement)(e7.span,(0,eW.Z)({},o,{ref:u,style:{pointerEvents:"none"}}),void 0===l.value&&void 0!==a?a:s)}),i0=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,children:i,...n}=e;return(0,g.createElement)(e7.span,(0,eW.Z)({"aria-hidden":!0},n,{ref:t}),i||"")}),i1=e=>(0,g.createElement)(tm,(0,eW.Z)({asChild:!0},e)),i2="SelectContent",i5=(0,g.forwardRef)((e,t)=>{let r=iK(i2,e.__scopeSelect),[i,n]=(0,g.useState)();return(eJ(()=>{n(new DocumentFragment)},[]),r.open)?(0,g.createElement)(i3,(0,eW.Z)({},e,{ref:t})):i?(0,e4.createPortal)((0,g.createElement)(i4,{scope:e.__scopeSelect},(0,g.createElement)(iU.Slot,{scope:e.__scopeSelect},(0,g.createElement)("div",null,e.children))),i):null}),[i4,i6]=iV(i2),i3=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,position:i="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:s,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:d,arrowPadding:u,collisionBoundary:p,collisionPadding:h,sticky:m,hideWhenDetached:f,avoidCollisions:v,...y}=e,b=iK(i2,r),[w,_]=(0,g.useState)(null),[S,x]=(0,g.useState)(null),C=eQ(t,e=>_(e)),[T,k]=(0,g.useState)(null),[R,E]=(0,g.useState)(null),P=iH(r),[D,L]=(0,g.useState)(!1),I=(0,g.useRef)(!1);(0,g.useEffect)(()=>{if(w)return t6(w)},[w]),ty();let M=(0,g.useCallback)(e=>{let[t,...r]=P().map(e=>e.ref.current),[i]=r.slice(-1),n=document.activeElement;for(let s of e)if(s===n||(null==s||s.scrollIntoView({block:"nearest"}),s===t&&S&&(S.scrollTop=0),s===i&&S&&(S.scrollTop=S.scrollHeight),null==s||s.focus(),document.activeElement!==n))return},[P,S]),j=(0,g.useCallback)(()=>M([T,w]),[M,T,w]);(0,g.useEffect)(()=>{D&&j()},[D,j]);let{onOpenChange:O,triggerPointerDownPosRef:A}=b;(0,g.useEffect)(()=>{if(w){let e={x:0,y:0},t=t=>{var r,i,n,s;e={x:Math.abs(Math.round(t.pageX)-(null!==(r=null===(i=A.current)||void 0===i?void 0:i.x)&&void 0!==r?r:0)),y:Math.abs(Math.round(t.pageY)-(null!==(n=null===(s=A.current)||void 0===s?void 0:s.y)&&void 0!==n?n:0))}},r=r=>{e.x<=10&&e.y<=10?r.preventDefault():w.contains(r.target)||O(!1),document.removeEventListener("pointermove",t),A.current=null};return null!==A.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",r,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",r,{capture:!0})}}},[w,O,A]),(0,g.useEffect)(()=>{let e=()=>O(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[O]);let[N,F]=nm(e=>{let t=P().filter(e=>!e.disabled),r=t.find(e=>e.ref.current===document.activeElement),i=nf(t,e,r);i&&setTimeout(()=>i.ref.current.focus())}),q=(0,g.useCallback)((e,t,r)=>{let i=!I.current&&!r,n=void 0!==b.value&&b.value===t;(n||i)&&(k(e),i&&(I.current=!0))},[b.value]),B=(0,g.useCallback)(()=>null==w?void 0:w.focus(),[w]),U=(0,g.useCallback)((e,t,r)=>{let i=!I.current&&!r,n=void 0!==b.value&&b.value===t;(n||i)&&E(e)},[b.value]),H="popper"===i?i8:i9;return(0,g.createElement)(i4,{scope:r,content:w,viewport:S,onViewportChange:x,itemRefCallback:q,selectedItem:T,onItemLeave:B,itemTextRefCallback:U,focusSelectedItem:j,selectedItemText:R,position:i,isPositioned:D,searchRef:N},(0,g.createElement)(tJ,{as:e6,allowPinchZoom:!0},(0,g.createElement)(tl,{asChild:!0,trapped:b.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:eK(n,e=>{var t;null===(t=b.trigger)||void 0===t||t.focus({preventScroll:!0}),e.preventDefault()})},(0,g.createElement)(tr,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>b.onOpenChange(!1)},(0,g.createElement)(H,(0,eW.Z)({role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:e=>e.preventDefault()},y,H===i8?{side:o,sideOffset:l,align:c,alignOffset:d,arrowPadding:u,collisionBoundary:p,collisionPadding:h,sticky:m,hideWhenDetached:f,avoidCollisions:v}:{},{onPlaced:()=>L(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:eK(y.onKeyDown,e=>{let t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||F(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let r=P().filter(e=>!e.disabled),i=r.map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(i=i.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){let n=e.target,s=i.indexOf(n);i=i.slice(s+1)}setTimeout(()=>M(i)),e.preventDefault()}})}))))))}),i9=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,onPlaced:i,...n}=e,s=iK(i2,r),a=i6(i2,r),[o,l]=(0,g.useState)(null),[c,d]=(0,g.useState)(null),u=eQ(t,e=>d(e)),p=iH(r),h=(0,g.useRef)(!1),m=(0,g.useRef)(!0),{viewport:f,selectedItem:v,selectedItemText:y,focusSelectedItem:b}=a,w=(0,g.useCallback)(()=>{if(s.trigger&&s.valueNode&&o&&c&&f&&v&&y){let e=s.trigger.getBoundingClientRect(),t=c.getBoundingClientRect(),r=s.valueNode.getBoundingClientRect(),n=y.getBoundingClientRect();if("rtl"!==s.dir){let a=n.left-t.left,l=r.left-a,d=e.left-l,u=e.width+d,m=Math.max(u,t.width),g=window.innerWidth-10,b=r_(l,[10,g-m]);o.style.minWidth=u+"px",o.style.left=b+"px"}else{let w=t.right-n.right,_=window.innerWidth-r.right-w,S=window.innerWidth-e.right-_,x=e.width+S,C=Math.max(x,t.width),T=window.innerWidth-10,k=r_(_,[10,T-C]);o.style.minWidth=x+"px",o.style.right=k+"px"}let R=p(),E=window.innerHeight-20,P=f.scrollHeight,D=window.getComputedStyle(c),L=parseInt(D.borderTopWidth,10),I=parseInt(D.paddingTop,10),M=parseInt(D.borderBottomWidth,10),j=parseInt(D.paddingBottom,10),O=L+I+P+j+M,A=Math.min(5*v.offsetHeight,O),N=window.getComputedStyle(f),F=parseInt(N.paddingTop,10),q=parseInt(N.paddingBottom,10),B=e.top+e.height/2-10,U=v.offsetHeight/2,H=v.offsetTop+U,z=L+I+H;if(z<=B){let V=v===R[R.length-1].ref.current;o.style.bottom="0px";let $=c.clientHeight-f.offsetTop-f.offsetHeight;o.style.height=z+Math.max(E-B,U+(V?q:0)+$+M)+"px"}else{let Z=v===R[0].ref.current;o.style.top="0px";let W=Math.max(B,L+f.offsetTop+(Z?F:0)+U);o.style.height=W+(O-z)+"px",f.scrollTop=z-B+f.offsetTop}o.style.margin="10px 0",o.style.minHeight=A+"px",o.style.maxHeight=E+"px",null==i||i(),requestAnimationFrame(()=>h.current=!0)}},[p,s.trigger,s.valueNode,o,c,f,v,y,s.dir,i]);eJ(()=>w(),[w]);let[_,S]=(0,g.useState)();eJ(()=>{c&&S(window.getComputedStyle(c).zIndex)},[c]);let x=(0,g.useCallback)(e=>{e&&!0===m.current&&(w(),null==b||b(),m.current=!1)},[w,b]);return(0,g.createElement)(i7,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:h,onScrollButtonChange:x},(0,g.createElement)("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:_}},(0,g.createElement)(e7.div,(0,eW.Z)({},n,{ref:u,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}}))))}),i8=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,align:i="start",collisionPadding:n=10,...s}=e,a=iZ(r);return(0,g.createElement)(iI,(0,eW.Z)({},a,s,{ref:t,align:i,collisionPadding:n,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[i7,ne]=iV(i2,{}),nt="SelectViewport",nr=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,...i}=e,n=i6(nt,r),s=ne(nt,r),a=eQ(t,n.onViewportChange),o=(0,g.useRef)(0);return(0,g.createElement)(g.Fragment,null,(0,g.createElement)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),(0,g.createElement)(iU.Slot,{scope:r},(0,g.createElement)(e7.div,(0,eW.Z)({"data-radix-select-viewport":"",role:"presentation"},i,{ref:a,style:{position:"relative",flex:1,overflow:"auto",...i.style},onScroll:eK(i.onScroll,e=>{let t=e.currentTarget,{contentWrapper:r,shouldExpandOnScrollRef:i}=s;if(null!=i&&i.current&&r){let n=Math.abs(o.current-t.scrollTop);if(n>0){let a=window.innerHeight-20,l=parseFloat(r.style.minHeight),c=parseFloat(r.style.height),d=Math.max(l,c);if(d<a){let u=d+n,p=Math.min(a,u),h=u-p;r.style.height=p+"px","0px"===r.style.bottom&&(t.scrollTop=h>0?h:0,r.style.justifyContent="flex-end")}}}o.current=t.scrollTop})}))))}),[ni,nn]=iV("SelectGroup"),ns=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,...i}=e,n=e1();return(0,g.createElement)(ni,{scope:r,id:n},(0,g.createElement)(e7.div,(0,eW.Z)({role:"group","aria-labelledby":n},i,{ref:t})))}),na="SelectItem",[no,nl]=iV(na),nc=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,value:i,disabled:n=!1,textValue:s,...a}=e,o=iK(na,r),l=i6(na,r),c=o.value===i,[d,u]=(0,g.useState)(null!=s?s:""),[p,h]=(0,g.useState)(!1),m=eQ(t,e=>{var t;return null===(t=l.itemRefCallback)||void 0===t?void 0:t.call(l,e,i,n)}),f=e1(),v=()=>{n||(o.onValueChange(i),o.onOpenChange(!1))};return(0,g.createElement)(no,{scope:r,value:i,disabled:n,textId:f,isSelected:c,onItemTextChange:(0,g.useCallback)(e=>{u(t=>{var r;return t||(null!==(r=null==e?void 0:e.textContent)&&void 0!==r?r:"").trim()})},[])},(0,g.createElement)(iU.ItemSlot,{scope:r,value:i,disabled:n,textValue:d},(0,g.createElement)(e7.div,(0,eW.Z)({role:"option","aria-labelledby":f,"data-highlighted":p?"":void 0,"aria-selected":c&&p,"data-state":c?"checked":"unchecked","aria-disabled":n||void 0,"data-disabled":n?"":void 0,tabIndex:n?void 0:-1},a,{ref:m,onFocus:eK(a.onFocus,()=>h(!0)),onBlur:eK(a.onBlur,()=>h(!1)),onPointerUp:eK(a.onPointerUp,v),onPointerMove:eK(a.onPointerMove,e=>{if(n){var t;null===(t=l.onItemLeave)||void 0===t||t.call(l)}else e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:eK(a.onPointerLeave,e=>{if(e.currentTarget===document.activeElement){var t;null===(t=l.onItemLeave)||void 0===t||t.call(l)}}),onKeyDown:eK(a.onKeyDown,e=>{var t;let r=(null===(t=l.searchRef)||void 0===t?void 0:t.current)!=="";r&&" "===e.key||(iq.includes(e.key)&&v()," "===e.key&&e.preventDefault())})}))))}),nd="SelectItemText",nu=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,className:i,style:n,...s}=e,a=iK(nd,r),o=i6(nd,r),l=nl(nd,r),c=iQ(nd,r),[d,u]=(0,g.useState)(null),p=eQ(t,e=>u(e),l.onItemTextChange,e=>{var t;return null===(t=o.itemTextRefCallback)||void 0===t?void 0:t.call(o,e,l.value,l.disabled)}),h=null==d?void 0:d.textContent,m=(0,g.useMemo)(()=>(0,g.createElement)("option",{key:l.value,value:l.value,disabled:l.disabled},h),[l.disabled,l.value,h]),{onNativeOptionAdd:f,onNativeOptionRemove:v}=c;return eJ(()=>(f(m),()=>v(m)),[f,v,m]),(0,g.createElement)(g.Fragment,null,(0,g.createElement)(e7.span,(0,eW.Z)({id:l.textId},s,{ref:p})),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?(0,e4.createPortal)(s.children,a.valueNode):null)}),np=(0,g.forwardRef)((e,t)=>{let{__scopeSelect:r,...i}=e,n=nl("SelectItemIndicator",r);return n.isSelected?(0,g.createElement)(e7.span,(0,eW.Z)({"aria-hidden":!0},i,{ref:t})):null}),nh=((e,t)=>{let{__scopeSelect:r,onAutoScroll:i,...n}=e,s=i6("SelectScrollButton",r),a=(0,g.useRef)(null),o=iH(r),l=(0,g.useCallback)(()=>{null!==a.current&&(window.clearInterval(a.current),a.current=null)},[]);return(0,g.useEffect)(()=>()=>l(),[l]),eJ(()=>{var e;let t=o().find(e=>e.ref.current===document.activeElement);null==t||null===(e=t.ref.current)||void 0===e||e.scrollIntoView({block:"nearest"})},[o]),(0,g.createElement)(e7.div,(0,eW.Z)({"aria-hidden":!0},n,{ref:t,style:{flexShrink:0,...n.style},onPointerDown:eK(n.onPointerDown,()=>{null===a.current&&(a.current=window.setInterval(i,50))}),onPointerMove:eK(n.onPointerMove,()=>{var e;null===(e=s.onItemLeave)||void 0===e||e.call(s),null===a.current&&(a.current=window.setInterval(i,50))}),onPointerLeave:eK(n.onPointerLeave,()=>{l()})}))},(0,g.forwardRef)((e,t)=>{let{value:r,...i}=e,n=(0,g.useRef)(null),s=eQ(t,n),a=function(e){let t=(0,g.useRef)({value:e,previous:e});return(0,g.useMemo)(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(r);return(0,g.useEffect)(()=>{let e=n.current,t=window.HTMLSelectElement.prototype,i=Object.getOwnPropertyDescriptor(t,"value"),s=i.set;if(a!==r&&s){let o=new Event("change",{bubbles:!0});s.call(e,r),e.dispatchEvent(o)}},[a,r]),(0,g.createElement)(iN,{asChild:!0},(0,g.createElement)("select",(0,eW.Z)({},i,{ref:s,defaultValue:r})))}));function nm(e){let t=e2(e),r=(0,g.useRef)(""),i=(0,g.useRef)(0),n=(0,g.useCallback)(e=>{let n=r.current+e;t(n),function e(t){r.current=t,window.clearTimeout(i.current),""!==t&&(i.current=window.setTimeout(()=>e(""),1e3))}(n)},[t]),s=(0,g.useCallback)(()=>{r.current="",window.clearTimeout(i.current)},[]);return(0,g.useEffect)(()=>()=>window.clearTimeout(i.current),[]),[r,n,s]}function nf(e,t,r){var i;let n=t.length>1&&Array.from(t).every(e=>e===t[0]),s=n?t[0]:t,a=r?e.indexOf(r):-1,o=(i=Math.max(a,0),e.map((t,r)=>e[(i+r)%e.length])),l=1===s.length;l&&(o=o.filter(e=>e!==r));let c=o.find(e=>e.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}nh.displayName="BubbleSelect";var ng=r(5901),nv=r(49657),ny=r(93041),nb="data-hls-initialized",nw=0,n_=function(e,t,r,i){if("true"===t.getAttribute(nb))return{destroy:function(){}};t.setAttribute(nb,"true");var n,s,a=new ny.Z((0,ex.b)({maxBufferLength:15,maxMaxBufferLength:60,liveMaxLatencyDurationCount:7,liveSyncDurationCount:3},i));return t&&a.attachMedia(t),a.on(ny.Z.Events.LEVEL_LOADED,(n=(0,ex._)((0,ex.a)().mark(function e(t,i){var n,s,a,o,l;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=(a=i.details).live,l=a.totalduration,null==r||null===(n=r.onLive)||void 0===n||n.call(r,Boolean(o)),null==r||null===(s=r.onDuration)||void 0===s||s.call(r,null!=l?l:0);case 3:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)})),a.on(ny.Z.Events.MEDIA_ATTACHED,(0,ex._)((0,ex.a)().mark(function t(){return(0,ex.a)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.loadSource(e),a.on(ny.Z.Events.MANIFEST_PARSED,function(e,t){var i;null==r||null===(i=r.onCanPlay)||void 0===i||i.call(r)});case 2:case"end":return t.stop()}},t)}))),a.on(ny.Z.Events.ERROR,(s=(0,ex._)((0,ex.a)().mark(function e(t,i){var n,s,o,l,c,d,u;return(0,ex.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i.type,o=i.details,l=i.fatal,c=s===ny.Z.ErrorTypes.NETWORK_ERROR&&l,d=s===ny.Z.ErrorTypes.MEDIA_ERROR&&l,u=ny.Z.ErrorTypes.NETWORK_ERROR&&"manifestParsingError"===o,!(!l&&!u)){e.next=6;break}return e.abrupt("return");case 6:if(null==r||null===(n=r.onError)||void 0===n||n.call(r,i),!(c||d||u)){e.next=11;break}return e.next=10,new Promise(function(e){return setTimeout(e,1e3*++nw)});case 10:null==a||a.recoverMediaError();case 11:case"end":return e.stop()}},e)})),function(e,t){return s.apply(this,arguments)})),{destroy:function(){var e,r;null==a||null===(e=a.destroy)||void 0===e||e.call(a),null==t||null===(r=t.removeAttribute)||void 0===r||r.call(t,nb)}}};function nS(){nS=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(c){l=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var s,a,o=Object.create((t&&t.prototype instanceof h?t:h).prototype);return i(o,"_invoke",{value:(s=new C(n||[]),a="suspendedStart",function(t,i){if("executing"===a)throw Error("Generator is already running");if("completed"===a){if("throw"===t)throw i;return k()}for(s.method=t,s.arg=i;;){var n=s.delegate;if(n){var o=function e(t,r){var i=r.method,n=t.iterator[i];if(void 0===n)return r.delegate=null,"throw"===i&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+i+"' method")),p;var s=u(n,t.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,p;var a=s.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):a:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,p)}(n,s);if(o){if(o===p)continue;return o}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";var l=u(e,r,s);if("normal"===l.type){if(a=s.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:s.done}}"throw"===l.type&&(a="completed",s.method="throw",s.arg=l.arg)}})}),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(i){return{type:"throw",arg:i}}}e.wrap=d;var p={};function h(){}function m(){}function f(){}var g={};l(g,s,function(){return this});var v=Object.getPrototypeOf,y=v&&v(v(T([])));y&&y!==t&&r.call(y,s)&&(g=y);var b=f.prototype=h.prototype=Object.create(g);function w(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function _(e,t){var n;i(this,"_invoke",{value:function(i,s){function a(){return new t(function(n,a){!function i(n,s,a,o){var l=u(e[n],e,s);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,a,o)},function(e){i("throw",e,a,o)}):t.resolve(d).then(function(e){c.value=e,a(c)},function(e){return i("throw",e,a,o)})}o(l.arg)}(i,s,n,a)})}return n=n?n.then(a,a):a()}})}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function T(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return m.prototype=f,i(b,"constructor",{value:f,configurable:!0}),i(f,"constructor",{value:m,configurable:!0}),m.displayName=l(f,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,o,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},w(_.prototype),l(_.prototype,a,function(){return this}),e.AsyncIterator=_,e.async=function(t,r,i,n,s){void 0===s&&(s=Promise);var a=new _(d(t,r,i,n),s);return e.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},w(b),l(b,o,"Generator"),l(b,s,function(){return this}),l(b,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return a.type="throw",a.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(o&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;x(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},e}function nx(e,t,r,i,n,s,a){try{var o=e[s](a),l=o.value}catch(c){r(c);return}o.done?t(l):Promise.resolve(l).then(i,n)}function nC(e){return function(){var t=this,r=arguments;return new Promise(function(i,n){var s=e.apply(t,r);function a(e){nx(s,i,n,a,o,"next",e)}function o(e){nx(s,i,n,a,o,"throw",e)}a(void 0)})}}function nT(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function nk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=s.call(r)).done)&&(o.push(i.value),o.length!==t);l=!0);}catch(d){c=!0,n=d}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return nT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nT(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var nR=function(e){return{_element:e._element,setLive:e.setLive,fullscreen:e.fullscreen,togglePlay:e.togglePlay,_updateMediaStream:e._updateMediaStream,deviceIds:e.deviceIds}},nE=g.forwardRef(function(e,t){var r,i=e.ingestUrl,n=e.title,s=e.aspectRatio,a=e.objectFit,o=e.webrtcConfig,l=e.onBroadcastError,c=e.onPlaybackStatusUpdate,d=e.playbackStatusSelector,u=g.useContext(eZ.b),p=g.useCallback(function(e){var t;return null!==(t=null==d?void 0:d(e))&&void 0!==t?t:e},[d]);g.useEffect(function(){return u.subscribe(p,function(e,t){return null==c?void 0:c((0,ea.s)(e),(0,ea.s)(t))})},[c,p,u]);var h=(0,eZ.u)(nR),m=h._element,f=h.setLive,v=h.fullscreen,y=h.togglePlay,b=h._updateMediaStream,w=nk(g.useState(null),2),_=w[0],S=w[1],x=g.useCallback((r=nC(nS().mark(function e(t){var r,i,n,s,a,o,c,d;return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b(t.stream,{audio:null==t?void 0:null===(r=t.audioTransceiver)||void 0===r?void 0:null===(i=r.sender)||void 0===i?void 0:null===(n=i.track)||void 0===n?void 0:null===(s=n.getSettings())||void 0===s?void 0:s.deviceId,video:null==t?void 0:null===(a=t.videoTransceiver)||void 0===a?void 0:null===(o=a.sender)||void 0===o?void 0:null===(c=o.track)||void 0===c?void 0:null===(d=c.getSettings())||void 0===d?void 0:d.deviceId}),S({audio:t.audioTransceiver,video:t.videoTransceiver}),null==l||l(null),null==y||y(!0),f(!0);case 5:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),[f,l,y,b]),C=g.useCallback(function(e){var t,r,i,n=Error(null!==(t=null==e?void 0:null===(r=e.message)||void 0===r?void 0:null===(i=r.toString)||void 0===i?void 0:i.call(r))&&void 0!==t?t:"Error with WebRTC");null==l||l(n)},[l]);return g.useEffect(function(){if(m&&i){var e=eB(i,m,null!=s?s:"16to9",{onConnected:x,onError:C},o).destroy;return function(){null==e||e()}}},[o,s,m,x,i,l,C]),g.useEffect(function(){return u.subscribe(function(e,t){var r,i;(null===(r=e._mediaStream)||void 0===r?void 0:r.id)!==(null===(i=t._mediaStream)||void 0===i?void 0:i.id)&&e._element&&_&&e._mediaStream&&eU({newMediaStream:e._mediaStream,prevMediaStream:t._mediaStream,aspectRatio:null!=s?s:"16to9",element:e._element,videoTransceiver:_.video,audioTransceiver:_.audio,onConnected:x}).catch(function(e){return C(e)})})},[u,_,s,x,C]),(0,eo.jsx)("video",{className:eS.Il.media.video({size:v?"fullscreen":a}),"aria-label":null!=n?n:"Video player",role:"video",width:"100%",height:"100%",ref:t,"webkit-playsinline":"true",playsInline:!0,muted:!0})}),nP=function(e){var t=e.value,r=e.onChange,i=e.type,n=e.portalContainer,s=e.mediaDevices,a=(0,g.useMemo)(function(){if(t&&s.every(function(e){return t!==e.deviceId})){var e,r=t.split(":",2),i=r.length>1?"".concat(null===(e=r[0])||void 0===e?void 0:e.slice(0,10),"...").concat(t.slice(-4)):t.slice(0,8);return null!=i?i:"screen"}return null},[s,t]);return(0,eo.jsxs)("div",{className:eS.Il.settings.select.group(),children:[(0,eo.jsx)("label",{className:eS.Il.settings.select.label(),htmlFor:"audio"===i?"audio-source":"video-source",children:"audio"===i?"Audio Source":"Video Source"}),(0,eo.jsxs)(iY,{disabled:0===s.length,value:t,onValueChange:r,name:"audio"===i?"audio-source":"video-source",children:[(0,eo.jsxs)(iJ,{className:eS.Il.settings.select.trigger(),"aria-label":"audio"===i?"Audio Source":"Video Source",children:[(0,eo.jsx)(iX,{placeholder:"audio"===i?"Select your audio source...":"Select your video source..."}),(0,eo.jsx)(i0,{className:eS.Il.settings.select.icon(),children:(0,eo.jsx)(nD,{})})]}),(0,eo.jsx)(i1,{container:n,children:(0,eo.jsx)(i5,{className:eS.Il.settings.select.content(),children:(0,eo.jsx)(nr,{className:eS.Il.settings.select.viewport(),children:(0,eo.jsxs)(ns,{children:[s.map(function(e,t){var r;return(0,eo.jsxs)(nc,{value:e.deviceId,className:eS.Il.settings.select.item(),children:[(0,eo.jsx)(nu,{children:null!==(r=e.label)&&void 0!==r?r:"".concat("audio"===i?"Audio Source":"Video Source"," ").concat(t+1," (").concat("default"===e.deviceId?"default":e.deviceId.slice(0,6),")")}),(0,eo.jsx)(np,{className:eS.Il.settings.select.itemIndicator(),children:(0,eo.jsx)(nL,{})})]},e.deviceId)}),t&&a&&(0,eo.jsxs)(nc,{value:t,className:eS.Il.settings.select.item(),children:[(0,eo.jsx)(nu,{children:"Screen Source (".concat(a,")")}),(0,eo.jsx)(np,{className:eS.Il.settings.select.itemIndicator(),children:(0,eo.jsx)(nL,{})})]},t)]})})})})]})]})},nD=function(){return(0,eo.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 -960 960 960",width:"20",children:(0,eo.jsx)("path",{fill:"currentColor",d:"M480-345 240-585l43-43 197 198 197-197 43 43-240 239Z"})})},nL=function(){return(0,eo.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"16",viewBox:"0 -960 960 960",width:"16",children:(0,eo.jsx)("path",{d:"M378-246 154-470l43-43 181 181 384-384 43 43-427 427Z"})})},nI=function(e){return{deviceIds:e.deviceIds,_updateMediaStream:e._updateMediaStream}},nM=function(e){var t,r=e.portalContainer,i=e.streamConstraints,n=(0,eZ.u)(nI),s=n.deviceIds,a=n._updateMediaStream,o=nk(g.useState(null),2),l=o[0],c=o[1];g.useEffect(function(){return ez(function(e){c(e.filter(function(e){return"audioinput"===e.kind}))})},[]);var d=g.useCallback((t=nC(nS().mark(function e(t){var r,n,o;return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,eH({source:{streamConstraints:i,videoDeviceId:null!==(r=null==s?void 0:s.video)&&void 0!==r?r:void 0,audioDeviceId:null!==(n=null!=t?t:null==s?void 0:s.audio)&&void 0!==n?n:void 0}});case 2:(o=e.sent)&&a(o);case 4:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),[a,s,i]);return(0,eo.jsx)(nP,{type:"audio",onChange:d,value:null==s?void 0:s.audio,mediaDevices:null!=l?l:[],portalContainer:r})},nj=function(){return(0,eo.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",children:[(0,eo.jsx)("path",{d:"M 9.25,9 7.98,10.27 24.71,27 l 1.27,-1.27 Z",fill:"currentColor"}),(0,eo.jsx)("path",{fill:"currentColor",d:"M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 ZM19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z"})]})},nO=function(){return(0,eo.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",children:(0,eo.jsx)("path",{fill:"currentColor",d:"M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 ZM19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z"})})},nA=function(e){return{isVolumeChangeSupported:e.isVolumeChangeSupported,requestToggleMute:e.requestToggleMute,requestVolume:e.requestVolume,muted:e.muted,volume:e.volume}},nN=function(e){var t=(0,eZ.u)(nA),r=t.volume,i=t.requestToggleMute,n=t.muted,s=t.requestVolume,a=t.isVolumeChangeSupported,o=eg((0,f._)({volume:r,requestToggleMute:i,muted:n,requestVolume:s,isVolumeChangeSupported:a,defaultMutedIcon:(0,eo.jsx)(nj,{}),defaultUnmutedIcon:(0,eo.jsx)(nO,{})},e)),l=o.buttonProps,c=o.title;return(0,eo.jsx)("div",{className:eS.Il.volume.container(),children:(0,eo.jsx)("button",(0,f._)({style:{width:e.size,height:e.size},className:eS.Il.iconButton(),title:c,"aria-label":c,onClick:l.onPress},(0,K.o)(l,"onPress","size")))})},nF=function(e){return{deviceIds:e.deviceIds,_updateMediaStream:e._updateMediaStream}},nq=function(e){var t,r=e.portalContainer,i=e.streamConstraints,n=(0,eZ.u)(nF),s=n.deviceIds,a=n._updateMediaStream,o=nk(g.useState(null),2),l=o[0],c=o[1];g.useEffect(function(){return ez(function(e){c(e.filter(function(e){return"videoinput"===e.kind}))})},[]);var d=g.useCallback((t=nC(nS().mark(function e(t){var r,n,o;return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,eH({source:{streamConstraints:i,videoDeviceId:null!==(r=null!=t?t:null==s?void 0:s.video)&&void 0!==r?r:void 0,audioDeviceId:null!==(n=null==s?void 0:s.audio)&&void 0!==n?n:void 0}});case 2:(o=e.sent)&&a(o);case 4:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),[a,s,i]);return(0,eo.jsx)(nP,{type:"video",onChange:d,value:null==s?void 0:s.video,mediaDevices:null!=l?l:[],portalContainer:r})},nB=function(){return(0,eo.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",children:(0,eo.jsx)("path",{d:"m 23.94,18.78 c .03,-0.25 .05,-0.51 .05,-0.78 0,-0.27 -0.02,-0.52 -0.05,-0.78 l 1.68,-1.32 c .15,-0.12 .19,-0.33 .09,-0.51 l -1.6,-2.76 c -0.09,-0.17 -0.31,-0.24 -0.48,-0.17 l -1.99,.8 c -0.41,-0.32 -0.86,-0.58 -1.35,-0.78 l -0.30,-2.12 c -0.02,-0.19 -0.19,-0.33 -0.39,-0.33 l -3.2,0 c -0.2,0 -0.36,.14 -0.39,.33 l -0.30,2.12 c -0.48,.2 -0.93,.47 -1.35,.78 l -1.99,-0.8 c -0.18,-0.07 -0.39,0 -0.48,.17 l -1.6,2.76 c -0.10,.17 -0.05,.39 .09,.51 l 1.68,1.32 c -0.03,.25 -0.05,.52 -0.05,.78 0,.26 .02,.52 .05,.78 l -1.68,1.32 c -0.15,.12 -0.19,.33 -0.09,.51 l 1.6,2.76 c .09,.17 .31,.24 .48,.17 l 1.99,-0.8 c .41,.32 .86,.58 1.35,.78 l .30,2.12 c .02,.19 .19,.33 .39,.33 l 3.2,0 c .2,0 .36,-0.14 .39,-0.33 l .30,-2.12 c .48,-0.2 .93,-0.47 1.35,-0.78 l 1.99,.8 c .18,.07 .39,0 .48,-0.17 l 1.6,-2.76 c .09,-0.17 .05,-0.39 -0.09,-0.51 l -1.68,-1.32 0,0 z m -5.94,2.01 c -1.54,0 -2.8,-1.25 -2.8,-2.8 0,-1.54 1.25,-2.8 2.8,-2.8 1.54,0 2.8,1.25 2.8,2.8 0,1.54 -1.25,2.8 -2.8,2.8 l 0,0 z",fill:"currentColor"})})},nU=function(e){return{_element:e._element}},nH=function(e){var t,r,i,n,s=(0,eZ.u)(nU)._element;return(0,eo.jsx)("div",{className:eS.Il.volume.container(),children:(0,eo.jsxs)(rt,{children:[(0,eo.jsx)(rr,{asChild:!0,children:(0,eo.jsx)("button",(0,f._)((0,f._)({style:{width:e.size,height:e.size},className:eS.Il.iconButton(),title:"Broadcast settings","aria-label":"Broadcast settings"},(0,K.o)(e,"icon","size","streamConstraints")),{},{children:null!==(t=null==e?void 0:e.icon)&&void 0!==t?t:(0,eo.jsx)(nB,{})}))}),(0,eo.jsxs)(ra,{container:null!==(r=null==s?void 0:s.parentElement)&&void 0!==r?r:s,children:[(0,eo.jsx)(rl,{className:eS.Il.settings.overlay()}),(0,eo.jsxs)(ru,{className:eS.Il.settings.content(),children:[(0,eo.jsx)(rg,{className:eS.Il.settings.title(),children:"Settings"}),(0,eo.jsx)(nq,{streamConstraints:e.streamConstraints,portalContainer:null!==(i=null==s?void 0:s.parentElement)&&void 0!==i?i:s}),(0,eo.jsx)(nM,{streamConstraints:e.streamConstraints,portalContainer:null!==(n=null==s?void 0:s.parentElement)&&void 0!==n?n:s}),(0,eo.jsx)(rv,{asChild:!0,children:(0,eo.jsx)("button",{className:eS.Il.settings.close(),"aria-label":"Close",children:(0,eo.jsx)(nz,{})})})]})]})]})})},nz=function(){return(0,eo.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 -960 960 960",width:"48",children:(0,eo.jsx)("path",{d:"m249-207-42-42 231-231-231-231 42-42 231 231 231-231 42 42-231 231 231 231-42 42-231-231-231 231Z"})})},nV=function(){return(0,eo.jsx)("svg",{width:"100%",height:"100%",viewBox:"-340 -1265 1600 1600",children:(0,eo.jsx)("path",{fill:"currentColor",d:"M451-328h59v-194l79 81 43-43-153-152-152 152 43 43 81-81v194ZM140-160q-24 0-42-18t-18-42v-520q0-24 18-42t42-18h680q24 0 42 18t18 42v520q0 24-18 42t-42 18H140Zm0-60h680v-520H140v520Zm0 0v-520 520Z"})})},n$=function(e){return{_updateMediaStream:e._updateMediaStream}},nZ=function(e){var t,r=(0,eZ.u)(n$)._updateMediaStream,i=(0,g.useCallback)(nC(nS().mark(function t(){var i;return nS().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,eV(null==e?void 0:e.options);case 2:(i=t.sent)&&r(i);case 4:case"end":return t.stop()}},t)})),[r,null==e?void 0:e.options]);return(0,eo.jsx)("button",(0,f._)((0,f._)({style:{width:e.size,height:e.size},className:eS.Il.iconButton(),title:"Screen share","aria-label":"Screen share"},(0,K.o)(e,"icon","options","size")),{},{onClick:i,children:null!==(t=null==e?void 0:e.icon)&&void 0!==t?t:(0,eo.jsx)(nV,{})}))};function nW(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var nK=["onIcon","offIcon","onPress"],nG=function(){return(0,eo.jsx)("svg",{width:"100%",height:"100%",viewBox:"-340 -1265 1600 1600",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,eo.jsx)("path",{fill:"currentColor",d:"M140-160q-24 0-42-18t-18-42v-520q0-24 18-42t42-18h520q24 0 42 18t18 42v215l160-160v410L720-435v215q0 24-18 42t-42 18H140Zm0-60h520v-520H140v520Zm0 0v-520 520Z"})})},nQ=function(){return(0,eo.jsx)("svg",{width:"100%",height:"100%",viewBox:"-340 -1265 1600 1600",fill:"none",children:(0,eo.jsx)("path",{fill:"currentColor",d:"M880-275 720-435v111l-60-60v-356H304l-60-60h416q24 0 42 18t18 42v215l160-160v410ZM848-27 39-836l42-42L890-69l-42 42ZM484-560Zm-87 82ZM159-800l60 60h-79v520h520v-79l60 60v19q0 24-18 42t-42 18H140q-24 0-42-18t-18-42v-520q0-24 18-42t42-18h19Z"})})},nY=function(e){return{toggleVideo:e.toggleVideo,video:e.video}},nJ=function(e){var t,r=(0,eZ.u)(nY),i=r.toggleVideo,n=r.video,s=e.onIcon,a=e.offIcon,o=e.onPress,l=nW(e,nK),c=(t=nC(nS().mark(function e(){return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==o?void 0:o();case 2:return e.next=4,i();case 4:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),d=ei(Boolean(n),s,(0,eo.jsx)(nG,{}),a,(0,eo.jsx)(nQ,{})),u=(0,g.useMemo)(function(){return n?"Turn video off (v)":"Turn video on (v)"},[n]);return(0,eo.jsx)("button",(0,f._)((0,f._)({style:{width:e.size,height:e.size},className:eS.Il.iconButton(),title:u,"aria-label":u,onClick:c},(0,K.o)(l,"size")),{},{children:d}))},nX=function(e){return{device:e.device}},n0=function(e){var t,r=(0,eZ.u)(nX).device,i=g.useRef(null),n=nk(g.useState({width:0,left:0}),2),s=n[0],a=n[1];g.useEffect(function(){if("undefined"!=typeof window){var e=function(){var e,t,r,n=null===(e=i.current)||void 0===e?void 0:e.getBoundingClientRect();a({width:null!==(t=null==n?void 0:n.width)&&void 0!==t?t:0,left:null!==(r=null==n?void 0:n.left)&&void 0!==r?r:0})};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}},[]);var o=nk(g.useState(!1),2),l=o[0],c=o[1],d=nk(g.useState(0),2),u=d[0],p=d[1],h=ec((0,f._)({isActive:l||(null==r?void 0:r.isMobile),sliderWidth:s.width,defaultThumbIcon:(0,eo.jsx)(n1,{})},e)),m=h.title,v=h.value,y=h.active,b=h.handle,w=h.sliderProps,_=h.sliderLeftTrackProps,S=h.sliderMiddleTrackProps,x=h.sliderRightTrackProps,C=nk(g.useState(!1),2),T=C[0],k=C[1];g.useEffect(function(){if(T){var t,r,i,n,a,o,l,c,d=(n=nC(nS().mark(function e(t){var r;return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Date.now()-u>50,e.next=3,w.onUpdate(t.clientX-s.left,r);case 3:r&&p(Date.now());case 4:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),h=(t=nC(nS().mark(function e(t){var r,i,n,a,o;return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Date.now()-u>50,!(o=null===(r=t.touches)||void 0===r?void 0:null===(i=r.item)||void 0===i?void 0:null===(n=i.call(r,0))||void 0===n?void 0:n.clientX)){e.next=6;break}return e.next=5,w.onUpdate(o-s.left,a);case 5:a&&p(Date.now());case 6:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),m=(r=nC(nS().mark(function t(r){var i;return nS().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return k(!1),t.next=3,w.onUpdate(r.clientX-s.left,!0);case 3:return t.next=5,null==e?void 0:null===(i=e.onDone)||void 0===i?void 0:i.call(e);case 5:case"end":return t.stop()}},t)})),function(e){return r.apply(this,arguments)}),f=(i=nC(nS().mark(function t(r){var i,n,a,o,l,c,d,u,p;return nS().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(k(!1),!(p=null!==(i=null===(n=r.touches)||void 0===n?void 0:null===(a=n.item)||void 0===a?void 0:null===(o=a.call(n,0))||void 0===o?void 0:o.clientX)&&void 0!==i?i:null===(l=r.changedTouches)||void 0===l?void 0:null===(c=l.item)||void 0===c?void 0:null===(d=c.call(l,0))||void 0===d?void 0:d.clientX)){t.next=5;break}return t.next=5,w.onUpdate(p-s.left,!0);case 5:return t.next=7,null==e?void 0:null===(u=e.onDone)||void 0===u?void 0:u.call(e);case 7:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)});return null===(a=document)||void 0===a||a.addEventListener("mousemove",d),null===(o=document)||void 0===o||o.addEventListener("mouseup",m),null===(l=document)||void 0===l||l.addEventListener("touchmove",h),null===(c=document)||void 0===c||c.addEventListener("touchend",f),function(){var e,t,r,i;null===(e=document)||void 0===e||e.removeEventListener("mousemove",d),null===(t=document)||void 0===t||t.removeEventListener("mouseup",m),null===(r=document)||void 0===r||r.removeEventListener("touchmove",h),null===(i=document)||void 0===i||i.removeEventListener("touchend",f)}}},[T,w,e,s,u]);var R=g.useCallback((t=nC(nS().mark(function e(t){return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.onUpdate(t.clientX-s.left);case 2:k(!0);case 3:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),[w,s]),E=g.useCallback(nC(nS().mark(function e(){return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c(!0);case 1:case"end":return e.stop()}},e)})),[c]),P=g.useCallback(nC(nS().mark(function e(){return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c(!1);case 1:case"end":return e.stop()}},e)})),[c]);return(0,eo.jsxs)("div",{ref:i,onPointerDown:R,onMouseEnter:E,onMouseLeave:P,role:"slider","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":v,"aria-valuetext":m,"aria-orientation":"horizontal",className:eS.Il.slider.container(),children:[_.shown&&(0,eo.jsx)("div",{className:eS.Il.slider.track.left({size:y?"active":"default",rounded:_.rounded,css:_.css})}),b,S.shown&&(0,eo.jsx)("div",{className:eS.Il.slider.track.middle({size:y?"active":"default",rounded:S.rounded,css:S.css})}),x.shown&&(0,eo.jsx)("div",{className:eS.Il.slider.track.right({size:y?"active":"default",rounded:x.rounded,css:x.css})})]})},n1=function(e){var t=e.size,r=e.css;return(0,eo.jsx)("div",{className:eS.Il.slider.thumb({css:r,size:t})})},n2=function(e){return{fullscreen:e.fullscreen}},n5=function(e){var t=e.children,r=e.aspectRatio,i=e.theme,n=e.tabIndex,s=(0,eZ.a)(i),a=(0,eZ.u)(n2).fullscreen;return(0,eo.jsx)("div",{style:{display:"contents"},className:"".concat(s?"".concat(s," "):"","livepeer-contents-container"),children:(0,eo.jsx)("div",{className:"".concat(eS.Il.container({aspectRatio:r,size:a?"fullscreen":"default"})," livepeer-aspect-ratio-container"),tabIndex:null!=n?n:0,children:t})})},n4=function(){return(0,eo.jsxs)("svg",{viewBox:"0 0 324 140",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M82 8.30584L239.745 5.68359L242.335 118.151L83.9414 118.502L82 8.30584Z",fill:"#97F2EF"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M66 124.072L254.898 124L258 129L68.3248 128.971L66 124.072Z",fill:"#97F2EF"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M94.2062 111.151L92.5204 15.5292L229.556 14.1187L231.803 111.716L94.2062 111.151Z",fill:"#4CC38A"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M185 58.1481C185 70.8507 174.703 82 162 82C153.04 82 145.277 77.3008 141.48 70.0741C141.421 69.9609 141.362 69.8472 141.305 69.7328C140.965 69.0558 140.782 66.2859 140.704 64.963C140.278 66.2407 140.43 67.3765 140.507 67.9444C139.533 65.4642 139 62.7423 139 59.8519C139 47.1493 149.297 36 162 36C166.913 36 171.467 37.4132 175.204 39.8814C175.63 41.0012 176.226 43.6667 175.204 45.3704C176 44.8025 177.651 43.3259 177.888 41.963C182.27 45.9317 185 51.6082 185 58.1481Z",fill:"#141716"}),(0,eo.jsx)("path",{d:"M140.704 64.963C140.278 66.2407 140.43 67.3765 140.507 67.9444C140.746 68.5556 141.013 69.1521 141.305 69.7328C140.965 69.0558 140.782 66.2859 140.704 64.963Z",fill:"#141716"}),(0,eo.jsx)("path",{d:"M171 60.5003L156 70V60.6462V51L166.104 57.3994L171 60.5003Z",stroke:"#4CC38A",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,eo.jsx)("path",{d:"M101.096 100.921L176.5 101.109M219.885 101.163L198.193 101.136",stroke:"#141716",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M148.197 101.161C148.197 103.28 146.472 104.998 144.344 104.998C142.215 104.998 140.49 103.28 140.49 101.161C140.49 99.042 142.215 97.3242 144.344 97.3242C146.472 97.3242 148.197 99.042 148.197 101.161Z",fill:"#DF0087"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M148.197 101.161C148.197 103.28 146.472 104.998 144.344 104.998C142.215 104.998 140.49 103.28 140.49 101.161C140.49 99.042 142.215 97.3242 144.344 97.3242C146.472 97.3242 148.197 99.042 148.197 101.161Z",stroke:"#141716",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,eo.jsx)("path",{d:"M93.7252 111.754L91.7752 14.7408L230.275 13.7374L232.225 112.245L93.7252 111.754Z",stroke:"#141716",strokeWidth:"2.5"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M49.0868 58.0273L49.9632 88.7907L19.4093 88.9852L19.0201 58.6113L49.0868 58.0273ZM51 89.7922L50.0663 57L18 57.6228L18.4147 90L51 89.7922Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M296.114 25.1881L297.132 60.7679L261.637 60.9929L261.185 25.8636L296.114 25.1881ZM298.336 61.9263L297.252 24L260 24.7203L260.482 62.1666L298.336 61.9263Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M293.138 78.0001L293 67.2077L303.689 67.0001L304 77.9308L293.138 78.0001ZM304.309 78.2288L292.842 78.3019L292.696 66.9135L303.98 66.6943L304.309 78.2288ZM303.071 67.6482L293.644 67.8313L293.766 77.3599L303.346 77.2989L303.071 67.6482ZM303.362 67.3425L293.34 67.5372L293.47 77.6618L303.654 77.5969L303.362 67.3425Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M303.362 67.3424L303.654 77.5969L293.47 77.6617L293.34 67.5371L303.362 67.3424ZM304 77.9307L303.689 67L293 67.2076L293.138 78L304 77.9307Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M289.594 66.2179L289.78 72.7435L283.299 72.7847L283.216 66.3418L289.594 66.2179ZM290 72.9559L289.802 66L283 66.1321L283.088 73L290 72.9559Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M290.309 73.254L282.792 73.3019L282.696 65.838L290.093 65.6943L290.309 73.254ZM289.594 66.218L289.78 72.7435L283.299 72.7848L283.216 66.3419L289.594 66.218ZM289.471 72.4455L283.595 72.4829L283.52 66.636L289.303 66.5237L289.471 72.4455ZM283.088 73.0001L283 66.1322L289.802 66.0001L290 72.956L283.088 73.0001Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M47.442 36.3017L47.3038 47.0941L57.9925 47.3017L58.3038 36.371L47.442 36.3017ZM58.6124 36.0729L47.1459 35.9998L47 47.3883L58.284 47.6074L58.6124 36.0729ZM57.3747 46.6536L47.9476 46.4704L48.0697 36.9419L57.6496 37.0029L57.3747 46.6536ZM57.6661 46.9593L47.6438 46.7646L47.7736 36.64L57.9582 36.7048L57.6661 46.9593Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M57.6661 46.9593L57.9582 36.7049L47.7736 36.64L47.6439 46.7646L57.6661 46.9593ZM58.3038 36.371L57.9926 47.3018L47.3038 47.0942L47.4421 36.3018L58.3038 36.371Z",fill:"#434545"})]})},n6=function(){return(0,eo.jsxs)("svg",{viewBox:"0 0 324 142",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,eo.jsx)("circle",{cx:"162",cy:"76",r:"23",stroke:"#141716",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),(0,eo.jsx)("path",{d:"M242 88.5C242 88.5 206.183 131 162 131C117.817 131 82 88.5 82 88.5C82 88.5 117.817 46 162 46C206.183 46 242 88.5 242 88.5Z",fill:"#97F2EF"}),(0,eo.jsx)("path",{d:"M249 82C249 82 210.825 128 162.5 128C114.175 128 74.5 82.5 74.5 82.5C74.5 82.5 114.175 32 162.5 32C219 34 249 82 249 82Z",fill:"#97F2EF"}),(0,eo.jsx)("path",{d:"M249 82.5C249 82.5 210.049 129 162 129C113.951 129 75 82.5 75 82.5C75 82.5 113.951 36 162 36C210.049 36 249 82.5 249 82.5Z",fill:"#4CC38A"}),(0,eo.jsx)("path",{d:"M216.5 60.8302C202.013 51.0702 182.921 42 162 42C116.713 42 80 84.5 80 84.5C80 84.5 116.713 127 162 127C207.287 127 244 84.5 244 84.5C244 84.5 240.941 80.9589 235.5 75.921",stroke:"#141716",strokeWidth:"2.5"}),(0,eo.jsx)("path",{d:"M118 117.5C117 119.5 107.5 122.7 107.5 125.5M127 121.5C123.667 126.167 117 136.7 117 141.5",stroke:"#97F2EF",strokeWidth:"2.5"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M193 86C193 100.912 180.912 114 166 114C155.482 114 146.369 108.484 141.912 100C141.842 99.8672 141.773 99.7336 141.706 99.5994C141.306 98.8046 141.091 95.553 141 94C140.5 95.5 140.679 96.8333 140.769 97.5C139.626 94.5884 139 91.3932 139 88C139 73.0883 151.088 60 166 60C171.768 60 177.113 61.6589 181.5 64.5564C182 65.8709 182.7 69 181.5 71C182.434 70.3333 184.373 68.6 184.652 67C189.796 71.6589 193 78.3227 193 86Z",fill:"#141716"}),(0,eo.jsx)("path",{d:"M141 94C140.5 95.5 140.679 96.8333 140.769 97.5C141.05 98.2174 141.363 98.9177 141.706 99.5994C141.306 98.8046 141.091 95.553 141 94Z",fill:"#141716"}),(0,eo.jsx)("path",{d:"M170.403 79C176.754 79 182.328 84.8203 182.328 92C182.328 99.1797 177.606 105 171.254 105C167.788 105 164.552 103.266 162.328 100.523C161.871 99.9592 161.457 99.3526 161.092 98.7097C159.98 96.7509 159.328 94.4549 159.328 92C159.328 84.8203 164.051 79 170.403 79Z",fill:"#4CC38A"}),(0,eo.jsx)("path",{d:"M70.5 43C77 48.1667 87.3 55 94.5 63M98 8C103 19.6667 113 44.8 113 52M156.5 0.5C156 12.5 158 32.5 158 32.5M223 56C231.667 50.6667 241 43 263 39",stroke:"#97F2EF",strokeWidth:"2.5"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M288.028 49.4047L287.706 29.9756L312.554 29.6019L313.278 49.28L288.028 49.4047ZM313.995 49.8165L287.339 49.9481L287 29.4461L313.232 29.0515L313.995 49.8165ZM311.118 30.7687L289.203 31.0984L289.487 48.2522L311.757 48.1424L311.118 30.7687ZM311.795 30.2184L288.497 30.5688L288.798 48.7957L312.474 48.679L311.795 30.2184Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M311.795 30.2182L312.475 48.6788L288.798 48.7955L288.497 30.5687L311.795 30.2182ZM313.278 49.2798L312.554 29.6017L287.706 29.9755L288.028 49.4045L313.278 49.2798Z",fill:"#434545"}),(0,eo.jsx)("path",{d:"M308.595 29.6018V24.201C308.595 20.224 305.371 17 301.394 17V17C297.417 17 294.193 20.224 294.193 24.201V29.6018",stroke:"#434545",strokeWidth:"2"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M31.9897 127.881L31.6802 109.168L55.6122 108.808L56.309 127.761L31.9897 127.881ZM57 128.278L31.3266 128.405L31 108.658L56.2646 108.278L57 128.278ZM54.2287 109.932L33.1217 110.25L33.3951 126.771L54.8443 126.665L54.2287 109.932ZM54.8812 109.402L32.4415 109.74L32.732 127.295L55.5352 127.182L54.8812 109.402Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M54.8813 109.402L55.5353 127.182L32.7321 127.295L32.4416 109.74L54.8813 109.402ZM56.3091 127.761L55.6122 108.808L31.6803 109.168L31.9898 127.881L56.3091 127.761Z",fill:"#434545"}),(0,eo.jsx)("path",{d:"M51.7984 108.808V103.606C51.7984 99.776 48.6932 96.6709 44.8628 96.6709V96.6709C41.0325 96.6709 37.9273 99.776 37.9273 103.606V108.808",stroke:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.4568 93.4225L16.3139 85.9741L27.3595 85.8309L27.6811 93.3747L16.4568 93.4225ZM28 93.5804L16.1507 93.6308L16 85.7711L27.6606 85.6199L28 93.5804ZM26.7209 86.2782L16.9793 86.4046L17.1054 92.9807L27.005 92.9386L26.7209 86.2782ZM27.0221 86.0672L16.6653 86.2016L16.7994 93.189L27.324 93.1443L27.0221 86.0672Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27.0221 86.0676L27.324 93.1447L16.7994 93.1895L16.6654 86.202L27.0221 86.0676ZM27.6811 93.3751L27.3595 85.8313L16.314 85.9746L16.4568 93.4229L27.6811 93.3751Z",fill:"#434545"}),(0,eo.jsx)("path",{d:"M25.5992 85.831V84.201C25.5992 82.4331 24.1661 81 22.3982 81V81C20.6304 81 19.1972 82.4331 19.1972 84.201V85.831",stroke:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M289.419 69.8179L289.288 62.3096L299.413 62.1844L299.708 69.7762L289.419 69.8179ZM300 69.9559L289.138 70L289 62.1322L299.689 62L300 69.9559ZM299 63H290L290.013 69.4319L299.088 69.3951L299 63ZM299.104 62.3909L289.61 62.5083L289.733 69.6139L299.38 69.5748L299.104 62.3909Z",fill:"#434545"}),(0,eo.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M299.104 62.3909L299.38 69.5748L289.733 69.6139L289.61 62.5083L299.104 62.3909ZM299.708 69.7762L299.413 62.1844L289.288 62.3096L289.419 69.8179L299.708 69.7762Z",fill:"#434545"}),(0,eo.jsx)("path",{d:"M296.752 62.9402V61.2516C296.752 60.0081 295.744 59 294.5 59V59C293.257 59 292.249 60.0081 292.249 61.2516V62.9402",stroke:"#434545"})]})},n3=function(e){var t=e.isBroadcast;return(0,eo.jsxs)("div",{className:eS.Il.controlsContainer.error.background(),children:[(0,eo.jsx)(n4,{}),(0,eo.jsx)("div",{className:eS.Il.controlsContainer.error.title(),children:t?"Stream key invalid":"Stream is offline"}),(0,eo.jsx)("div",{className:eS.Il.controlsContainer.error.text(),children:t?"The provided stream key could not be found. Please check it and try again.":"Playback will start automatically once the stream has started."})]})},n9=function(){return(0,eo.jsxs)("div",{className:eS.Il.controlsContainer.error.background(),children:[(0,eo.jsx)(n6,{}),(0,eo.jsx)("div",{className:eS.Il.controlsContainer.error.title(),children:"Stream is private"}),(0,eo.jsx)("div",{className:eS.Il.controlsContainer.error.text(),children:"It looks like you don't have permission to view this content."})]})},n8=function(e){var t=e.isBroadcast;return(0,eo.jsxs)("div",{className:eS.Il.controlsContainer.error.background(),children:[(0,eo.jsx)(n4,{}),(0,eo.jsx)("div",{className:eS.Il.controlsContainer.error.title(),children:t?"Broadcast failed":"Playback failed"}),(0,eo.jsx)("div",{className:eS.Il.controlsContainer.error.text(),children:t?"There was an error with broadcasting - please try again later.":"There was an error with playback - please wait while we are retrying in the background."})]})},n7=function(e){return{hidden:e.hidden,togglePlay:e.togglePlay,canPlay:e.canPlay,hasPlayed:e.hasPlayed,buffered:e.buffered,ingestUrl:e.ingestUrl,_updateLastInteraction:e._updateLastInteraction}},se=function(e){var t=e.top,r=e.middle,i=e.left,n=e.right,s=e.poster,a=e.showLoadingSpinner,o=e.hidePosterOnPlayed,l=e.loadingText,c=e.error,d=e.children,u=(0,eZ.u)(n7),p=u.hidden,h=u.togglePlay,m=u.canPlay,f=u.hasPlayed,v=u.buffered,y=u.ingestUrl,b=u._updateLastInteraction,w=g.useMemo(function(){return Boolean(y)},[y]),_=ed({togglePlay:h,canPlay:m,buffered:v,isBroadcast:w,_updateLastInteraction:b}),S=_.isLoaded,x=_.containerProps;return(0,eo.jsxs)(eo.Fragment,{children:[s?(0,eo.jsx)("div",{className:eS.Il.controlsContainer.background({display:f&&(void 0===o||o)?"hidden":"shown"}),onMouseUp:x.onPress,children:s}):(0,eo.jsx)("div",{className:eS.Il.controlsContainer.background({display:"hidden"}),onMouseUp:x.onPress}),(void 0===a||a)&&!S&&!(null!=c&&c.type)&&(0,eo.jsxs)("div",{className:eS.Il.controlsContainer.background(),onMouseUp:x.onPress,children:[l&&(0,eo.jsx)("div",{className:eS.Il.controlsContainer.loadingText(),children:l}),(0,eo.jsx)("div",{className:eS.Il.controlsContainer.loading()})]}),(null==c?void 0:c.type)&&(0,eo.jsx)("div",{className:eS.Il.controlsContainer.background(),onMouseUp:x.onPress,children:(null==c?void 0:c.type)==="access-control"?(0,eo.jsx)(n9,{}):(null==c?void 0:c.type)==="offline"?(0,eo.jsx)(n3,{isBroadcast:w}):(0,eo.jsx)(n8,{isBroadcast:w})}),S&&!(null!=c&&c.type)&&(0,eo.jsxs)(eo.Fragment,{children:[(0,eo.jsx)("div",{className:eS.Il.controlsContainer.gradient({display:p?"hidden":"shown"}),onMouseUp:x.onPress}),(0,eo.jsx)("div",{className:eS.Il.controlsContainer.top.container({display:p?"hidden":"shown"}),children:t}),(0,eo.jsxs)("div",{className:eS.Il.controlsContainer.bottom.container({display:p?"hidden":"shown"}),children:[(0,eo.jsx)("div",{className:eS.Il.controlsContainer.bottom.middle.container(),children:r}),(0,eo.jsxs)("div",{className:eS.Il.controlsContainer.bottom.lower.container(),children:[(0,eo.jsx)("div",{className:eS.Il.controlsContainer.bottom.lower.left(),children:i}),(0,eo.jsx)("div",{className:eS.Il.controlsContainer.bottom.lower.right(),children:n})]})]}),d&&(0,eo.jsx)("div",{className:eS.Il.controlsContainer.background({display:p?"hidden":"shown"}),children:d})]})]})},st=function(){return(0,eo.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,eo.jsx)("path",{fill:"currentColor",d:"m 10,16 2,0 0,-4 4,0 0,-2 L 10,10 l 0,6 0,0 z"}),(0,eo.jsx)("path",{fill:"currentColor",d:"m 20,10 0,2 4,0 0,4 2,0 L 26,10 l -6,0 0,0 z"}),(0,eo.jsx)("path",{fill:"currentColor",d:"m 24,24 -4,0 0,2 L 26,26 l 0,-6 -2,0 0,4 0,0 z"}),(0,eo.jsx)("path",{fill:"currentColor",d:"M 12,20 10,20 10,26 l 6,0 0,-2 -4,0 0,-4 0,0 z"})]})},sr=function(){return(0,eo.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",xmlns:"http://www.w3.org/2000/svg",children:[(0,eo.jsx)("path",{fill:"currentColor",d:"m 14,14 -4,0 0,2 6,0 0,-6 -2,0 0,4 0,0 z"}),(0,eo.jsx)("path",{fill:"currentColor",d:"m 22,14 0,-4 -2,0 0,6 6,0 0,-2 -4,0 0,0 z"}),(0,eo.jsx)("path",{fill:"currentColor",d:"m 20,26 2,0 0,-4 4,0 0,-2 -6,0 0,6 0,0 z"}),(0,eo.jsx)("path",{fill:"currentColor",d:"m 10,22 4,0 0,4 2,0 0,-6 -6,0 0,2 0,0 z"})]})},si=function(e){return{fullscreen:e.fullscreen,pictureInPicture:e.pictureInPicture,requestToggleFullscreen:e.requestToggleFullscreen}},sn=function(e){var t=(0,eZ.u)(si),r=t.fullscreen,i=t.pictureInPicture,n=t.requestToggleFullscreen,s=eu((0,f._)({fullscreen:r,pictureInPicture:i,requestToggleFullscreen:n,defaultEnterIcon:(0,eo.jsx)(st,{}),defaultExitIcon:(0,eo.jsx)(sr,{})},e)),a=s.title,o=s.buttonProps;return o?(0,eo.jsx)("button",(0,f._)({style:{width:e.size,height:e.size},className:eS.Il.iconButton(),title:a,"aria-label":a,onClick:o.onPress},(0,K.o)(o,"onPress","size"))):(0,eo.jsx)(eo.Fragment,{})},ss=["icon","onPress"],sa=function(){return(0,eo.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",xmlns:"http://www.w3.org/2000/svg",children:(0,eo.jsx)("path",{fill:"currentColor",d:"M25,17 L17,17 L17,23 L25,23 L25,17 L25,17 Z M29,25 L29,10.98 C29,9.88 28.1,9 27,9 L9,9 C7.9,9 7,9.88 7,10.98 L7,25 C7,26.1 7.9,27 9,27 L27,27 C28.1,27 29,26.1 29,25 L29,25 Z M27,25.02 L9,25.02 L9,10.97 L27,10.97 L27,25.02 L27,25.02 Z"})})},so=function(e){return{requestTogglePictureInPicture:e.requestTogglePictureInPicture,pictureInPicture:e.pictureInPicture,_element:e._element,fullscreen:e.fullscreen}},sl=function(e){var t=(0,eZ.u)(so),r=t.requestTogglePictureInPicture,i=t._element,n=t.pictureInPicture,s=t.fullscreen,a=e.icon,o=e.onPress,l=nW(e,ss),c=g.useCallback(nC(nS().mark(function e(){return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==o?void 0:o();case 2:return e.next=4,r();case 4:case"end":return e.stop()}},e)})),[o,r]),d=g.useMemo(function(){return(0,nv.vs)(i)},[i]),u=g.useMemo(function(){return n?"Exit mini player (i)":"Mini player (i)"},[n]);if(!d||s)return(0,eo.jsx)(eo.Fragment,{});var p=a||(0,eo.jsx)(sa,{});return(0,eo.jsx)("button",(0,f._)((0,f._)({style:{width:e.size,height:e.size},className:eS.Il.iconButton(),title:u,"aria-label":u,onClick:c},l),{},{children:p}))},sc=function(e){return{duration:e.duration,progress:e.progress,live:e.live}},sd=function(){var e=(0,eZ.u)(sc),t=ef({duration:e.duration,progress:e.progress,live:e.live}),r=t.title,i=t.live;return(0,eo.jsx)(eo.Fragment,{children:i?(0,eo.jsxs)("div",{className:eS.Il.time.container(),children:[(0,eo.jsx)("div",{className:eS.Il.time.liveIndicator()}),(0,eo.jsx)("span",{className:eS.Il.time.text(),"aria-label":"Live streaming media",children:"LIVE"})]}):(0,eo.jsx)("span",{className:eS.Il.time.text(),"aria-label":"Playback time",children:r})})},su=function(e){var t=e.content;return(0,eo.jsx)("span",{className:eS.Il.title(),"aria-label":"Title",children:t})};(0,g.memo)(function(e){var t=el(e),r=t.mediaElement,i=t.broadcastProps,n=t.mediaControllerProps,s=t.controlsContainerProps,a=t.props,o=a.children,l=a.controls,c=a.theme,d=a.title,u=a.aspectRatio,p=a.renderChildrenOutsideContainer;return(0,eo.jsxs)(eZ.M,{element:r,opts:l,mediaProps:n,children:[(0,eo.jsxs)(n5,{theme:c,aspectRatio:u,tabIndex:e.tabIndex,children:[(0,eo.jsx)(nE,(0,f._)({},i)),!p&&g.isValidElement(o)?g.cloneElement(o,s):(0,eo.jsx)(se,(0,f._)((0,f._)({},s),{},{top:(0,eo.jsx)(eo.Fragment,{children:d&&(0,eo.jsx)(su,{content:d})}),left:(0,eo.jsxs)(eo.Fragment,{children:[(0,eo.jsx)(nJ,{}),(0,eo.jsx)(nN,{}),(0,eo.jsx)(nZ,{options:null==e?void 0:e.displayMediaOptions}),(0,eo.jsx)(sd,{})]}),right:(0,eo.jsxs)(eo.Fragment,{children:[e.showPipButton&&(0,eo.jsx)(sl,{}),(0,eo.jsx)(nH,{streamConstraints:e.mediaStreamConstraints}),(0,eo.jsx)(sn,{})]})}))]}),p&&g.isValidElement(o)?o:(0,eo.jsx)(eo.Fragment,{})]})});var sp=function(e){return{fullscreen:e.fullscreen}},sh=g.forwardRef(function(e,t){var r=e.src,i=e.autoPlay,n=e.title,s=e.loop,a=e.muted,o=e.objectFit,l=e.allowCrossOriginCredentials,c=(0,eZ.u)(sp).fullscreen,d=g.useMemo(function(){var e;return null!==(e=null==r?void 0:r.filter(function(e){return(null==e?void 0:e.mime)&&(0,nv.wf)(e)}))&&void 0!==e?e:[]},[r]);return(0,eo.jsxs)("audio",{className:eS.Il.media.audio({size:c?"fullscreen":o}),loop:s,"aria-label":null!=n?n:"Audio player",role:"audio",autoPlay:i,ref:t,"webkit-playsinline":"true",playsInline:!0,muted:a,crossOrigin:l?"use-credentials":"anonymous",children:[d.map(function(e){return(0,eo.jsx)("source",{src:e.src,type:e.mime},e.src)}),"Your browser doesn't support the HTML5 <code>audio</code> tag, or the audio format."]})});sh.displayName="AudioPlayer";var sm=function(){return(0,eo.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,eo.jsx)("path",{d:"M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z",fill:"currentColor"})})},sf=function(){return(0,eo.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",fill:"none",children:(0,eo.jsx)("path",{d:"M 12,26 16,26 16,10 12,10 z M 21,26 25,26 25,10 21,10 z",fill:"currentColor"})})},sg=function(e){return{togglePlay:e.togglePlay,playing:e.playing}},sv=function(e){var t=(0,eZ.u)(sg),r=t.togglePlay,i=t.playing,n=ep((0,f._)({togglePlay:r,playing:i,defaultPauseIcon:(0,eo.jsx)(sf,{}),defaultPlayIcon:(0,eo.jsx)(sm,{})},e)),s=n.buttonProps,a=n.title;return(0,eo.jsx)("button",(0,f._)({style:{width:e.size,height:e.size},className:eS.Il.iconButton(),title:a,"aria-label":a,onClick:s.onPress},(0,K.o)(s,"onPress","size")))},sy=function(e){return{fullscreen:e.fullscreen}},sb=function(e){var t=(0,eZ.u)(sy).fullscreen,r=e.content,i=e.title;return"string"==typeof r?(0,eo.jsx)("img",{className:eS.Il.media.poster({size:t?"fullscreen":"default"}),"aria-label":i,alt:i,src:r}):g.isValidElement(r)?g.cloneElement(r,{className:eS.Il.media.poster({size:t?"fullscreen":"default"})}):(0,eo.jsx)(eo.Fragment,{})},sw=function(e){return{duration:e.duration,progress:e.progress,requestSeek:e.requestSeek,buffered:e.buffered,live:e.live}},s_=function(e){var t=(0,eZ.u)(sw),r=t.duration,i=t.progress,n=t.requestSeek,s=t.buffered,a=t.live,o=eh((0,f._)({duration:r,progress:i,requestSeek:n,buffered:s,live:a},e)),l=o.isVisible,c=o.progressProps,d=o.title;return l?(0,eo.jsx)(n0,(0,f._)((0,f._)({},c),{},{ariaName:d})):(0,eo.jsx)(eo.Fragment,{})},sS=function(){return(0,eo.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",children:[(0,eo.jsx)("path",{d:"M 9.25,9 7.98,10.27 24.71,27 l 1.27,-1.27 Z",fill:"currentColor"}),(0,eo.jsx)("path",{fill:"currentColor",d:"M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 ZM19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z"})]})},sx=function(){return(0,eo.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 36 36",children:(0,eo.jsx)("path",{fill:"currentColor",d:"M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 ZM19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z"})})},sC=function(e){return{isVolumeChangeSupported:e.isVolumeChangeSupported,requestToggleMute:e.requestToggleMute,requestVolume:e.requestVolume,muted:e.muted,volume:e.volume}},sT=function(e){var t=(0,eZ.u)(sC),r=t.volume,i=t.requestToggleMute,n=t.muted,s=t.requestVolume,a=t.isVolumeChangeSupported,o=eg((0,f._)({volume:r,requestToggleMute:i,muted:n,requestVolume:s,isVolumeChangeSupported:a,defaultMutedIcon:(0,eo.jsx)(sS,{}),defaultUnmutedIcon:(0,eo.jsx)(sx,{})},e)),l=o.progressProps,c=o.buttonProps,d=o.title;return(0,eo.jsxs)("div",{className:eS.Il.volume.container(),children:[(0,eo.jsx)("button",(0,f._)({style:{width:e.size,height:e.size},className:eS.Il.iconButton(),title:d,"aria-label":d,onClick:c.onPress},(0,K.o)(c,"onPress","size"))),l.shown&&(0,eo.jsx)(n0,(0,f._)({ariaName:"volume",value:n?0:r},l))]})},sk=function(e){return{setLive:e.setLive,onDurationChange:e.onDurationChange,onCanPlay:e.onCanPlay,_element:e._element}},sR=g.forwardRef(function(e,t){var r,i=e.src,n=e.hlsConfig,s=e.autoPlay,a=e.title,o=e.loop,l=e.muted,c=e.poster,d=e.objectFit,u=e.fullscreen,p=e.playbackError,h=e.onPlaybackError,m=e.priority,v=e.allowCrossOriginCredentials,y=(0,eZ.u)(sk),b=y.setLive,w=y.onCanPlay,_=y.onDurationChange,S=y._element,x=g.useCallback((r=nC(nS().mark(function e(t){return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:null==h||h(null),b(t);case 2:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),[h,b]);return g.useEffect(function(){if(S&&i){var e=n_(null==i?void 0:i.src,S,{onLive:x,onDuration:_,onCanPlay:w,onError:function(e){var t,r,i,n,s,a=Error(null!==(t=null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(i=r.data)||void 0===i?void 0:null===(n=i.toString)||void 0===n?void 0:n.call(i))&&void 0!==t?t:(null==e?void 0:null===(s=e.response)||void 0===s?void 0:s.code)===401?es.Hn:"Error with HLS.js");null==h||h(a)}},(0,f._)({autoplay:s,xhrSetup:function(e,t){e.withCredentials=Boolean(v)}},n)).destroy;return function(){null==e||e()}}},[s,n,_,w,S,i,x,h,v]),null!=p&&p.type?(0,eo.jsx)(eo.Fragment,{}):(0,eo.jsx)("video",{className:eS.Il.media.video({size:u?"fullscreen":d}),loop:o,"aria-label":null!=a?a:"Video player",role:"video",width:"100%",height:"100%",ref:t,"webkit-playsinline":"true",playsInline:!0,autoPlay:s,muted:l,poster:"string"==typeof c?c:void 0,preload:m?"auto":"metadata",crossOrigin:v?"use-credentials":"anonymous"})}),sE=function(e){return{canPlay:e.canPlay}},sP=g.forwardRef(function(e,t){var r,i,n=e.autoPlay,s=e.title,a=e.loop,o=e.muted,l=e.poster,c=e.objectFit,d=e.priority,u=e.onPlaybackError,p=e.src,h=e.fullscreen,m=(0,eZ.u)(sE).canPlay,f=g.useCallback((r=nC(nS().mark(function e(t){var r,i,n,s,a;return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s=null!==(r=null==(n=null==(i=t.target)?void 0:i.parentElement)?void 0:n.currentSrc)&&void 0!==r?r:null==i?void 0:i.currentSrc)){e.next=22;break}return e.prev=4,e.next=7,fetch(s);case 7:if(404!==(a=e.sent).status){e.next=13;break}return console.warn("Video not found"),e.abrupt("return",null==u?void 0:u(Error(es.fu)));case 13:if(401!==a.status){e.next=16;break}return console.warn("Unauthorized to view video"),e.abrupt("return",null==u?void 0:u(Error(es.Hn)));case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(4),console.warn(e.t0),e.abrupt("return",null==u?void 0:u(Error("Error fetching video URL")));case 22:return console.warn("Unknown error loading video"),e.abrupt("return",null==u?void 0:u(Error("Unknown error loading video")));case 24:case"end":return e.stop()}},e,null,[[4,18]])})),function(e){return r.apply(this,arguments)}),[u]);return g.useEffect(function(){m&&(null==u||u(null))},[m,u]),(0,eo.jsx)("video",{className:eS.Il.media.video({size:h?"fullscreen":c}),loop:a,"aria-label":null!=s?s:"Video player",role:"video",autoPlay:n,width:"100%",height:"100%",ref:t,"webkit-playsinline":"true",playsInline:!0,muted:o,poster:"string"==typeof l?l:void 0,onError:f,preload:d?"auto":"metadata",src:null!==(i=null==p?void 0:p.src)&&void 0!==i?i:void 0,children:"Your browser doesn't support the HTML5 <code>video</code> tag, or the video format."})});sP.displayName="HtmlVideoPlayer";var sD=function(e){return{metadata:e.metadata,_element:e._element,setLive:e.setLive}},sL=g.forwardRef(function(e,t){var r=e.src,i=e.autoPlay,n=e.title,s=e.loop,a=e.muted,o=e.poster,l=e.objectFit,c=e.fullscreen,d=e.onPlaybackError,u=e.priority,p=e.webrtcConfig,h=(0,eZ.u)(sD),m=h.metadata,f=h._element,v=h.setLive,y=g.useCallback(nC(nS().mark(function e(){return nS().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:null==d||d(null),v(!0);case 2:case"end":return e.stop()}},e)})),[d,v]);return g.useEffect(function(){null!=m&&m.bframes&&d(Error("Metadata indicates that WebRTC playback contains bframes."))},[m,d]),g.useEffect(function(){if(f&&r.src){var e=eF(null==r?void 0:r.src,f,{onConnected:y,onError:function(e){var t,r,i,n=Error(null!==(t=null==e?void 0:null===(r=e.message)||void 0===r?void 0:null===(i=r.toString)||void 0===i?void 0:i.call(r))&&void 0!==t?t:"Error with WebRTC");null==d||d(n)}},p).destroy;return function(){null==e||e()}}},[p,f,y,r,d]),(0,eo.jsx)("video",{className:eS.Il.media.video({size:c?"fullscreen":l}),loop:s,"aria-label":null!=n?n:"Video player",role:"video",width:"100%",height:"100%",ref:t,"webkit-playsinline":"true",playsInline:!0,autoPlay:i,muted:a,poster:"string"==typeof o?o:void 0,preload:u?"auto":"metadata"})}),sI=function(e){return{fullscreen:e.fullscreen}},sM=g.forwardRef(function(e,t){var r=(0,eZ.u)(sI).fullscreen,i=e.src,n=e.onPlaybackError,s=e.playbackError,a=e.lowLatency,o=e.onPlaybackStatusUpdate,l=e.playbackStatusSelector,c=nk(g.useMemo(function(){return[!(0,eR.i)()||ny.Z.isSupported(),eE()]},[]),2),d=c[0],u=c[1],p=g.useMemo(function(){var e;return null==i?void 0:null===(e=i.filter(function(e){return!!a||"webrtc"!==e.type}))||void 0===e?void 0:e.map(function(e){return"hls"!==e.type||d?e:(0,f._)((0,f._)({},e),{},{type:"video",mime:"application/vnd.apple.mpegurl"})})},[i,d,a]),h=nk(g.useState(0),2),m=h[0],v=h[1],y=g.useCallback(function(){v(function(e){return e+1})},[v]),b=g.useMemo(function(){var e,t;return e=1e3*Math.pow(2,m),t=null,{debouncedFn:function(){for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];null===t&&(t=setTimeout(function(){t=null,y.apply(void 0,i)},e))},cancel:function(){t&&(clearTimeout(t),t=null)}}},[y,m]),w=b.debouncedFn,_=b.cancel,S=g.useRef(w),x=g.useRef(_);g.useEffect(function(){S.current=w,x.current=_},[w,_]);var C=g.useMemo(function(){var e,t;return null!==(e=null==p?void 0:p[m%(null!==(t=null==p?void 0:p.length)&&void 0!==t?t:0)])&&void 0!==e?e:null},[p,m]);g.useEffect(function(){if((null==s?void 0:s.type)==="offline"&&(null==C?void 0:C.type)!=="hls"){var e;null==S||null===(e=S.current)||void 0===e||e.call(S)}},[s,C]),g.useEffect(function(){var e,t;(null==s?void 0:s.type)==="unknown"?null==S||null===(e=S.current)||void 0===e||e.call(S):null===s&&(null==x||null===(t=x.current)||void 0===t||t.call(x))},[s]),g.useEffect(function(){var e;((null==C?void 0:C.type)!=="webrtc"||u)&&((null==C?void 0:C.type)!=="hls"||d)&&((null==C?void 0:C.type)!=="video"||(0,nv.wf)(C))||null==S||null===(e=S.current)||void 0===e||e.call(S)},[d,u,C]);var T=g.useContext(eZ.b),k=g.useCallback(function(e){return l?l(e):e},[l]);return g.useEffect(function(){return T.subscribe(k,function(e,t){return null==o?void 0:o((0,ea.s)(e),(0,ea.s)(t))})},[o,k,T]),g.useEffect(function(){if(C){var e,t,r;null==T||null===(e=T.getState)||void 0===e||null===(t=e.call(T))||void 0===t||null===(r=t._updateSource)||void 0===r||r.call(t,null==C?void 0:C.src)}},[T,C]),g.useEffect(function(){return(0,ng.z2)(T,function(e){null==n||n(e),console.error("Not able to report player metrics",e)}).destroy},[n,T]),(null==C?void 0:C.type)==="webrtc"?(0,eo.jsx)(sL,(0,f._)((0,f._)({},e),{},{ref:t,src:C,fullscreen:r})):(null==C?void 0:C.type)==="hls"?(0,eo.jsx)(sR,(0,f._)((0,f._)({},e),{},{ref:t,src:C,fullscreen:r})):(0,eo.jsx)(sP,(0,f._)((0,f._)({},e),{},{ref:t,src:C,fullscreen:r}))}),sj=g.memo(sM),sO=function(e){var t=nk(g.useState(!1),2),r=t[0],i=t[1];return g.useEffect(function(){if("undefined"!=typeof window&&e){if("IntersectionObserver"in window){var t=new IntersectionObserver(function(e){var t=nk(e,1)[0];return i(Boolean(null==t?void 0:t.isIntersecting))});return t.observe(e),function(){t.disconnect()}}i(!0)}},[e]),r},sA=(0,g.memo)(function(e){var t,r=nk(g.useState(!1),2),i=r[0],n=r[1],s=g.useMemo(function(){var e,t,r,i;return"undefined"!=typeof window&&null!==(e=(null===(t=window)||void 0===t?void 0:null===(r=t.screen)||void 0===r?void 0:r.availWidth)||(null===(i=window)||void 0===i?void 0:i.innerWidth))&&void 0!==e?e:null},[]),a=g.useMemo(function(){var t;return null!==(t=e._isCurrentlyShown)&&void 0!==t?t:i},[e._isCurrentlyShown,i]),o=e_((0,f._)((0,f._)({},e),{},{_isCurrentlyShown:a}),{_screenWidth:s}),l=o.mediaElement,c=o.playerProps,d=o.mediaControllerProps,u=o.controlsContainerProps,p=o.source,h=o.props,m=h.children,v=h.controls,y=h.theme,b=h.title,w=h.poster,_=h.showTitle,S=h.aspectRatio,x=h.renderChildrenOutsideContainer,C=sO(l);return g.useEffect(function(){n(C)},[C]),(0,eo.jsxs)(eZ.M,{element:l,opts:v,mediaProps:d,children:[(0,eo.jsxs)(n5,{theme:y,aspectRatio:S,tabIndex:e.tabIndex,children:[p&&(null==p?void 0:null===(t=p[0])||void 0===t?void 0:t.type)==="audio"?(0,eo.jsx)(sh,(0,f._)((0,f._)({},c),{},{src:p,allowCrossOriginCredentials:e.allowCrossOriginCredentials})):(0,eo.jsx)(sj,(0,f._)((0,f._)({},c),{},{hlsConfig:e.hlsConfig,webrtcConfig:e.webrtcConfig,lowLatency:e.lowLatency,playbackStatusSelector:e.playbackStatusSelector,allowCrossOriginCredentials:e.allowCrossOriginCredentials,src:p})),!x&&g.isValidElement(m)?g.cloneElement(m,u):(0,eo.jsx)(se,(0,f._)((0,f._)({},u),{},{poster:w&&(0,eo.jsx)(sb,{content:w,title:b}),top:(0,eo.jsx)(eo.Fragment,{children:b&&_&&(0,eo.jsx)(su,{content:b})}),middle:(0,eo.jsx)(s_,{}),left:(0,eo.jsxs)(eo.Fragment,{children:[(0,eo.jsx)(sv,{}),(0,eo.jsx)(sT,{}),(0,eo.jsx)(sd,{})]}),right:(0,eo.jsxs)(eo.Fragment,{children:[e.showPipButton&&(0,eo.jsx)(sl,{}),(0,eo.jsx)(sn,{})]})}))]}),x&&g.isValidElement(m)?m:(0,eo.jsx)(eo.Fragment,{})]})})},47329:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;let n=i(r(11227)),s="awaitqueue";t.Logger=class{constructor(e){e?(this._debug=(0,n.default)(`${s}:${e}`),this._warn=(0,n.default)(`${s}:WARN:${e}`),this._error=(0,n.default)(`${s}:ERROR:${e}`)):(this._debug=(0,n.default)(s),this._warn=(0,n.default)(`${s}:WARN`),this._error=(0,n.default)(`${s}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}},32186:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwaitQueue=t.AwaitQueueRemovedTaskError=t.AwaitQueueStoppedError=void 0;let i=r(47329),n=new i.Logger;class s extends Error{constructor(e){super(null!=e?e:"AwaitQueue stopped"),this.name="AwaitQueueStoppedError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,s)}}t.AwaitQueueStoppedError=s;class a extends Error{constructor(e){super(null!=e?e:"AwaitQueue task removed"),this.name="AwaitQueueRemovedTaskError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}}t.AwaitQueueRemovedTaskError=a,t.AwaitQueue=class{constructor(){this.pendingTasks=new Map,this.nextTaskId=0,this.stopping=!1}get size(){return this.pendingTasks.size}async push(e,t){if(t=null!=t?t:e.name,n.debug(`push() [name:${t}]`),"function"!=typeof e)throw TypeError("given task is not a function");if(t)try{Object.defineProperty(e,"name",{value:t})}catch(r){}return new Promise((r,i)=>{let s={id:this.nextTaskId++,task:e,name:t,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:e=>{if(s.completed)return;s.completed=!0,this.pendingTasks.delete(s.id),n.debug(`resolving task [name:${s.name}]`),r(e);let[t]=this.pendingTasks.values();t&&!t.executedAt&&this.execute(t)},reject:e=>{if(!s.completed&&(s.completed=!0,this.pendingTasks.delete(s.id),n.debug(`rejecting task [name:${s.name}]: %s`,String(e)),i(e),!this.stopping)){let[t]=this.pendingTasks.values();t&&!t.executedAt&&this.execute(t)}}};this.pendingTasks.set(s.id,s),1===this.pendingTasks.size&&this.execute(s)})}stop(){for(let e of(n.debug("stop()"),this.stopping=!0,this.pendingTasks.values()))n.debug(`stop() | stopping task [name:${e.name}]`),e.reject(new s);this.stopping=!1}remove(e){n.debug(`remove() [taskIdx:${e}]`);let t=Array.from(this.pendingTasks.values())[e];if(!t){n.debug(`stop() | no task with given idx [taskIdx:${e}]`);return}t.reject(new a)}dump(){let e=Date.now(),t=0;return Array.from(this.pendingTasks.values()).map(r=>({idx:t++,task:r.task,name:r.name,enqueuedTime:r.executedAt?r.executedAt-r.enqueuedAt:e-r.enqueuedAt,executionTime:r.executedAt?e-r.executedAt:0}))}async execute(e){if(n.debug(`execute() [name:${e.name}]`),e.executedAt)throw Error("task already being executed");e.executedAt=Date.now();try{let t=await e.task();e.resolve(t)}catch(r){e.reject(r)}}}},31530:function(e,t,r){"use strict";var i=r(28710).charAt;e.exports=function(e,t,r){return t+(r?i(e,t).length:1)}},48457:function(e,t,r){"use strict";var i=r(49974),n=r(46916),s=r(47908),a=r(53411),o=r(97659),l=r(4411),c=r(26244),d=r(86135),u=r(18554),p=r(71246),h=Array;e.exports=function(e){var t,r,m,f,g,v,y=s(e),b=l(this),w=arguments.length,_=w>1?arguments[1]:void 0,S=void 0!==_;S&&(_=i(_,w>2?arguments[2]:void 0));var x=p(y),C=0;if(x&&!(this===h&&o(x)))for(g=(f=u(y,x)).next,r=b?new this:[];!(m=n(g,f)).done;C++)v=S?a(f,_,[m.value,C],!0):m.value,d(r,C,v);else for(t=c(y),r=b?new this(t):h(t);t>C;C++)v=S?_(y[C],C):y[C],d(r,C,v);return r.length=C,r}},42092:function(e,t,r){var i=r(49974),n=r(1702),s=r(68361),a=r(47908),o=r(26244),l=r(65417),c=n([].push),d=function(e){var t=1==e,r=2==e,n=3==e,d=4==e,u=6==e,p=7==e,h=5==e||u;return function(m,f,g,v){for(var y,b,w=a(m),_=s(w),S=i(f,g),x=o(_),C=0,T=v||l,k=t?T(m,x):r||p?T(m,0):void 0;x>C;C++)if((h||C in _)&&(b=S(y=_[C],C,w),e)){if(t)k[C]=b;else if(b)switch(e){case 3:return!0;case 5:return y;case 6:return C;case 2:c(k,y)}else switch(e){case 4:return!1;case 7:c(k,y)}}return u?-1:n||d?d:k}};e.exports={forEach:d(0),map:d(1),filter:d(2),some:d(3),every:d(4),find:d(5),findIndex:d(6),filterReject:d(7)}},81194:function(e,t,r){var i=r(47293),n=r(5112),s=r(7392),a=n("species");e.exports=function(e){return s>=51||!i(function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo})}},41589:function(e,t,r){var i=r(51400),n=r(26244),s=r(86135),a=Array,o=Math.max;e.exports=function(e,t,r){for(var l=n(e),c=i(t,l),d=i(void 0===r?l:r,l),u=a(o(d-c,0)),p=0;c<d;c++,p++)s(u,p,e[c]);return u.length=p,u}},94362:function(e,t,r){var i=r(41589),n=Math.floor,s=function(e,t){var r=e.length,l=n(r/2);return r<8?a(e,t):o(e,s(i(e,0,l),t),s(i(e,l),t),t)},a=function(e,t){for(var r,i,n=e.length,s=1;s<n;){for(i=s,r=e[s];i&&t(e[i-1],r)>0;)e[i]=e[--i];i!==s++&&(e[i]=r)}return e},o=function(e,t,r,i){for(var n=t.length,s=r.length,a=0,o=0;a<n||o<s;)e[a+o]=a<n&&o<s?0>=i(t[a],r[o])?t[a++]:r[o++]:a<n?t[a++]:r[o++];return e};e.exports=s},77475:function(e,t,r){var i=r(43157),n=r(4411),s=r(70111),a=r(5112)("species"),o=Array;e.exports=function(e){var t;return i(e)&&(n(t=e.constructor)&&(t===o||i(t.prototype))?t=void 0:s(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?o:t}},65417:function(e,t,r){var i=r(77475);e.exports=function(e,t){return new(i(e))(0===t?0:t)}},53411:function(e,t,r){var i=r(19670),n=r(99212);e.exports=function(e,t,r,s){try{return s?t(i(r)[0],r[1]):t(r)}catch(a){n(e,"throw",a)}}},49920:function(e,t,r){var i=r(47293);e.exports=!i(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},76178:function(e){e.exports=function(e,t){return{value:e,done:t}}},86135:function(e,t,r){"use strict";var i=r(34948),n=r(3070),s=r(79114);e.exports=function(e,t,r){var a=i(t);a in e?n.f(e,a,s(0,r)):e[a]=r}},89190:function(e,t,r){var i=r(98052);e.exports=function(e,t,r){for(var n in t)i(e,n,t[n],r);return e}},7207:function(e){var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},48324:function(e){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},98509:function(e,t,r){var i=r(80317)("span").classList,n=i&&i.constructor&&i.constructor.prototype;e.exports=n===Object.prototype?void 0:n},27007:function(e,t,r){"use strict";r(74916);var i=r(21470),n=r(98052),s=r(22261),a=r(47293),o=r(5112),l=r(68880),c=o("species"),d=RegExp.prototype;e.exports=function(e,t,r,u){var p=o(e),h=!a(function(){var t={};return t[p]=function(){return 7},7!=""[e](t)}),m=h&&!a(function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[c]=function(){return r},r.flags="",r[p]=/./[p]),r.exec=function(){return t=!0,null},r[p](""),!t});if(!h||!m||r){var f=i(/./[p]),g=t(p,""[e],function(e,t,r,n,a){var o=i(e),l=t.exec;return l===s||l===d.exec?h&&!a?{done:!0,value:f(t,r,n)}:{done:!0,value:o(r,t,n)}:{done:!1}});n(String.prototype,e,g[0]),n(d,p,g[1])}u&&l(d[p],"sham",!0)}},10647:function(e,t,r){var i=r(1702),n=r(47908),s=Math.floor,a=i("".charAt),o=i("".replace),l=i("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,r,i,u,p){var h=r+e.length,m=i.length,f=d;return void 0!==u&&(u=n(u),f=c),o(p,f,function(n,o){var c;switch(a(o,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,r);case"'":return l(t,h);case"<":c=u[l(o,1,-1)];break;default:var d=+o;if(0===d)return n;if(d>m){var p=s(d/10);if(0===p)return n;if(p<=m)return void 0===i[p-1]?a(o,1):i[p-1]+a(o,1);return n}c=i[d-1]}return void 0===c?"":c})}},43157:function(e,t,r){var i=r(84326);e.exports=Array.isArray||function(e){return"Array"==i(e)}},63061:function(e,t,r){"use strict";var i=r(13383).IteratorPrototype,n=r(70030),s=r(79114),a=r(58003),o=r(97497),l=function(){return this};e.exports=function(e,t,r,c){var d=t+" Iterator";return e.prototype=n(i,{next:s(+!c,r)}),a(e,d,!1,!0),o[d]=l,e}},51656:function(e,t,r){"use strict";var i=r(82109),n=r(46916),s=r(31913),a=r(76530),o=r(60614),l=r(63061),c=r(79518),d=r(27674),u=r(58003),p=r(68880),h=r(98052),m=r(5112),f=r(97497),g=r(13383),v=a.PROPER,y=a.CONFIGURABLE,b=g.IteratorPrototype,w=g.BUGGY_SAFARI_ITERATORS,_=m("iterator"),S="keys",x="values",C="entries",T=function(){return this};e.exports=function(e,t,r,a,m,g,k){l(r,t,a);var R,E,P,D=function(e){if(e===m&&O)return O;if(!w&&e in M)return M[e];switch(e){case S:case x:case C:return function(){return new r(this,e)}}return function(){return new r(this)}},L=t+" Iterator",I=!1,M=e.prototype,j=M[_]||M["@@iterator"]||m&&M[m],O=!w&&j||D(m),A="Array"==t&&M.entries||j;if(A&&(R=c(A.call(new e)))!==Object.prototype&&R.next&&(s||c(R)===b||(d?d(R,b):o(R[_])||h(R,_,T)),u(R,L,!0,!0),s&&(f[L]=T)),v&&m==x&&j&&j.name!==x&&(!s&&y?p(M,"name",x):(I=!0,O=function(){return n(j,this)})),m){if(E={values:D(x),keys:g?O:D(S),entries:D(C)},k)for(P in E)!w&&!I&&P in M||h(M,P,E[P]);else i({target:t,proto:!0,forced:w||I},E)}return(!s||k)&&M[_]!==O&&h(M,_,O,{name:m}),f[t]=O,E}},13383:function(e,t,r){"use strict";var i,n,s,a=r(47293),o=r(60614),l=r(70111),c=r(70030),d=r(79518),u=r(98052),p=r(5112),h=r(31913),m=p("iterator"),f=!1;[].keys&&("next"in(s=[].keys())?(n=d(d(s)))!==Object.prototype&&(i=n):f=!0),!l(i)||a(function(){var e={};return i[m].call(e)!==e})?i={}:h&&(i=c(i)),o(i[m])||u(i,m,function(){return this}),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:f}},79518:function(e,t,r){var i=r(92597),n=r(60614),s=r(47908),a=r(6200),o=r(49920),l=a("IE_PROTO"),c=Object,d=c.prototype;e.exports=o?c.getPrototypeOf:function(e){var t=s(e);if(i(t,l))return t[l];var r=t.constructor;return n(r)&&t instanceof r?r.prototype:t instanceof c?d:null}},97651:function(e,t,r){var i=r(46916),n=r(19670),s=r(60614),a=r(84326),o=r(22261),l=TypeError;e.exports=function(e,t){var r=e.exec;if(s(r)){var c=i(r,e,t);return null!==c&&n(c),c}if("RegExp"===a(e))return i(o,e,t);throw l("RegExp#exec called on incompatible receiver")}},34706:function(e,t,r){var i=r(46916),n=r(92597),s=r(47976),a=r(67066),o=RegExp.prototype;e.exports=function(e){var t=e.flags;return!(void 0===t&&!("flags"in o)&&!n(e,"flags")&&s(o,e))?t:i(a,e)}},28710:function(e,t,r){var i=r(1702),n=r(19303),s=r(41340),a=r(84488),o=i("".charAt),l=i("".charCodeAt),c=i("".slice),d=function(e){return function(t,r){var i,d,u=s(a(t)),p=n(r),h=u.length;return p<0||p>=h?e?"":void 0:(i=l(u,p))<55296||i>56319||p+1===h||(d=l(u,p+1))<56320||d>57343?e?o(u,p):i:e?c(u,p,p+2):(i-55296<<10)+(d-56320)+65536}};e.exports={codeAt:d(!1),charAt:d(!0)}},33197:function(e,t,r){var i=r(1702),n=/[^\0-\u007E]/,s=/[.\u3002\uFF0E\uFF61]/g,a="Overflow: input needs wider integers to process",o=RangeError,l=i(s.exec),c=Math.floor,d=String.fromCharCode,u=i("".charCodeAt),p=i([].join),h=i([].push),m=i("".replace),f=i("".split),g=i("".toLowerCase),v=function(e){for(var t=[],r=0,i=e.length;r<i;){var n=u(e,r++);if(n>=55296&&n<=56319&&r<i){var s=u(e,r++);(64512&s)==56320?h(t,((1023&n)<<10)+(1023&s)+65536):(h(t,n),r--)}else h(t,n)}return t},y=function(e){return e+22+75*(e<26)},b=function(e,t,r){var i=0;for(e=r?c(e/700):e>>1,e+=c(e/t);e>455;)e=c(e/35),i+=36;return c(i+36*e/(e+38))},w=function(e){var t,r,i=[],n=(e=v(e)).length,s=128,l=0,u=72;for(t=0;t<e.length;t++)(r=e[t])<128&&h(i,d(r));var m=i.length,f=m;for(m&&h(i,"-");f<n;){var g=2147483647;for(t=0;t<e.length;t++)(r=e[t])>=s&&r<g&&(g=r);var w=f+1;if(g-s>c((2147483647-l)/w))throw o(a);for(l+=(g-s)*w,s=g,t=0;t<e.length;t++){if((r=e[t])<s&&++l>2147483647)throw o(a);if(r==s){for(var _=l,S=36;;){var x=S<=u?1:S>=u+26?26:S-u;if(_<x)break;var C=_-x,T=36-x;h(i,d(y(x+C%T))),_=c(C/T),S+=36}h(i,d(y(_))),u=b(l,w,f==m),l=0,f++}}l++,s++}return p(i,"")};e.exports=function(e){var t,r,i=[],a=f(m(g(e),s,"."),".");for(t=0;t<a.length;t++)h(i,l(n,r=a[t])?"xn--"+w(r):r);return p(i,".")}},85143:function(e,t,r){var i=r(47293),n=r(5112),s=r(19781),a=r(31913),o=n("iterator");e.exports=!i(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2"),i="";return e.pathname="c%20d",t.forEach(function(e,r){t.delete("b"),i+=r+e}),r.delete("a",2),a&&(!e.toJSON||!r.has("a",1)||r.has("a",2))||!t.size&&(a||!s)||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==i||"x"!==new URL("http://x",void 0).host})},92222:function(e,t,r){"use strict";var i=r(82109),n=r(47293),s=r(43157),a=r(70111),o=r(47908),l=r(26244),c=r(7207),d=r(86135),u=r(65417),p=r(81194),h=r(5112),m=r(7392),f=h("isConcatSpreadable"),g=m>=51||!n(function(){var e=[];return e[f]=!1,e.concat()[0]!==e}),v=function(e){if(!a(e))return!1;var t=e[f];return void 0!==t?!!t:s(e)};i({target:"Array",proto:!0,arity:1,forced:!g||!p("concat")},{concat:function(e){var t,r,i,n,s,a=o(this),p=u(a,0),h=0;for(t=-1,i=arguments.length;t<i;t++)if(s=-1===t?a:arguments[t],v(s))for(c(h+(n=l(s))),r=0;r<n;r++,h++)r in s&&d(p,h,s[r]);else c(h+1),d(p,h++,s);return p.length=h,p}})},4480:function(e,t,r){"use strict";var i=r(82109),n=r(42092).filter;i({target:"Array",proto:!0,forced:!r(81194)("filter")},{filter:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},66992:function(e,t,r){"use strict";var i=r(45656),n=r(51223),s=r(97497),a=r(29909),o=r(3070).f,l=r(51656),c=r(76178),d=r(31913),u=r(19781),p="Array Iterator",h=a.set,m=a.getterFor(p);e.exports=l(Array,"Array",function(e,t){h(this,{type:p,target:i(e),index:0,kind:t})},function(){var e=m(this),t=e.target,r=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,c(void 0,!0)):"keys"==r?c(i,!1):"values"==r?c(t[i],!1):c([i,t[i]],!1)},"values");var f=s.Arguments=s.Array;if(n("keys"),n("values"),n("entries"),!d&&u&&"values"!==f.name)try{o(f,"name",{value:"values"})}catch(g){}},21249:function(e,t,r){"use strict";var i=r(82109),n=r(42092).map;i({target:"Array",proto:!0,forced:!r(81194)("map")},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},47042:function(e,t,r){"use strict";var i=r(82109),n=r(43157),s=r(4411),a=r(70111),o=r(51400),l=r(26244),c=r(45656),d=r(86135),u=r(5112),p=r(81194),h=r(50206),m=p("slice"),f=u("species"),g=Array,v=Math.max;i({target:"Array",proto:!0,forced:!m},{slice:function(e,t){var r,i,u,p=c(this),m=l(p),y=o(e,m),b=o(void 0===t?m:t,m);if(n(p)&&(s(r=p.constructor)&&(r===g||n(r.prototype))?r=void 0:a(r)&&null===(r=r[f])&&(r=void 0),r===g||void 0===r))return h(p,y,b);for(u=0,i=new(void 0===r?g:r)(v(b-y,0));y<b;y++,u++)y in p&&d(i,u,p[y]);return i.length=u,i}})},39714:function(e,t,r){"use strict";var i=r(76530).PROPER,n=r(98052),s=r(19670),a=r(41340),o=r(47293),l=r(34706),c="toString",d=RegExp.prototype[c],u=o(function(){return"/a/b"!=d.call({source:"a",flags:"b"})}),p=i&&d.name!=c;(u||p)&&n(RegExp.prototype,c,function(){var e=s(this);return"/"+a(e.source)+"/"+a(l(e))},{unsafe:!0})},78783:function(e,t,r){"use strict";var i=r(28710).charAt,n=r(41340),s=r(29909),a=r(51656),o=r(76178),l="String Iterator",c=s.set,d=s.getterFor(l);a(String,"String",function(e){c(this,{type:l,string:n(e),index:0})},function(){var e,t=d(this),r=t.string,n=t.index;return n>=r.length?o(void 0,!0):(e=i(r,n),t.index+=e.length,o(e,!1))})},15306:function(e,t,r){"use strict";var i=r(22104),n=r(46916),s=r(1702),a=r(27007),o=r(47293),l=r(19670),c=r(60614),d=r(68554),u=r(19303),p=r(17466),h=r(41340),m=r(84488),f=r(31530),g=r(58173),v=r(10647),y=r(97651),b=r(5112)("replace"),w=Math.max,_=Math.min,S=s([].concat),x=s([].push),C=s("".indexOf),T=s("".slice),k="$0"==="a".replace(/./,"$0"),R=!!/./[b]&&""===/./[b]("a","$0");a("replace",function(e,t,r){var s=R?"$":"$0";return[function(e,r){var i=m(this),s=d(e)?void 0:g(e,b);return s?n(s,e,i,r):n(t,h(i),e,r)},function(e,n){var a=l(this),o=h(e);if("string"==typeof n&&-1===C(n,s)&&-1===C(n,"$<")){var d=r(t,a,o,n);if(d.done)return d.value}var m=c(n);m||(n=h(n));var g=a.global;if(g){var b=a.unicode;a.lastIndex=0}for(var k=[];;){var R=y(a,o);if(null===R||(x(k,R),!g))break;""===h(R[0])&&(a.lastIndex=f(o,p(a.lastIndex),b))}for(var E="",P=0,D=0;D<k.length;D++){for(var L,I=h((R=k[D])[0]),M=w(_(u(R.index),o.length),0),j=[],O=1;O<R.length;O++)x(j,void 0===(L=R[O])?L:String(L));var A=R.groups;if(m){var N=S([I],j,M,o);void 0!==A&&x(N,A);var F=h(i(n,void 0,N))}else F=v(I,o,M,j,A,n);M>=P&&(E+=T(o,P,M)+F,P=M+I.length)}return E+T(o,P)}]},!!o(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})||!k||R)},23157:function(e,t,r){"use strict";var i,n=r(82109),s=r(21470),a=r(31236).f,o=r(17466),l=r(41340),c=r(3929),d=r(84488),u=r(84964),p=r(31913),h=s("".startsWith),m=s("".slice),f=Math.min,g=u("startsWith");n({target:"String",proto:!0,forced:!(!p&&!g&&(i=a(String.prototype,"startsWith"))&&!i.writable)&&!g},{startsWith:function(e){var t=l(d(this));c(e);var r=o(f(arguments.length>1?arguments[1]:void 0,t.length)),i=l(e);return h?h(t,i,r):m(t,r,r+i.length)===i}})},33948:function(e,t,r){var i=r(17854),n=r(48324),s=r(98509),a=r(66992),o=r(68880),l=r(5112),c=l("iterator"),d=l("toStringTag"),u=a.values,p=function(e,t){if(e){if(e[c]!==u)try{o(e,c,u)}catch(r){e[c]=u}if(e[d]||o(e,d,t),n[t]){for(var i in a)if(e[i]!==a[i])try{o(e,i,a[i])}catch(s){e[i]=a[i]}}}};for(var h in n)p(i[h]&&i[h].prototype,h);p(s,"DOMTokenList")},65556:function(e,t,r){"use strict";r(66992);var i=r(82109),n=r(17854),s=r(46916),a=r(1702),o=r(19781),l=r(85143),c=r(98052),d=r(47045),u=r(89190),p=r(58003),h=r(63061),m=r(29909),f=r(25787),g=r(60614),v=r(92597),y=r(49974),b=r(70648),w=r(19670),_=r(70111),S=r(41340),x=r(70030),C=r(79114),T=r(18554),k=r(71246),R=r(48053),E=r(5112),P=r(94362),D=E("iterator"),L="URLSearchParams",I=L+"Iterator",M=m.set,j=m.getterFor(L),O=m.getterFor(I),A=Object.getOwnPropertyDescriptor,N=function(e){if(!o)return n[e];var t=A(n,e);return t&&t.value},F=N("fetch"),q=N("Request"),B=N("Headers"),U=q&&q.prototype,H=B&&B.prototype,z=n.RegExp,V=n.TypeError,$=n.decodeURIComponent,Z=n.encodeURIComponent,W=a("".charAt),K=a([].join),G=a([].push),Q=a("".replace),Y=a([].shift),J=a([].splice),X=a("".split),ee=a("".slice),et=/\+/g,er=[,,,,],ei=function(e){try{return $(e)}catch(t){return e}},en=function(e){var t,r=Q(e,et," "),i=4;try{return $(r)}catch(n){for(;i;)r=Q(r,er[(t=i--)-1]||(er[t-1]=z("((?:%[\\da-f]{2}){"+t+"})","gi")),ei);return r}},es=/[!'()~]|%20/g,ea={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},eo=function(e){return ea[e]},el=function(e){return Q(Z(e),es,eo)},ec=h(function(e,t){M(this,{type:I,iterator:T(j(e).entries),kind:t})},"Iterator",function(){var e=O(this),t=e.kind,r=e.iterator.next(),i=r.value;return r.done||(r.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),r},!0),ed=function(e){this.entries=[],this.url=null,void 0!==e&&(_(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===W(e,0)?ee(e,1):e:S(e)))};ed.prototype={type:L,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,i,n,a,o,l,c=k(e);if(c)for(r=(t=T(e,c)).next;!(i=s(r,t)).done;){if((o=s(a=(n=T(w(i.value))).next,n)).done||(l=s(a,n)).done||!s(a,n).done)throw V("Expected sequence with length 2");G(this.entries,{key:S(o.value),value:S(l.value)})}else for(var d in e)v(e,d)&&G(this.entries,{key:d,value:S(e[d])})},parseQuery:function(e){if(e)for(var t,r,i=X(e,"&"),n=0;n<i.length;)(t=i[n++]).length&&(r=X(t,"="),G(this.entries,{key:en(Y(r)),value:en(K(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],i=0;i<t.length;)G(r,el((e=t[i++]).key)+"="+el(e.value));return K(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var eu=function(){f(this,ep);var e=arguments.length>0?arguments[0]:void 0,t=M(this,new ed(e));o||(this.size=t.entries.length)},ep=eu.prototype;if(u(ep,{append:function(e,t){var r=j(this);R(arguments.length,2),G(r.entries,{key:S(e),value:S(t)}),!o&&this.length++,r.updateURL()},delete:function(e){for(var t=j(this),r=R(arguments.length,1),i=t.entries,n=S(e),s=r<2?void 0:arguments[1],a=void 0===s?s:S(s),l=0;l<i.length;){var c=i[l];if(c.key===n&&(void 0===a||c.value===a)){if(J(i,l,1),void 0!==a)break}else l++}o||(this.size=i.length),t.updateURL()},get:function(e){var t=j(this).entries;R(arguments.length,1);for(var r=S(e),i=0;i<t.length;i++)if(t[i].key===r)return t[i].value;return null},getAll:function(e){var t=j(this).entries;R(arguments.length,1);for(var r=S(e),i=[],n=0;n<t.length;n++)t[n].key===r&&G(i,t[n].value);return i},has:function(e){for(var t=j(this).entries,r=R(arguments.length,1),i=S(e),n=r<2?void 0:arguments[1],s=void 0===n?n:S(n),a=0;a<t.length;){var o=t[a++];if(o.key===i&&(void 0===s||o.value===s))return!0}return!1},set:function(e,t){var r,i=j(this);R(arguments.length,1);for(var n=i.entries,s=!1,a=S(e),l=S(t),c=0;c<n.length;c++)(r=n[c]).key===a&&(s?J(n,c--,1):(s=!0,r.value=l));s||G(n,{key:a,value:l}),o||(this.size=n.length),i.updateURL()},sort:function(){var e=j(this);P(e.entries,function(e,t){return e.key>t.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,r=j(this).entries,i=y(e,arguments.length>1?arguments[1]:void 0),n=0;n<r.length;)i((t=r[n++]).value,t.key,this)},keys:function(){return new ec(this,"keys")},values:function(){return new ec(this,"values")},entries:function(){return new ec(this,"entries")}},{enumerable:!0}),c(ep,D,ep.entries,{name:"entries"}),c(ep,"toString",function(){return j(this).serialize()},{enumerable:!0}),o&&d(ep,"size",{get:function(){return j(this).entries.length},configurable:!0,enumerable:!0}),p(eu,L),i({global:!0,constructor:!0,forced:!l},{URLSearchParams:eu}),!l&&g(B)){var eh=a(H.has),em=a(H.set),ef=function(e){if(_(e)){var t,r=e.body;if(b(r)===L)return eh(t=e.headers?new B(e.headers):new B,"content-type")||em(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),x(e,{body:C(0,S(r)),headers:C(0,t)})}return e};if(g(F)&&i({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return F(e,arguments.length>1?ef(arguments[1]):{})}}),g(q)){var eg=function(e){return f(this,U),new q(e,arguments.length>1?ef(arguments[1]):{})};U.constructor=eg,eg.prototype=U,i({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:eg})}}e.exports={URLSearchParams:eu,getState:j}},41637:function(e,t,r){r(65556)},68789:function(e,t,r){"use strict";r(78783);var i,n=r(82109),s=r(19781),a=r(85143),o=r(17854),l=r(49974),c=r(1702),d=r(98052),u=r(47045),p=r(25787),h=r(92597),m=r(21574),f=r(48457),g=r(41589),v=r(28710).codeAt,y=r(33197),b=r(41340),w=r(58003),_=r(48053),S=r(65556),x=r(29909),C=x.set,T=x.getterFor("URL"),k=S.URLSearchParams,R=S.getState,E=o.URL,P=o.TypeError,D=o.parseInt,L=Math.floor,I=Math.pow,M=c("".charAt),j=c(/./.exec),O=c([].join),A=c(1..toString),N=c([].pop),F=c([].push),q=c("".replace),B=c([].shift),U=c("".split),H=c("".slice),z=c("".toLowerCase),V=c([].unshift),$="Invalid scheme",Z="Invalid host",W="Invalid port",K=/[a-z]/i,G=/[\d+-.a-z]/i,Q=/\d/,Y=/^0x/i,J=/^[0-7]+$/,X=/^\d+$/,ee=/^[\da-f]+$/i,et=/[\0\t\n\r #%/:<>?@[\\\]^|]/,er=/[\0\t\n\r #/:<>?@[\\\]^|]/,ei=/^[\u0000-\u0020]+/,en=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,es=/[\t\n\r]/g,ea=function(e){var t,r,i,n,s,a,o,l=U(e,".");if(l.length&&""==l[l.length-1]&&l.length--,(t=l.length)>4)return e;for(i=0,r=[];i<t;i++){if(""==(n=l[i]))return e;if(s=10,n.length>1&&"0"==M(n,0)&&(s=j(Y,n)?16:8,n=H(n,8==s?1:2)),""===n)a=0;else{if(!j(10==s?X:8==s?J:ee,n))return e;a=D(n,s)}F(r,a)}for(i=0;i<t;i++)if(a=r[i],i==t-1){if(a>=I(256,5-t))return null}else if(a>255)return null;for(i=0,o=N(r);i<r.length;i++)o+=r[i]*I(256,3-i);return o},eo=function(e){var t,r,i,n,s,a,o,l=[0,0,0,0,0,0,0,0],c=0,d=null,u=0,p=function(){return M(e,u)};if(":"==p()){if(":"!=M(e,1))return;u+=2,d=++c}for(;p();){if(8==c)return;if(":"==p()){if(null!==d)return;u++,d=++c;continue}for(t=r=0;r<4&&j(ee,p());)t=16*t+D(p(),16),u++,r++;if("."==p()){if(0==r||(u-=r,c>6))return;for(i=0;p();){if(n=null,i>0){if("."!=p()||!(i<4))return;u++}if(!j(Q,p()))return;for(;j(Q,p());){if(s=D(p(),10),null===n)n=s;else{if(0==n)return;n=10*n+s}if(n>255)return;u++}l[c]=256*l[c]+n,(2==++i||4==i)&&c++}if(4!=i)return;break}if(":"==p()){if(u++,!p())return}else if(p())return;l[c++]=t}if(null!==d)for(a=c-d,c=7;0!=c&&a>0;)o=l[c],l[c--]=l[d+a-1],l[d+--a]=o;else if(8!=c)return;return l},el=function(e){for(var t=null,r=1,i=null,n=0,s=0;s<8;s++)0!==e[s]?(n>r&&(t=i,r=n),i=null,n=0):(null===i&&(i=s),++n);return n>r&&(t=i,r=n),t},ec=function(e){var t,r,i,n;if("number"==typeof e){for(r=0,t=[];r<4;r++)V(t,e%256),e=L(e/256);return O(t,".")}if("object"==typeof e){for(r=0,t="",i=el(e);r<8;r++)(!n||0!==e[r])&&(n&&(n=!1),i===r?(t+=r?":":"::",n=!0):(t+=A(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},ed={},eu=m({},ed,{" ":1,'"':1,"<":1,">":1,"`":1}),ep=m({},eu,{"#":1,"?":1,"{":1,"}":1}),eh=m({},ep,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),em=function(e,t){var r=v(e,0);return r>32&&r<127&&!h(t,e)?e:encodeURIComponent(e)},ef={ftp:21,file:null,http:80,https:443,ws:80,wss:443},eg=function(e,t){var r;return 2==e.length&&j(K,M(e,0))&&(":"==(r=M(e,1))||!t&&"|"==r)},ev=function(e){var t;return e.length>1&&eg(H(e,0,2))&&(2==e.length||"/"===(t=M(e,2))||"\\"===t||"?"===t||"#"===t)},ey={},eb={},ew={},e_={},eS={},ex={},eC={},eT={},ek={},eR={},eE={},eP={},eD={},eL={},eI={},eM={},ej={},eO={},eA={},eN={},eF={},eq=function(e,t,r){var i,n,s,a=b(e);if(t){if(n=this.parse(a))throw P(n);this.searchParams=null}else{if(void 0!==r&&(i=new eq(r,!0)),n=this.parse(a,null,i))throw P(n);(s=R(new k)).bindURL(this),this.searchParams=s}};eq.prototype={type:"URL",parse:function(e,t,r){var n,s,a,o,l=this,c=t||ey,d=0,u="",p=!1,m=!1,v=!1;for(e=b(e),t||(l.scheme="",l.username="",l.password="",l.host=null,l.port=null,l.path=[],l.query=null,l.fragment=null,l.cannotBeABaseURL=!1,e=q(e,ei,""),e=q(e,en,"$1")),n=f(e=q(e,es,""));d<=n.length;){switch(s=n[d],c){case ey:if(s&&j(K,s))u+=z(s),c=eb;else{if(t)return $;c=ew;continue}break;case eb:if(s&&(j(G,s)||"+"==s||"-"==s||"."==s))u+=z(s);else if(":"==s){if(t&&(l.isSpecial()!=h(ef,u)||"file"==u&&(l.includesCredentials()||null!==l.port)||"file"==l.scheme&&!l.host))return;if(l.scheme=u,t){l.isSpecial()&&ef[l.scheme]==l.port&&(l.port=null);return}u="","file"==l.scheme?c=eL:l.isSpecial()&&r&&r.scheme==l.scheme?c=e_:l.isSpecial()?c=eT:"/"==n[d+1]?(c=eS,d++):(l.cannotBeABaseURL=!0,F(l.path,""),c=eA)}else{if(t)return $;u="",c=ew,d=0;continue}break;case ew:if(!r||r.cannotBeABaseURL&&"#"!=s)return $;if(r.cannotBeABaseURL&&"#"==s){l.scheme=r.scheme,l.path=g(r.path),l.query=r.query,l.fragment="",l.cannotBeABaseURL=!0,c=eF;break}c="file"==r.scheme?eL:ex;continue;case e_:if("/"==s&&"/"==n[d+1])c=ek,d++;else{c=ex;continue}break;case eS:if("/"==s){c=eR;break}c=eO;continue;case ex:if(l.scheme=r.scheme,s==i)l.username=r.username,l.password=r.password,l.host=r.host,l.port=r.port,l.path=g(r.path),l.query=r.query;else if("/"==s||"\\"==s&&l.isSpecial())c=eC;else if("?"==s)l.username=r.username,l.password=r.password,l.host=r.host,l.port=r.port,l.path=g(r.path),l.query="",c=eN;else if("#"==s)l.username=r.username,l.password=r.password,l.host=r.host,l.port=r.port,l.path=g(r.path),l.query=r.query,l.fragment="",c=eF;else{l.username=r.username,l.password=r.password,l.host=r.host,l.port=r.port,l.path=g(r.path),l.path.length--,c=eO;continue}break;case eC:if(l.isSpecial()&&("/"==s||"\\"==s))c=ek;else if("/"==s)c=eR;else{l.username=r.username,l.password=r.password,l.host=r.host,l.port=r.port,c=eO;continue}break;case eT:if(c=ek,"/"!=s||"/"!=M(u,d+1))continue;d++;break;case ek:if("/"!=s&&"\\"!=s){c=eR;continue}break;case eR:if("@"==s){p&&(u="%40"+u),p=!0,a=f(u);for(var y,w,_=0;_<a.length;_++){var S=a[_];if(":"==S&&!v){v=!0;continue}var x=em(S,eh);v?l.password+=x:l.username+=x}u=""}else if(s==i||"/"==s||"?"==s||"#"==s||"\\"==s&&l.isSpecial()){if(p&&""==u)return"Invalid authority";d-=f(u).length+1,u="",c=eE}else u+=s;break;case eE:case eP:if(t&&"file"==l.scheme){c=eM;continue}if(":"!=s||m){if(s==i||"/"==s||"?"==s||"#"==s||"\\"==s&&l.isSpecial()){if(l.isSpecial()&&""==u)return Z;if(t&&""==u&&(l.includesCredentials()||null!==l.port))return;if(o=l.parseHost(u))return o;if(u="",c=ej,t)return;continue}"["==s?m=!0:"]"==s&&(m=!1),u+=s}else{if(""==u)return Z;if(o=l.parseHost(u))return o;if(u="",c=eD,t==eP)return}break;case eD:if(j(Q,s))u+=s;else{if(!(s==i||"/"==s||"?"==s||"#"==s||"\\"==s&&l.isSpecial())&&!t)return W;if(""!=u){var C=D(u,10);if(C>65535)return W;l.port=l.isSpecial()&&C===ef[l.scheme]?null:C,u=""}if(t)return;c=ej;continue}break;case eL:if(l.scheme="file","/"==s||"\\"==s)c=eI;else if(r&&"file"==r.scheme){if(s==i)l.host=r.host,l.path=g(r.path),l.query=r.query;else if("?"==s)l.host=r.host,l.path=g(r.path),l.query="",c=eN;else if("#"==s)l.host=r.host,l.path=g(r.path),l.query=r.query,l.fragment="",c=eF;else{ev(O(g(n,d),""))||(l.host=r.host,l.path=g(r.path),l.shortenPath()),c=eO;continue}}else{c=eO;continue}break;case eI:if("/"==s||"\\"==s){c=eM;break}r&&"file"==r.scheme&&!ev(O(g(n,d),""))&&(eg(r.path[0],!0)?F(l.path,r.path[0]):l.host=r.host),c=eO;continue;case eM:if(s==i||"/"==s||"\\"==s||"?"==s||"#"==s){if(!t&&eg(u))c=eO;else if(""==u){if(l.host="",t)return;c=ej}else{if(o=l.parseHost(u))return o;if("localhost"==l.host&&(l.host=""),t)return;u="",c=ej}continue}u+=s;break;case ej:if(l.isSpecial()){if(c=eO,"/"!=s&&"\\"!=s)continue}else if(t||"?"!=s){if(t||"#"!=s){if(s!=i&&(c=eO,"/"!=s))continue}else l.fragment="",c=eF}else l.query="",c=eN;break;case eO:if(s==i||"/"==s||"\\"==s&&l.isSpecial()||!t&&("?"==s||"#"==s)){if(".."===(y=z(y=u))||"%2e."===y||".%2e"===y||"%2e%2e"===y?(l.shortenPath(),"/"==s||"\\"==s&&l.isSpecial()||F(l.path,"")):"."===(w=u)||"%2e"===z(w)?"/"==s||"\\"==s&&l.isSpecial()||F(l.path,""):("file"==l.scheme&&!l.path.length&&eg(u)&&(l.host&&(l.host=""),u=M(u,0)+":"),F(l.path,u)),u="","file"==l.scheme&&(s==i||"?"==s||"#"==s))for(;l.path.length>1&&""===l.path[0];)B(l.path);"?"==s?(l.query="",c=eN):"#"==s&&(l.fragment="",c=eF)}else u+=em(s,ep);break;case eA:"?"==s?(l.query="",c=eN):"#"==s?(l.fragment="",c=eF):s!=i&&(l.path[0]+=em(s,ed));break;case eN:t||"#"!=s?s!=i&&("'"==s&&l.isSpecial()?l.query+="%27":"#"==s?l.query+="%23":l.query+=em(s,ed)):(l.fragment="",c=eF);break;case eF:s!=i&&(l.fragment+=em(s,eu))}d++}},parseHost:function(e){var t,r,i;if("["==M(e,0)){if("]"!=M(e,e.length-1)||!(t=eo(H(e,1,-1))))return Z;this.host=t}else if(this.isSpecial()){if(j(et,e=y(e))||null===(t=ea(e)))return Z;this.host=t}else{if(j(er,e))return Z;for(i=0,t="",r=f(e);i<r.length;i++)t+=em(r[i],ed);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return h(ef,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;t&&("file"!=this.scheme||1!=t||!eg(e[0],!0))&&e.length--},serialize:function(){var e=this.scheme,t=this.username,r=this.password,i=this.host,n=this.port,s=this.path,a=this.query,o=this.fragment,l=e+":";return null!==i?(l+="//",this.includesCredentials()&&(l+=t+(r?":"+r:"")+"@"),l+=ec(i),null!==n&&(l+=":"+n)):"file"==e&&(l+="//"),l+=this.cannotBeABaseURL?s[0]:s.length?"/"+O(s,"/"):"",null!==a&&(l+="?"+a),null!==o&&(l+="#"+o),l},setHref:function(e){var t=this.parse(e);if(t)throw P(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new eB(e.path[0]).origin}catch(r){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ec(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(b(e)+":",ey)},getUsername:function(){return this.username},setUsername:function(e){var t=f(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=em(t[r],eh)}},getPassword:function(){return this.password},setPassword:function(e){var t=f(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=em(t[r],eh)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ec(e):ec(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,eE)},getHostname:function(){var e=this.host;return null===e?"":ec(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,eP)},getPort:function(){var e=this.port;return null===e?"":b(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=b(e))?this.port=null:this.parse(e,eD))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+O(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,ej))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=b(e))?this.query=null:("?"==M(e,0)&&(e=H(e,1)),this.query="",this.parse(e,eN)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){if(""==(e=b(e))){this.fragment=null;return}"#"==M(e,0)&&(e=H(e,1)),this.fragment="",this.parse(e,eF)},update:function(){this.query=this.searchParams.serialize()||null}};var eB=function(e){var t=p(this,eU),r=_(arguments.length,1)>1?arguments[1]:void 0,i=C(t,new eq(e,!1,r));s||(t.href=i.serialize(),t.origin=i.getOrigin(),t.protocol=i.getProtocol(),t.username=i.getUsername(),t.password=i.getPassword(),t.host=i.getHost(),t.hostname=i.getHostname(),t.port=i.getPort(),t.pathname=i.getPathname(),t.search=i.getSearch(),t.searchParams=i.getSearchParams(),t.hash=i.getHash())},eU=eB.prototype,eH=function(e,t){return{get:function(){return T(this)[e]()},set:t&&function(e){return T(this)[t](e)},configurable:!0,enumerable:!0}};if(s&&(u(eU,"href",eH("serialize","setHref")),u(eU,"origin",eH("getOrigin")),u(eU,"protocol",eH("getProtocol","setProtocol")),u(eU,"username",eH("getUsername","setUsername")),u(eU,"password",eH("getPassword","setPassword")),u(eU,"host",eH("getHost","setHost")),u(eU,"hostname",eH("getHostname","setHostname")),u(eU,"port",eH("getPort","setPort")),u(eU,"pathname",eH("getPathname","setPathname")),u(eU,"search",eH("getSearch","setSearch")),u(eU,"searchParams",eH("getSearchParams")),u(eU,"hash",eH("getHash","setHash"))),d(eU,"toJSON",function(){return T(this).serialize()},{enumerable:!0}),d(eU,"toString",function(){return T(this).serialize()},{enumerable:!0}),E){var ez=E.createObjectURL,eV=E.revokeObjectURL;ez&&d(eB,"createObjectURL",l(ez,E)),eV&&d(eB,"revokeObjectURL",l(eV,E))}w(eB,"URL"),n({global:!0,constructor:!0,forced:!a,sham:!s},{URL:eB})},60285:function(e,t,r){r(68789)},59435:function(e){function t(e,t,r,i){return Math.round(e/r)+" "+i+(t>=1.5*r?"s":"")}e.exports=function(e,r){r=r||{};var i,n,s=typeof e;if("string"===s&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(e);if("number"===s&&isFinite(e))return r.long?(i=Math.abs(e))>=864e5?t(e,i,864e5,"day"):i>=36e5?t(e,i,36e5,"hour"):i>=6e4?t(e,i,6e4,"minute"):i>=1e3?t(e,i,1e3,"second"):e+" ms":(n=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":n>=36e5?Math.round(e/36e5)+"h":n>=6e4?Math.round(e/6e4)+"m":n>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},11227:function(e,t,r){let i;var n=r(34155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let i=0,n=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(i++,"%c"===e&&(n=i))}),t.splice(n,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(r){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e},t.useColors=function(){return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(i=!1,()=>{i||(i=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(82447)(t);let{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},82447:function(e,t,r){e.exports=function(e){function t(e){let r,n,s;let a=null;function o(...e){if(!o.enabled)return;let i=o,n=Number(new Date),s=n-(r||n);i.diff=s,i.prev=r,i.curr=n,r=n,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return"%";a++;let s=t.formatters[n];if("function"==typeof s){let o=e[a];r=s.call(i,o),e.splice(a,1),a--}return r}),t.formatArgs.call(i,e);let l=i.log||t.log;l.apply(i,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=i,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(n!==t.namespaces&&(n=t.namespaces,s=t.enabled(e)),s),set:e=>{a=e}}),"function"==typeof t.init&&t.init(o),o}function i(e,r){let i=t(this.namespace+(void 0===r?":":r)+e);return i.log=this.log,i}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){let e=[...t.names.map(n),...t.skips.map(n).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];let i=("string"==typeof e?e:"").split(/[\s,]+/),n=i.length;for(r=0;r<n;r++)i[r]&&("-"===(e=i[r].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.slice(1)+"$")):t.names.push(RegExp("^"+e+"$")))},t.enabled=function(e){let r,i;if("*"===e[e.length-1])return!0;for(r=0,i=t.skips.length;r<i;r++)if(t.skips[r].test(e))return!1;for(r=0,i=t.names.length;r<i;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(59435),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let i=0;i<e.length;i++)r=(r<<5)-r+e.charCodeAt(i)|0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},57855:function(e,t,r){let i=r(11227)("h264-profile-level-id");i.log=console.info.bind(console),t.ProfileConstrainedBaseline=1,t.ProfileBaseline=2,t.ProfileMain=3,t.ProfileConstrainedHigh=4,t.ProfileHigh=5,t.Level1_b=0,t.Level1=10,t.Level1_1=11,t.Level1_2=12,t.Level1_3=13,t.Level2=20,t.Level2_1=21,t.Level2_2=22,t.Level3=30,t.Level3_1=31,t.Level3_2=32,t.Level4=40,t.Level4_1=41,t.Level4_2=42,t.Level5=50,t.Level5_1=51,t.Level5_2=52;class n{constructor(e,t){this.profile=e,this.level=t}}t.ProfileLevelId=n;let s=new n(1,31);class a{constructor(e){this._mask=~c("x",e),this._maskedValue=c("1",e)}isMatch(e){return this._maskedValue===(e&this._mask)}}class o{constructor(e,t,r){this.profile_idc=e,this.profile_iop=t,this.profile=r}}let l=[new o(66,new a("x1xx0000"),1),new o(77,new a("1xxx0000"),1),new o(88,new a("11xx0000"),1),new o(66,new a("x0xx0000"),2),new o(88,new a("10xx0000"),2),new o(77,new a("0x0x0000"),3),new o(100,new a("00000000"),5),new o(100,new a("00001100"),4)];function c(e,t){return(t[0]===e)<<7|(t[1]===e)<<6|(t[2]===e)<<5|(t[3]===e)<<4|(t[4]===e)<<3|(t[5]===e)<<2|(t[6]===e)<<1|(t[7]===e)<<0}function d(e={}){let t=e["level-asymmetry-allowed"];return 1===t||"1"===t}t.parseProfileLevelId=function(e){let t;if("string"!=typeof e||6!==e.length)return null;let r=parseInt(e,16);if(0===r)return null;let s=255&r,a=r>>8&255,o=r>>16&255;switch(s){case 11:t=(16&a)!=0?0:11;break;case 10:case 12:case 13:case 20:case 21:case 22:case 30:case 31:case 32:case 40:case 41:case 42:case 50:case 51:case 52:t=s;break;default:return i("parseProfileLevelId() | unrecognized level_idc:%s",s),null}for(let c of l)if(o===c.profile_idc&&c.profile_iop.isMatch(a))return new n(c.profile,t);return i("parseProfileLevelId() | unrecognized profile_idc/profile_iop combination"),null},t.profileLevelIdToString=function(e){let t;if(0==e.level)switch(e.profile){case 1:return"42f00b";case 2:return"42100b";case 3:return"4d100b";default:return i("profileLevelIdToString() | Level 1_b not is allowed for profile:%s",e.profile),null}switch(e.profile){case 1:t="42e0";break;case 2:t="4200";break;case 3:t="4d00";break;case 4:t="640c";break;case 5:t="6400";break;default:return i("profileLevelIdToString() | unrecognized profile:%s",e.profile),null}let r=e.level.toString(16);return 1===r.length&&(r=`0${r}`),`${t}${r}`},t.parseSdpProfileLevelId=function(e={}){let r=e["profile-level-id"];return r?t.parseProfileLevelId(r):s},t.isSameProfile=function(e={},r={}){let i=t.parseSdpProfileLevelId(e),n=t.parseSdpProfileLevelId(r);return Boolean(i&&n&&i.profile===n.profile)},t.generateProfileLevelIdForAnswer=function(e={},r={}){var s,a;if(!e["profile-level-id"]&&!r["profile-level-id"])return i("generateProfileLevelIdForAnswer() | no profile-level-id in local and remote params"),null;let o=t.parseSdpProfileLevelId(e),l=t.parseSdpProfileLevelId(r);if(!o)throw TypeError("invalid local_profile_level_id");if(!l)throw TypeError("invalid remote_profile_level_id");if(o.profile!==l.profile)throw TypeError("H264 Profile mismatch");let c=d(e)&&d(r),u=o.level,p=l.level,h=(s=u,a=p,(0===s?10!==a&&0!==a:0===a?10!==s:s<a)?s:a),m=c?u:h;return i("generateProfileLevelIdForAnswer() | result: [profile:%s, level:%s]",o.profile,m),t.profileLevelIdToString(new n(o.profile,m))}},59514:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Consumer=void 0;let i=r(38562),n=r(54493),s=r(99992),a=new i.Logger("Consumer");class o extends n.EnhancedEventEmitter{constructor({id:e,localId:t,producerId:r,rtpReceiver:i,track:s,rtpParameters:o,appData:l}){super(),this._closed=!1,this._observer=new n.EnhancedEventEmitter,a.debug("constructor()"),this._id=e,this._localId=t,this._producerId=r,this._rtpReceiver=i,this._track=s,this._rtpParameters=o,this._paused=!s.enabled,this._appData=l||{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(a.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new s.InvalidStateError("closed");return new Promise((e,t)=>{this.safeEmit("@getstats",e,t)})}pause(){if(a.debug("pause()"),this._closed){a.error("pause() | Consumer closed");return}if(this._paused){a.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(a.debug("resume()"),this._closed){a.error("resume() | Consumer closed");return}if(!this._paused){a.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){a.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch(e){}}}t.Consumer=o},31623:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataConsumer=void 0;let i=r(38562),n=r(54493),s=new i.Logger("DataConsumer");class a extends n.EnhancedEventEmitter{constructor({id:e,dataProducerId:t,dataChannel:r,sctpStreamParameters:i,appData:a}){super(),this._closed=!1,this._observer=new n.EnhancedEventEmitter,s.debug("constructor()"),this._id=e,this._dataProducerId=t,this._dataChannel=r,this._sctpStreamParameters=i,this._appData=a||{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(e){this._dataChannel.binaryType=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(s.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(s.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(s.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:t}=e;t||(t=Error("unknown DataChannel error")),"sctp-failure"===t.errorDetail?s.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.sctpCauseCode,t.message):s.error('DataChannel "error" event: %o',t),this.safeEmit("error",t)}),this._dataChannel.addEventListener("close",()=>{this._closed||(s.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",e=>{this._closed||this.safeEmit("message",e.data)})}}t.DataConsumer=a},25504:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataProducer=void 0;let i=r(38562),n=r(54493),s=r(99992),a=new i.Logger("DataProducer");class o extends n.EnhancedEventEmitter{constructor({id:e,dataChannel:t,sctpStreamParameters:r,appData:i}){super(),this._closed=!1,this._observer=new n.EnhancedEventEmitter,a.debug("constructor()"),this._id=e,this._dataChannel=t,this._sctpStreamParameters=r,this._appData=i||{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(e){this._dataChannel.bufferedAmountLowThreshold=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(a.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(e){if(a.debug("send()"),this._closed)throw new s.InvalidStateError("closed");this._dataChannel.send(e)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(a.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:t}=e;t||(t=Error("unknown DataChannel error")),"sctp-failure"===t.errorDetail?a.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.sctpCauseCode,t.message):a.error('DataChannel "error" event: %o',t),this.safeEmit("error",t)}),this._dataChannel.addEventListener("close",()=>{this._closed||(a.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||a.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}}t.DataProducer=o},43120:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Device=t.detectDevice=void 0;let a=r(42238),o=r(38562),l=r(54493),c=r(99992),d=s(r(13347)),u=s(r(45280)),p=r(35202),h=r(32960),m=r(66656),f=r(75372),g=r(5697),v=r(20564),y=r(61419),b=r(29862),w=r(32205),_=r(37392),S=r(23433),x=r(44770),C=new o.Logger("Device");function T(){if("object"==typeof navigator&&"ReactNative"===navigator.product){if(C.debug("detectDevice() | React-Native detected"),"undefined"==typeof RTCPeerConnection){C.warn("detectDevice() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?");return}return"undefined"!=typeof RTCRtpTransceiver?(C.debug("detectDevice() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(C.debug("detectDevice() | ReactNative PlanB handler chosen"),"ReactNative")}if("object"==typeof navigator&&"string"==typeof navigator.userAgent){let e=navigator.userAgent,t=new a.UAParser(e);C.debug("detectDevice() | browser detected [ua:%s, parsed:%o]",e,t.getResult());let r=t.getBrowser(),i=r.name?.toLowerCase()??"",n=parseInt(r.major??"0"),s=t.getEngine(),o=s.name?.toLowerCase()??"",l=t.getOS(),c=l.name?.toLowerCase()??"",d=parseFloat(l.version??"0"),u="ios"===c,p=["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(i),h=["firefox","mobile firefox","mobile focus"].includes(i),m=["safari","mobile safari"].includes(i),f=["edge"].includes(i);if((p||f)&&!u&&n>=111)return"Chrome111";if(p&&!u&&n>=74||f&&!u&&n>=88)return"Chrome74";if(p&&!u&&n>=70)return"Chrome70";if(p&&!u&&n>=67)return"Chrome67";else if(p&&!u&&n>=55)return"Chrome55";else if(h&&!u&&n>=60)return"Firefox60";else if(h&&u&&d>=14.3)return"Safari12";else if(m&&n>=12&&"undefined"!=typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";else if(m&&n>=11)return"Safari11";else if(f&&!u&&n>=11&&n<=18)return"Edge11";else if("webkit"===o&&u&&d>=14.3&&"undefined"!=typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";else if("blink"===o){let g=e.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(!g)return"Chrome111";{let v=Number(g[1]);return v>=111?"Chrome111":v>=74?"Chrome74":v>=70?"Chrome70":v>=67?"Chrome67":"Chrome55"}}else{C.warn("detectDevice() | browser not supported [name:%s, version:%s]",i,n);return}}C.warn("detectDevice() | unknown device")}t.detectDevice=T,t.Device=class{constructor({handlerName:e,handlerFactory:t,Handler:r}={}){if(this._loaded=!1,this._observer=new l.EnhancedEventEmitter,C.debug("constructor()"),r){if(C.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),"string"==typeof r)e=r;else throw TypeError("non string Handler option no longer supported, use handlerFactory instead")}if(e&&t)throw TypeError("just one of handlerName or handlerInterface can be given");if(t)this._handlerFactory=t;else{if(e)C.debug("constructor() | handler given: %s",e);else if(e=T())C.debug("constructor() | detected handler: %s",e);else throw new c.UnsupportedError("device not supported");switch(e){case"Chrome111":this._handlerFactory=h.Chrome111.createFactory();break;case"Chrome74":this._handlerFactory=m.Chrome74.createFactory();break;case"Chrome70":this._handlerFactory=f.Chrome70.createFactory();break;case"Chrome67":this._handlerFactory=g.Chrome67.createFactory();break;case"Chrome55":this._handlerFactory=v.Chrome55.createFactory();break;case"Firefox60":this._handlerFactory=y.Firefox60.createFactory();break;case"Safari12":this._handlerFactory=b.Safari12.createFactory();break;case"Safari11":this._handlerFactory=w.Safari11.createFactory();break;case"Edge11":this._handlerFactory=_.Edge11.createFactory();break;case"ReactNativeUnifiedPlan":this._handlerFactory=S.ReactNativeUnifiedPlan.createFactory();break;case"ReactNative":this._handlerFactory=x.ReactNative.createFactory();break;default:throw TypeError(`unknown handlerName "${e}"`)}}let i=this._handlerFactory();this._handlerName=i.name,i.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new c.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new c.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}async load({routerRtpCapabilities:e}){let t;C.debug("load() [routerRtpCapabilities:%o]",e),e=d.clone(e,void 0);try{if(this._loaded)throw new c.InvalidStateError("already loaded");u.validateRtpCapabilities(e),t=this._handlerFactory();let r=await t.getNativeRtpCapabilities();C.debug("load() | got native RTP capabilities:%o",r),u.validateRtpCapabilities(r),this._extendedRtpCapabilities=u.getExtendedRtpCapabilities(r,e),C.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=u.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=u.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=u.getRecvRtpCapabilities(this._extendedRtpCapabilities),u.validateRtpCapabilities(this._recvRtpCapabilities),C.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._sctpCapabilities=await t.getNativeSctpCapabilities(),C.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),u.validateSctpCapabilities(this._sctpCapabilities),C.debug("load() succeeded"),this._loaded=!0,t.close()}catch(i){throw t&&t.close(),i}}canProduce(e){if(this._loaded){if("audio"!==e&&"video"!==e)throw TypeError(`invalid kind "${e}"`)}else throw new c.InvalidStateError("not loaded");return this._canProduceByKind[e]}createSendTransport({id:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,appData:c}){return C.debug("createSendTransport()"),this.createTransport({direction:"send",id:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,appData:c})}createRecvTransport({id:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,appData:c}){return C.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,appData:c})}createTransport({direction:e,id:t,iceParameters:r,iceCandidates:i,dtlsParameters:n,sctpParameters:s,iceServers:a,iceTransportPolicy:o,additionalSettings:l,proprietaryConstraints:d,appData:u}){if(this._loaded){if("string"!=typeof t)throw TypeError("missing id");if("object"!=typeof r)throw TypeError("missing iceParameters");if(Array.isArray(i)){if("object"!=typeof n)throw TypeError("missing dtlsParameters");if(s&&"object"!=typeof s)throw TypeError("wrong sctpParameters");if(u&&"object"!=typeof u)throw TypeError("if given, appData must be an object")}else throw TypeError("missing iceCandidates")}else throw new c.InvalidStateError("not loaded");let h=new p.Transport({direction:e,id:t,iceParameters:r,iceCandidates:i,dtlsParameters:n,sctpParameters:s,iceServers:a,iceTransportPolicy:o,additionalSettings:l,proprietaryConstraints:d,appData:u,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",h),h}}},54493:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnhancedEventEmitter=void 0;let i=r(17187),n=r(38562),s=new n.Logger("EnhancedEventEmitter");class a extends i.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}emit(e,...t){return super.emit(e,...t)}safeEmit(e,...t){let r=super.listenerCount(e);try{return super.emit(e,...t)}catch(i){return s.error("safeEmit() | event listener threw an error [eventName:%s]:%o",e,i),Boolean(r)}}on(e,t){return super.on(e,t),this}off(e,t){return super.off(e,t),this}addListener(e,t){return super.on(e,t),this}prependListener(e,t){return super.prependListener(e,t),this}once(e,t){return super.once(e,t),this}prependOnceListener(e,t){return super.prependOnceListener(e,t),this}removeListener(e,t){return super.off(e,t),this}removeAllListeners(e){return super.removeAllListeners(e),this}listenerCount(e){return super.listenerCount(e)}listeners(e){return super.listeners(e)}rawListeners(e){return super.rawListeners(e)}}t.EnhancedEventEmitter=a},38562:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;let n=i(r(11227)),s="mediasoup-client";t.Logger=class{constructor(e){e?(this._debug=(0,n.default)(`${s}:${e}`),this._warn=(0,n.default)(`${s}:WARN:${e}`),this._error=(0,n.default)(`${s}:ERROR:${e}`)):(this._debug=(0,n.default)(s),this._warn=(0,n.default)(`${s}:WARN`),this._error=(0,n.default)(`${s}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}},26569:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Producer=void 0;let i=r(38562),n=r(54493),s=r(99992),a=new i.Logger("Producer");class o extends n.EnhancedEventEmitter{constructor({id:e,localId:t,rtpSender:r,track:i,rtpParameters:s,stopTracks:o,disableTrackOnPause:l,zeroRtpOnPause:c,appData:d}){super(),this._closed=!1,this._observer=new n.EnhancedEventEmitter,a.debug("constructor()"),this._id=e,this._localId=t,this._rtpSender=r,this._track=i,this._kind=i.kind,this._rtpParameters=s,this._paused=!!l&&!i.enabled,this._maxSpatialLayer=void 0,this._stopTracks=o,this._disableTrackOnPause=l,this._zeroRtpOnPause=c,this._appData=d||{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(a.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new s.InvalidStateError("closed");return new Promise((e,t)=>{this.safeEmit("@getstats",e,t)})}pause(){if(a.debug("pause()"),this._closed){a.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((e,t)=>{this.safeEmit("@pause",e,t)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(a.debug("resume()"),this._closed){a.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((e,t)=>{this.safeEmit("@resume",e,t)}).catch(()=>{}),this._observer.safeEmit("resume")}async replaceTrack({track:e}){if(a.debug("replaceTrack() [track:%o]",e),this._closed){if(e&&this._stopTracks)try{e.stop()}catch(t){}throw new s.InvalidStateError("closed")}if(e&&"ended"===e.readyState)throw new s.InvalidStateError("track ended");if(e===this._track){a.debug("replaceTrack() | same track, ignored");return}await new Promise((t,r)=>{this.safeEmit("@replacetrack",e,t,r)}),this.destroyTrack(),this._track=e,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()}async setMaxSpatialLayer(e){if(this._closed)throw new s.InvalidStateError("closed");if("video"!==this._kind)throw new s.UnsupportedError("not a video Producer");if("number"!=typeof e)throw TypeError("invalid spatialLayer");e!==this._maxSpatialLayer&&(await new Promise((t,r)=>{this.safeEmit("@setmaxspatiallayer",e,t,r)}).catch(()=>{}),this._maxSpatialLayer=e)}async setRtpEncodingParameters(e){if(this._closed)throw new s.InvalidStateError("closed");if("object"!=typeof e)throw TypeError("invalid params");await new Promise((t,r)=>{this.safeEmit("@setrtpencodingparameters",e,t,r)})}onTrackEnded(){a.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch(e){}}}t.Producer=o},94879:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},37669:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},35202:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;let o=r(32186),l=a(r(54375)),c=r(38562),d=r(54493),u=r(99992),p=s(r(13347)),h=s(r(45280)),m=r(26569),f=r(59514),g=r(25504),v=r(31623),y=new c.Logger("Transport");class b{constructor(e){this.consumerOptions=e,this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class w extends d.EnhancedEventEmitter{constructor({direction:e,id:t,iceParameters:r,iceCandidates:i,dtlsParameters:n,sctpParameters:s,iceServers:a,iceTransportPolicy:l,additionalSettings:c,proprietaryConstraints:u,appData:h,handlerFactory:m,extendedRtpCapabilities:f,canProduceByKind:g}){super(),this._closed=!1,this._connectionState="new",this._producers=new Map,this._consumers=new Map,this._dataProducers=new Map,this._dataConsumers=new Map,this._probatorConsumerCreated=!1,this._awaitQueue=new o.AwaitQueue,this._pendingConsumerTasks=[],this._consumerCreationInProgress=!1,this._pendingPauseConsumers=new Map,this._consumerPauseInProgress=!1,this._pendingResumeConsumers=new Map,this._consumerResumeInProgress=!1,this._pendingCloseConsumers=new Map,this._consumerCloseInProgress=!1,this._observer=new d.EnhancedEventEmitter,y.debug("constructor() [id:%s, direction:%s]",t,e),this._id=t,this._direction=e,this._extendedRtpCapabilities=f,this._canProduceByKind=g,this._maxSctpMessageSize=s?s.maxMessageSize:null,delete(c=p.clone(c,{})).iceServers,delete c.iceTransportPolicy,delete c.bundlePolicy,delete c.rtcpMuxPolicy,delete c.sdpSemantics,this._handler=m(),this._handler.run({direction:e,iceParameters:r,iceCandidates:i,dtlsParameters:n,sctpParameters:s,iceServers:a,iceTransportPolicy:l,additionalSettings:c,proprietaryConstraints:u,extendedRtpCapabilities:f}),this._appData=h||{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){if(!this._closed){for(let e of(y.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._producers.values()))e.transportClosed();for(let t of(this._producers.clear(),this._consumers.values()))t.transportClosed();for(let r of(this._consumers.clear(),this._dataProducers.values()))r.transportClosed();for(let i of(this._dataProducers.clear(),this._dataConsumers.values()))i.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close")}}async getStats(){if(this._closed)throw new u.InvalidStateError("closed");return this._handler.getTransportStats()}async restartIce({iceParameters:e}){if(y.debug("restartIce()"),this._closed)throw new u.InvalidStateError("closed");if(!e)throw TypeError("missing iceParameters");return this._awaitQueue.push(async()=>await this._handler.restartIce(e),"transport.restartIce()")}async updateIceServers({iceServers:e}={}){if(y.debug("updateIceServers()"),this._closed)throw new u.InvalidStateError("closed");if(!Array.isArray(e))throw TypeError("missing iceServers");return this._awaitQueue.push(async()=>this._handler.updateIceServers(e),"transport.updateIceServers()")}async produce({track:e,encodings:t,codecOptions:r,codec:i,stopTracks:n=!0,disableTrackOnPause:s=!0,zeroRtpOnPause:a=!1,appData:o={}}={}){if(y.debug("produce() [track:%o]",e),this._closed)throw new u.InvalidStateError("closed");if(e){if("send"!==this._direction)throw new u.UnsupportedError("not a sending Transport");if(this._canProduceByKind[e.kind]){if("ended"===e.readyState)throw new u.InvalidStateError("track ended");if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw TypeError('no "connect" listener set into this transport');if(0===this.listenerCount("produce"))throw TypeError('no "produce" listener set into this transport');else if(o&&"object"!=typeof o)throw TypeError("if given, appData must be an object")}else throw new u.UnsupportedError(`cannot produce ${e.kind}`)}else throw TypeError("missing track");return this._awaitQueue.push(async()=>{let l;if(t&&!Array.isArray(t))throw TypeError("encodings must be an array");t&&0===t.length?l=void 0:t&&(l=t.map(e=>{let t={active:!0};return!1===e.active&&(t.active=!1),"boolean"==typeof e.dtx&&(t.dtx=e.dtx),"string"==typeof e.scalabilityMode&&(t.scalabilityMode=e.scalabilityMode),"number"==typeof e.scaleResolutionDownBy&&(t.scaleResolutionDownBy=e.scaleResolutionDownBy),"number"==typeof e.maxBitrate&&(t.maxBitrate=e.maxBitrate),"number"==typeof e.maxFramerate&&(t.maxFramerate=e.maxFramerate),"boolean"==typeof e.adaptivePtime&&(t.adaptivePtime=e.adaptivePtime),"string"==typeof e.priority&&(t.priority=e.priority),"string"==typeof e.networkPriority&&(t.networkPriority=e.networkPriority),t}));let{localId:c,rtpParameters:d,rtpSender:u}=await this._handler.send({track:e,encodings:l,codecOptions:r,codec:i});try{h.validateRtpParameters(d);let{id:p}=await new Promise((t,r)=>{this.safeEmit("produce",{kind:e.kind,rtpParameters:d,appData:o},t,r)}),f=new m.Producer({id:p,localId:c,rtpSender:u,track:e,rtpParameters:d,stopTracks:n,disableTrackOnPause:s,zeroRtpOnPause:a,appData:o});return this._producers.set(f.id,f),this.handleProducer(f),this._observer.safeEmit("newproducer",f),f}catch(g){throw this._handler.stopSending(c).catch(()=>{}),g}},"transport.produce()").catch(t=>{if(n)try{e.stop()}catch(r){}throw t})}async consume({id:e,producerId:t,kind:r,rtpParameters:i,streamId:n,appData:s={}}){if(y.debug("consume()"),i=p.clone(i,void 0),this._closed)throw new u.InvalidStateError("closed");if("recv"!==this._direction)throw new u.UnsupportedError("not a receiving Transport");if("string"!=typeof e)throw TypeError("missing id");if("string"!=typeof t)throw TypeError("missing producerId");if("audio"!==r&&"video"!==r)throw TypeError(`invalid kind '${r}'`);if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw TypeError('no "connect" listener set into this transport');if(s&&"object"!=typeof s)throw TypeError("if given, appData must be an object");let a=h.canReceive(i,this._extendedRtpCapabilities);if(!a)throw new u.UnsupportedError("cannot consume this Producer");let o=new b({id:e,producerId:t,kind:r,rtpParameters:i,streamId:n,appData:s});return this._pendingConsumerTasks.push(o),(0,l.default)(()=>{this._closed||!1!==this._consumerCreationInProgress||this.createPendingConsumers()}),o.promise}async produceData({ordered:e=!0,maxPacketLifeTime:t,maxRetransmits:r,label:i="",protocol:n="",appData:s={}}={}){if(y.debug("produceData()"),this._closed)throw new u.InvalidStateError("closed");if("send"!==this._direction)throw new u.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw TypeError('no "connect" listener set into this transport');if(0===this.listenerCount("producedata"))throw TypeError('no "producedata" listener set into this transport');if(s&&"object"!=typeof s)throw TypeError("if given, appData must be an object")}else throw new u.UnsupportedError("SCTP not enabled by remote Transport");return(t||r)&&(e=!1),this._awaitQueue.push(async()=>{let{dataChannel:a,sctpStreamParameters:o}=await this._handler.sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n});h.validateSctpStreamParameters(o);let{id:l}=await new Promise((e,t)=>{this.safeEmit("producedata",{sctpStreamParameters:o,label:i,protocol:n,appData:s},e,t)}),c=new g.DataProducer({id:l,dataChannel:a,sctpStreamParameters:o,appData:s});return this._dataProducers.set(c.id,c),this.handleDataProducer(c),this._observer.safeEmit("newdataproducer",c),c},"transport.produceData()")}async consumeData({id:e,dataProducerId:t,sctpStreamParameters:r,label:i="",protocol:n="",appData:s={}}){if(y.debug("consumeData()"),r=p.clone(r,void 0),this._closed)throw new u.InvalidStateError("closed");if("recv"!==this._direction)throw new u.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if("string"!=typeof e)throw TypeError("missing id");if("string"!=typeof t)throw TypeError("missing dataProducerId");if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw TypeError('no "connect" listener set into this transport');else if(s&&"object"!=typeof s)throw TypeError("if given, appData must be an object")}else throw new u.UnsupportedError("SCTP not enabled by remote Transport");return h.validateSctpStreamParameters(r),this._awaitQueue.push(async()=>{let{dataChannel:a}=await this._handler.receiveDataChannel({sctpStreamParameters:r,label:i,protocol:n}),o=new v.DataConsumer({id:e,dataProducerId:t,dataChannel:a,sctpStreamParameters:r,appData:s});return this._dataConsumers.set(o.id,o),this.handleDataConsumer(o),this._observer.safeEmit("newdataconsumer",o),o},"transport.consumeData()")}async createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(async()=>{let e;if(0===this._pendingConsumerTasks.length){y.debug("createPendingConsumers() | there is no Consumer to be created");return}let t=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let r=[];for(let i of t){let{id:n,kind:s,rtpParameters:a,streamId:o}=i.consumerOptions;r.push({trackId:n,kind:s,rtpParameters:a,streamId:o})}try{let l=await this._handler.receive(r);for(let c=0;c<l.length;++c){let d=t[c],u=l[c],{id:p,producerId:m,kind:g,rtpParameters:v,appData:b}=d.consumerOptions,{localId:w,rtpReceiver:_,track:S}=u,x=new f.Consumer({id:p,localId:w,producerId:m,rtpReceiver:_,track:S,rtpParameters:v,appData:b});this._consumers.set(x.id,x),this.handleConsumer(x),this._probatorConsumerCreated||e||"video"!==g||(e=x),this._observer.safeEmit("newconsumer",x),d.resolve(x)}}catch(T){for(let C of t)C.reject(T)}if(e)try{let k=h.generateProbatorRtpParameters(e.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:k}]),y.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(R){y.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",R)}},"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(async()=>{if(0===this._pendingPauseConsumers.size){y.debug("pausePendingConsumers() | there is no Consumer to be paused");return}let e=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{let t=e.map(e=>e.localId);await this._handler.pauseReceiving(t)}catch(r){y.error("pausePendingConsumers() | failed to pause Consumers:",r)}},"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(async()=>{if(0===this._pendingResumeConsumers.size){y.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}let e=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{let t=e.map(e=>e.localId);await this._handler.resumeReceiving(t)}catch(r){y.error("resumePendingConsumers() | failed to resume Consumers:",r)}},"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(async()=>{if(0===this._pendingCloseConsumers.size){y.debug("closePendingConsumers() | there is no Consumer to be closed");return}let e=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(e.map(e=>e.localId))}catch(t){y.error("closePendingConsumers() | failed to close Consumers:",t)}},"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){let e=this._handler;e.on("@connect",({dtlsParameters:e},t,r)=>{if(this._closed){r(new u.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:e},t,r)}),e.on("@connectionstatechange",e=>{e!==this._connectionState&&(y.debug("connection state changed to %s",e),this._connectionState=e,this._closed||this.safeEmit("connectionstatechange",e))})}handleProducer(e){e.on("@close",()=>{this._producers.delete(e.id),this._closed||this._awaitQueue.push(async()=>await this._handler.stopSending(e.localId),"producer @close event").catch(e=>y.warn("producer.close() failed:%o",e))}),e.on("@pause",(t,r)=>{this._awaitQueue.push(async()=>await this._handler.pauseSending(e.localId),"producer @pause event").then(t).catch(r)}),e.on("@resume",(t,r)=>{this._awaitQueue.push(async()=>await this._handler.resumeSending(e.localId),"producer @resume event").then(t).catch(r)}),e.on("@replacetrack",(t,r,i)=>{this._awaitQueue.push(async()=>await this._handler.replaceTrack(e.localId,t),"producer @replacetrack event").then(r).catch(i)}),e.on("@setmaxspatiallayer",(t,r,i)=>{this._awaitQueue.push(async()=>await this._handler.setMaxSpatialLayer(e.localId,t),"producer @setmaxspatiallayer event").then(r).catch(i)}),e.on("@setrtpencodingparameters",(t,r,i)=>{this._awaitQueue.push(async()=>await this._handler.setRtpEncodingParameters(e.localId,t),"producer @setrtpencodingparameters event").then(r).catch(i)}),e.on("@getstats",(t,r)=>{if(this._closed)return r(new u.InvalidStateError("closed"));this._handler.getSenderStats(e.localId).then(t).catch(r)})}handleConsumer(e){e.on("@close",()=>{this._consumers.delete(e.id),this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.delete(e.id),this._closed||(this._pendingCloseConsumers.set(e.id,e),!1===this._consumerCloseInProgress&&this.closePendingConsumers())}),e.on("@pause",()=>{this._pendingResumeConsumers.has(e.id)&&this._pendingResumeConsumers.delete(e.id),this._pendingPauseConsumers.set(e.id,e),(0,l.default)(()=>{this._closed||!1!==this._consumerPauseInProgress||this.pausePendingConsumers()})}),e.on("@resume",()=>{this._pendingPauseConsumers.has(e.id)&&this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.set(e.id,e),(0,l.default)(()=>{this._closed||!1!==this._consumerResumeInProgress||this.resumePendingConsumers()})}),e.on("@getstats",(t,r)=>{if(this._closed)return r(new u.InvalidStateError("closed"));this._handler.getReceiverStats(e.localId).then(t).catch(r)})}handleDataProducer(e){e.on("@close",()=>{this._dataProducers.delete(e.id)})}handleDataConsumer(e){e.on("@close",()=>{this._dataConsumers.delete(e.id)})}}t.Transport=w},99992:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidStateError=t.UnsupportedError=void 0;class r extends Error{constructor(e){super(e),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,r):this.stack=Error(e).stack}}t.UnsupportedError=r;class i extends Error{constructor(e){super(e),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,i):this.stack=Error(e).stack}}t.InvalidStateError=i},32960:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome111=void 0;let a=s(r(70766)),o=r(38562),l=s(r(13347)),c=s(r(45280)),d=s(r(82267)),u=s(r(29072)),p=s(r(58954)),h=r(99992),m=r(89316),f=r(37910),g=r(82770),v=new o.Logger("Chrome111"),y={OS:1024,MIS:1024};class b extends m.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome111"}close(){if(v.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");let t=await e.createOffer();try{e.close()}catch(r){}let i=a.parse(t.sdp),n=d.extractRtpCapabilities({sdpObject:i});return p.addNackSuppportForOpus(n),n}catch(o){try{e.close()}catch(s){}throw o}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:y}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),v.debug("run()"),this._direction=e,this._remoteSdp=new f.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){this.assertNotClosed(),v.debug("updateIceServers()");let t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(this.assertNotClosed(),v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){if(this.assertNotClosed(),this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&t.length>1){t.forEach((e,t)=>{e.rid=`r${t}`});let n=1,s=1;for(let o of t){let p=o.scalabilityMode?(0,g.parse)(o.scalabilityMode).temporalLayers:3;p>s&&(s=p)}for(let h of t)h.rid=`r${n++}`,h.scalabilityMode=`L1T${s}`}let m=l.clone(this._sendingRtpParametersByKind[e.kind],{});m.codecs=c.reduceCodecs(m.codecs,i);let f=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});f.codecs=c.reduceCodecs(f.codecs,i);let y=this._remoteSdp.getNextMediaSectionIdx(),b=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:t}),w=await this._pc.createOffer(),_=a.parse(w.sdp);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:_}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",w),await this._pc.setLocalDescription(w);let S=b.mid;m.mid=S,_=a.parse(this._pc.localDescription.sdp);let x=_.media[y.idx];if(m.rtcp.cname=d.getCname({offerMediaObject:x}),t){if(1===t.length){let C=u.getRtpEncodings({offerMediaObject:x});Object.assign(C[0],t[0]),m.encodings=C}else m.encodings=t}else m.encodings=u.getRtpEncodings({offerMediaObject:x});this._remoteSdp.send({offerMediaObject:x,reuseMid:y.reuseMid,offerRtpParameters:m,answerRtpParameters:f,codecOptions:r,extmapAllowMixed:!0});let T={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",T),await this._pc.setRemoteDescription(T),this._mapMidTransceiver.set(S,b),{localId:S,rtpParameters:m,rtpSender:b.sender}}async stopSending(e){if(this.assertSendDirection(),v.debug("stopSending() [localId:%s]",e),this._closed)return;let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);let r=this._remoteSdp.closeMediaSection(t.mid);if(r)try{t.stop()}catch(i){}let n=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("pauseSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);let r=await this._pc.createOffer();v.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("resumeSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw Error("associated RTCRtpTransceiver not found");t.direction="sendonly";let r=await this._pc.createOffer();v.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?v.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):v.debug("replaceTrack() [localId:%s, no track]",e);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{r<=t?e.active=!0:e.active=!1}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{i.encodings[r]={...e,...t}}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertNotClosed(),this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:r,protocol:n};v.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%y.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c}),v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();let t=[],r=new Map;for(let i of e){let{trackId:n,kind:s,rtpParameters:o,streamId:l}=i;v.debug("receive() [trackId:%s, kind:%s]",n,s);let c=o.mid||String(this._mapMidTransceiver.size);r.set(n,c),this._remoteSdp.receive({mid:c,kind:s,offerRtpParameters:o,streamId:l||o.rtcp.cname,trackId:n})}let u={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",u),await this._pc.setRemoteDescription(u);let p=await this._pc.createAnswer(),h=a.parse(p.sdp);for(let m of e){let{trackId:f,rtpParameters:g}=m,y=r.get(f),b=h.media.find(e=>String(e.mid)===y);d.applyCodecParameters({offerRtpParameters:g,answerMediaObject:b})}for(let w of(p={type:"answer",sdp:a.write(h)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:h}),v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),e)){let{trackId:_}=w,S=r.get(_),x=this._pc.getTransceivers().find(e=>e.mid===S);if(x)this._mapMidTransceiver.set(S,x),t.push({localId:S,track:x.receiver.track,rtpReceiver:x.receiver});else throw Error("new RTCRtpTransceiver not found")}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(let t of e){v.debug("stopReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(r.mid)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();for(let s of(v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n),e))this._mapMidTransceiver.delete(s)}async pauseReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){v.debug("pauseReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){v.debug("resumeReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o,protocol:r};v.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();let d={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=d.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new h.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.Chrome111=b},20564:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome55=void 0;let a=s(r(70766)),o=r(38562),l=r(99992),c=s(r(13347)),d=s(r(45280)),u=s(r(82267)),p=s(r(89875)),h=r(89316),m=r(37910),f=new o.Logger("Chrome55"),g={OS:1024,MIS:1024};class v extends h.HandlerInterface{static createFactory(){return()=>new v}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome55"}close(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){f.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{let t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(r){}let i=a.parse(t.sdp),n=u.extractRtpCapabilities({sdpObject:i});return n}catch(o){try{e.close()}catch(s){}throw o}}async getNativeSctpCapabilities(){return f.debug("getNativeSctpCapabilities()"),{numStreams:g}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:c}){f.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,planB:!0}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){f.debug("updateIceServers()");let t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){let n;this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&f.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let s=await this._pc.createOffer(),o=a.parse(s.sdp),l=c.clone(this._sendingRtpParametersByKind[e.kind],{});l.codecs=d.reduceCodecs(l.codecs);let h=c.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(h.codecs=d.reduceCodecs(h.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),"video"===e.kind&&t&&t.length>1&&(f.debug("send() | enabling simulcast"),n=(o=a.parse(s.sdp)).media.find(e=>"video"===e.type),p.addLegacySimulcast({offerMediaObject:n,track:e,numStreams:t.length}),s={type:"offer",sdp:a.write(o)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),n=(o=a.parse(this._pc.localDescription.sdp)).media.find(t=>t.type===e.kind),l.rtcp.cname=u.getCname({offerMediaObject:n}),l.encodings=p.getRtpEncodings({offerMediaObject:n,track:e}),t)for(let m=0;m<l.encodings.length;++m)t[m]&&Object.assign(l.encodings[m],t[m]);if(l.encodings.length>1&&"video/vp8"===l.codecs[0].mimeType.toLowerCase())for(let g of l.encodings)g.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:n,offerRtpParameters:l,answerRtpParameters:h,codecOptions:r});let v={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",v),await this._pc.setRemoteDescription(v);let y=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(y,e),{localId:y,rtpParameters:l}}async stopSending(e){this.assertSendDirection(),f.debug("stopSending() [localId:%s]",e);let t=this._mapSendLocalIdTrack.get(e);if(!t)throw Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(t),this._pc.addStream(this._sendStream);let r=await this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r);try{await this._pc.setLocalDescription(r)}catch(i){if(0===this._sendStream.getTracks().length){f.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());return}throw i}if("stable"===this._pc.signalingState)return;let n={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){throw new l.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,t){throw new l.UnsupportedError(" not implemented")}async setRtpEncodingParameters(e,t){throw new l.UnsupportedError("not supported")}async getSenderStats(e){throw new l.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:r,protocol:n};f.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%g.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c}),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertRecvDirection();let t=[];for(let r of e){let{trackId:i,kind:n,rtpParameters:s,streamId:o}=r;f.debug("receive() [trackId:%s, kind:%s]",i,n),this._remoteSdp.receive({mid:n,kind:n,offerRtpParameters:s,streamId:o||s.rtcp.cname,trackId:i})}let l={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",l),await this._pc.setRemoteDescription(l);let c=await this._pc.createAnswer(),d=a.parse(c.sdp);for(let p of e){let{kind:h,rtpParameters:m}=p,g=d.media.find(e=>String(e.mid)===h);u.applyCodecParameters({offerRtpParameters:m,answerMediaObject:g})}for(let v of(c={type:"answer",sdp:a.write(d)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",c),await this._pc.setLocalDescription(c),e)){let{kind:y,trackId:b,rtpParameters:w}=v,_=v.streamId||w.rtcp.cname,S=this._pc.getRemoteStreams().find(e=>e.id===_),x=S.getTrackById(b);if(!x)throw Error("remote track not found");this._mapRecvLocalIdInfo.set(b,{mid:y,rtpParameters:w}),t.push({localId:b,track:x})}return t}async stopReceiving(e){for(let t of(this.assertRecvDirection(),e)){f.debug("stopReceiving() [localId:%s]",t);let{mid:r,rtpParameters:i}=this._mapRecvLocalIdInfo.get(t)||{};this._mapRecvLocalIdInfo.delete(t),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:i})}let n={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let s=await this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new l.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmitTime:s,maxRetransmits:o,protocol:r};f.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});let d={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=u.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.Chrome55=v},5697:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome67=void 0;let a=s(r(70766)),o=r(38562),l=s(r(13347)),c=s(r(45280)),d=s(r(82267)),u=s(r(89875)),p=r(89316),h=r(37910),m=new o.Logger("Chrome67"),f={OS:1024,MIS:1024};class g extends p.HandlerInterface{static createFactory(){return()=>new g}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome67"}close(){if(m.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){m.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{let t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(r){}let i=a.parse(t.sdp),n=d.extractRtpCapabilities({sdpObject:i});return n}catch(o){try{e.close()}catch(s){}throw o}}async getNativeSctpCapabilities(){return m.debug("getNativeSctpCapabilities()"),{numStreams:f}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:d}){m.debug("run()"),this._direction=e,this._remoteSdp=new h.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,planB:!0}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(m.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){m.debug("updateIceServers()");let t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(m.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});m.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();m.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){let n;this.assertSendDirection(),m.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&m.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let s=await this._pc.createOffer(),o=a.parse(s.sdp),p=l.clone(this._sendingRtpParametersByKind[e.kind],{});p.codecs=c.reduceCodecs(p.codecs);let h=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(h.codecs=c.reduceCodecs(h.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),"video"===e.kind&&t&&t.length>1&&(m.debug("send() | enabling simulcast"),n=(o=a.parse(s.sdp)).media.find(e=>"video"===e.type),u.addLegacySimulcast({offerMediaObject:n,track:e,numStreams:t.length}),s={type:"offer",sdp:a.write(o)}),m.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),n=(o=a.parse(this._pc.localDescription.sdp)).media.find(t=>t.type===e.kind),p.rtcp.cname=d.getCname({offerMediaObject:n}),p.encodings=u.getRtpEncodings({offerMediaObject:n,track:e}),t)for(let f=0;f<p.encodings.length;++f)t[f]&&Object.assign(p.encodings[f],t[f]);if(p.encodings.length>1&&"video/vp8"===p.codecs[0].mimeType.toLowerCase())for(let g of p.encodings)g.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:n,offerRtpParameters:p,answerRtpParameters:h,codecOptions:r});let v={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("send() | calling pc.setRemoteDescription() [answer:%o]",v),await this._pc.setRemoteDescription(v);let y=String(this._nextSendLocalId);this._nextSendLocalId++;let b=this._pc.getSenders().find(t=>t.track===e);return this._mapSendLocalIdRtpSender.set(y,b),{localId:y,rtpParameters:p,rtpSender:b}}async stopSending(e){this.assertSendDirection(),m.debug("stopSending() [localId:%s]",e);let t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw Error("associated RTCRtpSender not found");this._pc.removeTrack(t),t.track&&this._sendStream.removeTrack(t.track),this._mapSendLocalIdRtpSender.delete(e);let r=await this._pc.createOffer();m.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r);try{await this._pc.setLocalDescription(r)}catch(i){if(0===this._sendStream.getTracks().length){m.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());return}throw i}if("stable"===this._pc.signalingState)return;let n={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?m.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):m.debug("replaceTrack() [localId:%s, no track]",e);let r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw Error("associated RTCRtpSender not found");let i=r.track;await r.replaceTrack(t),i&&this._sendStream.removeTrack(i),t&&this._sendStream.addTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),m.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);let r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw Error("associated RTCRtpSender not found");let i=r.getParameters();i.encodings.forEach((e,r)=>{r<=t?e.active=!0:e.active=!1}),await r.setParameters(i)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),m.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);let r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw Error("associated RTCRtpSender not found");let i=r.getParameters();i.encodings.forEach((e,r)=>{i.encodings[r]={...e,...t}}),await r.setParameters(i)}async getSenderStats(e){this.assertSendDirection();let t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw Error("associated RTCRtpSender not found");return t.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:r,protocol:n};m.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c}),m.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertRecvDirection();let t=[];for(let r of e){let{trackId:i,kind:n,rtpParameters:s,streamId:o}=r;m.debug("receive() [trackId:%s, kind:%s]",i,n),this._remoteSdp.receive({mid:n,kind:n,offerRtpParameters:s,streamId:o||s.rtcp.cname,trackId:i})}let l={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",l),await this._pc.setRemoteDescription(l);let c=await this._pc.createAnswer(),u=a.parse(c.sdp);for(let p of e){let{kind:h,rtpParameters:f}=p,g=u.media.find(e=>String(e.mid)===h);d.applyCodecParameters({offerRtpParameters:f,answerMediaObject:g})}for(let v of(c={type:"answer",sdp:a.write(u)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u}),m.debug("receive() | calling pc.setLocalDescription() [answer:%o]",c),await this._pc.setLocalDescription(c),e)){let{kind:y,trackId:b,rtpParameters:w}=v,_=this._pc.getReceivers().find(e=>e.track&&e.track.id===b);if(!_)throw Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(b,{mid:y,rtpParameters:w,rtpReceiver:_}),t.push({localId:b,track:_.track,rtpReceiver:_})}return t}async stopReceiving(e){for(let t of(this.assertRecvDirection(),e)){m.debug("stopReceiving() [localId:%s]",t);let{mid:r,rtpParameters:i}=this._mapRecvLocalIdInfo.get(t)||{};this._mapRecvLocalIdInfo.delete(t),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:i})}let n={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let s=await this._pc.createAnswer();m.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();let{rtpReceiver:t}=this._mapRecvLocalIdInfo.get(e)||{};if(!t)throw Error("associated RTCRtpReceiver not found");return t.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmitTime:s,maxRetransmits:o,protocol:r};m.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});let d={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p})}m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=d.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.Chrome67=g},75372:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome70=void 0;let a=s(r(70766)),o=r(38562),l=s(r(13347)),c=s(r(45280)),d=s(r(82267)),u=s(r(29072)),p=r(89316),h=r(37910),m=r(82770),f=new o.Logger("Chrome70"),g={OS:1024,MIS:1024};class v extends p.HandlerInterface{static createFactory(){return()=>new v}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome70"}close(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){f.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");let t=await e.createOffer();try{e.close()}catch(r){}let i=a.parse(t.sdp),n=d.extractRtpCapabilities({sdpObject:i});return n}catch(o){try{e.close()}catch(s){}throw o}}async getNativeSctpCapabilities(){return f.debug("getNativeSctpCapabilities()"),{numStreams:g}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:d}){f.debug("run()"),this._direction=e,this._remoteSdp=new h.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){f.debug("updateIceServers()");let t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){let n;this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);let s=l.clone(this._sendingRtpParametersByKind[e.kind],{});s.codecs=c.reduceCodecs(s.codecs,i);let o=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});o.codecs=c.reduceCodecs(o.codecs,i);let p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]}),g=await this._pc.createOffer(),v=a.parse(g.sdp);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:v}),t&&t.length>1&&(f.debug("send() | enabling legacy simulcast"),n=(v=a.parse(g.sdp)).media[p.idx],u.addLegacySimulcast({offerMediaObject:n,numStreams:t.length}),g={type:"offer",sdp:a.write(v)});let y=!1,b=(0,m.parse)((t||[{}])[0].scalabilityMode);if(t&&1===t.length&&b.spatialLayers>1&&"video/vp9"===s.codecs[0].mimeType.toLowerCase()&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),y=!0,n=(v=a.parse(g.sdp)).media[p.idx],u.addLegacySimulcast({offerMediaObject:n,numStreams:b.spatialLayers}),g={type:"offer",sdp:a.write(v)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",g),await this._pc.setLocalDescription(g),t){f.debug("send() | applying given encodings");let w=h.sender.getParameters();for(let _=0;_<(w.encodings||[]).length;++_){let S=w.encodings[_],x=t[_];if(!x)break;w.encodings[_]=Object.assign(S,x)}await h.sender.setParameters(w)}let C=h.mid;if(s.mid=C,n=(v=a.parse(this._pc.localDescription.sdp)).media[p.idx],s.rtcp.cname=d.getCname({offerMediaObject:n}),s.encodings=u.getRtpEncodings({offerMediaObject:n}),t)for(let T=0;T<s.encodings.length;++T)t[T]&&Object.assign(s.encodings[T],t[T]);if(y&&(s.encodings=[s.encodings[0]]),s.encodings.length>1&&("video/vp8"===s.codecs[0].mimeType.toLowerCase()||"video/h264"===s.codecs[0].mimeType.toLowerCase()))for(let k of s.encodings)k.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:n,reuseMid:p.reuseMid,offerRtpParameters:s,answerRtpParameters:o,codecOptions:r});let R={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R),this._mapMidTransceiver.set(C,h),{localId:C,rtpParameters:s,rtpSender:h.sender}}async stopSending(e){this.assertSendDirection(),f.debug("stopSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);let r=this._remoteSdp.closeMediaSection(t.mid);if(r)try{t.stop()}catch(i){}let n=await this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?f.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):f.debug("replaceTrack() [localId:%s, no track]",e);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{r<=t?e.active=!0:e.active=!1}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{i.encodings[r]={...e,...t}}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async getSenderStats(e){this.assertSendDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:r,protocol:n};f.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%g.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c}),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertRecvDirection();let t=[],r=new Map;for(let i of e){let{trackId:n,kind:s,rtpParameters:o,streamId:l}=i;f.debug("receive() [trackId:%s, kind:%s]",n,s);let c=o.mid||String(this._mapMidTransceiver.size);r.set(n,c),this._remoteSdp.receive({mid:c,kind:s,offerRtpParameters:o,streamId:l||o.rtcp.cname,trackId:n})}let u={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",u),await this._pc.setRemoteDescription(u);let p=await this._pc.createAnswer(),h=a.parse(p.sdp);for(let m of e){let{trackId:g,rtpParameters:v}=m,y=r.get(g),b=h.media.find(e=>String(e.mid)===y);d.applyCodecParameters({offerRtpParameters:v,answerMediaObject:b})}for(let w of(p={type:"answer",sdp:a.write(h)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:h}),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),e)){let{trackId:_}=w,S=r.get(_),x=this._pc.getTransceivers().find(e=>e.mid===S);if(!x)throw Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(S,x),t.push({localId:S,track:x.receiver.track,rtpReceiver:x.receiver})}return t}async stopReceiving(e){for(let t of(this.assertRecvDirection(),e)){f.debug("stopReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(r.mid)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();for(let s of(f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n),e))this._mapMidTransceiver.delete(s)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmitTime:s,maxRetransmits:o,protocol:r};f.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();let d={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=d.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.Chrome70=v},66656:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome74=void 0;let a=s(r(70766)),o=r(38562),l=s(r(13347)),c=s(r(45280)),d=s(r(82267)),u=s(r(29072)),p=s(r(58954)),h=r(99992),m=r(89316),f=r(37910),g=r(82770),v=new o.Logger("Chrome74"),y={OS:1024,MIS:1024};class b extends m.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome74"}close(){if(v.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");let t=await e.createOffer();try{e.close()}catch(r){}let i=a.parse(t.sdp),n=d.extractRtpCapabilities({sdpObject:i});return p.addNackSuppportForOpus(n),n}catch(o){try{e.close()}catch(s){}throw o}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:y}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:d}){v.debug("run()"),this._direction=e,this._remoteSdp=new f.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){this.assertNotClosed(),v.debug("updateIceServers()");let t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(this.assertNotClosed(),v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){let n;this.assertNotClosed(),this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&t.length>1&&t.forEach((e,t)=>{e.rid=`r${t}`});let s=l.clone(this._sendingRtpParametersByKind[e.kind],{});s.codecs=c.reduceCodecs(s.codecs,i);let o=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});o.codecs=c.reduceCodecs(o.codecs,i);let p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:t}),m=await this._pc.createOffer(),f=a.parse(m.sdp);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f});let y=!1,b=(0,g.parse)((t||[{}])[0].scalabilityMode);t&&1===t.length&&b.spatialLayers>1&&"video/vp9"===s.codecs[0].mimeType.toLowerCase()&&(v.debug("send() | enabling legacy simulcast for VP9 SVC"),y=!0,n=(f=a.parse(m.sdp)).media[p.idx],u.addLegacySimulcast({offerMediaObject:n,numStreams:b.spatialLayers}),m={type:"offer",sdp:a.write(f)}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",m),await this._pc.setLocalDescription(m);let w=h.mid;if(s.mid=w,n=(f=a.parse(this._pc.localDescription.sdp)).media[p.idx],s.rtcp.cname=d.getCname({offerMediaObject:n}),t){if(1===t.length){let _=u.getRtpEncodings({offerMediaObject:n});Object.assign(_[0],t[0]),y&&(_=[_[0]]),s.encodings=_}else s.encodings=t}else s.encodings=u.getRtpEncodings({offerMediaObject:n});if(s.encodings.length>1&&("video/vp8"===s.codecs[0].mimeType.toLowerCase()||"video/h264"===s.codecs[0].mimeType.toLowerCase()))for(let S of s.encodings)S.scalabilityMode?S.scalabilityMode=`L1T${b.temporalLayers}`:S.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:n,reuseMid:p.reuseMid,offerRtpParameters:s,answerRtpParameters:o,codecOptions:r,extmapAllowMixed:!0});let x={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",x),await this._pc.setRemoteDescription(x),this._mapMidTransceiver.set(w,h),{localId:w,rtpParameters:s,rtpSender:h.sender}}async stopSending(e){if(this.assertSendDirection(),v.debug("stopSending() [localId:%s]",e),this._closed)return;let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);let r=this._remoteSdp.closeMediaSection(t.mid);if(r)try{t.stop()}catch(i){}let n=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("pauseSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);let r=await this._pc.createOffer();v.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("resumeSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw Error("associated RTCRtpTransceiver not found");t.direction="sendonly";let r=await this._pc.createOffer();v.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?v.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):v.debug("replaceTrack() [localId:%s, no track]",e);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{r<=t?e.active=!0:e.active=!1}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{i.encodings[r]={...e,...t}}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertNotClosed(),this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:r,protocol:n};v.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%y.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c}),v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();let t=[],r=new Map;for(let i of e){let{trackId:n,kind:s,rtpParameters:o,streamId:l}=i;v.debug("receive() [trackId:%s, kind:%s]",n,s);let c=o.mid||String(this._mapMidTransceiver.size);r.set(n,c),this._remoteSdp.receive({mid:c,kind:s,offerRtpParameters:o,streamId:l||o.rtcp.cname,trackId:n})}let u={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",u),await this._pc.setRemoteDescription(u);let p=await this._pc.createAnswer(),h=a.parse(p.sdp);for(let m of e){let{trackId:f,rtpParameters:g}=m,y=r.get(f),b=h.media.find(e=>String(e.mid)===y);d.applyCodecParameters({offerRtpParameters:g,answerMediaObject:b})}for(let w of(p={type:"answer",sdp:a.write(h)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:h}),v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),e)){let{trackId:_}=w,S=r.get(_),x=this._pc.getTransceivers().find(e=>e.mid===S);if(x)this._mapMidTransceiver.set(S,x),t.push({localId:S,track:x.receiver.track,rtpReceiver:x.receiver});else throw Error("new RTCRtpTransceiver not found")}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(let t of e){v.debug("stopReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(r.mid)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();for(let s of(v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n),e))this._mapMidTransceiver.delete(s)}async pauseReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){v.debug("pauseReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){v.debug("resumeReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o,protocol:r};v.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();let d={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=d.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new h.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.Chrome74=b},37392:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Edge11=void 0;let a=r(38562),o=r(99992),l=s(r(13347)),c=s(r(45280)),d=s(r(63635)),u=r(89316),p=new a.Logger("Edge11");class h extends u.HandlerInterface{static createFactory(){return()=>new h}constructor(){super(),this._rtpSenders=new Map,this._rtpReceivers=new Map,this._nextSendLocalId=0,this._transportReady=!1}get name(){return"Edge11"}close(){p.debug("close()");try{this._iceGatherer.close()}catch(e){}try{this._iceTransport.stop()}catch(t){}try{this._dtlsTransport.stop()}catch(r){}for(let i of this._rtpSenders.values())try{i.stop()}catch(n){}for(let s of this._rtpReceivers.values())try{s.stop()}catch(a){}this.emit("@close")}async getNativeRtpCapabilities(){return p.debug("getNativeRtpCapabilities()"),d.getCapabilities()}async getNativeSctpCapabilities(){return p.debug("getNativeSctpCapabilities()"),{numStreams:{OS:0,MIS:0}}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:d,extendedRtpCapabilities:u}){p.debug("run()"),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",u),video:c.getSendingRtpParameters("video",u)},this._remoteIceParameters=t,this._remoteIceCandidates=r,this._remoteDtlsParameters=i,this._cname=`CNAME-${l.generateRandomNumber()}`,this.setIceGatherer({iceServers:s,iceTransportPolicy:a}),this.setIceTransport(),this.setDtlsTransport()}async updateIceServers(e){throw new o.UnsupportedError("not supported")}async restartIce(e){if(p.debug("restartIce()"),this._remoteIceParameters=e,this._transportReady){for(let t of(p.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,e,"controlling"),this._remoteIceCandidates))this._iceTransport.addRemoteCandidate(t);this._iceTransport.addRemoteCandidate({})}}async getTransportStats(){return this._iceTransport.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){p.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),p.debug("send() | calling new RTCRtpSender()");let n=new RTCRtpSender(e,this._dtlsTransport),s=l.clone(this._sendingRtpParametersByKind[e.kind],{});s.codecs=c.reduceCodecs(s.codecs,i);let a=s.codecs.some(e=>/.+\/rtx$/i.test(e.mimeType));for(let o of(t||(t=[{}]),t))o.ssrc=l.generateRandomNumber(),a&&(o.rtx={ssrc:l.generateRandomNumber()});s.encodings=t,s.rtcp={cname:this._cname,reducedSize:!0,mux:!0};let u=d.mangleRtpParameters(s);p.debug("send() | calling rtpSender.send() [params:%o]",u),await n.send(u);let h=String(this._nextSendLocalId);return this._nextSendLocalId++,this._rtpSenders.set(h,n),{localId:h,rtpParameters:s,rtpSender:n}}async stopSending(e){p.debug("stopSending() [localId:%s]",e);let t=this._rtpSenders.get(e);if(!t)throw Error("RTCRtpSender not found");this._rtpSenders.delete(e);try{p.debug("stopSending() | calling rtpSender.stop()"),t.stop()}catch(r){throw p.warn("stopSending() | rtpSender.stop() failed:%o",r),r}}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){t?p.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):p.debug("replaceTrack() [localId:%s, no track]",e);let r=this._rtpSenders.get(e);if(!r)throw Error("RTCRtpSender not found");r.setTrack(t)}async setMaxSpatialLayer(e,t){p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);let r=this._rtpSenders.get(e);if(!r)throw Error("RTCRtpSender not found");let i=r.getParameters();i.encodings.forEach((e,r)=>{r<=t?e.active=!0:e.active=!1}),await r.setParameters(i)}async setRtpEncodingParameters(e,t){p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);let r=this._rtpSenders.get(e);if(!r)throw Error("RTCRtpSender not found");let i=r.getParameters();i.encodings.forEach((e,r)=>{i.encodings[r]={...e,...t}}),await r.setParameters(i)}async getSenderStats(e){let t=this._rtpSenders.get(e);if(!t)throw Error("RTCRtpSender not found");return t.getStats()}async sendDataChannel(e){throw new o.UnsupportedError("not implemented")}async receive(e){let t=[];for(let r of e){let{trackId:i,kind:n}=r;p.debug("receive() [trackId:%s, kind:%s]",i,n)}for(let s of(this._transportReady||await this.setupTransport({localDtlsRole:"server"}),e)){let{trackId:a,kind:o,rtpParameters:l}=s;p.debug("receive() | calling new RTCRtpReceiver()");let c=new RTCRtpReceiver(this._dtlsTransport,o);c.addEventListener("error",e=>{p.error('rtpReceiver "error" event [event:%o]',e)});let u=d.mangleRtpParameters(l);p.debug("receive() | calling rtpReceiver.receive() [params:%o]",u),await c.receive(u),this._rtpReceivers.set(a,c),t.push({localId:a,track:c.track,rtpReceiver:c})}return t}async stopReceiving(e){for(let t of e){p.debug("stopReceiving() [localId:%s]",t);let r=this._rtpReceivers.get(t);if(!r)throw Error("RTCRtpReceiver not found");this._rtpReceivers.delete(t);try{p.debug("stopReceiving() | calling rtpReceiver.stop()"),r.stop()}catch(i){p.warn("stopReceiving() | rtpReceiver.stop() failed:%o",i)}}}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){let t=this._rtpReceivers.get(e);if(!t)throw Error("RTCRtpReceiver not found");return t.getStats()}async receiveDataChannel(e){throw new o.UnsupportedError("not implemented")}setIceGatherer({iceServers:e,iceTransportPolicy:t}){let r=new RTCIceGatherer({iceServers:e||[],gatherPolicy:t||"all"});r.addEventListener("error",e=>{p.error('iceGatherer "error" event [event:%o]',e)});try{r.gather()}catch(i){p.debug("setIceGatherer() | iceGatherer.gather() failed: %s",i.toString())}this._iceGatherer=r}setIceTransport(){let e=new RTCIceTransport(this._iceGatherer);e.addEventListener("statechange",()=>{switch(e.state){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}),e.addEventListener("icestatechange",()=>{switch(e.state){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}),e.addEventListener("candidatepairchange",e=>{p.debug('iceTransport "candidatepairchange" event [pair:%o]',e.pair)}),this._iceTransport=e}setDtlsTransport(){let e=new RTCDtlsTransport(this._iceTransport);e.addEventListener("statechange",()=>{p.debug('dtlsTransport "statechange" event [state:%s]',e.state)}),e.addEventListener("dtlsstatechange",()=>{p.debug('dtlsTransport "dtlsstatechange" event [state:%s]',e.state),"closed"===e.state&&this.emit("@connectionstatechange","closed")}),e.addEventListener("error",e=>{p.error('dtlsTransport "error" event [event:%o]',e)}),this._dtlsTransport=e}async setupTransport({localDtlsRole:e}){p.debug("setupTransport()");let t=this._dtlsTransport.getLocalParameters();for(let r of(t.role=e,await new Promise((e,r)=>{this.safeEmit("@connect",{dtlsParameters:t},e,r)}),this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling"),this._remoteIceCandidates))this._iceTransport.addRemoteCandidate(r);this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter(e=>"sha-256"===e.algorithm||"sha-384"===e.algorithm||"sha-512"===e.algorithm),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0}}t.Edge11=h},61419:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Firefox60=void 0;let a=s(r(70766)),o=r(38562),l=r(99992),c=s(r(13347)),d=s(r(45280)),u=s(r(82267)),p=s(r(29072)),h=r(89316),m=r(37910),f=r(82770),g=new o.Logger("Firefox60"),v={OS:16,MIS:2048};class y extends h.HandlerInterface{static createFactory(){return()=>new y}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Firefox60"}close(){if(g.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){g.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),t=document.createElement("canvas");t.getContext("2d");let r=t.captureStream(),i=r.getVideoTracks()[0];try{e.addTransceiver("audio",{direction:"sendrecv"});let n=e.addTransceiver(i,{direction:"sendrecv"}),s=n.sender.getParameters();s.encodings=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}],await n.sender.setParameters(s);let o=await e.createOffer();try{t.remove()}catch(l){}try{i.stop()}catch(c){}try{e.close()}catch(d){}let p=a.parse(o.sdp),h=u.extractRtpCapabilities({sdpObject:p});return h}catch(y){try{t.remove()}catch(m){}try{i.stop()}catch(f){}try{e.close()}catch(v){}throw y}}async getNativeSctpCapabilities(){return g.debug("getNativeSctpCapabilities()"),{numStreams:v}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:c}){this.assertNotClosed(),g.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(g.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){throw this.assertNotClosed(),new l.UnsupportedError("not supported")}async restartIce(e){if(this.assertNotClosed(),g.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});g.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();g.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){this.assertNotClosed(),this.assertSendDirection(),g.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&(t=c.clone(t,[])).length>1&&(t.forEach((e,t)=>{e.rid=`r${t}`}),t.reverse());let n=c.clone(this._sendingRtpParametersByKind[e.kind],{});n.codecs=d.reduceCodecs(n.codecs,i);let s=c.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});s.codecs=d.reduceCodecs(s.codecs,i);let o=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});if(t){let l=o.sender.getParameters();l.encodings=t,await o.sender.setParameters(l)}let h=await this._pc.createOffer(),m=a.parse(h.sdp);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:m});let v=(0,f.parse)((t||[{}])[0].scalabilityMode);g.debug("send() | calling pc.setLocalDescription() [offer:%o]",h),await this._pc.setLocalDescription(h);let y=o.mid;n.mid=y,m=a.parse(this._pc.localDescription.sdp);let b=m.media[m.media.length-1];if(n.rtcp.cname=u.getCname({offerMediaObject:b}),t){if(1===t.length){let w=p.getRtpEncodings({offerMediaObject:b});Object.assign(w[0],t[0]),n.encodings=w}else n.encodings=t.reverse()}else n.encodings=p.getRtpEncodings({offerMediaObject:b});if(n.encodings.length>1&&("video/vp8"===n.codecs[0].mimeType.toLowerCase()||"video/h264"===n.codecs[0].mimeType.toLowerCase()))for(let _ of n.encodings)_.scalabilityMode?_.scalabilityMode=`L1T${v.temporalLayers}`:_.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:b,offerRtpParameters:n,answerRtpParameters:s,codecOptions:r,extmapAllowMixed:!0});let S={type:"answer",sdp:this._remoteSdp.getSdp()};return g.debug("send() | calling pc.setRemoteDescription() [answer:%o]",S),await this._pc.setRemoteDescription(S),this._mapMidTransceiver.set(y,o),{localId:y,rtpParameters:n,rtpSender:o.sender}}async stopSending(e){if(this.assertSendDirection(),g.debug("stopSending() [localId:%s]",e),this._closed)return;let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated transceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender),this._remoteSdp.disableMediaSection(t.mid);let r=await this._pc.createOffer();g.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),g.debug("pauseSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);let r=await this._pc.createOffer();g.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),g.debug("resumeSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);let r=await this._pc.createOffer();g.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?g.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):g.debug("replaceTrack() [localId:%s, no track]",e);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),g.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated transceiver not found");let i=r.sender.getParameters();t=i.encodings.length-1-t,i.encodings.forEach((e,r)=>{r>=t?e.active=!0:e.active=!1}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();g.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),g.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{i.encodings[r]={...e,...t}}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();g.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertNotClosed(),this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:r,protocol:n};g.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%v.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:c}),g.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();let t=[],r=new Map;for(let i of e){let{trackId:n,kind:s,rtpParameters:o,streamId:l}=i;g.debug("receive() [trackId:%s, kind:%s]",n,s);let c=o.mid||String(this._mapMidTransceiver.size);r.set(n,c),this._remoteSdp.receive({mid:c,kind:s,offerRtpParameters:o,streamId:l||o.rtcp.cname,trackId:n})}let d={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let p=await this._pc.createAnswer(),h=a.parse(p.sdp);for(let m of e){let{trackId:f,rtpParameters:v}=m,y=r.get(f),b=h.media.find(e=>String(e.mid)===y);u.applyCodecParameters({offerRtpParameters:v,answerMediaObject:b}),p={type:"answer",sdp:a.write(h)}}for(let w of(this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:h}),g.debug("receive() | calling pc.setLocalDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),e)){let{trackId:_}=w,S=r.get(_),x=this._pc.getTransceivers().find(e=>e.mid===S);if(!x)throw Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(S,x),t.push({localId:S,track:x.receiver.track,rtpReceiver:x.receiver})}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(let t of e){g.debug("stopReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(r.mid)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();for(let s of(g.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n),e))this._mapMidTransceiver.delete(s)}async pauseReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){g.debug("pauseReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();g.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){g.debug("resumeReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();g.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertRecvDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o,protocol:r};g.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();let d={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:p})}g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=u.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new l.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.Firefox60=y},89316:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandlerInterface=void 0;let i=r(54493);class n extends i.EnhancedEventEmitter{constructor(){super()}}t.HandlerInterface=n},44770:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNative=void 0;let a=s(r(70766)),o=r(38562),l=r(99992),c=s(r(13347)),d=s(r(45280)),u=s(r(82267)),p=s(r(89875)),h=r(89316),m=r(37910),f=new o.Logger("ReactNative"),g={OS:1024,MIS:1024};class v extends h.HandlerInterface{static createFactory(){return()=>new v}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"ReactNative"}close(){if(f.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){f.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{let t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(r){}let i=a.parse(t.sdp),n=u.extractRtpCapabilities({sdpObject:i});return n}catch(o){try{e.close()}catch(s){}throw o}}async getNativeSctpCapabilities(){return f.debug("getNativeSctpCapabilities()"),{numStreams:g}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:c}){f.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,planB:!0}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){f.debug("updateIceServers()");let t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){let n;this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&f.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let s=await this._pc.createOffer(),o=a.parse(s.sdp),l=c.clone(this._sendingRtpParametersByKind[e.kind],{});l.codecs=d.reduceCodecs(l.codecs);let h=c.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(h.codecs=d.reduceCodecs(h.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),"video"===e.kind&&t&&t.length>1&&(f.debug("send() | enabling simulcast"),n=(o=a.parse(s.sdp)).media.find(e=>"video"===e.type),p.addLegacySimulcast({offerMediaObject:n,track:e,numStreams:t.length}),s={type:"offer",sdp:a.write(o)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),n=(o=a.parse(this._pc.localDescription.sdp)).media.find(t=>t.type===e.kind),l.rtcp.cname=u.getCname({offerMediaObject:n}),l.encodings=p.getRtpEncodings({offerMediaObject:n,track:e}),t)for(let m=0;m<l.encodings.length;++m)t[m]&&Object.assign(l.encodings[m],t[m]);if(l.encodings.length>1&&("video/vp8"===l.codecs[0].mimeType.toLowerCase()||"video/h264"===l.codecs[0].mimeType.toLowerCase()))for(let g of l.encodings)g.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:n,offerRtpParameters:l,answerRtpParameters:h,codecOptions:r});let v={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",v),await this._pc.setRemoteDescription(v);let y=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(y,e),{localId:y,rtpParameters:l}}async stopSending(e){this.assertSendDirection(),f.debug("stopSending() [localId:%s]",e);let t=this._mapSendLocalIdTrack.get(e);if(!t)throw Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(t),this._pc.addStream(this._sendStream);let r=await this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r);try{await this._pc.setLocalDescription(r)}catch(i){if(0===this._sendStream.getTracks().length){f.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());return}throw i}if("stable"===this._pc.signalingState)return;let n={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){throw new l.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,t){throw new l.UnsupportedError("not implemented")}async setRtpEncodingParameters(e,t){throw new l.UnsupportedError("not implemented")}async getSenderStats(e){throw new l.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:r,protocol:n};f.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%g.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c}),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertRecvDirection();let t=[],r=new Map;for(let i of e){let{trackId:n,kind:s,rtpParameters:o}=i;f.debug("receive() [trackId:%s, kind:%s]",n,s);let l=i.streamId||o.rtcp.cname;f.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),l+=`-hack-${c.generateRandomNumber()}`,r.set(n,l),this._remoteSdp.receive({mid:s,kind:s,offerRtpParameters:o,streamId:l,trackId:n})}let d={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let p=await this._pc.createAnswer(),h=a.parse(p.sdp);for(let m of e){let{kind:g,rtpParameters:v}=m,y=h.media.find(e=>String(e.mid)===g);u.applyCodecParameters({offerRtpParameters:v,answerMediaObject:y})}for(let b of(p={type:"answer",sdp:a.write(h)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:h}),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),e)){let{kind:w,trackId:_,rtpParameters:S}=b,x=r.get(_),C=this._pc.getRemoteStreams().find(e=>e.id===x),T=C.getTrackById(_);if(!T)throw Error("remote track not found");this._mapRecvLocalIdInfo.set(_,{mid:w,rtpParameters:S}),t.push({localId:_,track:T})}return t}async stopReceiving(e){for(let t of(this.assertRecvDirection(),e)){f.debug("stopReceiving() [localId:%s]",t);let{mid:r,rtpParameters:i}=this._mapRecvLocalIdInfo.get(t)||{};this._mapRecvLocalIdInfo.delete(t),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:i})}let n={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let s=await this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new l.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmitTime:s,maxRetransmits:o,protocol:r};f.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});let d={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=u.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.ReactNative=v},23433:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNativeUnifiedPlan=void 0;let a=s(r(70766)),o=r(38562),l=s(r(13347)),c=s(r(45280)),d=s(r(82267)),u=s(r(29072)),p=s(r(58954)),h=r(99992),m=r(89316),f=r(37910),g=r(82770),v=new o.Logger("ReactNativeUnifiedPlan"),y={OS:1024,MIS:1024};class b extends m.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"ReactNativeUnifiedPlan"}close(){if(v.debug("close()"),!this._closed){if(this._closed=!0,this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");let t=await e.createOffer();try{e.close()}catch(r){}let i=a.parse(t.sdp),n=d.extractRtpCapabilities({sdpObject:i});return p.addNackSuppportForOpus(n),n}catch(o){try{e.close()}catch(s){}throw o}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:y}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),v.debug("run()"),this._direction=e,this._remoteSdp=new f.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){this.assertNotClosed(),v.debug("updateIceServers()");let t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(this.assertNotClosed(),v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){let n;this.assertNotClosed(),this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&t.length>1&&t.forEach((e,t)=>{e.rid=`r${t}`});let s=l.clone(this._sendingRtpParametersByKind[e.kind],{});s.codecs=c.reduceCodecs(s.codecs,i);let o=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});o.codecs=c.reduceCodecs(o.codecs,i);let p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:t}),m=await this._pc.createOffer(),f=a.parse(m.sdp);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f});let y=!1,b=(0,g.parse)((t||[{}])[0].scalabilityMode);t&&1===t.length&&b.spatialLayers>1&&"video/vp9"===s.codecs[0].mimeType.toLowerCase()&&(v.debug("send() | enabling legacy simulcast for VP9 SVC"),y=!0,n=(f=a.parse(m.sdp)).media[p.idx],u.addLegacySimulcast({offerMediaObject:n,numStreams:b.spatialLayers}),m={type:"offer",sdp:a.write(f)}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",m),await this._pc.setLocalDescription(m);let w=h.mid??void 0;if(w||v.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),s.mid=w,n=(f=a.parse(this._pc.localDescription.sdp)).media[p.idx],s.rtcp.cname=d.getCname({offerMediaObject:n}),t){if(1===t.length){let _=u.getRtpEncodings({offerMediaObject:n});Object.assign(_[0],t[0]),y&&(_=[_[0]]),s.encodings=_}else s.encodings=t}else s.encodings=u.getRtpEncodings({offerMediaObject:n});if(s.encodings.length>1&&("video/vp8"===s.codecs[0].mimeType.toLowerCase()||"video/h264"===s.codecs[0].mimeType.toLowerCase()))for(let S of s.encodings)S.scalabilityMode?S.scalabilityMode=`L1T${b.temporalLayers}`:S.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:n,reuseMid:p.reuseMid,offerRtpParameters:s,answerRtpParameters:o,codecOptions:r,extmapAllowMixed:!0});let x={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",x),await this._pc.setRemoteDescription(x),w||(w=h.mid,s.mid=w),this._mapMidTransceiver.set(w,h),{localId:w,rtpParameters:s,rtpSender:h.sender}}async stopSending(e){if(this.assertSendDirection(),this._closed)return;v.debug("stopSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);let r=this._remoteSdp.closeMediaSection(t.mid);if(r)try{t.stop()}catch(i){}let n=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("pauseSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);let r=await this._pc.createOffer();v.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("resumeSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw Error("associated RTCRtpTransceiver not found");t.direction="sendonly";let r=await this._pc.createOffer();v.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?v.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):v.debug("replaceTrack() [localId:%s, no track]",e);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{r<=t?e.active=!0:e.active=!1}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{i.encodings[r]={...e,...t}}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertNotClosed(),this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:r,protocol:n};v.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%y.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c}),v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();let t=[],r=new Map;for(let i of e){let{trackId:n,kind:s,rtpParameters:o,streamId:l}=i;v.debug("receive() [trackId:%s, kind:%s]",n,s);let c=o.mid||String(this._mapMidTransceiver.size);r.set(n,c),this._remoteSdp.receive({mid:c,kind:s,offerRtpParameters:o,streamId:l||o.rtcp.cname,trackId:n})}let u={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",u),await this._pc.setRemoteDescription(u);let p=await this._pc.createAnswer(),h=a.parse(p.sdp);for(let m of e){let{trackId:f,rtpParameters:g}=m,y=r.get(f),b=h.media.find(e=>String(e.mid)===y);d.applyCodecParameters({offerRtpParameters:g,answerMediaObject:b})}for(let w of(p={type:"answer",sdp:a.write(h)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:h}),v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),e)){let{trackId:_}=w,S=r.get(_),x=this._pc.getTransceivers().find(e=>e.mid===S);if(x)this._mapMidTransceiver.set(S,x),t.push({localId:S,track:x.receiver.track,rtpReceiver:x.receiver});else throw Error("new RTCRtpTransceiver not found")}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(let t of e){v.debug("stopReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(r.mid)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();for(let s of(v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n),e))this._mapMidTransceiver.delete(s)}async pauseReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){v.debug("pauseReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){v.debug("resumeReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o,protocol:r};v.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();let d={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=d.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new h.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.ReactNativeUnifiedPlan=b},32205:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari11=void 0;let a=s(r(70766)),o=r(38562),l=s(r(13347)),c=s(r(45280)),d=s(r(82267)),u=s(r(89875)),p=r(89316),h=r(37910),m=new o.Logger("Safari11"),f={OS:1024,MIS:1024};class g extends p.HandlerInterface{static createFactory(){return()=>new g}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Safari11"}close(){if(m.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){m.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{let t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(r){}let i=a.parse(t.sdp),n=d.extractRtpCapabilities({sdpObject:i});return n}catch(o){try{e.close()}catch(s){}throw o}}async getNativeSctpCapabilities(){return m.debug("getNativeSctpCapabilities()"),{numStreams:f}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:d}){m.debug("run()"),this._direction=e,this._remoteSdp=new h.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,planB:!0}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(m.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){m.debug("updateIceServers()");let t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(m.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});m.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();m.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){let n;this.assertSendDirection(),m.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&m.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let s=await this._pc.createOffer(),o=a.parse(s.sdp),p=l.clone(this._sendingRtpParametersByKind[e.kind],{});p.codecs=c.reduceCodecs(p.codecs);let h=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(h.codecs=c.reduceCodecs(h.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),"video"===e.kind&&t&&t.length>1&&(m.debug("send() | enabling simulcast"),n=(o=a.parse(s.sdp)).media.find(e=>"video"===e.type),u.addLegacySimulcast({offerMediaObject:n,track:e,numStreams:t.length}),s={type:"offer",sdp:a.write(o)}),m.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),n=(o=a.parse(this._pc.localDescription.sdp)).media.find(t=>t.type===e.kind),p.rtcp.cname=d.getCname({offerMediaObject:n}),p.encodings=u.getRtpEncodings({offerMediaObject:n,track:e}),t)for(let f=0;f<p.encodings.length;++f)t[f]&&Object.assign(p.encodings[f],t[f]);if(p.encodings.length>1&&"video/vp8"===p.codecs[0].mimeType.toLowerCase())for(let g of p.encodings)g.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:n,offerRtpParameters:p,answerRtpParameters:h,codecOptions:r});let v={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("send() | calling pc.setRemoteDescription() [answer:%o]",v),await this._pc.setRemoteDescription(v);let y=String(this._nextSendLocalId);this._nextSendLocalId++;let b=this._pc.getSenders().find(t=>t.track===e);return this._mapSendLocalIdRtpSender.set(y,b),{localId:y,rtpParameters:p,rtpSender:b}}async stopSending(e){this.assertSendDirection();let t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw Error("associated RTCRtpSender not found");t.track&&this._sendStream.removeTrack(t.track),this._mapSendLocalIdRtpSender.delete(e);let r=await this._pc.createOffer();m.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r);try{await this._pc.setLocalDescription(r)}catch(i){if(0===this._sendStream.getTracks().length){m.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());return}throw i}if("stable"===this._pc.signalingState)return;let n={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?m.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):m.debug("replaceTrack() [localId:%s, no track]",e);let r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw Error("associated RTCRtpSender not found");let i=r.track;await r.replaceTrack(t),i&&this._sendStream.removeTrack(i),t&&this._sendStream.addTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),m.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);let r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw Error("associated RTCRtpSender not found");let i=r.getParameters();i.encodings.forEach((e,r)=>{r<=t?e.active=!0:e.active=!1}),await r.setParameters(i)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),m.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);let r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw Error("associated RTCRtpSender not found");let i=r.getParameters();i.encodings.forEach((e,r)=>{i.encodings[r]={...e,...t}}),await r.setParameters(i)}async getSenderStats(e){this.assertSendDirection();let t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw Error("associated RTCRtpSender not found");return t.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:r,protocol:n};m.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c}),m.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertRecvDirection();let t=[];for(let r of e){let{trackId:i,kind:n,rtpParameters:s,streamId:o}=r;m.debug("receive() [trackId:%s, kind:%s]",i,n),this._remoteSdp.receive({mid:n,kind:n,offerRtpParameters:s,streamId:o||s.rtcp.cname,trackId:i})}let l={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",l),await this._pc.setRemoteDescription(l);let c=await this._pc.createAnswer(),u=a.parse(c.sdp);for(let p of e){let{kind:h,rtpParameters:f}=p,g=u.media.find(e=>String(e.mid)===h);d.applyCodecParameters({offerRtpParameters:f,answerMediaObject:g})}for(let v of(c={type:"answer",sdp:a.write(u)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u}),m.debug("receive() | calling pc.setLocalDescription() [answer:%o]",c),await this._pc.setLocalDescription(c),e)){let{kind:y,trackId:b,rtpParameters:w}=v,_=this._pc.getReceivers().find(e=>e.track&&e.track.id===b);if(!_)throw Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(b,{mid:y,rtpParameters:w,rtpReceiver:_}),t.push({localId:b,track:_.track,rtpReceiver:_})}return t}async stopReceiving(e){for(let t of(this.assertRecvDirection(),e)){m.debug("stopReceiving() [localId:%s]",t);let{mid:r,rtpParameters:i}=this._mapRecvLocalIdInfo.get(t)||{};this._mapRecvLocalIdInfo.delete(t),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:i})}let n={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let s=await this._pc.createAnswer();m.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(e){this.assertRecvDirection();let{rtpReceiver:t}=this._mapRecvLocalIdInfo.get(e)||{};if(!t)throw Error("associated RTCRtpReceiver not found");return t.getStats()}async pauseReceiving(e){}async resumeReceiving(e){}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o,protocol:r};m.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});let d={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p})}m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=d.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.Safari11=g},29862:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari12=void 0;let a=s(r(70766)),o=r(38562),l=s(r(13347)),c=s(r(45280)),d=s(r(82267)),u=s(r(29072)),p=s(r(58954)),h=r(99992),m=r(89316),f=r(37910),g=r(82770),v=new o.Logger("Safari12"),y={OS:1024,MIS:1024};class b extends m.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Safari12"}close(){if(v.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");let e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{e.addTransceiver("audio"),e.addTransceiver("video");let t=await e.createOffer();try{e.close()}catch(r){}let i=a.parse(t.sdp),n=d.extractRtpCapabilities({sdpObject:i});return p.addNackSuppportForOpus(n),n}catch(o){try{e.close()}catch(s){}throw o}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:y}}run({direction:e,iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n,iceServers:s,iceTransportPolicy:a,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),v.debug("run()"),this._direction=e,this._remoteSdp=new f.RemoteSdp({iceParameters:t,iceCandidates:r,dtlsParameters:i,sctpParameters:n}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:s||[],iceTransportPolicy:a||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...o},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){this.assertNotClosed(),v.debug("updateIceServers()");let t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(this.assertNotClosed(),v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){if("send"===this._direction){let t=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);let r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:t,codecOptions:r,codec:i}){let n;this.assertNotClosed(),this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);let s=l.clone(this._sendingRtpParametersByKind[e.kind],{});s.codecs=c.reduceCodecs(s.codecs,i);let o=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});o.codecs=c.reduceCodecs(o.codecs,i);let p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]}),m=await this._pc.createOffer(),f=a.parse(m.sdp);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f});let y=(0,g.parse)((t||[{}])[0].scalabilityMode);t&&t.length>1&&(v.debug("send() | enabling legacy simulcast"),n=(f=a.parse(m.sdp)).media[p.idx],u.addLegacySimulcast({offerMediaObject:n,numStreams:t.length}),m={type:"offer",sdp:a.write(f)}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",m),await this._pc.setLocalDescription(m);let b=h.mid;if(s.mid=b,n=(f=a.parse(this._pc.localDescription.sdp)).media[p.idx],s.rtcp.cname=d.getCname({offerMediaObject:n}),s.encodings=u.getRtpEncodings({offerMediaObject:n}),t)for(let w=0;w<s.encodings.length;++w)t[w]&&Object.assign(s.encodings[w],t[w]);if(s.encodings.length>1&&("video/vp8"===s.codecs[0].mimeType.toLowerCase()||"video/h264"===s.codecs[0].mimeType.toLowerCase()))for(let _ of s.encodings)_.scalabilityMode?_.scalabilityMode=`L1T${y.temporalLayers}`:_.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:n,reuseMid:p.reuseMid,offerRtpParameters:s,answerRtpParameters:o,codecOptions:r});let S={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",S),await this._pc.setRemoteDescription(S),this._mapMidTransceiver.set(b,h),{localId:b,rtpParameters:s,rtpSender:h.sender}}async stopSending(e){if(this.assertSendDirection(),this._closed)return;v.debug("stopSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);let r=this._remoteSdp.closeMediaSection(t.mid);if(r)try{t.stop()}catch(i){}let n=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("pauseSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);let r=await this._pc.createOffer();v.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),v.debug("resumeSending() [localId:%s]",e);let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");t.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);let r=await this._pc.createOffer();v.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);let i={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,t){this.assertNotClosed(),this.assertSendDirection(),t?v.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):v.debug("replaceTrack() [localId:%s, no track]",e);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{r<=t?e.active=!0:e.active=!1}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async setRtpEncodingParameters(e,t){this.assertNotClosed(),this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);let r=this._mapMidTransceiver.get(e);if(!r)throw Error("associated RTCRtpTransceiver not found");let i=r.sender.getParameters();i.encodings.forEach((e,r)=>{i.encodings[r]={...e,...t}}),await r.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);let n=await this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);let s={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:r,label:i,protocol:n}){this.assertNotClosed(),this.assertSendDirection();let s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:r,protocol:n};v.debug("sendDataChannel() [options:%o]",s);let o=this._pc.createDataChannel(i,s);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%y.MIS,!this._hasDataChannelMediaSection){let l=await this._pc.createOffer(),c=a.parse(l.sdp),d=c.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c}),v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});let u={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}let p={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits};return{dataChannel:o,sctpStreamParameters:p}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();let t=[],r=new Map;for(let i of e){let{trackId:n,kind:s,rtpParameters:o,streamId:l}=i;v.debug("receive() [trackId:%s, kind:%s]",n,s);let c=o.mid||String(this._mapMidTransceiver.size);r.set(n,c),this._remoteSdp.receive({mid:c,kind:s,offerRtpParameters:o,streamId:l||o.rtcp.cname,trackId:n})}let u={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",u),await this._pc.setRemoteDescription(u);let p=await this._pc.createAnswer(),h=a.parse(p.sdp);for(let m of e){let{trackId:f,rtpParameters:g}=m,y=r.get(f),b=h.media.find(e=>String(e.mid)===y);d.applyCodecParameters({offerRtpParameters:g,answerMediaObject:b})}for(let w of(p={type:"answer",sdp:a.write(h)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:h}),v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),e)){let{trackId:_}=w,S=r.get(_),x=this._pc.getTransceivers().find(e=>e.mid===S);if(!x)throw Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(S,x),t.push({localId:S,track:x.receiver.track,rtpReceiver:x.receiver})}return t}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(let t of e){v.debug("stopReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(r.mid)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();for(let s of(v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n),e))this._mapMidTransceiver.delete(s)}async pauseReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){v.debug("pauseReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){for(let t of(this.assertNotClosed(),this.assertRecvDirection(),e)){v.debug("resumeReceiving() [localId:%s]",t);let r=this._mapMidTransceiver.get(t);if(!r)throw Error("associated RTCRtpTransceiver not found");r.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}let i={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let n=await this._pc.createAnswer();v.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();let t=this._mapMidTransceiver.get(e);if(!t)throw Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();let{streamId:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o}=e,l={negotiated:!0,id:i,ordered:n,maxPacketLifeTime:s,maxRetransmits:o,protocol:r};v.debug("receiveDataChannel() [options:%o]",l);let c=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();let d={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);let u=await this._pc.createAnswer();if(!this._transportReady){let p=a.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=a.parse(this._pc.localDescription.sdp));let r=d.extractDtlsParameters({sdpObject:t});r.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:r},e,t)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new h.InvalidStateError("method called in a closed handler")}assertSendDirection(){if("send"!==this._direction)throw Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw Error('method can just be called for handlers with "recv" direction')}}t.Safari12=b},63635:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.mangleRtpParameters=t.getCapabilities=void 0;let a=s(r(13347));t.getCapabilities=function(){let e=RTCRtpReceiver.getCapabilities(),t=a.clone(e,{});for(let r of t.codecs){if(r.channels=r.numChannels,delete r.numChannels,r.mimeType=r.mimeType||`${r.kind}/${r.name}`,r.parameters){let i=r.parameters;i.apt&&(i.apt=Number(i.apt)),i["packetization-mode"]&&(i["packetization-mode"]=Number(i["packetization-mode"]))}for(let n of r.rtcpFeedback||[])n.parameter||(n.parameter="")}return t},t.mangleRtpParameters=function(e){let t=a.clone(e,{});for(let r of(t.mid&&(t.muxId=t.mid,delete t.mid),t.codecs))r.channels&&(r.numChannels=r.channels,delete r.channels),r.mimeType&&!r.name&&(r.name=r.mimeType.split("/")[1]),delete r.mimeType;return t}},58954:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addNackSuppportForOpus=void 0,t.addNackSuppportForOpus=function(e){for(let t of e.codecs||[])"audio/opus"!==t.mimeType.toLowerCase()&&"audio/multiopus"!==t.mimeType.toLowerCase()||t.rtcpFeedback?.some(e=>"nack"===e.type&&!e.parameter)||(t.rtcpFeedback||(t.rtcpFeedback=[]),t.rtcpFeedback.push({type:"nack"}))}},76698:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OfferMediaSection=t.AnswerMediaSection=t.MediaSection=void 0;let a=s(r(70766)),o=s(r(13347));class l{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:r,planB:i=!1}){if(this._mediaObject={},this._planB=i,e&&this.setIceParameters(e),t){for(let n of(this._mediaObject.candidates=[],t)){let s={};s.component=1,s.foundation=n.foundation,s.ip=n.ip,s.port=n.port,s.priority=n.priority,s.transport=n.protocol,s.type=n.type,n.tcpType&&(s.tcptype=n.tcpType),this._mediaObject.candidates.push(s)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}r&&this.setDtlsRole(r.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return 0===this._mediaObject.port}getObject(){return this._mediaObject}setIceParameters(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}}function c(e){let t=RegExp("^(audio|video)/(.+)","i"),r=t.exec(e.mimeType);if(!r)throw TypeError("invalid codec.mimeType");return r[2]}t.MediaSection=l,t.AnswerMediaSection=class extends l{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:r,sctpParameters:i,plainRtpParameters:n,planB:s=!1,offerMediaObject:a,offerRtpParameters:l,answerRtpParameters:d,codecOptions:u,extmapAllowMixed:p=!1}){switch(super({iceParameters:e,iceCandidates:t,dtlsParameters:r,planB:s}),this._mediaObject.mid=String(a.mid),this._mediaObject.type=a.type,this._mediaObject.protocol=a.protocol,n?(this._mediaObject.connection={ip:n.ip,version:n.ipVersion},this._mediaObject.port=n.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),a.type){case"audio":case"video":for(let h of(this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],d.codecs)){let m={payload:h.payloadType,codec:c(h),rate:h.clockRate};h.channels>1&&(m.encoding=h.channels),this._mediaObject.rtp.push(m);let f=o.clone(h.parameters,{}),g=o.clone(h.rtcpFeedback,[]);if(u){let{opusStereo:v,opusFec:y,opusDtx:b,opusMaxPlaybackRate:w,opusMaxAverageBitrate:_,opusPtime:S,opusNack:x,videoGoogleStartBitrate:C,videoGoogleMaxBitrate:T,videoGoogleMinBitrate:k}=u,R=l.codecs.find(e=>e.payloadType===h.payloadType);switch(h.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":void 0!==v&&(R.parameters["sprop-stereo"]=v?1:0,f.stereo=v?1:0),void 0!==y&&(R.parameters.useinbandfec=y?1:0,f.useinbandfec=y?1:0),void 0!==b&&(R.parameters.usedtx=b?1:0,f.usedtx=b?1:0),void 0!==w&&(f.maxplaybackrate=w),void 0!==_&&(f.maxaveragebitrate=_),void 0!==S&&(R.parameters.ptime=S,f.ptime=S),x||(R.rtcpFeedback=R.rtcpFeedback.filter(e=>"nack"!==e.type||e.parameter),g=g.filter(e=>"nack"!==e.type||e.parameter));break;case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":void 0!==C&&(f["x-google-start-bitrate"]=C),void 0!==T&&(f["x-google-max-bitrate"]=T),void 0!==k&&(f["x-google-min-bitrate"]=k)}}let E={payload:h.payloadType,config:""};for(let P of Object.keys(f))E.config&&(E.config+=";"),E.config+=`${P}=${f[P]}`;for(let D of(E.config&&this._mediaObject.fmtp.push(E),g))this._mediaObject.rtcpFb.push({payload:h.payloadType,type:D.type,subtype:D.parameter})}for(let L of(this._mediaObject.payloads=d.codecs.map(e=>e.payloadType).join(" "),this._mediaObject.ext=[],d.headerExtensions)){let I=(a.ext||[]).some(e=>e.uri===L.uri);I&&this._mediaObject.ext.push({uri:L.uri,value:L.id})}if(p&&"extmap-allow-mixed"===a.extmapAllowMixed&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),a.simulcast)for(let M of(this._mediaObject.simulcast={dir1:"recv",list1:a.simulcast.list1},this._mediaObject.rids=[],a.rids||[]))"send"===M.direction&&this._mediaObject.rids.push({id:M.id,direction:"recv"});else if(a.simulcast_03)for(let j of(this._mediaObject.simulcast_03={value:a.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[],a.rids||[]))"send"===j.direction&&this._mediaObject.rids.push({id:j.id,direction:"recv"});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize",this._planB&&"video"===this._mediaObject.type&&(this._mediaObject.xGoogleFlag="conference");break;case"application":"number"==typeof a.sctpPort?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=i.port,this._mediaObject.maxMessageSize=i.maxMessageSize):a.sctpmap&&(this._mediaObject.payloads=i.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:i.port,maxMessageSize:i.maxMessageSize})}}setDtlsRole(e){switch(e){case"client":this._mediaObject.setup="active";break;case"server":this._mediaObject.setup="passive";break;case"auto":this._mediaObject.setup="actpass"}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(e){if(!this._mediaObject.simulcast||!this._mediaObject.simulcast.list1)return;let t={};for(let r of e)r.rid&&(t[r.rid]=r);let i=this._mediaObject.simulcast.list1,n=a.parseSimulcastStreamList(i);for(let s of n)for(let o of s)o.paused=!t[o.scid]?.active;this._mediaObject.simulcast.list1=n.map(e=>e.map(e=>`${e.paused?"~":""}${e.scid}`).join(",")).join(";")}},t.OfferMediaSection=class extends l{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:r,sctpParameters:i,plainRtpParameters:n,planB:s=!1,mid:a,kind:o,offerRtpParameters:l,streamId:d,trackId:u,oldDataChannelSpec:p=!1}){switch(super({iceParameters:e,iceCandidates:t,dtlsParameters:r,planB:s}),this._mediaObject.mid=String(a),this._mediaObject.type=o,n?(this._mediaObject.connection={ip:n.ip,version:n.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=n.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},i?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),o){case"audio":case"video":{for(let h of(this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._planB||(this._mediaObject.msid=`${d||"-"} ${u}`),l.codecs)){let m={payload:h.payloadType,codec:c(h),rate:h.clockRate};h.channels>1&&(m.encoding=h.channels),this._mediaObject.rtp.push(m);let f={payload:h.payloadType,config:""};for(let g of Object.keys(h.parameters))f.config&&(f.config+=";"),f.config+=`${g}=${h.parameters[g]}`;for(let v of(f.config&&this._mediaObject.fmtp.push(f),h.rtcpFeedback))this._mediaObject.rtcpFb.push({payload:h.payloadType,type:v.type,subtype:v.parameter})}for(let y of(this._mediaObject.payloads=l.codecs.map(e=>e.payloadType).join(" "),this._mediaObject.ext=[],l.headerExtensions))this._mediaObject.ext.push({uri:y.uri,value:y.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";let b=l.encodings[0],w=b.ssrc,_=b.rtx&&b.rtx.ssrc?b.rtx.ssrc:void 0;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],l.rtcp.cname&&this._mediaObject.ssrcs.push({id:w,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:w,attribute:"msid",value:`${d||"-"} ${u}`}),_&&(l.rtcp.cname&&this._mediaObject.ssrcs.push({id:_,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:_,attribute:"msid",value:`${d||"-"} ${u}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${w} ${_}`}));break}case"application":p?(this._mediaObject.payloads=i.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:i.port,maxMessageSize:i.maxMessageSize}):(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=i.port,this._mediaObject.maxMessageSize=i.maxMessageSize)}}setDtlsRole(e){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}planBReceive({offerRtpParameters:e,streamId:t,trackId:r}){let i=e.encodings[0],n=i.ssrc,s=i.rtx&&i.rtx.ssrc?i.rtx.ssrc:void 0,a=this._mediaObject.payloads.split(" ");for(let o of e.codecs){if(a.includes(String(o.payloadType)))continue;let l={payload:o.payloadType,codec:c(o),rate:o.clockRate};o.channels>1&&(l.encoding=o.channels),this._mediaObject.rtp.push(l);let d={payload:o.payloadType,config:""};for(let u of Object.keys(o.parameters))d.config&&(d.config+=";"),d.config+=`${u}=${o.parameters[u]}`;for(let p of(d.config&&this._mediaObject.fmtp.push(d),o.rtcpFeedback))this._mediaObject.rtcpFb.push({payload:o.payloadType,type:p.type,subtype:p.parameter})}this._mediaObject.payloads+=` ${e.codecs.filter(e=>!this._mediaObject.payloads.includes(e.payloadType)).map(e=>e.payloadType).join(" ")}`,this._mediaObject.payloads=this._mediaObject.payloads.trim(),e.rtcp.cname&&this._mediaObject.ssrcs.push({id:n,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:n,attribute:"msid",value:`${t||"-"} ${r}`}),s&&(e.rtcp.cname&&this._mediaObject.ssrcs.push({id:s,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:s,attribute:"msid",value:`${t||"-"} ${r}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${n} ${s}`}))}planBStopReceiving({offerRtpParameters:e}){let t=e.encodings[0],r=t.ssrc,i=t.rtx&&t.rtx.ssrc?t.rtx.ssrc:void 0;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter(e=>e.id!==r&&e.id!==i),i&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter(e=>e.ssrcs!==`${r} ${i}`))}}},37910:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteSdp=void 0;let a=s(r(70766)),o=r(38562),l=r(76698),c=new o.Logger("RemoteSdp");t.RemoteSdp=class{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:r,sctpParameters:i,plainRtpParameters:n,planB:s=!1}){if(this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=e,this._iceCandidates=t,this._dtlsParameters=r,this._sctpParameters=i,this._plainRtpParameters=n,this._planB=s,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},e&&e.iceLite&&(this._sdpObject.icelite="ice-lite"),r){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};let a=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:r.fingerprints[a-1].algorithm,hash:r.fingerprints[a-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}n&&(this._sdpObject.origin.address=n.ip,this._sdpObject.origin.ipVer=n.ipVersion)}updateIceParameters(e){for(let t of(c.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0,this._mediaSections))t.setIceParameters(e)}updateDtlsRole(e){for(let t of(c.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e,this._mediaSections))t.setDtlsRole(e)}getNextMediaSectionIdx(){for(let e=0;e<this._mediaSections.length;++e){let t=this._mediaSections[e];if(t.closed)return{idx:e,reuseMid:t.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:e,reuseMid:t,offerRtpParameters:r,answerRtpParameters:i,codecOptions:n,extmapAllowMixed:s=!1}){let a=new l.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:e,offerRtpParameters:r,answerRtpParameters:i,codecOptions:n,extmapAllowMixed:s});t?this._replaceMediaSection(a,t):this._midToIndex.has(a.mid)?this._replaceMediaSection(a):this._addMediaSection(a)}receive({mid:e,kind:t,offerRtpParameters:r,streamId:i,trackId:n}){let s;let a=this._midToIndex.get(e);if(void 0!==a&&(s=this._mediaSections[a]),s)s.planBReceive({offerRtpParameters:r,streamId:i,trackId:n}),this._replaceMediaSection(s);else{s=new l.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:e,kind:t,offerRtpParameters:r,streamId:i,trackId:n});let o=this._mediaSections.find(e=>e.closed);o?this._replaceMediaSection(s,o.mid):this._addMediaSection(s)}}pauseMediaSection(e){let t=this._findMediaSection(e);t.pause()}resumeSendingMediaSection(e){let t=this._findMediaSection(e);t.resume()}resumeReceivingMediaSection(e){let t=this._findMediaSection(e);t.resume()}disableMediaSection(e){let t=this._findMediaSection(e);t.disable()}closeMediaSection(e){let t=this._findMediaSection(e);return e===this._firstMid?(c.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),this.disableMediaSection(e),!1):(t.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(e,t){let r=this._findMediaSection(e);r.muxSimulcastStreams(t),this._replaceMediaSection(r)}planBStopReceiving({mid:e,offerRtpParameters:t}){let r=this._findMediaSection(e);r.planBStopReceiving({offerRtpParameters:t}),this._replaceMediaSection(r)}sendSctpAssociation({offerMediaObject:e}){let t=new l.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:e});this._addMediaSection(t)}receiveSctpAssociation({oldDataChannelSpec:e=!1}={}){let t=new l.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:e});this._addMediaSection(t)}getSdp(){return this._sdpObject.origin.sessionVersion++,a.write(this._sdpObject)}_addMediaSection(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}_replaceMediaSection(e,t){if("string"==typeof t){let r=this._midToIndex.get(t);if(void 0===r)throw Error(`no media section found for reuseMid '${t}'`);let i=this._mediaSections[r];this._mediaSections[r]=e,this._midToIndex.delete(i.mid),this._midToIndex.set(e.mid,r),this._sdpObject.media[r]=e.getObject(),this._regenerateBundleMids()}else{let n=this._midToIndex.get(e.mid);if(void 0===n)throw Error(`no media section found with mid '${e.mid}'`);this._mediaSections[n]=e,this._sdpObject.media[n]=e.getObject()}}_findMediaSection(e){let t=this._midToIndex.get(e);if(void 0===t)throw Error(`no media section found with mid '${e}'`);return this._mediaSections[t]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(e=>!e.closed).map(e=>e.mid).join(" "))}}},82267:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.applyCodecParameters=t.getCname=t.extractDtlsParameters=t.extractRtpCapabilities=void 0;let a=s(r(70766));t.extractRtpCapabilities=function({sdpObject:e}){let t=new Map,r=[],i=!1,n=!1;for(let s of e.media){let o=s.type;switch(o){case"audio":if(i)continue;i=!0;break;case"video":if(n)continue;n=!0;break;default:continue}for(let l of s.rtp){let c={kind:o,mimeType:`${o}/${l.codec}`,preferredPayloadType:l.payload,clockRate:l.rate,channels:l.encoding,parameters:{},rtcpFeedback:[]};t.set(c.preferredPayloadType,c)}for(let d of s.fmtp||[]){let u=a.parseParams(d.config),p=t.get(d.payload);p&&(u&&u.hasOwnProperty("profile-level-id")&&(u["profile-level-id"]=String(u["profile-level-id"])),p.parameters=u)}for(let h of s.rtcpFb||[]){let m={type:h.type,parameter:h.subtype};if(m.parameter||delete m.parameter,"*"!==h.payload){let f=t.get(h.payload);if(!f)continue;f.rtcpFeedback.push(m)}else for(let g of t.values())g.kind!==o||/.+\/rtx$/i.test(g.mimeType)||g.rtcpFeedback.push(m)}for(let v of s.ext||[]){if(v["encrypt-uri"])continue;let y={kind:o,uri:v.uri,preferredId:v.value};r.push(y)}}let b={codecs:Array.from(t.values()),headerExtensions:r};return b},t.extractDtlsParameters=function({sdpObject:e}){let t;let r=(e.media||[]).find(e=>e.iceUfrag&&0!==e.port);if(!r)throw Error("no active media section found");let i=r.fingerprint||e.fingerprint;switch(r.setup){case"active":t="client";break;case"passive":t="server";break;case"actpass":t="auto"}let n={role:t,fingerprints:[{algorithm:i.type,value:i.hash}]};return n},t.getCname=function({offerMediaObject:e}){let t=(e.ssrcs||[]).find(e=>"cname"===e.attribute);return t?t.value:""},t.applyCodecParameters=function({offerRtpParameters:e,answerMediaObject:t}){for(let r of e.codecs){let i=r.mimeType.toLowerCase();if("audio/opus"!==i)continue;let n=(t.rtp||[]).find(e=>e.payload===r.payloadType);if(!n)continue;t.fmtp=t.fmtp||[];let s=t.fmtp.find(e=>e.payload===r.payloadType);s||(s={payload:r.payloadType,config:""},t.fmtp.push(s));let o=a.parseParams(s.config);if("audio/opus"===i){let l=r.parameters["sprop-stereo"];void 0!==l&&(o.stereo=l?1:0)}for(let c of(s.config="",Object.keys(o)))s.config&&(s.config+=";"),s.config+=`${c}=${o[c]}`}}},89875:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function({offerMediaObject:e,track:t}){let r;let i=new Set;for(let n of e.ssrcs||[]){if("msid"!==n.attribute)continue;let s=n.value.split(" ")[1];if(s===t.id){let a=n.id;i.add(a),r||(r=a)}}if(0===i.size)throw Error(`a=ssrc line with msid information not found [track.id:${t.id}]`);let o=new Map;for(let l of e.ssrcGroups||[]){if("FID"!==l.semantics)continue;let[c,d]=l.ssrcs.split(/\s+/);c=Number(c),d=Number(d),i.has(c)&&(i.delete(c),i.delete(d),o.set(c,d))}for(let u of i)o.set(u,null);let p=[];for(let[h,m]of o){let f={ssrc:h};m&&(f.rtx={ssrc:m}),p.push(f)}return p},t.addLegacySimulcast=function({offerMediaObject:e,track:t,numStreams:r}){let i,n,s;if(r<=1)throw TypeError("numStreams must be greater than 1");let a=(e.ssrcs||[]).find(e=>{if("msid"!==e.attribute)return!1;let r=e.value.split(" ")[1];return r===t.id&&(i=e.id,s=e.value.split(" ")[0],!0)});if(!a)throw Error(`a=ssrc line with msid information not found [track.id:${t.id}]`);(e.ssrcGroups||[]).some(e=>{if("FID"!==e.semantics)return!1;let t=e.ssrcs.split(/\s+/);return Number(t[0])===i&&(n=Number(t[1]),!0)});let o=e.ssrcs.find(e=>"cname"===e.attribute&&e.id===i);if(!o)throw Error(`a=ssrc line with cname information not found [track.id:${t.id}]`);let l=o.value,c=[],d=[];for(let u=0;u<r;++u)c.push(i+u),n&&d.push(n+u);e.ssrcGroups=e.ssrcGroups||[],e.ssrcs=e.ssrcs||[],e.ssrcGroups.push({semantics:"SIM",ssrcs:c.join(" ")});for(let p=0;p<c.length;++p){let h=c[p];e.ssrcs.push({id:h,attribute:"cname",value:l}),e.ssrcs.push({id:h,attribute:"msid",value:`${s} ${t.id}`})}for(let m=0;m<d.length;++m){let f=c[m],g=d[m];e.ssrcs.push({id:g,attribute:"cname",value:l}),e.ssrcs.push({id:g,attribute:"msid",value:`${s} ${t.id}`}),e.ssrcGroups.push({semantics:"FID",ssrcs:`${f} ${g}`})}}},29072:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function({offerMediaObject:e}){let t=new Set;for(let r of e.ssrcs||[]){let i=r.id;t.add(i)}if(0===t.size)throw Error("no a=ssrc lines found");let n=new Map;for(let s of e.ssrcGroups||[]){if("FID"!==s.semantics)continue;let[a,o]=s.ssrcs.split(/\s+/);a=Number(a),o=Number(o),t.has(a)&&(t.delete(a),t.delete(o),n.set(a,o))}for(let l of t)n.set(l,null);let c=[];for(let[d,u]of n){let p={ssrc:d};u&&(p.rtx={ssrc:u}),c.push(p)}return c},t.addLegacySimulcast=function({offerMediaObject:e,numStreams:t}){let r;if(t<=1)throw TypeError("numStreams must be greater than 1");let i=(e.ssrcs||[]).find(e=>"msid"===e.attribute);if(!i)throw Error("a=ssrc line with msid information not found");let[n,s]=i.value.split(" "),a=i.id;(e.ssrcGroups||[]).some(e=>{if("FID"!==e.semantics)return!1;let t=e.ssrcs.split(/\s+/);return Number(t[0])===a&&(r=Number(t[1]),!0)});let o=e.ssrcs.find(e=>"cname"===e.attribute);if(!o)throw Error("a=ssrc line with cname information not found");let l=o.value,c=[],d=[];for(let u=0;u<t;++u)c.push(a+u),r&&d.push(r+u);e.ssrcGroups=[],e.ssrcs=[],e.ssrcGroups.push({semantics:"SIM",ssrcs:c.join(" ")});for(let p=0;p<c.length;++p){let h=c[p];e.ssrcs.push({id:h,attribute:"cname",value:l}),e.ssrcs.push({id:h,attribute:"msid",value:`${n} ${s}`})}for(let m=0;m<d.length;++m){let f=c[m],g=d[m];e.ssrcs.push({id:g,attribute:"cname",value:l}),e.ssrcs.push({id:g,attribute:"msid",value:`${n} ${s}`}),e.ssrcGroups.push({semantics:"FID",ssrcs:`${f} ${g}`})}}},50960:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=t.parseScalabilityMode=t.detectDevice=t.Device=t.version=t.types=void 0;let o=a(r(11227));t.debug=o.default;let l=r(43120);Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return l.Device}}),Object.defineProperty(t,"detectDevice",{enumerable:!0,get:function(){return l.detectDevice}});let c=s(r(10053));t.types=c,t.version="3.6.97";var d=r(82770);Object.defineProperty(t,"parseScalabilityMode",{enumerable:!0,get:function(){return d.parse}})},45280:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.canReceive=t.canSend=t.generateProbatorRtpParameters=t.reduceCodecs=t.getSendingRemoteRtpParameters=t.getSendingRtpParameters=t.getRecvRtpCapabilities=t.getExtendedRtpCapabilities=t.validateSctpStreamParameters=t.validateSctpParameters=t.validateNumSctpStreams=t.validateSctpCapabilities=t.validateRtcpParameters=t.validateRtpEncodingParameters=t.validateRtpHeaderExtensionParameters=t.validateRtpCodecParameters=t.validateRtpParameters=t.validateRtpHeaderExtension=t.validateRtcpFeedback=t.validateRtpCodecCapability=t.validateRtpCapabilities=void 0;let a=s(r(57855)),o=s(r(13347));function l(e){let t=RegExp("^(audio|video)/(.+)","i");if("object"!=typeof e)throw TypeError("codec is not an object");if(!e.mimeType||"string"!=typeof e.mimeType)throw TypeError("missing codec.mimeType");let r=t.exec(e.mimeType);if(!r)throw TypeError("invalid codec.mimeType");if(e.kind=r[1].toLowerCase(),e.preferredPayloadType&&"number"!=typeof e.preferredPayloadType)throw TypeError("invalid codec.preferredPayloadType");if("number"!=typeof e.clockRate)throw TypeError("missing codec.clockRate");for(let i of("audio"===e.kind?"number"!=typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"==typeof e.parameters||(e.parameters={}),Object.keys(e.parameters))){let n=e.parameters[i];if(void 0===n&&(e.parameters[i]="",n=""),"string"!=typeof n&&"number"!=typeof n)throw TypeError(`invalid codec parameter [key:${i}s, value:${n}]`);if("apt"===i&&"number"!=typeof n)throw TypeError("invalid codec apt parameter")}for(let s of(e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]),e.rtcpFeedback))c(s)}function c(e){if("object"!=typeof e)throw TypeError("fb is not an object");if(!e.type||"string"!=typeof e.type)throw TypeError("missing fb.type");e.parameter&&"string"==typeof e.parameter||(e.parameter="")}function d(e){if("object"!=typeof e)throw TypeError("ext is not an object");if("audio"!==e.kind&&"video"!==e.kind)throw TypeError("invalid ext.kind");if(!e.uri||"string"!=typeof e.uri)throw TypeError("missing ext.uri");if("number"!=typeof e.preferredId)throw TypeError("missing ext.preferredId");if(e.preferredEncrypt&&"boolean"!=typeof e.preferredEncrypt)throw TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&"string"!=typeof e.direction)throw TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function u(e){if("object"!=typeof e)throw TypeError("params is not an object");if(e.mid&&"string"!=typeof e.mid)throw TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw TypeError("missing params.codecs");for(let t of e.codecs)p(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw TypeError("params.headerExtensions is not an array");for(let r of(e.headerExtensions||(e.headerExtensions=[]),e.headerExtensions))h(r);if(e.encodings&&!Array.isArray(e.encodings))throw TypeError("params.encodings is not an array");for(let i of(e.encodings||(e.encodings=[]),e.encodings))m(i);if(e.rtcp&&"object"!=typeof e.rtcp)throw TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),f(e.rtcp)}function p(e){let t=RegExp("^(audio|video)/(.+)","i");if("object"!=typeof e)throw TypeError("codec is not an object");if(!e.mimeType||"string"!=typeof e.mimeType)throw TypeError("missing codec.mimeType");let r=t.exec(e.mimeType);if(!r)throw TypeError("invalid codec.mimeType");if("number"!=typeof e.payloadType)throw TypeError("missing codec.payloadType");if("number"!=typeof e.clockRate)throw TypeError("missing codec.clockRate");let i=r[1].toLowerCase();for(let n of("audio"===i?"number"!=typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"==typeof e.parameters||(e.parameters={}),Object.keys(e.parameters))){let s=e.parameters[n];if(void 0===s&&(e.parameters[n]="",s=""),"string"!=typeof s&&"number"!=typeof s)throw TypeError(`invalid codec parameter [key:${n}s, value:${s}]`);if("apt"===n&&"number"!=typeof s)throw TypeError("invalid codec apt parameter")}for(let a of(e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]),e.rtcpFeedback))c(a)}function h(e){if("object"!=typeof e)throw TypeError("ext is not an object");if(!e.uri||"string"!=typeof e.uri)throw TypeError("missing ext.uri");if("number"!=typeof e.id)throw TypeError("missing ext.id");if(e.encrypt&&"boolean"!=typeof e.encrypt)throw TypeError("invalid ext.encrypt");for(let t of(e.encrypt||(e.encrypt=!1),e.parameters&&"object"==typeof e.parameters||(e.parameters={}),Object.keys(e.parameters))){let r=e.parameters[t];if(void 0===r&&(e.parameters[t]="",r=""),"string"!=typeof r&&"number"!=typeof r)throw TypeError("invalid header extension parameter")}}function m(e){if("object"!=typeof e)throw TypeError("encoding is not an object");if(e.ssrc&&"number"!=typeof e.ssrc)throw TypeError("invalid encoding.ssrc");if(e.rid&&"string"!=typeof e.rid)throw TypeError("invalid encoding.rid");if(e.rtx&&"object"!=typeof e.rtx)throw TypeError("invalid encoding.rtx");if(e.rtx&&"number"!=typeof e.rtx.ssrc)throw TypeError("missing encoding.rtx.ssrc");if(e.dtx&&"boolean"==typeof e.dtx||(e.dtx=!1),e.scalabilityMode&&"string"!=typeof e.scalabilityMode)throw TypeError("invalid encoding.scalabilityMode")}function f(e){if("object"!=typeof e)throw TypeError("rtcp is not an object");if(e.cname&&"string"!=typeof e.cname)throw TypeError("invalid rtcp.cname");e.reducedSize&&"boolean"==typeof e.reducedSize||(e.reducedSize=!0)}function g(e){if("object"!=typeof e)throw TypeError("numStreams is not an object");if("number"!=typeof e.OS)throw TypeError("missing numStreams.OS");if("number"!=typeof e.MIS)throw TypeError("missing numStreams.MIS")}function v(e){return!!e&&/.+\/rtx$/i.test(e.mimeType)}function y(e,t,{strict:r=!1,modify:i=!1}={}){let n=e.mimeType.toLowerCase(),s=t.mimeType.toLowerCase();if(n!==s||e.clockRate!==t.clockRate||e.channels!==t.channels)return!1;switch(n){case"video/h264":if(r){let o;let l=e.parameters["packetization-mode"]||0,c=t.parameters["packetization-mode"]||0;if(l!==c||!a.isSameProfile(e.parameters,t.parameters))return!1;try{o=a.generateProfileLevelIdForAnswer(e.parameters,t.parameters)}catch(d){return!1}i&&(o?(e.parameters["profile-level-id"]=o,t.parameters["profile-level-id"]=o):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break;case"video/vp9":if(r){let u=e.parameters["profile-id"]||0,p=t.parameters["profile-id"]||0;if(u!==p)return!1}}return!0}t.validateRtpCapabilities=function(e){if("object"!=typeof e)throw TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw TypeError("caps.codecs is not an array");for(let t of(e.codecs||(e.codecs=[]),e.codecs))l(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw TypeError("caps.headerExtensions is not an array");for(let r of(e.headerExtensions||(e.headerExtensions=[]),e.headerExtensions))d(r)},t.validateRtpCodecCapability=l,t.validateRtcpFeedback=c,t.validateRtpHeaderExtension=d,t.validateRtpParameters=u,t.validateRtpCodecParameters=p,t.validateRtpHeaderExtensionParameters=h,t.validateRtpEncodingParameters=m,t.validateRtcpParameters=f,t.validateSctpCapabilities=function(e){if("object"!=typeof e)throw TypeError("caps is not an object");if(!e.numStreams||"object"!=typeof e.numStreams)throw TypeError("missing caps.numStreams");g(e.numStreams)},t.validateNumSctpStreams=g,t.validateSctpParameters=function(e){if("object"!=typeof e)throw TypeError("params is not an object");if("number"!=typeof e.port)throw TypeError("missing params.port");if("number"!=typeof e.OS)throw TypeError("missing params.OS");if("number"!=typeof e.MIS)throw TypeError("missing params.MIS");if("number"!=typeof e.maxMessageSize)throw TypeError("missing params.maxMessageSize")},t.validateSctpStreamParameters=function(e){if("object"!=typeof e)throw TypeError("params is not an object");if("number"!=typeof e.streamId)throw TypeError("missing params.streamId");let t=!1;if("boolean"==typeof e.ordered?t=!0:e.ordered=!0,e.maxPacketLifeTime&&"number"!=typeof e.maxPacketLifeTime)throw TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&"number"!=typeof e.maxRetransmits)throw TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!t&&(e.maxPacketLifeTime||e.maxRetransmits)&&(e.ordered=!1),e.label&&"string"!=typeof e.label)throw TypeError("invalid params.label");if(e.protocol&&"string"!=typeof e.protocol)throw TypeError("invalid params.protocol")},t.getExtendedRtpCapabilities=function(e,t){let r={codecs:[],headerExtensions:[]};for(let i of t.codecs||[]){if(v(i))continue;let n=(e.codecs||[]).find(e=>y(e,i,{strict:!0,modify:!0}));if(!n)continue;let s={mimeType:n.mimeType,kind:n.kind,clockRate:n.clockRate,channels:n.channels,localPayloadType:n.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:i.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:n.parameters,remoteParameters:i.parameters,rtcpFeedback:function(e,t){let r=[];for(let i of e.rtcpFeedback||[]){let n=(t.rtcpFeedback||[]).find(e=>e.type===i.type&&(e.parameter===i.parameter||!e.parameter&&!i.parameter));n&&r.push(n)}return r}(n,i)};r.codecs.push(s)}for(let a of r.codecs){let o=e.codecs.find(e=>v(e)&&e.parameters.apt===a.localPayloadType),l=t.codecs.find(e=>v(e)&&e.parameters.apt===a.remotePayloadType);o&&l&&(a.localRtxPayloadType=o.preferredPayloadType,a.remoteRtxPayloadType=l.preferredPayloadType)}for(let c of t.headerExtensions){let d=e.headerExtensions.find(e=>{var t;return t=c,(!e.kind||!t.kind||e.kind===t.kind)&&e.uri===t.uri});if(!d)continue;let u={kind:c.kind,uri:c.uri,sendId:d.preferredId,recvId:c.preferredId,encrypt:d.preferredEncrypt,direction:"sendrecv"};switch(c.direction){case"sendrecv":u.direction="sendrecv";break;case"recvonly":u.direction="sendonly";break;case"sendonly":u.direction="recvonly";break;case"inactive":u.direction="inactive"}r.headerExtensions.push(u)}return r},t.getRecvRtpCapabilities=function(e){let t={codecs:[],headerExtensions:[]};for(let r of e.codecs){let i={mimeType:r.mimeType,kind:r.kind,preferredPayloadType:r.remotePayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.localParameters,rtcpFeedback:r.rtcpFeedback};if(t.codecs.push(i),!r.remoteRtxPayloadType)continue;let n={mimeType:`${r.kind}/rtx`,kind:r.kind,preferredPayloadType:r.remoteRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.remotePayloadType},rtcpFeedback:[]};t.codecs.push(n)}for(let s of e.headerExtensions){if("sendrecv"!==s.direction&&"recvonly"!==s.direction)continue;let a={kind:s.kind,uri:s.uri,preferredId:s.recvId,preferredEncrypt:s.encrypt,direction:s.direction};t.headerExtensions.push(a)}return t},t.getSendingRtpParameters=function(e,t){let r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(let i of t.codecs){if(i.kind!==e)continue;let n={mimeType:i.mimeType,payloadType:i.localPayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.localParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(n),i.localRtxPayloadType){let s={mimeType:`${i.kind}/rtx`,payloadType:i.localRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.localPayloadType},rtcpFeedback:[]};r.codecs.push(s)}}for(let a of t.headerExtensions){if(a.kind&&a.kind!==e||"sendrecv"!==a.direction&&"sendonly"!==a.direction)continue;let o={uri:a.uri,id:a.sendId,encrypt:a.encrypt,parameters:{}};r.headerExtensions.push(o)}return r},t.getSendingRemoteRtpParameters=function(e,t){let r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(let i of t.codecs){if(i.kind!==e)continue;let n={mimeType:i.mimeType,payloadType:i.localPayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.remoteParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(n),i.localRtxPayloadType){let s={mimeType:`${i.kind}/rtx`,payloadType:i.localRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.localPayloadType},rtcpFeedback:[]};r.codecs.push(s)}}for(let a of t.headerExtensions){if(a.kind&&a.kind!==e||"sendrecv"!==a.direction&&"sendonly"!==a.direction)continue;let o={uri:a.uri,id:a.sendId,encrypt:a.encrypt,parameters:{}};r.headerExtensions.push(o)}if(r.headerExtensions.some(e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.uri))for(let l of r.codecs)l.rtcpFeedback=(l.rtcpFeedback||[]).filter(e=>"goog-remb"!==e.type);else if(r.headerExtensions.some(e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.uri))for(let c of r.codecs)c.rtcpFeedback=(c.rtcpFeedback||[]).filter(e=>"transport-cc"!==e.type);else for(let d of r.codecs)d.rtcpFeedback=(d.rtcpFeedback||[]).filter(e=>"transport-cc"!==e.type&&"goog-remb"!==e.type);return r},t.reduceCodecs=function(e,t){let r=[];if(t){for(let i=0;i<e.length;++i)if(y(e[i],t)){r.push(e[i]),v(e[i+1])&&r.push(e[i+1]);break}if(0===r.length)throw TypeError("no matching codec found")}else r.push(e[0]),v(e[1])&&r.push(e[1]);return r},t.generateProbatorRtpParameters=function(e){u(e=o.clone(e,{}));let t={mid:"probator",codecs:[],headerExtensions:[],encodings:[{ssrc:1234}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=127,t.headerExtensions=e.headerExtensions,t},t.canSend=function(e,t){return t.codecs.some(t=>t.kind===e)},t.canReceive=function(e,t){if(u(e),0===e.codecs.length)return!1;let r=e.codecs[0];return t.codecs.some(e=>e.remotePayloadType===r.payloadType)}},82770:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;let r=RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");t.parse=function(e){let t=r.exec(e||"");return t?{spatialLayers:Number(t[1]),temporalLayers:Number(t[2])}:{spatialLayers:1,temporalLayers:1}}},10053:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(43120),t),n(r(35202),t),n(r(26569),t),n(r(59514),t),n(r(25504),t),n(r(31623),t),n(r(94879),t),n(r(37669),t),n(r(89316),t),n(r(99992),t)},13347:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRandomNumber=t.clone=void 0,t.clone=function(e,t){return void 0===e?t:JSON.parse(JSON.stringify(e))},t.generateRandomNumber=function(){return Math.round(1e7*Math.random())}},54125:function(e){e.exports=function(){var e={80:function(e,t,r){e.exports=r(728).default},728:function(e,t,r){"use strict";r.d(t,{default:function(){return tj}});var i=r(48),n=r.n(i),s=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},a=function(){return("000000"+(2176782336*Math.random()<<0).toString(36)).slice(-6)},o=function(e){return e&&void 0!==e.nodeName?(e.muxId||(e.muxId=e.id||a()),e.muxId):e},l=function(e){e&&void 0!==e.nodeName?e=o(t=e):t=document.querySelector(e);var t,r=t&&t.nodeName?t.nodeName.toLowerCase():"";return[t,e,r]},c=r(640),d=r.n(c),u=d().methodFactory;d().methodFactory=function(e,t,r){var i=u(e,t,r);return function(){for(var e=["[mux]"],t=0;t<arguments.length;t++)e.push(arguments[t]);i.apply(void 0,e)}},d().setLevel(d().getLevel());var p=d();function h(){return"1"===(n().doNotTrack||n().navigator&&n().navigator.doNotTrack)}var m={now:function(){var e=n().performance,t=e&&e.timing,r=t&&t.navigationStart;return Math.round("number"==typeof r&&"function"==typeof e.now?r+e.now():Date.now())}},f=function(e){return g(e)[0]},g=function(e){if("string"!=typeof e||""===e)return["localhost"];var t,r=(e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/)||[])[4];return r&&(t=(r.match(/[^\.]+\.[^\.]+$/)||[])[0]),[r,t]},v={exists:function(){var e=n().performance;return void 0!==(e&&e.timing)},domContentLoadedEventEnd:function(){var e=n().performance,t=e&&e.timing;return t&&t.domContentLoadedEventEnd},navigationStart:function(){var e=n().performance,t=e&&e.timing;return t&&t.navigationStart}};function y(e,t,r){r=void 0===r?1:r,e[t]=e[t]||0,e[t]+=r}var b=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],w=["x-cdn","content-type"].concat(b);function _(e){var t={};return(e=e||"").trim().split(/[\r\n]+/).forEach(function(e){if(e){var r=e.split(": "),i=r.shift();i&&(w.indexOf(i.toLowerCase())>=0||0===i.toLowerCase().indexOf("x-litix-"))&&(t[i]=r.join(": "))}}),t}function S(e){if(e){var t=b.find(function(t){return void 0!==e[t]});return t?e[t]:void 0}}var x=function(e){var t={};for(var r in e){var i=e[r];-1!==i["DATA-ID"].search("io.litix.data.")&&(t[i["DATA-ID"].replace("io.litix.data.","")]=i.VALUE)}return t};function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach(function(t){var i,n;i=e,n=r[t],t in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var k=function(e){if(!e)return{};var t=v.navigationStart(),r=e.loading,i=r?r.start:e.trequest,n=r?r.first:e.tfirst,s=r?r.end:e.tload;return{bytesLoaded:e.total,requestStart:Math.round(t+i),responseStart:Math.round(t+n),responseEnd:Math.round(t+s)}},R=function(e){if(e&&"function"==typeof e.getAllResponseHeaders)return _(e.getAllResponseHeaders())};function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach(function(t){var i,n;i=e,n=r[t],t in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var D=function(e,t){if(!e||"function"!=typeof e.getRequests)return{};var r=e.getRequests({state:"executed"});if(0===r.length)return{};var i,n=r[r.length-1],s=f(n.url),a=n.url,o=n.bytesLoaded,l=new Date(n.requestStartDate).getTime(),c=new Date(n.firstByteDate).getTime(),d=new Date(n.requestEndDate).getTime(),u=isNaN(n.duration)?0:n.duration,p="function"==typeof t.getMetricsFor?t.getMetricsFor(n.mediaType).HttpList:t.getDashMetrics().getHttpRequests(n.mediaType);return p.length>0&&(i=_(p[p.length-1]._responseHeaders||"")),{requestStart:l,requestResponseStart:c,requestResponseEnd:d,requestBytesLoaded:o,requestResponseHeaders:i,requestMediaDuration:u,requestHostname:s,requestUrl:a,requestId:i?S(i):void 0}},L=function(e,t){var r=t.getQualityFor(e),i=t.getCurrentTrackFor(e).bitrateList;return i?{currentLevel:r,renditionWidth:i[r].width||null,renditionHeight:i[r].height||null,renditionBitrate:i[r].bandwidth}:{}},I=function(e){var t;return null===(t=e.match(/.*codecs\*?="(.*)"/))||void 0===t?void 0:t[1]};function M(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var j=0,O=function(){var e,t;function r(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,r)}return e=[{key:"on",value:function(e,t,r){return t._eventEmitterGuid=t._eventEmitterGuid||++j,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],r&&(t=t.bind(r)),this._listeners[e].push(t),t}},{key:"off",value:function(e,t){var r=this._listeners&&this._listeners[e];r&&r.forEach(function(e,i){e._eventEmitterGuid===t._eventEmitterGuid&&r.splice(i,1)})}},{key:"one",value:function(e,t,r){var i=this;t._eventEmitterGuid=t._eventEmitterGuid||++j;var n=function n(){i.off(e,n),t.apply(r||this,arguments)};n._eventEmitterGuid=t._eventEmitterGuid,this.on(e,n)}},{key:"emit",value:function(e,t){var r=this;if(this._listeners){t=t||{};var i=this._listeners["before*"]||[],n=this._listeners[e]||[],s=this._listeners["after"+e]||[],a=function(t,i){(t=t.slice()).forEach(function(t){t.call(r,{type:e},i)})};a(i,t),a(n,t),a(s,t)}}}],M(r.prototype,e),t&&M(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}();function A(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var N=function(){var e;function t(e){var r=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.pm=e,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,e.on("playing",function(){r._playheadShouldBeProgressing=!0}),e.on("play",this._startPlaybackHeartbeatInterval.bind(this)),e.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),e.on("seeking",this._startPlaybackHeartbeatInterval.bind(this)),e.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),e.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("seeked",function(){e.data.player_is_paused?r._stopPlaybackHeartbeatInterval():r._startPlaybackHeartbeatInterval()}),e.on("timeupdate",function(){null!==r._playbackHeartbeatInterval&&e.emit("playbackheartbeat")}),e.on("devicesleep",function(t,i){null!==r._playbackHeartbeatInterval&&(n().clearInterval(r._playbackHeartbeatInterval),e.emit("playbackheartbeatend",{viewer_time:i.viewer_time}),r._playbackHeartbeatInterval=null)})}return A(t.prototype,[{key:"_startPlaybackHeartbeatInterval",value:function(){var e=this;null===this._playbackHeartbeatInterval&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=n().setInterval(function(){e.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,null!==this._playbackHeartbeatInterval&&(n().clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),e&&A(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function F(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var q=(e5=function e(t){var r=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),t.on("viewinit",function(){r.viewErrored=!1}),t.on("error",function(e,i){try{var n=t.errorTranslator({player_error_code:i.player_error_code,player_error_message:i.player_error_message,player_error_context:i.player_error_context});n?(t.data.player_error_code=n.player_error_code||i.player_error_code,t.data.player_error_message=n.player_error_message||i.player_error_message,t.data.player_error_context=n.player_error_context||i.player_error_context,r.viewErrored=!0):(delete t.data.player_error_code,delete t.data.player_error_message,delete t.data.player_error_context)}catch(s){t.mux.log.warn("Exception in error translator callback.",s),r.viewErrored=!0}})},e4&&F(e5.prototype,e4),e6&&F(e5,e6),Object.defineProperty(e5,"prototype",{writable:!1}),e5);function B(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var U=function(){var e;function t(e){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.pm=e,this._watchTimeTrackerLastCheckedTime=null,e.on("playbackheartbeat",this._updateWatchTime.bind(this)),e.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return B(t.prototype,[{key:"_updateWatchTime",value:function(e,t){var r=t.viewer_time;null===this._watchTimeTrackerLastCheckedTime&&(this._watchTimeTrackerLastCheckedTime=r),y(this.pm.data,"view_watch_time",r-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=r}},{key:"_clearWatchTimeState",value:function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null}}]),e&&B(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function H(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var z=function(){var e,t;function r(e){var t=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,r),this.pm=e,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=m.now(),this._isAdPlaying=!1,e.on("playbackheartbeat",this._updatePlaybackTime.bind(this)),e.on("playbackheartbeatend",this._clearPlaybackTimeState.bind(this)),e.on("seeking",this._clearPlaybackTimeState.bind(this)),e.on("adplaying",function(){t._isAdPlaying=!0}),e.on("adended",function(){t._isAdPlaying=!1}),e.on("adpause",function(){t._isAdPlaying=!1}),e.on("adbreakstart",function(){t._isAdPlaying=!1}),e.on("adbreakend",function(){t._isAdPlaying=!1}),e.on("adplay",function(){t._isAdPlaying=!1})}return e=[{key:"_updatePlaybackTime",value:function(){var e=this.pm.data.player_playhead_time,t=m.now(),r=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition?r=e-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(r=t-this._lastTime),r>0&&r<=1e3&&y(this.pm.data,"view_content_playback_time",r),this._playbackTimeTrackerLastPlayheadPosition=e,this._lastTime=t}},{key:"_clearPlaybackTimeState",value:function(){this._updatePlaybackTime(),this._playbackTimeTrackerLastPlayheadPosition=-1}}],H(r.prototype,e),t&&H(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}();function V(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $=function(){var e,t;function r(e){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,r),this.pm=e;var t=this._updatePlayheadTime.bind(this);e.on("playbackheartbeat",t),e.on("playbackheartbeatend",t),e.on("timeupdate",t),e.on("destroy",function(){e.off("timeupdate",t)})}return e=[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=void 0===this.pm.data.view_max_playhead_position?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(e,t){var r=this,i=function(){r.pm.currentFragmentPDT&&r.pm.currentFragmentStart&&(r.pm.data.player_program_time=r.pm.currentFragmentPDT+r.pm.data.player_playhead_time-r.pm.currentFragmentStart)};if(t&&t.player_playhead_time)this.pm.data.player_playhead_time=t.player_playhead_time,i(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var n=this.pm.getPlayheadTime();void 0!==n&&(this.pm.data.player_playhead_time=n,i(),this._updateMaxPlayheadPosition())}}}],V(r.prototype,e),t&&V(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}();function Z(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var W=(e3=function e(t){if(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e),!t.disableRebufferTracking){var r,i=function(e,t){n(t),r=void 0},n=function(e){if(r){var i=e.viewer_time-r;y(t.data,"view_rebuffer_duration",i),r=e.viewer_time,t.data.view_rebuffer_duration>3e5&&(t.emit("viewend"),t.send("viewend"),t.mux.log.warn("Ending view after rebuffering for longer than ".concat(3e5,"ms, future events will be ignored unless a programchange or videochange occurs.")))}t.data.view_watch_time>=0&&t.data.view_rebuffer_count>0&&(t.data.view_rebuffer_frequency=t.data.view_rebuffer_count/t.data.view_watch_time,t.data.view_rebuffer_percentage=t.data.view_rebuffer_duration/t.data.view_watch_time)};t.on("playbackheartbeat",function(e,t){return n(t)}),t.on("rebufferstart",function(e,n){r||(y(t.data,"view_rebuffer_count",1),r=n.viewer_time,t.one("rebufferend",i))}),t.on("viewinit",function(){r=void 0,t.off("rebufferend",i)})}},e9&&Z(e3.prototype,e9),e8&&Z(e3,e8),Object.defineProperty(e3,"prototype",{writable:!1}),e3);function K(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var G=function(){var e;function t(e){var r=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.pm=e,e.disableRebufferTracking||e.disablePlayheadRebufferTracking||(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,e.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),e.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),e.on("seeking",function(){r._cleanupRebufferTracker(null,{viewer_time:m.now()})}))}return K(t.prototype,[{key:"_checkIfRebuffering",value:function(e,t){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing)this._cleanupRebufferTracker(e,t);else if(null!==this._lastCheckedTime){if(this._lastPlayheadTime===this.pm.data.player_playhead_time){var r=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.sustainedRebufferThreshold&&r>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=t.viewer_time}else this._cleanupRebufferTracker(e,t,!0)}else this._prepareRebufferTrackerState(t.viewer_time)}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e}},{key:"_cleanupRebufferTracker",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:t.viewer_time});else{if(null===this._lastCheckedTime)return;var i=this.pm.data.player_playhead_time-this._lastPlayheadTime,n=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.minimumRebufferDuration&&i>0&&n-i>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+n-i}))}r?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}}]),e&&K(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function Q(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Y=function(){var e;function t(e){var r=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.pm=e,e.on("viewinit",function(){var t=e.data,i=t.view_id;if(!t.view_program_changed){var n=function(t,n){var s=n.viewer_time;"playing"===t.type&&void 0===e.data.view_time_to_first_frame?r.calculateTimeToFirstFrame(s||m.now(),i):"adplaying"===t.type&&(void 0===e.data.view_time_to_first_frame||r._inPrerollPosition())&&r.calculateTimeToFirstFrame(s||m.now(),i)};e.one("playing",n),e.one("adplaying",n),e.one("viewend",function(){e.off("playing",n),e.off("adplaying",n)})}})}return Q(t.prototype,[{key:"_inPrerollPosition",value:function(){return void 0===this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(e,t){t===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:e}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.NAVIGATION_START))}}]),e&&Q(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function J(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var X=(e7=function e(t){var r=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),t.on("viewinit",function(){r._lastPlayheadPosition=-1}),["pause","rebufferstart","seeking","error","adbreakstart","hb"].forEach(function(e){t.on(e,function(){if(r._lastPlayheadPosition>=0&&t.data.player_playhead_time>=0&&r._lastPlayerWidth>=0&&r._lastSourceWidth>0&&r._lastPlayerHeight>=0&&r._lastSourceHeight>0){var e=t.data.player_playhead_time-r._lastPlayheadPosition;if(e<0)return void(r._lastPlayheadPosition=-1);var i=Math.min(r._lastPlayerWidth/r._lastSourceWidth,r._lastPlayerHeight/r._lastSourceHeight),n=Math.max(0,i-1),s=Math.max(0,1-i);t.data.view_max_upscale_percentage=Math.max(t.data.view_max_upscale_percentage||0,n),t.data.view_max_downscale_percentage=Math.max(t.data.view_max_downscale_percentage||0,s),y(t.data,"view_total_content_playback_time",e),y(t.data,"view_total_upscaling",n*e),y(t.data,"view_total_downscaling",s*e)}r._lastPlayheadPosition=-1})}),["playing","hb"].forEach(function(e){t.on(e,function(){r._lastPlayheadPosition=t.data.player_playhead_time,r._lastPlayerWidth=t.data.player_width,r._lastPlayerHeight=t.data.player_height,r._lastSourceWidth=t.data.video_source_width,r._lastSourceHeight=t.data.video_source_height})})},te&&J(e7.prototype,te),tt&&J(e7,tt),Object.defineProperty(e7,"prototype",{writable:!1}),e7);function ee(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var et=(tr=function e(t){var r=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),this.isSeeking=!1,t.on("seeking",function(e,i){Object.assign(t.data,i),r._lastSeekingTime=m.now(),!1===r.isSeeking&&(r.isSeeking=!0,t.send("seeking"))}),t.on("seeked",function(){r.isSeeking=!1;var e=r._lastSeekingTime||m.now(),i=m.now()-e;y(t.data,"view_seek_count",1),y(t.data,"view_seek_duration",i);var n=t.data.view_max_seek_time||0;t.data.view_max_seek_time=Math.max(n,i)}),t.on("viewend",function(){r.isSeeking=!1})},ti&&ee(tr.prototype,ti),tn&&ee(tr,tn),Object.defineProperty(tr,"prototype",{writable:!1}),tr);function er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s=[],a=!0,o=!1;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(s.push(i.value),!t||s.length!==t);a=!0);}catch(l){o=!0,n=l}finally{try{a||null==r.return||r.return()}finally{if(o)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ei(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ei(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function en(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var es=function(e,t){e.push(t),e.sort(function(e,t){return e.viewer_time-t.viewer_time})},ea=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror"],eo=function(){var e,t;function r(e){var t=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,r),this.pm=e,e.on("viewinit",function(){t.isAdBreak=!1,t._currentAdRequestNumber=0,t._currentAdResponseNumber=0,t._adRequests=[],t._adResponses=[],t._adHasPlayed=!1,t._wouldBeNewAdPlay=!0,t._prerollPlayTime=void 0}),ea.forEach(function(r){return e.on(r,t._updateAdData.bind(t))});var i=function(){t.isAdBreak=!1};e.on("adbreakstart",function(){t.isAdBreak=!0}),e.on("play",i),e.on("playing",i),e.on("viewend",i),e.on("adrequest",function(r,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdRequestNumber++},i),es(t._adRequests,i),y(e.data,"view_ad_request_count"),t.inPrerollPosition()&&(e.data.view_preroll_requested=!0,t._adHasPlayed||y(e.data,"view_preroll_request_count"))}),e.on("adresponse",function(r,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdResponseNumber++},i),es(t._adResponses,i);var n=t.findAdRequest(i.ad_request_id);n&&y(e.data,"view_ad_request_time",Math.max(0,i.viewer_time-n.viewer_time))}),e.on("adplay",function(r,i){t._adHasPlayed=!0,t._wouldBeNewAdPlay&&(t._wouldBeNewAdPlay=!1,y(e.data,"view_ad_played_count")),t.inPrerollPosition()&&!e.data.view_preroll_played&&(e.data.view_preroll_played=!0,t._adRequests.length>0&&(e.data.view_preroll_request_time=Math.max(0,i.viewer_time-t._adRequests[0].viewer_time)),e.data.view_start&&(e.data.view_startup_preroll_request_time=Math.max(0,i.viewer_time-e.data.view_start)),t._prerollPlayTime=i.viewer_time)}),e.on("adplaying",function(r,i){t.inPrerollPosition()&&void 0===e.data.view_preroll_load_time&&void 0!==t._prerollPlayTime&&(e.data.view_preroll_load_time=i.viewer_time-t._prerollPlayTime,e.data.view_startup_preroll_load_time=i.viewer_time-t._prerollPlayTime)}),e.on("adended",function(){t._wouldBeNewAdPlay=!0}),e.on("aderror",function(){t._wouldBeNewAdPlay=!0})}return e=[{key:"inPrerollPosition",value:function(){return void 0===this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]}},{key:"_updateAdData",value:function(e,t){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var r=er(g(t.ad_tag_url),2),i=r[0],n=r[1];this.pm.data.view_preroll_ad_tag_domain=n,this.pm.data.view_preroll_ad_tag_hostname=i}if(!this.pm.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var s=er(g(t.ad_asset_url),2),a=s[0],o=s[1];this.pm.data.view_preroll_ad_asset_domain=o,this.pm.data.view_preroll_ad_asset_hostname=a}}this.pm.data.ad_asset_url=null==t?void 0:t.ad_asset_url,this.pm.data.ad_tag_url=null==t?void 0:t.ad_tag_url,this.pm.data.ad_creative_id=null==t?void 0:t.ad_creative_id,this.pm.data.ad_id=null==t?void 0:t.ad_id,this.pm.data.ad_universal_id=null==t?void 0:t.ad_universal_id}}],en(r.prototype,e),t&&en(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}();function el(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ec=(ts=function e(t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e);var r,i,s=function(){t.disableRebufferTracking||r&&(y(t.data,"view_waiting_rebuffer_duration",m.now()-r),r=!1,n().clearInterval(i))},a=!1,o=function(){a=!1,s()};t.on("waiting",function(){a&&(t.disableRebufferTracking||(y(t.data,"view_waiting_rebuffer_count",1),r=m.now(),i=n().setInterval(function(){if(r){var e=m.now();y(t.data,"view_waiting_rebuffer_duration",e-r),r=e}},250)))}),t.on("playing",function(){s(),a=!0}),t.on("pause",o),t.on("seeking",o)},ta&&el(ts.prototype,ta),to&&el(ts,to),Object.defineProperty(ts,"prototype",{writable:!1}),ts);function ed(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var eu=(tl=function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e);var i=function(){r.lastWallClockTime=m.now(),t.on("before*",n)},n=function(e){var i=m.now(),n=r.lastWallClockTime;r.lastWallClockTime=i,i-n>3e4&&(t.emit("devicesleep",{viewer_time:n}),Object.assign(t.data,{viewer_time:n}),t.send("devicesleep"),t.emit("devicewake",{viewer_time:i}),Object.assign(t.data,{viewer_time:i}),t.send("devicewake"))};t.one("playbackheartbeat",i),t.on("playbackheartbeatend",function(){t.off("before*",n),t.one("playbackheartbeat",i)})},tc&&ed(tl.prototype,tc),td&&ed(tl,td),Object.defineProperty(tl,"prototype",{writable:!1}),tl),ep=r(375),eh=r(655),em=r.n(eh),ef="muxData",eg=function(){var e;try{e=ep.parse(em().get(ef)||"")}catch(t){e={}}return e},ev=function(e){try{em().set(ef,ep.stringify(e),{expires:365})}catch(t){}},ey=function(){var e=eg();return e.mux_viewer_id=e.mux_viewer_id||s(),e.msn=e.msn||Math.random(),ev(e),{mux_viewer_id:e.mux_viewer_id,mux_sample_number:e.msn}},eb=function(){var e;switch(ew()){case"cellular":e="cellular";break;case"ethernet":e="wired";break;case"wifi":e="wifi";break;case void 0:break;default:e="other"}return e},ew=function(){var e=n().navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);return t&&t.type};eb.getConnectionFromAPI=ew;var e_=ex({a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"}),eS=ex({ad:"ad",ag:"aggregate",ap:"api",al:"application",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",br:"break",bw:"browser",by:"bytes",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",cl:"canceled",cn:"config",co:"count",ce:"counter",cp:"complete",cr:"creative",ct:"content",cu:"current",cx:"connection",cz:"context",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ep:"experiments",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pr:"preload",ps:"position",pt:"part",py:"property",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",se:"session",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",st:"start",su:"startup",sv:"server",sw:"software",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"});function ex(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}function eC(e){var t={},r={};return Object.keys(e).forEach(function(i){var n=!1;if(e.hasOwnProperty(i)&&void 0!==e[i]){var s=i.split("_"),a=s[0],o=e_[a];o||(p.info("Data key word `"+s[0]+"` not expected in "+i),o=a+"_"),s.splice(1).forEach(function(e){"url"===e&&(n=!0),eS[e]?o+=eS[e]:Number(e)&&Math.floor(Number(e))===Number(e)?o+=e:(p.info("Data key word `"+e+"` not expected in "+i),o+="_"+e+"_")}),n?r[o]=e[i]:t[o]=e[i]}}),Object.assign(t,r)}var eT={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},ek=["hb","requestcompleted","requestfailed","requestcanceled"],eR=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._beaconUrl=e||"https://img.litix.io",this._eventQueue=[],this._postInFlight=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},eT,t)};eR.prototype.queueEvent=function(e,t){var r=Object.assign({},t);return(this._eventQueue.length<=this._options.maxQueueLength||"eventrateexceeded"===e)&&(this._eventQueue.push(r),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength)},eR.prototype.flushEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&1===this._eventQueue.length?this._eventQueue.pop():(this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending())},eR.prototype.destroy=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.destroyed=!0,e?this._clearBeaconQueue():this.flushEvents(),n().clearTimeout(this._sendTimeout)},eR.prototype._clearBeaconQueue=function(){var e=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,t=this._eventQueue.slice(e);e>0&&Object.assign(t[t.length-1],eC({mux_view_message:"event queue truncated"}));var r=this._createPayload(t);eE(this._beaconUrl,r,!0,function(){})},eR.prototype._sendBeaconQueue=function(){var e=this;if(!this._postInFlight){var t=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var r=this._createPayload(t),i=m.now();eE(this._beaconUrl,r,!1,function(r,n){n?(e._eventQueue=t.concat(e._eventQueue),e._failureCount+=1,p.info("Error sending beacon: "+n)):e._failureCount=0,e._roundTripTime=m.now()-i,e._postInFlight=!1})}},eR.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var e=Math.pow(2,this._failureCount-1);return(1+(e*=Math.random()))*this._options.baseTimeBetweenBeacons},eR.prototype._startBeaconSending=function(){var e=this;n().clearTimeout(this._sendTimeout),this.destroyed||(this._sendTimeout=n().setTimeout(function(){e._eventQueue.length&&e._sendBeaconQueue(),e._startBeaconSending()},this._getNextBeaconTime()))},eR.prototype._createPayload=function(e){var t,r,i,n=this,s={transmission_timestamp:Math.round(m.now())};this._roundTripTime&&(s.rtt_ms=Math.round(this._roundTripTime));var a=function(){i=(t=JSON.stringify({metadata:s,events:r||e})).length/1024},o=function(){return i<=n._options.maxPayloadKBSize};return a(),o()||(p.info("Payload size is too big ("+i+" kb). Removing unnecessary events."),r=e.filter(function(e){return -1===ek.indexOf(e.e)}),a()),o()||(p.info("Payload size still too big ("+i+" kb). Cropping fields.."),r.forEach(function(e){for(var t in e){var r=e[t];"string"==typeof r&&r.length>51200&&(e[t]=r.substring(0,51200))}}),a()),t};var eE=function(e,t,r,i){if(r&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(e,t))i();else if(n().fetch)n().fetch(e,{method:"POST",body:t,headers:{"Content-Type":"text/plain"},keepalive:t.length<=57344}).then(function(e){return i(null,e.ok?null:"Error")}).catch(function(e){return i(null,e)});else{if(n().XMLHttpRequest){var s=new(n()).XMLHttpRequest;return s.onreadystatechange=function(){if(4===s.readyState)return i(null,200!==s.status?"error":void 0)},s.open("POST",e),s.setRequestHeader("Content-Type","text/plain"),void s.send(t)}i()}};function eP(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function eD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function eL(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eD(Object(r),!0).forEach(function(t){ej(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eD(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function eI(e){return(eI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eM(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ej(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var eO=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id"],eA=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],eN=["ad_id","ad_creative_id","ad_universal_id"],eF=["viewstart","error","ended","viewend"],eq=function(){var e,t;function r(e,t){var i,s,a,o,l,c,d,u,p,h,m,f,g,v,y,b,w,_,S,x=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,r),ej(this,"previousBeaconData",null),ej(this,"lastEventTime",0),ej(this,"rateLimited",!1),this.mux=e,this.envKey=t,this.options=x,this.eventQueue=new eR((i=this.envKey,a=(s=this.options).beaconCollectionDomain,o=s.beaconDomain,a?"https://"+a:(i=i||"inferred").match(/^[a-z0-9]+$/)?"https://"+i+"."+(o||"litix.io"):"https://img.litix.io/a.gif")),this.sampleRate=null!==(l=this.options.sampleRate)&&void 0!==l?l:1,this.disableCookies=null!==(c=this.options.disableCookies)&&void 0!==c&&c,this.respectDoNotTrack=null!==(d=this.options.respectDoNotTrack)&&void 0!==d&&d,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:null===(u=this.options.platform)||void 0===u?void 0:u.name,viewer_application_version:null===(p=this.options.platform)||void 0===p?void 0:p.version,viewer_application_engine:null===(h=this.options.platform)||void 0===h?void 0:h.layout,viewer_device_name:null===(m=this.options.platform)||void 0===m?void 0:m.product,viewer_device_category:"",viewer_device_manufacturer:null===(f=this.options.platform)||void 0===f?void 0:f.manufacturer,viewer_os_family:null===(g=this.options.platform)||void 0===g||null===(v=g.os)||void 0===v?void 0:v.family,viewer_os_architecture:null===(y=this.options.platform)||void 0===y||null===(b=y.os)||void 0===b?void 0:b.architecture,viewer_os_version:null===(w=this.options.platform)||void 0===w||null===(_=w.os)||void 0===_?void 0:_.version,viewer_connection_type:eb(),page_url:null===n()||void 0===n()||null===(S=n().location)||void 0===S?void 0:S.href},this.viewerData=this.disableCookies?{}:ey()}return e=[{key:"send",value:function(e,t){var r;if(e&&null!=t&&t.view_id){if(this.respectDoNotTrack&&h())return p.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||"object"!==eI(t))return p.error("A data object was expected in send() but was not provided");var i,n,a=this.disableCookies?{}:(i=eg(),n=m.now(),i.session_start&&(i.sst=i.session_start,delete i.session_start),i.session_id&&(i.sid=i.session_id,delete i.session_id),i.session_expires&&(i.sex=i.session_expires,delete i.session_expires),(!i.sex||i.sex<n)&&(i.sid=s(),i.sst=n),i.sex=n+15e5,ev(i),{session_id:i.sid,session_start:i.sst,session_expires:i.sex}),o=eL(eL(eL(eL(eL({},this.pageLevelData),t),a),this.viewerData),{},{event:e,env_key:this.envKey});o.user_id&&(o.viewer_user_id=o.user_id,delete o.user_id);var l=(null!==(r=o.mux_sample_number)&&void 0!==r?r:0)>=this.sampleRate,c=eC(this._deduplicateBeaconData(e,o));if(this.lastEventTime=this.mux.utils.now(),l)return p.info("Not sending event due to sample rate restriction",e,o,c);if(this.envKey||p.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",e,o,c),!this.rateLimited){if(p.info("Sending event",e,o,c),this.rateLimited=!this.eventQueue.queueEvent(e,c),this.mux.WINDOW_UNLOADING&&"viewend"===e)this.eventQueue.destroy(!0);else if(this.mux.WINDOW_HIDDEN&&"hb"===e?this.eventQueue.flushEvents(!0):eF.indexOf(e)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return o.event="eventrateexceeded",c=eC(o),this.eventQueue.queueEvent(o.event,c),p.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(e,t){var r=this,i={},n=t.view_id;if("-1"===n||"viewstart"===e||"viewend"===e||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=6e5)i=eL({},t),n&&(this.previousBeaconData=i),n&&"viewend"===e&&(this.previousBeaconData=null);else{var s=0===e.indexOf("request");Object.entries(t).forEach(function(t){var n=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s=[],a=!0,o=!1;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(s.push(i.value),!t||s.length!==t);a=!0);}catch(l){o=!0,n=l}finally{try{a||null==r.return||r.return()}finally{if(o)throw n}}return s}}(t,2)||function(e,t){if(e){if("string"==typeof e)return eP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?eP(e,t):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=n[0],o=n[1];r.previousBeaconData&&(o!==r.previousBeaconData[a]||eO.indexOf(a)>-1||r.objectHasChanged(s,a,o,r.previousBeaconData[a])||r.eventRequiresKey(e,a))&&(i[a]=o,r.previousBeaconData[a]=o)})}return i}},{key:"objectHasChanged",value:function(e,t,r,i){return!(!e||0!==t.indexOf("request_")||"request_response_headers"!==t&&"object"===eI(r)&&"object"===eI(i)&&Object.keys(r||{}).length===Object.keys(i||{}).length)}},{key:"eventRequiresKey",value:function(e,t){return"renditionchange"===e&&0===t.indexOf("video_source_")||!(!eN.includes(t)||!eA.includes(e))}}],eM(r.prototype,e),t&&eM(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}();function eB(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var eU=(tu=function e(t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e);var r=0,i=0,n=0,s=0,a=0,o=0,l=0;t.on("requestcompleted",function(e,o){var l,c,d=o.request_start,u=o.request_response_start,p=o.request_response_end,h=o.request_bytes_loaded;if(s++,u?(l=u-(null!=d?d:0),c=(null!=p?p:0)-u):c=(null!=p?p:0)-(null!=d?d:0),c>0&&h&&h>0){var m=h/c*8e3;a++,i+=h,n+=c,t.data.view_min_request_throughput=Math.min(t.data.view_min_request_throughput||1/0,m),t.data.view_average_request_throughput=i/n*8e3,t.data.view_request_count=s,l>0&&(r+=l,t.data.view_max_request_latency=Math.max(t.data.view_max_request_latency||0,l),t.data.view_average_request_latency=r/a)}}),t.on("requestfailed",function(e,r){s++,o++,t.data.view_request_count=s,t.data.view_request_failed_count=o}),t.on("requestcanceled",function(e,r){s++,l++,t.data.view_request_count=s,t.data.view_request_canceled_count=l})},tp&&eB(tu.prototype,tp),th&&eB(tu,th),Object.defineProperty(tu,"prototype",{writable:!1}),tu);function eH(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ez=(tm=function e(t){var r=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),t.on("before*",function(e,i){var n=i.viewer_time,s=m.now(),a=r._lastEventTime;if(r._lastEventTime=s,a&&s-a>36e5){var o=Object.keys(t.data).reduce(function(e,r){var i,n;return 0===r.indexOf("video_")?Object.assign(e,(i={},n=t.data[r],r in i?Object.defineProperty(i,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[r]=n,i)):e},{});t.mux.log.info("Received event after at least an hour inactivity, creating a new view"),t.emit("viewinit",Object.assign({viewer_time:n},o)),t.playbackHeartbeat._playheadShouldBeProgressing&&"play"!==e.type&&"adbreakstart"!==e.type&&(t.emit("play",{viewer_time:n}),"playing"!==e.type&&t.emit("playing",{viewer_time:n}))}})},tf&&eH(tm.prototype,tf),tg&&eH(tm,tg),Object.defineProperty(tm,"prototype",{writable:!1}),tm);function eV(e){return(eV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e$(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function eZ(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eW(e,t){return(eW=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eK(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eG(e){return(eG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eQ=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],eY=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eW(e,t)}(a,e);var t,r,i,n=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=eG(a);if(t){var i=eG(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){if(t&&("object"===eV(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return eK(e)}(this,e)});function a(e,t,r){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,a),(i=n.call(this)).DOM_CONTENT_LOADED_EVENT_END=v.domContentLoadedEventEnd(),i.NAVIGATION_START=v.navigationStart(),i.mux=e,i.id=t,(r=Object.assign({debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(e){return e}},r)).data=r.data||{},r.data.property_key&&(r.data.env_key=r.data.property_key,delete r.data.property_key),p.setLevel(r.debug?"debug":"warn"),i.getPlayheadTime=r.getPlayheadTime,i.getStateData=r.getStateData||function(){return{}},i.getAdData=r.getAdData||function(){},i.minimumRebufferDuration=r.minimumRebufferDuration,i.sustainedRebufferThreshold=r.sustainedRebufferThreshold,i.playbackHeartbeatTime=r.playbackHeartbeatTime,i.disableRebufferTracking=r.disableRebufferTracking,i.disableRebufferTracking&&i.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),i.disablePlayheadRebufferTracking=r.disablePlayheadRebufferTracking,i.errorTranslator=r.errorTranslator,i.playbackEventDispatcher=new eq(e,r.data.env_key,r),i.data={player_instance_id:s(),mux_sample_rate:r.sampleRate,beacon_domain:r.beaconCollectionDomain?r.beaconCollectionDomain:r.beaconDomain},i.data.view_sequence_number=1,i.data.player_sequence_number=1,i.oldEmit=i.emit,i.emit=function(e,t){t=Object.assign({viewer_time:this.mux.utils.now()},t),this.oldEmit(e,t)};var i,o=(function(){void 0===this.data.view_start&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}).bind(eK(i));i.on("viewinit",function(e,t){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,t),this._initializeViewData(),this.one("play",o),this.one("adbreakstart",o)});var l=(function(e){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",e)}).bind(eK(i));if(i.on("videochange",function(e,t){l(t)}),i.on("programchange",function(e,t){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),l(Object.assign(t,{view_program_changed:!0})),o(),this.emit("play"),this.emit("playing")}),i.on("fragmentchange",function(e,t){this.currentFragmentPDT=t.currentFragmentPDT,this.currentFragmentStart=t.currentFragmentStart}),i.on("destroy",i.destroy),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&"function"==typeof window.removeEventListener){var c=function(){var e=void 0!==i.data.view_start;i.mux.WINDOW_HIDDEN="hidden"===document.visibilityState,e&&i.mux.WINDOW_HIDDEN&&(i.data.player_is_paused||i.emit("hb"))};window.addEventListener("visibilitychange",c,!1);var d=function(e){e.persisted||i.destroy()};window.addEventListener("pagehide",d,!1),i.on("destroy",function(){window.removeEventListener("visibilitychange",c),window.removeEventListener("pagehide",d)})}return i.on("playerready",function(e,t){Object.assign(this.data,t)}),eQ.forEach(function(e){i.on(e,function(t,r){0!==e.indexOf("ad")&&this._updateStateData(),Object.assign(this.data,r),this._sanitizeData()}),i.on("after"+e,function(){("error"!==e||this.errorTracker.viewErrored)&&this.send(e)})}),i.on("viewend",function(e,t){Object.assign(i.data,t)}),i.one("playerready",function(e){var t=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=t-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time}),i.longResumeTracker=new ez(eK(i)),i.errorTracker=new q(eK(i)),new eu(eK(i)),i.seekingTracker=new et(eK(i)),i.playheadTime=new $(eK(i)),i.playbackHeartbeat=new N(eK(i)),new X(eK(i)),i.watchTimeTracker=new U(eK(i)),new z(eK(i)),i.adTracker=new eo(eK(i)),new G(eK(i)),new W(eK(i)),new Y(eK(i)),new ec(eK(i)),new eU(eK(i)),r.hlsjs&&i.addHLSJS(r),r.dashjs&&i.addDashJS(r),i.emit("viewinit",r.data),i}return r=[{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,void 0!==this.data.view_start&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(e){if(this.data.view_id){var t=Object.assign({},this.data);if(void 0===t.video_source_is_live&&(t.player_source_duration===1/0||t.video_source_duration===1/0?t.video_source_is_live=!0:(t.player_source_duration>0||t.video_source_duration>0)&&(t.video_source_is_live=!1)),t.video_source_is_live||["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"].forEach(function(e){t[e]=void 0}),t.video_source_url=t.video_source_url||t.player_source_url,t.video_source_url){var r,i=function(e){if(Array.isArray(e))return e}(r=g(t.video_source_url))||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s=[],a=!0,o=!1;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(s.push(i.value),!t||s.length!==t);a=!0);}catch(l){o=!0,n=l}finally{try{a||null==r.return||r.return()}finally{if(o)throw n}}return s}}(r,2)||function(e,t){if(e){if("string"==typeof e)return e$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e$(e,t):void 0}}(r,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=i[0],s=i[1];t.video_source_domain=s,t.video_source_hostname=n}delete t.ad_request_id,this.playbackEventDispatcher.send(e,t),this.data.view_sequence_number++,this.data.player_sequence_number++,this._restartHeartBeat(),"viewend"===e&&delete this.data.view_id}}},{key:"_updateStateData",value:function(){Object.assign(this.data,this.getStateData()),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var e=this;["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"].forEach(function(t){var r=parseInt(e.data[t],10);e.data[t]=isNaN(r)?void 0:r}),["player_source_url","video_source_url"].forEach(function(t){if(e.data[t]){var r=e.data[t].toLowerCase();0!==r.indexOf("data:")&&0!==r.indexOf("blob:")||(e.data[t]="MSE style URL")}})}},{key:"_resetVideoData",value:function(e,t){var r=this;Object.keys(this.data).forEach(function(e){0===e.indexOf("video_")&&delete r.data[e]})}},{key:"_resetViewData",value:function(){var e=this;Object.keys(this.data).forEach(function(t){0===t.indexOf("view_")&&delete e.data[t]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(e,t){delete this.data.player_error_code,delete this.data.player_error_message}},{key:"_initializeViewData",value:function(){var e=this,t=this.data.view_id=s(),r=function(){t===e.data.view_id&&y(e.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",r):r()}},{key:"_restartHeartBeat",value:function(){var e=this;window.clearTimeout(this._heartBeatTimeout),this.errorTracker.viewErrored||(this._heartBeatTimeout=window.setTimeout(function(){e.data.player_is_paused||e.emit("hb")},1e4))}},{key:"addHLSJS",value:function(e){e.hlsjs?this.hlsjs?this.mux.log.warn("An instance of HLS.js is already being monitored for this player."):(this.hlsjs=e.hlsjs,function(e,t,r){var i=arguments.length>4?arguments[4]:void 0,n=e.log,s=e.utils.secondsToMs,a=function(e){var t,r=parseInt(i.version);return 1===r&&null!==e.programDateTime&&(t=e.programDateTime),0===r&&null!==e.pdt&&(t=e.pdt),t};if(v.exists()){var o=function(r,i){return e.emit(t,r,i)},l=function(e,t){var r=t.levels,i=t.audioTracks,n=t.url,s=t.stats,a=t.networkDetails,l=t.sessionData,c={},d={};r.forEach(function(e,t){c[t]={width:e.width,height:e.height,bitrate:e.bitrate,attrs:e.attrs}}),i.forEach(function(e,t){d[t]={name:e.name,language:e.lang,bitrate:e.bitrate}});var u=k(s),p=u.bytesLoaded,h=u.requestStart,m=u.responseStart,g=u.responseEnd;o("requestcompleted",T(T({},x(l)),{},{request_event_type:e,request_bytes_loaded:p,request_start:h,request_response_start:m,request_response_end:g,request_type:"manifest",request_hostname:f(n),request_response_headers:R(a),request_rendition_lists:{media:c,audio:d,video:{}}}))};r.on(i.Events.MANIFEST_LOADED,l);var c=function(e,t){var r=t.details,i=t.level,n=t.networkDetails,l=k(t.stats),c=l.bytesLoaded,d=l.requestStart,u=l.responseStart,p=l.responseEnd,h=r.fragments[r.fragments.length-1],m=a(h)+s(h.duration);o("requestcompleted",{request_event_type:e,request_bytes_loaded:c,request_start:d,request_response_start:u,request_response_end:p,request_current_level:i,request_type:"manifest",request_hostname:f(r.url),request_response_headers:R(n),video_holdback:r.holdBack&&s(r.holdBack),video_part_holdback:r.partHoldBack&&s(r.partHoldBack),video_part_target_duration:r.partTarget&&s(r.partTarget),video_target_duration:r.targetduration&&s(r.targetduration),video_source_is_live:r.live,player_manifest_newest_program_time:isNaN(m)?void 0:m})};r.on(i.Events.LEVEL_LOADED,c);var d=function(e,t){var r=t.details,i=t.networkDetails,n=k(t.stats);o("requestcompleted",{request_event_type:e,request_bytes_loaded:n.bytesLoaded,request_start:n.requestStart,request_response_start:n.responseStart,request_response_end:n.responseEnd,request_type:"manifest",request_hostname:f(r.url),request_response_headers:R(i)})};r.on(i.Events.AUDIO_TRACK_LOADED,d);var u=function(e,t){var i=t.stats,n=t.networkDetails,s=t.frag,a=k(i=i||s.stats),l=a.bytesLoaded,c=a.requestStart,d=a.responseStart,u=a.responseEnd,p=n?R(n):void 0,h={request_event_type:e,request_bytes_loaded:l,request_start:c,request_response_start:d,request_response_end:u,request_hostname:n?f(n.responseURL):void 0,request_id:p?S(p):void 0,request_response_headers:p,request_media_duration:s.duration,request_url:null==n?void 0:n.responseURL};"main"===s.type?(h.request_type="media",h.request_current_level=s.level,h.request_video_width=(r.levels[s.level]||{}).width,h.request_video_height=(r.levels[s.level]||{}).height,h.request_labeled_bitrate=(r.levels[s.level]||{}).bitrate):h.request_type=s.type,o("requestcompleted",h)};r.on(i.Events.FRAG_LOADED,u);var p=function(e,t){var r=t.frag,i=r.start;o("fragmentchange",{currentFragmentPDT:a(r),currentFragmentStart:s(i)})};r.on(i.Events.FRAG_CHANGED,p);var h=function(e,t){var r,n=t.type,s=t.details,a=t.response,l=t.fatal,c=t.frag,d=t.networkDetails,u=(null==c?void 0:c.url)||t.url||"",p=d?R(d):void 0;s!==i.ErrorDetails.MANIFEST_LOAD_ERROR&&s!==i.ErrorDetails.MANIFEST_LOAD_TIMEOUT&&s!==i.ErrorDetails.FRAG_LOAD_ERROR&&s!==i.ErrorDetails.FRAG_LOAD_TIMEOUT&&s!==i.ErrorDetails.LEVEL_LOAD_ERROR&&s!==i.ErrorDetails.LEVEL_LOAD_TIMEOUT&&s!==i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&s!==i.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT&&s!==i.ErrorDetails.SUBTITLE_LOAD_ERROR&&s!==i.ErrorDetails.SUBTITLE_LOAD_TIMEOUT&&s!==i.ErrorDetails.KEY_LOAD_ERROR&&s!==i.ErrorDetails.KEY_LOAD_TIMEOUT||o("requestfailed",{request_error:s,request_url:u,request_hostname:f(u),request_id:p?S(p):void 0,request_type:s===i.ErrorDetails.FRAG_LOAD_ERROR||s===i.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":s===i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||s===i.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":s===i.ErrorDetails.SUBTITLE_LOAD_ERROR||s===i.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":s===i.ErrorDetails.KEY_LOAD_ERROR||s===i.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:null==a?void 0:a.code,request_error_text:null==a?void 0:a.text}),l&&o("error",{player_error_code:n,player_error_message:s,player_error_context:"".concat(u?"url: ".concat(u,"\n"):"")+"".concat(a&&(a.code||a.text)?"response: ".concat(a.code,", ").concat(a.text,"\n"):"")+"".concat(t.reason?"failure reason: ".concat(t.reason,"\n"):"")+"".concat(t.level?"level: ".concat(t.level,"\n"):"")+"".concat(t.parent?"parent stream controller: ".concat(t.parent,"\n"):"")+"".concat(t.buffer?"buffer length: ".concat(t.buffer,"\n"):"")+"".concat(t.error?"error: ".concat(t.error,"\n"):"")+"".concat(t.event?"event: ".concat(t.event,"\n"):"")+"".concat(t.err?"error message: ".concat(null===(r=t.err)||void 0===r?void 0:r.message,"\n"):"")})};r.on(i.Events.ERROR,h);var m=function(e,t){var r=t.frag,i=r&&r._url||"";o("requestcanceled",{request_event_type:e,request_url:i,request_type:"media",request_hostname:f(i)})};r.on(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,m);var g=function(e,t){var i=t.level,s=r.levels[i];if(s&&s.attrs&&s.attrs.BANDWIDTH){var a,l=s.attrs.BANDWIDTH,c=parseFloat(s.attrs["FRAME-RATE"]);isNaN(c)||(a=c),l?o("renditionchange",{video_source_fps:a,video_source_bitrate:l,video_source_width:s.width,video_source_height:s.height,video_source_rendition_name:s.name,video_source_codec:null==s?void 0:s.videoCodec}):n.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};r.on(i.Events.LEVEL_SWITCHED,g),r._stopMuxMonitor=function(){r.off(i.Events.MANIFEST_LOADED,l),r.off(i.Events.LEVEL_LOADED,c),r.off(i.Events.AUDIO_TRACK_LOADED,d),r.off(i.Events.FRAG_LOADED,u),r.off(i.Events.FRAG_CHANGED,p),r.off(i.Events.ERROR,h),r.off(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,m),r.off(i.Events.LEVEL_SWITCHED,g),r.off(i.Events.DESTROYING,r._stopMuxMonitor),delete r._stopMuxMonitor},r.on(i.Events.DESTROYING,r._stopMuxMonitor)}else n.warn("performance timing not supported. Not tracking HLS.js.")}(this.mux,this.id,e.hlsjs,{},e.Hls||window.Hls)):this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.")}},{key:"removeHLSJS",value:function(){var e;this.hlsjs&&((e=this.hlsjs)&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor(),this.hlsjs=void 0)}},{key:"addDashJS",value:function(e){e.dashjs?this.dashjs?this.mux.log.warn("An instance of Dash.js is already being monitored for this player."):(this.dashjs=e.dashjs,function(e,t,r){var i=e.log;if(r&&r.on){var n=function(r,i){return e.emit(t,r,i)},s=function(e){var t=e.type,r=(e.data||{}).url;n("requestcompleted",{request_event_type:t,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:f(r),request_url:r})};r.on("manifestLoaded",s);var a={},o=function(e){var t=e.type,i=e.fragmentModel,s=(e.chunk||{}).mediaInfo||{},o=s.type,l=s.bitrateList,c={};(l=l||[]).forEach(function(e,t){c[t]={},c[t].width=e.width,c[t].height=e.height,c[t].bitrate=e.bandwidth,c[t].attrs={}}),"video"===o?a.video=c:"audio"===o?a.audio=c:a.media=c;var d=D(i,r),u=d.requestStart,p=d.requestResponseStart,h=d.requestResponseEnd,m=d.requestResponseHeaders,f=d.requestMediaDuration,g=d.requestHostname,v=d.requestUrl;n("requestcompleted",{request_event_type:t,request_start:u,request_response_start:p,request_response_end:h,request_bytes_loaded:-1,request_type:o+"_init",request_response_headers:m,request_hostname:g,request_id:d.requestId,request_url:v,request_media_duration:f,request_rendition_lists:a})};r.on("initFragmentLoaded",o);var l=function(e){var t=e.type,i=e.fragmentModel,s=e.chunk||{},a=s.mediaInfo,o=s.start,l=(a||{}).type,c=D(i,r),d=c.requestStart,u=c.requestResponseStart,p=c.requestResponseEnd,h=c.requestBytesLoaded,m=c.requestResponseHeaders,f=c.requestMediaDuration,g=c.requestHostname,v=c.requestUrl,y=c.requestId,b=L(l,r),w=b.currentLevel,_=b.renditionWidth,S=b.renditionHeight,x=b.renditionBitrate;n("requestcompleted",{request_event_type:t,request_start:d,request_response_start:u,request_response_end:p,request_bytes_loaded:h,request_type:l,request_response_headers:m,request_hostname:g,request_id:y,request_url:v,request_media_start_time:o,request_media_duration:f,request_current_level:w,request_labeled_bitrate:x,request_video_width:_,request_video_height:S})};r.on("mediaFragmentLoaded",l);var c={video:void 0,audio:void 0,totalBitrate:void 0},d=function(){if(c.video&&"number"==typeof c.video.bitrate){if(c.video.width&&c.video.height){var e=c.video.bitrate;return c.audio&&"number"==typeof c.audio.bitrate&&(e+=c.audio.bitrate),e!==c.totalBitrate?(c.totalBitrate=e,{video_source_bitrate:e,video_source_height:c.video.height,video_source_width:c.video.width,video_source_codec:I(c.video.codec)}):void 0}i.warn("have bitrate info for video but missing width/height")}},u=function(e,t,s){if("number"==typeof e.newQuality){var a=e.mediaType;if("audio"===a||"video"===a){var o=r.getBitrateInfoListFor(a).find(function(t){return t.qualityIndex===e.newQuality});if(o&&"number"==typeof o.bitrate){c[a]=P(P({},o),{},{codec:r.getCurrentTrackFor(a).codec});var l=d();l&&n("renditionchange",l)}else i.warn("missing bitrate info for ".concat(a))}}else i.warn("missing evt.newQuality in qualityChangeRendered event",e)};r.on("qualityChangeRendered",u);var p=function(e){var t=e.request,r=e.mediaType;n("requestcanceled",{request_event_type:(t=t||{}).type+"_"+t.action,request_url:t.url,request_type:r,request_hostname:f(t.url)})};r.on("fragmentLoadingAbandoned",p);var h=function(e){var t,r,i=e.error,s=(null==i||null===(t=i.data)||void 0===t?void 0:t.request)||{},a=(null==i||null===(r=i.data)||void 0===r?void 0:r.response)||{};27===(null==i?void 0:i.code)&&n("requestfailed",{request_error:s.type+"_"+s.action,request_url:s.url,request_hostname:f(s.url),request_type:s.mediaType,request_error_code:a.status,request_error_text:a.statusText});var o="".concat(null!=s&&s.url?"url: ".concat(s.url,"\n"):"")+"".concat(null!=a&&a.status||null!=a&&a.statusText?"response: ".concat(null==a?void 0:a.status,", ").concat(null==a?void 0:a.statusText,"\n"):"");n("error",{player_error_code:null==i?void 0:i.code,player_error_message:null==i?void 0:i.message,player_error_context:o})};r.on("error",h),r._stopMuxMonitor=function(){r.off("manifestLoaded",s),r.off("initFragmentLoaded",o),r.off("mediaFragmentLoaded",l),r.off("qualityChangeRendered",u),r.off("error",h),r.off("fragmentLoadingAbandoned",p),delete r._stopMuxMonitor}}else i.warn("Invalid dash.js player reference. Monitoring blocked.")}(this.mux,this.id,e.dashjs)):this.mux.log.warn("You must pass a valid dashjs instance in order to track it.")}},{key:"removeDashJS",value:function(){var e;this.dashjs&&((e=this.dashjs)&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor(),this.dashjs=void 0)}}],eZ(a.prototype,r),i&&eZ(a,i),Object.defineProperty(a,"prototype",{writable:!1}),a}(O),eJ=r(153),eX=r.n(eJ);function e0(e){return(e0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e1(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s=[],a=!0,o=!1;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(s.push(i.value),!t||s.length!==t);a=!0);}catch(l){o=!0,n=l}finally{try{a||null==r.return||r.return()}finally{if(o)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return e2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e2(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e2(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var e5,e4,e6,e3,e9,e8,e7,te,tt,tr,ti,tn,ts,ta,to,tl,tc,td,tu,tp,th,tm,tf,tg,tv,ty=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],tb={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};n()&&n().WeakMap&&(tv=new WeakMap);var tw=function(e){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(e),this.manifest};tw.prototype.process=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.processLine(this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},tw.prototype.processLine=function(e){var t=e.indexOf(":"),r=tR(e,t),i=r[0],n=2===r.length?tx(r[1]):void 0;if("#"!==i[0])this.currentUri.uri=i,this.manifest.segments.push(this.currentUri),!this.manifest.targetDuration||"duration"in this.currentUri||(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(i){case"#EXT-X-TARGETDURATION":if(!isFinite(n)||n<0)return;this.manifest.targetDuration=n,this.setHoldBack();break;case"#EXT-X-PART-INF":t_(this.manifest,r),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break;case"#EXT-X-SERVER-CONTROL":t_(this.manifest,r),this.setHoldBack();break;case"#EXTINF":0===n?this.currentUri.duration=.01:n>0&&(this.currentUri.duration=n);break;case"#EXT-X-PROGRAM-DATE-TIME":var s=new Date(n);this.manifest.dateTimeString||(this.manifest.dateTimeString=n,this.manifest.dateTimeObject=s),this.currentUri.dateTimeString=n,this.currentUri.dateTimeObject=s;break;case"#EXT-X-VERSION":t_(this.manifest,r);break;case"#EXT-X-SESSION-DATA":var a=x(tE(r[1]));Object.assign(this.manifest.sessionData,a)}},tw.prototype.setHoldBack=function(){var e=this.manifest,t=e.serverControl,r=e.targetDuration,i=e.partTargetDuration;if(t){var n="holdBack",s="partHoldBack",a=r&&3*r,o=i&&2*i;r&&!t.hasOwnProperty(n)&&(t[n]=a),a&&t[n]<a&&(t[n]=a),i&&!t.hasOwnProperty(s)&&(t[s]=3*i),i&&t[s]<o&&(t[s]=o)}};var t_=function(e,t){var r,i=tS(t[0].replace("#EXT-X-",""));tk(t[1])?(r={},r=Object.assign(tT(t[1]),r)):r=tx(t[1]),e[i]=r},tS=function(e){return e.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},tx=function(e){if("yes"===e.toLowerCase()||"no"===e.toLowerCase())return"yes"===e.toLowerCase();var t=-1!==e.indexOf(":")?e:parseFloat(e);return isNaN(t)?e:t},tC=function(e){var t={},r=e.split("=");return r.length>1&&(t[tS(r[0])]=tx(r[1])),t},tT=function(e){for(var t=e.split(","),r={},i=0;t.length>i;i++)r=Object.assign(tC(t[i]),r);return r},tk=function(e){return e.indexOf("=")>-1},tR=function(e,t){return -1===t?[e]:[e.substring(0,t),e.substring(t+1)]},tE=function(e){var t={};if(e){var r=e.search(",");return[e.slice(0,r),e.slice(r+1)].forEach(function(e,r){for(var i=e.replace(/['"]+/g,"").split("="),n=0;n<i.length;n++)"DATA-ID"===i[n]&&(t["DATA-ID"]=i[1-n]),"VALUE"===i[n]&&(t.VALUE=i[1-n])}),{data:t}}},tP={safeCall:function(e,t,r,i){var n=i;if(e&&"function"==typeof e[t])try{n=e[t].apply(e,r)}catch(s){p.info("safeCall error",s)}return n},safeIncrement:y,getComputedStyle:function(e,t){var r;if(e&&t&&n()&&"function"==typeof n().getComputedStyle)return tv&&tv.has(e)&&(r=tv.get(e)),r||(r=n().getComputedStyle(e,null),tv&&tv.set(e,r)),r.getPropertyValue(t)},secondsToMs:function(e){return Math.floor(1e3*e)},assign:Object.assign,headersStringToObject:_,cdnHeadersToRequestId:S,extractHostnameAndDomain:g,extractHostname:f,manifestParser:tw,generateShortID:a,generateUUID:s,now:m.now};function tD(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var tL={},tI=function e(t){var r=arguments;"string"==typeof t?e.hasOwnProperty(t)?n().setTimeout(function(){r=Array.prototype.splice.call(r,1),e[t].apply(null,r)},0):p.warn("`"+t+"` is an unknown task"):"function"==typeof t?n().setTimeout(function(){t(e)},0):p.warn("`"+t+"` is invalid.")},tM={loaded:m.now(),NAME:"mux-embed",VERSION:"4.26.0",API_VERSION:"2.1",PLAYER_TRACKED:!1,monitor:function(e,t){return function(e,t,r){var i=e1(l(t),3),n=i[0],s=i[1],a=i[2],o=e.log,c=e.utils.getComputedStyle,d=e.utils.secondsToMs;if(!n)return o.error("No element was found with the `"+s+"` query selector.");if("video"!==a&&"audio"!==a)return o.error("The element of `"+s+"` was not a media element.");n.mux&&(n.mux.destroy(),delete n.mux,o.warn("Already monitoring this video element, replacing existing event listeners")),(r=Object.assign({automaticErrorTracking:!0},r)).data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:e.VERSION},r.data),r.getPlayheadTime=function(){return d(n.currentTime)},r.getStateData=function(){var e,t,i=this.hlsjs&&this.hlsjs.url,s=this.dashjs&&e0("function"===this.dashjs.getSource)&&this.dashjs.getSource(),a={player_is_paused:n.paused,player_playhead_time:d(n.currentTime),player_width:parseInt(c(n,"width")),player_height:parseInt(c(n,"height")),player_autoplay_on:n.autoplay,player_preload_on:n.preload,player_language_code:n.lang,player_is_fullscreen:eX()&&!!(eX().fullscreenElement||eX().webkitFullscreenElement||eX().mozFullScreenElement||eX().msFullscreenElement),video_poster_url:n.poster,video_source_url:i||s||n.currentSrc,video_source_duration:d(n.duration),video_source_height:n.videoHeight,video_source_width:n.videoWidth,view_dropped_frame_count:null===(e=n)||void 0===e||null===(t=e.getVideoPlaybackQuality)||void 0===t?void 0:t.call(e).droppedVideoFrames},o=r.getPlayheadTime();if(n.getStartDate&&o>0){var l=n.getStartDate();if(l&&"function"==typeof l.getTime&&l.getTime()){var u=l.getTime();if(a.player_program_time=u+o,n.seekable.length>0){var p=u+n.seekable.end(n.seekable.length-1);a.player_live_edge_program_time=p}}}return a},n.mux=n.mux||{},n.mux.deleted=!1,n.mux.emit=function(t,r){e.emit(s,t,r)};var u=function(){o.error("The monitor for this video element has already been destroyed.")};n.mux.destroy=function(){Object.keys(n.mux.listeners).forEach(function(e){n.removeEventListener(e,n.mux.listeners[e],!1)}),delete n.mux.listeners,n.mux.destroy=u,n.mux.swapElement=u,n.mux.emit=u,n.mux.addHLSJS=u,n.mux.addDashJS=u,n.mux.removeHLSJS=u,n.mux.removeDashJS=u,n.mux.deleted=!0,e.emit(s,"destroy")},n.mux.swapElement=function(t){var r=e1(l(t),3),i=r[0],s=r[1],a=r[2];return i?"video"!==a&&"audio"!==a?e.log.error("The element of `"+s+"` was not a media element."):(i.muxId=n.muxId,delete n.muxId,i.mux=i.mux||{},i.mux.listeners=Object.assign({},n.mux.listeners),delete n.mux.listeners,Object.keys(i.mux.listeners).forEach(function(e){n.removeEventListener(e,i.mux.listeners[e],!1),i.addEventListener(e,i.mux.listeners[e],!1)}),i.mux.swapElement=n.mux.swapElement,i.mux.destroy=n.mux.destroy,delete n.mux,void(n=i)):e.log.error("No element was found with the `"+s+"` query selector.")},n.mux.addHLSJS=function(t){e.addHLSJS(s,t)},n.mux.addDashJS=function(t){e.addDashJS(s,t)},n.mux.removeHLSJS=function(){e.removeHLSJS(s)},n.mux.removeDashJS=function(){e.removeDashJS(s)},e.init(s,r),e.emit(s,"playerready"),n.paused||(e.emit(s,"play"),n.readyState>2&&e.emit(s,"playing")),n.mux.listeners={},ty.forEach(function(t){("error"!==t||r.automaticErrorTracking)&&(n.mux.listeners[t]=function(){var r={};if("error"===t){if(!n.error||1===n.error.code)return;r.player_error_code=n.error.code,r.player_error_message=tb[n.error.code]||n.error.message}e.emit(s,t,r)},n.addEventListener(t,n.mux.listeners[t],!1))})}(tI,e,t)},destroyMonitor:function(e){var t,r=(function(e){if(Array.isArray(e))return e}(t=l(e))||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s=[],a=!0,o=!1;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(s.push(i.value),!t||s.length!==t);a=!0);}catch(l){o=!0,n=l}finally{try{a||null==r.return||r.return()}finally{if(o)throw n}}return s}}(t,1)||function(e,t){if(e){if("string"==typeof e)return tD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tD(e,t):void 0}}(t,1)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];r&&r.mux&&"function"==typeof r.mux.destroy?r.mux.destroy():p.error("A video element monitor for `"+e+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(e,t){var r=o(e);tL[r]?tL[r].addHLSJS(t):p.error("A monitor for `"+r+"` has not been initialized.")},addDashJS:function(e,t){var r=o(e);tL[r]?tL[r].addDashJS(t):p.error("A monitor for `"+r+"` has not been initialized.")},removeHLSJS:function(e){var t=o(e);tL[t]?tL[t].removeHLSJS():p.error("A monitor for `"+t+"` has not been initialized.")},removeDashJS:function(e){var t=o(e);tL[t]?tL[t].removeDashJS():p.error("A monitor for `"+t+"` has not been initialized.")},init:function(e,t){h()&&t&&t.respectDoNotTrack&&p.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var r=o(e);tL[r]=new eY(tI,r,t)},emit:function(e,t,r){var i=o(e);tL[i]?(tL[i].emit(t,r),"destroy"===t&&delete tL[i]):p.error("A monitor for `"+i+"` has not been initialized.")},checkDoNotTrack:h,log:p,utils:tP,events:{PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled"},WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(tI,tM),void 0!==n()&&"function"==typeof n().addEventListener&&n().addEventListener("pagehide",function(e){e.persisted||(tI.WINDOW_UNLOADING=!0)},!1);var tj=tI},655:function(e,t,r){var i;function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e);/*!
 * JavaScript Cookie v2.1.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */}!function(s){var a=!1;if(void 0===(i="function"==typeof s?s.call(t,r,t,e):s)||(e.exports=i),a=!0,"object"===n(t)&&(e.exports=s(),a=!0),!a){var o=window.Cookies,l=window.Cookies=s();l.noConflict=function(){return window.Cookies=o,l}}}(function(){var e=function(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var i in r)t[i]=r[i]}return t};return function t(r){function i(t,n,s){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(s=e({path:"/"},i.defaults,s)).expires){var o=new Date;o.setMilliseconds(o.getMilliseconds()+864e5*s.expires),s.expires=o}try{a=JSON.stringify(n),/^[\{\[]/.test(a)&&(n=a)}catch(l){}return n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[t,"=",n,s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("")}t||(a={});for(var c=document.cookie?document.cookie.split("; "):[],d=/(%[0-9A-Z]{2})+/g,u=0;u<c.length;u++){var p=c[u].split("="),h=p.slice(1).join("=");'"'===h.charAt(0)&&(h=h.slice(1,-1));try{var m=p[0].replace(d,decodeURIComponent);if(h=r.read?r.read(h,m):r(h,m)||h.replace(d,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(f){}if(t===m){a=h;break}t||(a[m]=h)}catch(g){}}return a}}return i.set=i,i.get=function(e){return i.call(i,e)},i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(t,r){i(t,"",e(r,{expires:-1}))},i.withConverter=t,i}(function(){})})},153:function(e,t,r){var i,n=void 0!==r.g?r.g:"undefined"!=typeof window?window:{},s=r(558);"undefined"!=typeof document?i=document:(i=n["__GLOBAL_DOCUMENT_CACHE@4"])||(i=n["__GLOBAL_DOCUMENT_CACHE@4"]=s),e.exports=i},48:function(e,t,r){var i;i="undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{},e.exports=i},640:function(e,t,r){var i,n;void 0===(n="function"==typeof(i=function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function n(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(i){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(t,r){for(var n=0;n<i.length;n++){var s=i[n];this[s]=n<t?e:this.methodFactory(s,t,r)}this.log=this.debug}function o(e,r,i){return function(){typeof console!==t&&(a.call(this,r,i),this[e].apply(this,arguments))}}function l(i,a,l){var c;return"debug"===(c=i)&&(c="log"),typeof console!==t&&("trace"===c&&r?s:void 0!==console[c]?n(console,c):void 0!==console.log?n(console,"log"):e)||o.apply(this,arguments)}function c(e,r,n){var s,o=this;r=null==r?"WARN":r;var c="loglevel";function d(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(r){}if(typeof e===t)try{var i=window.document.cookie,n=i.indexOf(encodeURIComponent(c)+"=");-1!==n&&(e=/^([^;]+)/.exec(i.slice(n))[1])}catch(s){}return void 0===o.levels[e]&&(e=void 0),e}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),o.name=e,o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=n||l,o.getLevel=function(){return s},o.setLevel=function(r,n){if("string"==typeof r&&void 0!==o.levels[r.toUpperCase()]&&(r=o.levels[r.toUpperCase()]),!("number"==typeof r&&r>=0&&r<=o.levels.SILENT))throw"log.setLevel() called with invalid level: "+r;if(s=r,!1!==n&&function(e){var r=(i[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=r)}catch(n){}try{window.document.cookie=encodeURIComponent(c)+"="+r+";"}catch(s){}}}(r),a.call(o,r,e),typeof console===t&&r<o.levels.SILENT)return"No console available for logging"},o.setDefaultLevel=function(e){r=e,d()||o.setLevel(e,!1)},o.resetLevel=function(){o.setLevel(r,!1),function(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(r){}}}()},o.enableAll=function(e){o.setLevel(o.levels.TRACE,e)},o.disableAll=function(e){o.setLevel(o.levels.SILENT,e)};var u=d();null==u&&(u=r),o.setLevel(u,!1)}var d=new c,u={};d.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw TypeError("You must supply a name when creating a logger.");var t=u[e];return t||(t=u[e]=new c(e,d.getLevel(),d.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return d.noConflict=function(){return typeof window!==t&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return u},d.default=d,d})?i.call(t,r,t,e):i)||(e.exports=n)},375:function(e,t){"use strict";var r=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}function n(e){try{return encodeURIComponent(e)}catch(t){return null}}t.stringify=function(e,t){var i,s,a=[];for(s in"string"!=typeof(t=t||"")&&(t="?"),e)if(r.call(e,s)){if((i=e[s])||null!=i&&!isNaN(i)||(i=""),s=n(s),i=n(i),null===s||null===i)continue;a.push(s+"="+i)}return a.length?t+a.join("&"):""},t.parse=function(e){for(var t,r=/([^=?#&]+)=?([^&]*)/g,n={};t=r.exec(e);){var s=i(t[1]),a=i(t[2]);null===s||null===a||s in n||(n[s]=a)}return n}},558:function(){}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,r),s.exports}return r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r(80)}()},8266:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return r(91565)}])},81288:function(e,t,r){"use strict";r.d(t,{M:function(){return i}});let i=[{inputs:[{internalType:"address",name:"hub",type:"address"},{internalType:"address",name:"moduleGlobals",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"FollowInvalid",type:"error"},{inputs:[],name:"InitParamsInvalid",type:"error"},{inputs:[],name:"InvalidParameters",type:"error"},{inputs:[],name:"ModuleDataMismatch",type:"error"},{inputs:[],name:"NotHub",type:"error"},{inputs:[],name:"NotOwnerOrApproved",type:"error"},{inputs:[],name:"OnlyOwner",type:"error"},{inputs:[],name:"SignatureExpired",type:"error"},{inputs:[],name:"SignatureInvalid",type:"error"},{inputs:[],name:"ZeroSpender",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"profileId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"pubId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"address",name:"currency",type:"address"},{indexed:!1,internalType:"address",name:"recipient",type:"address"},{indexed:!1,internalType:"uint16",name:"referralFee",type:"uint16"},{indexed:!1,internalType:"bool",name:"followerOnly",type:"bool"}],name:"ModuleParametersUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"HUB",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"MODULE_GLOBALS",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{components:[{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct DataTypes.EIP712Signature",name:"sig",type:"tuple"}],name:"burnWithSig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"exists",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getDomainSeparator",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"profileId",type:"uint256"},{internalType:"uint256",name:"pubId",type:"uint256"}],name:"getPublicationData",outputs:[{components:[{internalType:"uint256",name:"ownershipTokenId",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"currency",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint16",name:"referralFee",type:"uint16"},{internalType:"bool",name:"followerOnly",type:"bool"}],internalType:"struct ProfilePublicationData",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"profileId",type:"uint256"},{internalType:"uint256",name:"pubId",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"initializePublicationCollectModule",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"mintTimestampOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{components:[{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct DataTypes.EIP712Signature",name:"sig",type:"tuple"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"},{components:[{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct DataTypes.EIP712Signature",name:"sig",type:"tuple"}],name:"permitForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"referrerProfileId",type:"uint256"},{internalType:"address",name:"collector",type:"address"},{internalType:"uint256",name:"profileId",type:"uint256"},{internalType:"uint256",name:"pubId",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"processCollect",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"sigNonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenDataOf",outputs:[{components:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint96",name:"mintTimestamp",type:"uint96"}],internalType:"struct IERC721Time.TokenData",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"profileId",type:"uint256"},{internalType:"uint256",name:"pubId",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"currency",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint16",name:"referralFee",type:"uint16"},{internalType:"bool",name:"followerOnly",type:"bool"}],name:"updateModuleParameters",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"profileId",type:"uint256"},{internalType:"uint256",name:"pubId",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"currency",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint16",name:"referralFee",type:"uint16"},{internalType:"bool",name:"followerOnly",type:"bool"},{internalType:"address",name:"operator",type:"address"},{components:[{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct DataTypes.EIP712Signature",name:"sig",type:"tuple"}],name:"updateModuleParametersWithSig",outputs:[],stateMutability:"nonpayable",type:"function"}]},62083:function(e,t,r){"use strict";var i=r(85893),n=r(29780),s=r(33962),a=r(17295),o=r(9187),l=r(21273),c=r(14348),d=r(88005),u=r(67294),p=r(86501),h=r(31618);let m=e=>{let{module:t,title:r}=e,[m,f]=(0,u.useState)((null==t?void 0:t.allowance)!=="0x00"),[g,{loading:v}]=(0,l.Dw)(),{data:y,isLoading:b,sendTransaction:w}=(0,h.pQ)({onError:o.Z}),{isLoading:_}=(0,h.BX)({hash:null==y?void 0:y.hash,onSuccess:()=>{p.Am.success("Modude ".concat(m?"disabled":"enabled"," successfully!")),f(!m)},onError:o.Z}),S=(e,r,i)=>{g({variables:{request:{currency:e,value:r,[(0,a.rT)(t.module).field]:i}}}).then(e=>{var t;let r=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.generateModuleCurrencyApprovalData;null==w||w({to:null==r?void 0:r.to,data:null==r?void 0:r.data})})};return m?(0,i.jsx)(n.z,{variant:"warning",icon:v||b||_?(0,i.jsx)(s.$,{variant:"warning",size:"xs"}):(0,i.jsx)(c.Z,{className:"h-4 w-4"}),onClick:()=>S(t.currency,"0",t.module),children:"Revoke"}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(n.z,{variant:"success",icon:v||b||_?(0,i.jsx)(s.$,{variant:"success",size:"xs"}):(0,i.jsx)(d.Z,{className:"h-4 w-4"}),onClick:()=>S(t.currency,Number.MAX_SAFE_INTEGER.toString(),t.module),children:r})})};t.Z=m},88942:function(e,t,r){"use strict";r.d(t,{Z:function(){return K}});var i=r(85893),n=r(67294),s=r(68980),a=r(37331),o=r(81288),l=r(58806),c=r(29780),d=r(64208),u=r(34625),p=r(10588),h=r(2176),m=r(64911),f=r(9187),g=r(92882),v=r(21273),y=r(13250),b=r(7543),w=r(48987),_=r(85837),S=r(20445),x=r(97535),C=r(10050),T=r(56371),k=r(86501),R=r(31618),E=r(52040),P=r(9747),D=r(25675),L=r.n(D),I=r(62083),M=r(27484),j=r.n(M),O=r(33962),A=r(40819),N=r(3689);let F=e=>{var t,r,D,M,F,q,B,U,H,z,V,$,Z,W,K,G,Q,Y,J,X,ee,et,er,ei,en,es,ea,eo,el,ec,ed,eu,ep,eh,em,ef;let{publication:eg,setCount:ev,count:ey}=e,eb=(0,g.qr)(e=>e.userSigNonce),ew=(0,g.qr)(e=>e.setUserSigNonce),e_=(0,g.qr)(e=>e.currentProfile),[eS,ex]=(0,n.useState)(0),[eC,eT]=(0,n.useState)(null==eg?void 0:eg.hasCollectedByMe),[ek,eR]=(0,n.useState)(!1),[eE,eP]=(0,n.useState)(!0),[eD,eL]=(0,n.useState)(0),{address:eI}=(0,R.mA)(),{isLoading:eM,signTypedDataAsync:ej}=(0,R.yw)({onError:f.Z}),{data:eO,loading:eA}=(0,v.EE)({variables:{request:{publicationId:null==eg?void 0:eg.id}}}),eN=null==eO?void 0:null===(t=eO.publication)||void 0===t?void 0:t.collectModule,eF=()=>{var e;ex(eS+parseFloat(null==eN?void 0:null===(e=eN.amount)||void 0===e?void 0:e.value)),ev(ey+1),eT(!0),k.ZP.success("Collect Successfully")},{isFetching:eq,refetch:eB}=(0,R.do)({address:u.cX,abi:o.M,functionName:"getPublicationData",args:[parseInt(null===(r=eg.profile)||void 0===r?void 0:r.id),parseInt(null==eg?void 0:eg.id.split("-")[1])],enabled:!1}),{data:eU,isLoading:eH,write:ez}=(0,R.GG)({address:u.Nm,abi:a.g,functionName:"collectWithSig",onSuccess:eF,onError:f.Z}),eV=ey/parseInt(null==eN?void 0:eN.collectLimit)*100,{data:e$,loading:eZ}=(0,v.Or)({variables:{request:{currencies:null==eN?void 0:null===(D=eN.amount)||void 0===D?void 0:null===(M=D.asset)||void 0===M?void 0:M.address,followModules:[],collectModules:null==eN?void 0:eN.type,referenceModules:[]}},skip:!(null==eN?void 0:null===(F=eN.amount)||void 0===F?void 0:null===(q=F.asset)||void 0===q?void 0:q.address)||!e_,onCompleted:e=>{var t;eP((null===(t=null==e?void 0:e.approvedModuleAllowanceAmount[0])||void 0===t?void 0:t.allowance)!=="0x00")}}),{data:eW,loading:eK}=(0,v.kV)({variables:{request:{publicationId:null==eg?void 0:eg.id}},pollInterval:5e3,skip:!(null==eg?void 0:eg.id)});(0,n.useEffect)(()=>{var e,t,r,i,n,s;ex(parseFloat(null!==(i=null==eW?void 0:null===(e=eW.publicationRevenue)||void 0===e?void 0:null===(t=e.revenue)||void 0===t?void 0:null===(r=t.total)||void 0===r?void 0:r.value)&&void 0!==i?i:0)),(null==eN?void 0:eN.amount)&&(0,h.Z)((0,p.Z)(null==eN?void 0:null===(n=eN.amount)||void 0===n?void 0:null===(s=n.asset)||void 0===s?void 0:s.symbol)).then(e=>{eL(e)})},[null==eN?void 0:eN.amount,eW]);let{data:eG,isLoading:eQ}=(0,R.KQ)({address:eI,token:null==eN?void 0:null===(B=eN.amount)||void 0===B?void 0:null===(U=B.asset)||void 0===U?void 0:U.address,formatUnits:null==eN?void 0:null===(H=eN.amount)||void 0===H?void 0:null===(z=H.asset)||void 0===z?void 0:z.decimals,watch:!0}),eY=!1;eY=!(eG&&parseFloat(null==eG?void 0:eG.formatted)<parseFloat(null==eN?void 0:null===(V=eN.amount)||void 0===V?void 0:V.value));let{broadcast:eJ,data:eX,loading:e0}=(0,y.Z)({onCompleted:eF}),[e1,{loading:e2}]=(0,v.Dt)({onCompleted:async e=>{let{createCollectTypedData:t}=e;try{let{id:r,typedData:i}=t,{profileId:n,pubId:s,data:a,deadline:o}=i.value,l=await ej((0,m.Z)(i)),{v:c,r:d,s:p}=(0,T.splitSignature)(l),h={collector:eI,profileId:n,pubId:s,data:a,sig:{v:c,r:d,s:p,deadline:o}};if(ew(eb+1),!u.fx)return null==ez?void 0:ez({args:[h]});let{data:{broadcast:f}}=await eJ({request:{id:r,signature:l}});"reason"in f&&(null==ez||ez({args:[h]}))}catch(g){}},onError:f.Z}),[e5,{loading:e4}]=(0,v.RI)({onCompleted:eF,onError:f.Z}),e6=async e=>{let{data:t}=await e5({variables:e});(null==t?void 0:t.proxyAction)||e1({variables:{request:{publicationId:null==eg?void 0:eg.id},options:{overrideSigNonce:eb}}})},e3=()=>{if(!e_)return k.ZP.error("Please connect your Wallet");(null==eN?void 0:eN.type)===s.pYo.FeeCollectModule?e6({request:{collect:{freeCollect:{publicationId:null==eg?void 0:eg.id}}}}):(null==eN?void 0:eN.__typename)==="UnknownCollectModuleSettings"?eB().then(e=>{let{data:t}=e;t&&(T.defaultAbiCoder.encode(["address","uint256"],[null==t?void 0:t[2],null==t?void 0:t[1]]),e1({variables:{options:{overrideSigNonce:eb},request:{publicationId:null==eg?void 0:eg.id,unknownModuleData:N.cv}}}))}):e1({variables:{options:{overrideSigNonce:eb},request:{publicationId:null==eg?void 0:eg.id}}})};if(eA||eK)return(0,i.jsx)(P.Z,{message:"Loading collect"});let e9=e2||e4||eM||eq||eH||e0;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(i.Fragment,{children:[((null==eN?void 0:eN.type)===s.pYo.LimitedFeeCollectModule||(null==eN?void 0:eN.type)===s.pYo.LimitedTimedFeeCollectModule)&&(0,i.jsx)("div",{className:"h-2.5 w-full bg-gray-200",children:(0,i.jsx)("div",{className:"h-2.5 bg-blue-500",style:{width:"".concat(eV,"%")}})}),(0,i.jsxs)("div",{className:"p-5",children:[(null==eN?void 0:eN.followerOnly)&&(0,i.jsx)("div",{className:"pb-5",children:"Follower Only Collect Module"}),(0,i.jsxs)("div",{className:"space-y-1.5 pb-2",children:[(0,i.jsx)("div",{className:"flex items-center space-x-2",children:(null==eg?void 0:null===($=eg.metadata)||void 0===$?void 0:$.name)&&(0,i.jsx)("div",{className:"text-xl font-bold",children:null==eg?void 0:null===(Z=eg.metadata)||void 0===Z?void 0:Z.name})}),(null==eg?void 0:null===(W=eg.metadata)||void 0===W?void 0:W.description)&&(0,i.jsx)("span",{className:"line-clamp-2 text-gray-500",children:null==eg?void 0:null===(K=eg.metadata)||void 0===K?void 0:K.description})]}),(null==eN?void 0:eN.amount)&&(0,i.jsxs)("div",{className:"flex items-center space-x-1.5 py-2",children:[(0,i.jsx)(L(),{className:"h-7 w-7",height:28,width:28,src:(0,E.Z)(null==eN?void 0:null===(G=eN.amount)||void 0===G?void 0:null===(Q=G.asset)||void 0===Q?void 0:Q.symbol),alt:null==eN?void 0:null===(Y=eN.amount)||void 0===Y?void 0:null===(J=Y.asset)||void 0===J?void 0:J.symbol,title:null==eN?void 0:null===(X=eN.amount)||void 0===X?void 0:null===(ee=X.asset)||void 0===ee?void 0:ee.symbol}),(0,i.jsxs)("span",{className:"space-x-1",children:[(0,i.jsx)("span",{className:"text-2x1 font-bold",children:eN.amount.value}),(0,i.jsx)("span",{className:"text-xs",children:null==eN?void 0:null===(et=eN.amount)||void 0===et?void 0:null===(er=et.asset)||void 0===er?void 0:er.symbol}),eD?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"px-0.5 text-gray-500",children:"."}),(0,i.jsxs)("span",{children:["$",(eN.amount.value*eD).toFixed(2)]})]}):null]})]}),(0,i.jsxs)("div",{className:"space-y-1.5",children:[(0,i.jsxs)("div",{className:"item-center block space-y-1 sm:flex sm:space-x-5",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2 overflow-auto",children:[(0,i.jsx)(b.Z,{className:"h-4 w-4 text-gray-500"}),(0,i.jsxs)("span",{className:"cursor-pointer text-xs font-bold",onClick:()=>{eR(!ek)},children:[ey," Collectors"]}),(0,i.jsx)(d.u,{title:"Collected by",show:ek,onClose:()=>eR(!1),children:(0,i.jsx)(l.Z,{publicationId:null==eg?void 0:eg.id})})]}),(null==eN?void 0:eN.collectLimit)&&(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(w.Z,{className:"h-4 w-4 text-gray-500"}),(0,i.jsxs)("div",{className:"font-bold",children:[parseInt(null==eN?void 0:eN.collectLimit)-ey," Avaliable"]})]}),(null==eN?void 0:eN.referralFee)?(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(_.Z,{className:"h-4 w-4 text-gray-500"}),(0,i.jsxs)("div",{className:"font-bold",children:[eN.referralFee,"% Referral fee"]})]}):null]}),(null==eW?void 0:eW.publicationRevenue)&&(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(_.Z,{className:"h-4 w-4 text-gray-500"}),(0,i.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,i.jsx)("span",{children:"Revenue:"}),(0,i.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,i.jsx)(L(),{src:(0,E.Z)(null==eN?void 0:null===(ei=eN.amount)||void 0===ei?void 0:null===(en=ei.asset)||void 0===en?void 0:en.symbol),className:"h-5 w-5",height:20,width:20,alt:null==eN?void 0:null===(es=eN.amount)||void 0===es?void 0:null===(ea=es.asset)||void 0===ea?void 0:ea.symbol,title:null==eN?void 0:null===(eo=eN.amount)||void 0===eo?void 0:null===(el=eo.asset)||void 0===el?void 0:el.symbol}),(0,i.jsxs)("div",{className:"flex items-baseline space-x-1.5",children:[(0,i.jsx)("div",{className:"font-bold",children:eS}),(0,i.jsx)("div",{className:"text-[10px]",children:null==eN?void 0:null===(ec=eN.amount)||void 0===ec?void 0:null===(ed=ec.asset)||void 0===ed?void 0:ed.symbol}),eD?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"text-gray-500",children:"."}),(0,i.jsxs)("span",{className:"text-xs font-bold text-gray-500",children:["$",(eS*eD).toFixed(2)]})]}):null]})]})]})]}),(null==eN?void 0:eN.endTimestamp)&&(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(S.Z,{className:"h-4 w-4 text-gray-500"}),(0,i.jsxs)("div",{className:"space-x-1.5",children:[(0,i.jsx)("span",{children:"Sale Ends:"}),(0,i.jsxs)("span",{className:"font-bold text-gray-600",children:[j()(eN.endTimestamp).format("MMMM DD, YYYY")," ","at ",j()(eN.endTimestamp).format("hh:mm a")]})]})]}),(null==eO?void 0:null===(eu=eO.publication)||void 0===eu?void 0:eu.collectNftAddress)&&(0,i.jsx)("div",{})]}),(null!==(em=null==eU?void 0:eU.hash)&&void 0!==em?em:null==eX?void 0:null===(ep=eX.broadcast)||void 0===ep?void 0:ep.txHash)?(0,i.jsx)("div",{children:(0,i.jsx)(A.Z,{txHash:null!==(ef=null==eU?void 0:eU.hash)&&void 0!==ef?ef:null==eX?void 0:null===(eh=eX.broadcast)||void 0===eh?void 0:eh.txHash})}):null,(0,i.jsx)("div",{className:"mt-5 flex items-center space-x-2",children:e_&&!eC?eZ||eQ?(0,i.jsx)("div",{className:"round-lg shimmer h-[34px] w-28"}):eE?eY?(0,i.jsx)(c.z,{className:"text-xs font-bold",onClick:e3,disabled:e9,icon:e9?(0,i.jsx)(O.$,{size:"xs"}):(0,i.jsx)(x.Z,{className:"h-4 w-4"}),children:"Collect now"}):"Not enough money":(0,i.jsx)(I.Z,{title:"Allow collect module",module:null==e$?void 0:e$.approvedModuleAllowanceAmount[0],allowed:eE,setAllowed:eP}):null}),(null==eg?void 0:eg.hasCollectedByMe)&&(0,i.jsxs)("div",{className:"mt-3 flex items-center space-x-1.5 font-bold text-green-500",children:[(0,i.jsx)(C.Z,{className:"h-5 w-5"}),(0,i.jsx)("div",{children:"You already collected this"})]})]})]})})};var q=r(17295),B=r(53901);let U=n.forwardRef(function({title:e,titleId:t,...r},i){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:i,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 9.75h4.875a2.625 2.625 0 010 5.25H12M8.25 9.75L10.5 7.5M8.25 9.75L10.5 12m9-7.243V21.75l-3.75-1.5-3.75 1.5-3.75-1.5-3.75 1.5V4.757c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0c1.1.128 1.907 1.077 1.907 2.185z"}))}),H=n.forwardRef(function({title:e,titleId:t,...r},i){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:i,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))});var z=r(61452),V=r(28771);let $=e=>{let{module:t,size:r}=e;switch(t){case s.pYo.FeeCollectModule:return(0,i.jsx)(_.Z,{className:"h-".concat(r)});case s.pYo.LimitedFeeCollectModule:return(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(B.Z,{className:"h-".concat(r)}),(0,i.jsx)(_.Z,{className:"h-".concat(r)})]});case s.pYo.LimitedTimedFeeCollectModule:return(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(B.Z,{className:"h-".concat(r)}),(0,i.jsx)(S.Z,{className:"h-".concat(r)}),(0,i.jsx)(_.Z,{className:"h-".concat(r)})]});case s.pYo.TimedFeeCollectModule:return(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(S.Z,{className:"h-".concat(r)}),(0,i.jsx)(_.Z,{className:"h-".concat(r)})]});case s.pYo.RevertCollectModule:return(0,i.jsx)(U,{className:"h-".concat(r)});case s.pYo.FreeCollectModule:return(0,i.jsx)(H,{className:"h-".concat(r)});case s.wKL.FeeFollowModule:return(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(_.Z,{className:"h-".concat(r)}),(0,i.jsx)(z.Z,{className:"h-".concat(r)})]});case s._9N.FollowerOnlyReferenceModule:return(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(z.Z,{className:"h-".concat(r)}),(0,i.jsx)(V.Z,{className:"h-".concat(r)})]});default:return(0,i.jsx)(_.Z,{className:"h-".concat(r)})}},Z=e=>(0,i.jsxs)("svg",{...e,viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.448 0.750001C4.54954 0.749973 3.8003 0.749949 3.20552 0.829914C2.57773 0.914319 2.01093 1.09999 1.55546 1.55546C1.09999 2.01093 0.914319 2.57773 0.829914 3.20552C0.749949 3.8003 0.749973 4.54951 0.750001 5.44798V5.552C0.749973 6.45047 0.749949 7.19971 0.829914 7.79448C0.914319 8.42228 1.09999 8.98908 1.55546 9.44455C2.01093 9.90002 2.57773 10.0857 3.20552 10.1701C3.8003 10.2501 4.54951 10.25 5.44798 10.25H5.552C6.45047 10.25 7.19971 10.2501 7.79448 10.1701C8.42228 10.0857 8.98908 9.90002 9.44455 9.44455C9.90002 8.98908 10.0857 8.42228 10.1701 7.79448C10.2501 7.19971 10.25 6.4505 10.25 5.55203V5.44801C10.25 4.54954 10.2501 3.8003 10.1701 3.20552C10.0857 2.57773 9.90002 2.01093 9.44455 1.55546C8.98908 1.09999 8.42228 0.914319 7.79448 0.829914C7.19971 0.749949 6.4505 0.749973 5.55203 0.750001H5.448ZM2.61612 2.61612C2.74644 2.4858 2.94393 2.37858 3.4054 2.31654C3.88843 2.2516 4.53599 2.25 5.5 2.25C6.46401 2.25 7.11157 2.2516 7.59461 2.31654C8.05607 2.37858 8.25357 2.4858 8.38389 2.61612C8.5142 2.74644 8.62143 2.94393 8.68347 3.4054C8.74841 3.88843 8.75 4.53599 8.75 5.5C8.75 6.46401 8.74841 7.11157 8.68347 7.59461C8.62143 8.05607 8.5142 8.25357 8.38389 8.38389C8.25357 8.5142 8.05607 8.62143 7.59461 8.68347C7.11157 8.74841 6.46401 8.75 5.5 8.75C4.53599 8.75 3.88843 8.74841 3.4054 8.68347C2.94393 8.62143 2.74644 8.5142 2.61612 8.38389C2.4858 8.25357 2.37858 8.05607 2.31654 7.59461C2.2516 7.11157 2.25 6.46401 2.25 5.5C2.25 4.53599 2.2516 3.88843 2.31654 3.4054C2.37858 2.94393 2.4858 2.74644 2.61612 2.61612Z",fill:"currentColor"}),(0,i.jsx)("path",{d:"M17.25 2.5C17.25 2.08579 16.9142 1.75 16.5 1.75C16.0858 1.75 15.75 2.08579 15.75 2.5V4.75H13.5C13.0858 4.75 12.75 5.08579 12.75 5.5C12.75 5.91422 13.0858 6.25 13.5 6.25H15.75V8.5C15.75 8.91422 16.0858 9.25 16.5 9.25C16.9142 9.25 17.25 8.91422 17.25 8.5V6.25H19.5C19.9142 6.25 20.25 5.91422 20.25 5.5C20.25 5.08579 19.9142 4.75 19.5 4.75H17.25V2.5Z",fill:"currentColor"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.448 11.75H16.552C17.4505 11.75 18.1997 11.7499 18.7945 11.8299C19.4223 11.9143 19.9891 12.1 20.4445 12.5555C20.9 13.0109 21.0857 13.5777 21.1701 14.2055C21.2501 14.8003 21.25 15.5495 21.25 16.4479V16.552C21.25 17.4505 21.2501 18.1997 21.1701 18.7945C21.0857 19.4223 20.9 19.9891 20.4445 20.4445C19.9891 20.9 19.4223 21.0857 18.7945 21.1701C18.1997 21.2501 17.4505 21.25 16.5521 21.25H16.448C15.5496 21.25 14.8003 21.2501 14.2055 21.1701C13.5777 21.0857 13.0109 20.9 12.5555 20.4445C12.1 19.9891 11.9143 19.4223 11.8299 18.7945C11.7499 18.1997 11.75 17.4505 11.75 16.552V16.448C11.75 15.5495 11.7499 14.8003 11.8299 14.2055C11.9143 13.5777 12.1 13.0109 12.5555 12.5555C13.0109 12.1 13.5777 11.9143 14.2055 11.8299C14.8003 11.7499 15.5495 11.75 16.448 11.75ZM14.4054 13.3165C13.9439 13.3786 13.7464 13.4858 13.6161 13.6161C13.4858 13.7464 13.3786 13.9439 13.3165 14.4054C13.2516 14.8884 13.25 15.536 13.25 16.5C13.25 17.464 13.2516 18.1116 13.3165 18.5946C13.3786 19.0561 13.4858 19.2536 13.6161 19.3839C13.7464 19.5142 13.9439 19.6214 14.4054 19.6835C14.8884 19.7484 15.536 19.75 16.5 19.75C17.464 19.75 18.1116 19.7484 18.5946 19.6835C19.0561 19.6214 19.2536 19.5142 19.3839 19.3839C19.5142 19.2536 19.6214 19.0561 19.6835 18.5946C19.7484 18.1116 19.75 17.464 19.75 16.5C19.75 15.536 19.7484 14.8884 19.6835 14.4054C19.6214 13.9439 19.5142 13.7464 19.3839 13.6161C19.2536 13.4858 19.0561 13.3786 18.5946 13.3165C18.1116 13.2516 17.464 13.25 16.5 13.25C15.536 13.25 14.8884 13.2516 14.4054 13.3165Z",fill:"currentColor"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.448 11.75C4.54952 11.75 3.8003 11.7499 3.20552 11.8299C2.57773 11.9143 2.01093 12.1 1.55546 12.5555C1.09999 13.0109 0.914319 13.5777 0.829914 14.2055C0.749949 14.8003 0.749973 15.5495 0.750001 16.448V16.552C0.749973 17.4505 0.749949 18.1997 0.829914 18.7945C0.914319 19.4223 1.09999 19.9891 1.55546 20.4445C2.01093 20.9 2.57773 21.0857 3.20552 21.1701C3.8003 21.2501 4.54951 21.25 5.44798 21.25H5.552C6.45047 21.25 7.19971 21.2501 7.79448 21.1701C8.42228 21.0857 8.98908 20.9 9.44455 20.4445C9.90002 19.9891 10.0857 19.4223 10.1701 18.7945C10.2501 18.1997 10.25 17.4505 10.25 16.552V16.448C10.25 15.5495 10.2501 14.8003 10.1701 14.2055C10.0857 13.5777 9.90002 13.0109 9.44455 12.5555C8.98908 12.1 8.42228 11.9143 7.79448 11.8299C7.1997 11.7499 6.45048 11.75 5.552 11.75H5.448ZM2.61612 13.6161C2.74644 13.4858 2.94393 13.3786 3.4054 13.3165C3.88843 13.2516 4.53599 13.25 5.5 13.25C6.46401 13.25 7.11157 13.2516 7.59461 13.3165C8.05607 13.3786 8.25357 13.4858 8.38389 13.6161C8.5142 13.7464 8.62143 13.9439 8.68347 14.4054C8.74841 14.8884 8.75 15.536 8.75 16.5C8.75 17.464 8.74841 18.1116 8.68347 18.5946C8.62143 19.0561 8.5142 19.2536 8.38389 19.3839C8.25357 19.5142 8.05607 19.6214 7.59461 19.6835C7.11157 19.7484 6.46401 19.75 5.5 19.75C4.53599 19.75 3.88843 19.7484 3.4054 19.6835C2.94393 19.6214 2.74644 19.5142 2.61612 19.3839C2.4858 19.2536 2.37858 19.0561 2.31654 18.5946C2.2516 18.1116 2.25 17.464 2.25 16.5C2.25 15.536 2.2516 14.8884 2.31654 14.4054C2.37858 13.9439 2.4858 13.7464 2.61612 13.6161Z",fill:"currentColor"})]}),W=e=>{var t,r,a;let{publication:o}=e,[l,c]=(0,n.useState)(!1),[u,p]=(0,n.useState)(null==o?void 0:null===(t=o.stats)||void 0===t?void 0:t.totalAmountOfCollects),[h,m]=(0,n.useState)(!1),f=(null==o?void 0:o.collectModule.__typename)==="FreeCollectModuleSettings",v=(null==o?void 0:o.collectModule.__typename)==="UnknownCollectModuleSettings",y=(0,g.qr)(e=>e.currentProfile);return(0,n.useEffect)(()=>{(null==o?void 0:o.hasCollectedByMe)===!0?c(!0):c(!1),y||c(!1)},[null==o?void 0:o.hasCollectedByMe]),(0,i.jsx)("div",{className:"block flex gap-6",children:(0,i.jsxs)("div",{className:"flex cursor-pointer flex-col items-center justify-center md:mt-4",children:[l?(0,i.jsx)("div",{onClick:()=>{m(!0)},className:"flex cursor-pointer items-center rounded-full bg-gray-600/50 p-2 drop-shadow-lg dark:bg-gray-600/50 md:bg-gray-200 ",children:(0,i.jsx)(Z,{className:"w-3 font-bold text-blue-700 md:h-3"})}):(0,i.jsxs)("div",{onClick:()=>{m(!0)},className:"flex cursor-pointer items-center rounded-full bg-gray-600/50 p-2 drop-shadow-lg dark:bg-gray-600/50 md:bg-gray-200 ",children:[(0,i.jsx)(Z,{className:"h-3 w-3 cursor-pointer font-bold"}),(0,i.jsxs)("span",{className:"pointer-events-none absolute -bottom-7 left-7 hidden w-max px-2 py-1 text-xs text-blue-700 opacity-0 shadow group-hover:opacity-100 md:block",children:[" ","Collect"," "]})]}),(0,i.jsx)(d.u,{title:f?"Free Collect":v?"Unknown Collect":(0,q.rT)(null==o?void 0:null===(r=o.collectModule)||void 0===r?void 0:r.type).name,icon:(0,i.jsx)("div",{className:"text-[#57B8FF]",children:(0,i.jsx)($,{module:f?s.pYo.FreeCollectModule:null==o?void 0:null===(a=o.collectModule)||void 0===a?void 0:a.type,size:5})}),show:h,onClose:()=>m(!1),children:(0,i.jsx)(F,{publication:o,setCount:p,count:u})}),(0,i.jsx)("p",{className:"lg:[pb-2] hidden text-xs font-semibold text-gray-400"})]})})};var K=W},40339:function(e,t,r){"use strict";var i=r(85893),n=r(67294),s=r(41664),a=r.n(s),o=r(89583);let l=e=>{let{publication:t}=e,[r,s]=(0,n.useState)(!1),l="Mirror"===t.__typename,c=l?t.mirrorOf.stats.totalAmountOfComments:t.stats.totalAmountOfComments;return(0,i.jsx)("div",{className:"block flex gap-6",children:(0,i.jsx)(a(),{legacyBehavior:!0,href:"/post/".concat(t.id),children:(0,i.jsxs)("a",{className:"flex cursor-pointer flex-col items-center justify-center md:mt-4",children:[r?(0,i.jsx)("div",{className:"flex cursor-pointer items-center rounded-full bg-gray-600/50 p-2 drop-shadow-lg dark:bg-gray-600/50 md:bg-gray-200 ",children:(0,i.jsx)(o.QRJ,{className:"h-3 w-3 text-blue-700 "})}):(0,i.jsxs)("div",{className:"flex cursor-pointer items-center rounded-full bg-gray-600/50 p-2 drop-shadow-lg dark:bg-gray-600/50 md:bg-gray-200",children:[(0,i.jsx)(o.QRJ,{className:"h-3 w-3 "}),(0,i.jsxs)("span",{className:"pointer-events-none absolute -bottom-7 left-7 hidden w-max px-2 py-1 text-xs text-blue-700 opacity-0 shadow group-hover:opacity-100 md:block",children:[" ","Comment"," "]})]}),(0,i.jsx)("p",{className:"hidden text-xs font-semibold text-gray-400 lg:block",children:c})]})})})};t.Z=l},92864:function(e,t,r){"use strict";var i=r(85893),n=r(37331),s=r(34625),a=r(9187),o=r(13250),l=r(86501),c=r(92882),d=r(31618),u=r(64911),p=r(4242),h=r(21273);let m=e=>{let{setFollowing:t,profile:r}=e,m=(0,c.qr)(e=>e.userSigNonce),f=(0,c.qr)(e=>e.setUserSigNonce),g=(0,c.qr)(e=>e.currentProfile),{address:v}=(0,d.mA)(),{isLoading:y,signTypedDataAsync:b}=(0,d.yw)({onError:a.Z}),w=()=>{t(!0),l.Am.success("Followed successfully!")},_=e=>{e.modify({id:"Profile:".concat(null==r?void 0:r.id),fields:{isFollowedByMe:()=>!0}})},{isLoading:S,write:x}=(0,d.GG)({address:s.Nm,abi:n.g,functionName:"followWithSig",onSuccess:w,onError:a.Z}),{broadcast:C,loading:T}=(0,o.Z)({onCompleted:w}),[k,{loading:R}]=(0,h.Rs)({onCompleted:async e=>{let{createFollowTypedData:t}=e,{id:r,typedData:i}=t,{deadline:n}=i.value;try{let s=await b((0,u.Z)(JSON.parse(JSON.stringify(i))));f(m+1);let{profileIds:a,datas:o}=i.value,{v:l,r:c,s:d}=(0,p.Z)(s),h={follower:v,profileIds:a,datas:o,sig:{v:l,r:c,s:d,deadline:n}};null==x||x({args:[h]});let{data:{broadcast:g}}=await C({request:{id:r,signature:s}});"reason"in g&&(null==x||x({args:[h]}))}catch(y){}},onError:a.Z,update:_}),[E,{loading:P}]=(0,h.RI)({onCompleted:w,onError:a.Z,update:_}),D=async e=>{let{data:t}=await E({variables:e});(null==t?void 0:t.proxyAction)||k({variables:{request:{follow:[{profile:null==r?void 0:r.id}]},options:{overrideSigNonce:m}}})},L=()=>{if(!g)return l.Am.error("Please Connect Your Wallet");if(null==r?void 0:r.followModule){var e;k({variables:{options:{overrideSigNonce:m},request:{follow:[{profile:null==r?void 0:r.id,followModule:(null==r?void 0:null===(e=r.followModule)||void 0===e?void 0:e.__typename)==="ProfileFollowModuleSettings"?{profileFollowModule:{profileId:null==g?void 0:g.id}}:null}]}}})}else D({request:{follow:{freeFollow:{profileId:null==r?void 0:r.id}}}})};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{children:(0,i.jsx)("button",{onClick:L,disabled:R||P||y||S||T,className:"lg:text-md xl:text-md font-helvetica mt-2 cursor-pointer rounded-full border-2 border-black bg-blue-500 px-1 py-1 text-xs font-semibold text-[#000000] drop-shadow-xl transition hover:bg-[#57B8FF] hover:text-[#fff]",children:"Follow"})})})};t.Z=m},87184:function(e,t,r){"use strict";r.d(t,{Z:function(){return h}});var i=r(85893),n=r(67294),s=r(9187),a=r(92882),o=r(21273),l=r(68980),c=r(86501),d=r(8193);let u=e=>{let{setCount:t,setLiked:r,count:n,liked:u,publication:p}=e,h=(0,a.qr)(e=>e.currentProfile),[m]=(0,o.Os)({onCompleted:()=>{c.Am.success("Like successfully!")},onError:e=>{r(!u),t(n-1),(0,s.Z)(e)}}),[f]=(0,o.d6)({onCompleted:()=>{c.Am.success("Like removed successfully!")},onError:e=>{r(!u),t(n-1),(0,s.Z)(e)}}),g=()=>{if(!h)return c.Am.error("Please connect your wallet!");let e={variables:{request:{profileId:null==h?void 0:h.id,reaction:l.Oiw.Upvote,publicationId:null==p?void 0:p.id}}};u?(r(!1),t(n-1),f(e)):(r(!0),t(n+1),m(e))};return(0,i.jsx)(i.Fragment,{children:u?(0,i.jsx)("div",{onClick:g,className:" rounded-full bg-gray-600/50 p-2 dark:bg-gray-600/50 md:bg-gray-200",children:(0,i.jsx)(d.M_L,{className:"h-3 w-3 font-bold text-blue-500"})}):(0,i.jsx)("div",{onClick:g,className:" rounded-full bg-gray-600/50 p-2 dark:bg-gray-600/50 md:bg-gray-200",children:(0,i.jsx)(d.M_L,{className:"h-3 w-3 font-bold "})})})},p=e=>{let{publication:t}=e,[r,s]=(0,n.useState)(!1),o="Mirror"===t.__typename,[l,c]=(0,n.useState)(o?t.mirrorOf.stats.totalUpvotes:t.stats.totalUpvotes),d=(0,a.qr)(e=>e.currentProfile);return(0,n.useEffect)(()=>{(null==t?void 0:t.reaction)==="UPVOTE"?s(!0):s(!1),d||s(!1)},[null==t?void 0:t.reaction]),(0,i.jsx)("div",{className:"block flex gap-6",children:(0,i.jsxs)("div",{className:" flex cursor-pointer flex-col items-center justify-center md:mt-4",children:[(0,i.jsx)(u,{setCount:c,count:l,setLiked:s,liked:r,publication:t}),(0,i.jsxs)("p",{className:"hidden text-xs font-semibold text-gray-400 lg:block",children:[" ",l," "]})]})})};var h=p},8685:function(e,t,r){"use strict";r.d(t,{Z:function(){return T}});var i=r(85893),n=r(67294),s=r(92882),a=r(41664),o=r.n(a),l=r(86501),c=r(34625),d=r(6528),u=function(){let[e,t]=(0,n.useState)(null),r=async e=>{if(!(null==navigator?void 0:navigator.clipboard))return!1;try{return await navigator.clipboard.writeText(e),t(e),!0}catch(r){return t(null),!1}};return[r,e]},p=r(93300),h=r(21321),m=r(29350),f=r(5434);let g=e=>{let{videoId:t,onClose:r}=e,[s,a]=(0,n.useState)(!1),[o]=u(),d='<iframe width="560" height="315" src="'.concat(c.Qy,"/").concat(t,'?autoplay=1&t=0&loop=0" title="LensShare video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write;" allowfullscreen></iframe>'),g=()=>{o(d),l.ZP.success("Copied to clipboard")},v=()=>{a(!1),r()},y=()=>{a(!0)};return(0,i.jsxs)("div",{children:[(0,i.jsx)(m.Z,{title:"Embed Video",onClose:v,show:s,children:(0,i.jsxs)("div",{className:"display:absolute mt-40 rounded-xl bg-white ",children:[(0,i.jsx)("div",{className:"z-10 max-md:absolute",children:(0,i.jsx)("button",{type:"button",className:"right-1 m-4 rounded-full bg-slate-600 p-1 focus:outline-none",onClick:()=>a(!1),children:(0,i.jsx)(f.lTq,{className:"h-4 w-4 text-white"})})}),(0,i.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,i.jsx)("div",{className:"w-full break-words",children:(0,i.jsx)("iframe",{sandbox:"allow-scripts allow-same-origin",className:"mt-24 aspect-[16/9] w-full break-words",src:"".concat(c.Qy,"/").concat(t),title:"LensShare video player",allow:"accelerometer; autoplay; clipboard-write; gyroscope;",allowFullScreen:!0})}),(0,i.jsx)("div",{className:"col-span-2 mt-80",children:(0,i.jsx)("button",{type:"button",onClick:()=>g(),className:"select-all rounded-xl border p-4 text-left",children:(0,i.jsx)("code",{className:"select-all break-words text-xs opacity-60",children:d})})})]})]})}),(0,i.jsx)(p.u,{placement:"top",content:"Embed Video",children:(0,i.jsx)("button",{type:"button",onClick:()=>y(),className:"rounded-full bg-blue-500 p-2.5",children:(0,i.jsx)(h.Z,{className:"h-5 w-5 text-black"})})})]})};var v=r(47516),y=r(97454);let b=e=>"".concat(c.Tq,"/post/").concat(e.id),w=(e,t)=>{var r,i,n,s,a,o,l,d,u;return"lenster"===e?"".concat(c.ZT,"/?url=").concat(b(t),"&text=").concat(null===(r=t.metadata)||void 0===r?void 0:r.name," by @").concat((0,y.Z)(null===(i=t.profile)||void 0===i?void 0:i.handle),"&hashtags=Lensshare&preview=true"):"twitter"===e?encodeURI("https://twitter.com/intent/tweet?url=".concat(b(t),"&text=").concat(null===(n=t.metadata)||void 0===n?void 0:n.name," by @").concat((0,y.Z)(null===(s=t.profile)||void 0===s?void 0:s.handle),"&via=").concat(c.nG,"&related=Lensshare&hashtags=Lensshare")):"reddit"===e?"https://www.reddit.com/submit?url=".concat(b(t),"&title=").concat(null===(a=t.metadata)||void 0===a?void 0:a.name," by @").concat((0,y.Z)(null===(o=t.profile)||void 0===o?void 0:o.handle)):"linkedin"===e?"https://www.linkedin.com/shareArticle/?url=".concat(b(t)," by @").concat((0,y.Z)(null===(l=t.profile)||void 0===l?void 0:l.handle),"&title=").concat(null===(d=t.metadata)||void 0===d?void 0:d.name,"&summary=").concat(null===(u=t.metadata)||void 0===u?void 0:u.description,"&source=").concat(c.iC):""};var _=r(11761);let S=e=>{let{setShowShare:t,publication:r,show:n}=e,[s]=u(),a=async()=>{await s("".concat(c.Tq,"/post/").concat(r.id)),l.ZP.success("Permalink copied to clipboard")};return(0,i.jsxs)(m.Z,{title:"Share",onClose:()=>t(!1),show:n,children:[(0,i.jsx)("div",{className:"z-10 max-md:absolute",children:(0,i.jsx)("button",{type:"button",className:"right-1 m-4 rounded-full bg-slate-600 p-1 focus:outline-none",onClick:()=>t(!1),children:(0,i.jsx)(f.lTq,{className:"h-4 w-4 text-white"})})}),(0,i.jsx)("div",{className:"mt-20 rounded-xl bg-white",children:(0,i.jsxs)(_.Z,{className:"rounded-xl border-0 object-contain object-center p-2 ",children:[(0,i.jsxs)("div",{className:"no-scrollbar mb-4 flex flex-nowrap items-center space-x-3 overflow-x-auto",children:[(0,i.jsx)(g,{videoId:r.id,onClose:()=>t(!1)}),(0,i.jsx)(o(),{className:"rounded-full",target:"_blank",rel:"noreferrer",href:w("lenster",r),children:(0,i.jsx)("img",{src:(0,d.Z)("".concat(c.Fv,"/images/social/lenster.png"),"avatar_lg"),className:"h-10 w-10 max-w-none rounded-full",alt:"lenster",draggable:!1})}),(0,i.jsx)(o(),{className:"rounded-full",target:"_blank",rel:"noreferrer",href:w("twitter",r),children:(0,i.jsx)("img",{src:(0,d.Z)("".concat(c.Fv,"/images/social/twitter.png"),"avatar_lg"),className:"h-10 w-10 max-w-none rounded-full",alt:"twitter",draggable:!1})}),(0,i.jsx)(o(),{href:w("reddit",r),target:"_blank",rel:"noreferrer",children:(0,i.jsx)("img",{src:(0,d.Z)("".concat(c.Fv,"/images/social/reddit-logo.png"),"avatar_lg"),className:"h-10 w-10 max-w-none rounded-full",alt:"reddit",draggable:!1})}),(0,i.jsx)(o(),{href:w("linkedin",r),target:"_blank",rel:"noreferrer",children:(0,i.jsx)("img",{src:(0,d.Z)("".concat(c.Fv,"/images/social/linkedin.png"),"avatar_lg"),alt:"linkedin",className:"h-10 w-10 max-w-none rounded-full",draggable:!1})})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-gray-200 p-2 dark:border-gray-800",children:[(0,i.jsxs)("div",{className:"select-all truncate text-sm",children:[c.Tq,"/post/",r.id]}),(0,i.jsx)("button",{className:"ml-2 hover:opacity-60 focus:outline-none",onClick:()=>a(),type:"button",children:(0,i.jsx)(v.LhG,{className:"h-4 w-4"})})]})]})})]})},x=e=>(0,i.jsxs)("svg",{...e,viewBox:"0 0 22 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.75 4C14.75 1.92893 13.0711 0.25 11 0.25C8.92893 0.25 7.25 1.92893 7.25 4C7.25 6.07107 8.92893 7.75 11 7.75C13.0711 7.75 14.75 6.07107 14.75 4ZM11 1.75C12.2426 1.75 13.25 2.75736 13.25 4C13.25 5.24264 12.2426 6.25 11 6.25C9.75736 6.25 8.75 5.24264 8.75 4C8.75 2.75736 9.75736 1.75 11 1.75Z",fill:"currentColor"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.25 16C8.25 13.9289 6.57107 12.25 4.5 12.25C2.42893 12.25 0.75 13.9289 0.75 16C0.75 18.0711 2.42893 19.75 4.5 19.75C6.57107 19.75 8.25 18.0711 8.25 16ZM4.5 13.75C5.74264 13.75 6.75 14.7574 6.75 16C6.75 17.2426 5.74264 18.25 4.5 18.25C3.25736 18.25 2.25 17.2426 2.25 16C2.25 14.7574 3.25736 13.75 4.5 13.75Z",fill:"currentColor"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.5 12.25C19.5711 12.25 21.25 13.9289 21.25 16C21.25 18.0711 19.5711 19.75 17.5 19.75C15.4289 19.75 13.75 18.0711 13.75 16C13.75 13.9289 15.4289 12.25 17.5 12.25ZM19.75 16C19.75 14.7574 18.7426 13.75 17.5 13.75C16.2574 13.75 15.25 14.7574 15.25 16C15.25 17.2426 16.2574 18.25 17.5 18.25C18.7426 18.25 19.75 17.2426 19.75 16Z",fill:"currentColor"}),(0,i.jsx)("path",{d:"M6.20468 5.56231C6.51523 5.28821 6.54478 4.81426 6.27069 4.5037C5.99659 4.19315 5.52264 4.1636 5.21208 4.43769C3.39676 6.03991 2.25 8.38652 2.25 11C2.25 11.4142 2.58579 11.75 3 11.75C3.41421 11.75 3.75 11.4142 3.75 11C3.75 8.83474 4.69828 6.89187 6.20468 5.56231Z",fill:"currentColor"}),(0,i.jsx)("path",{d:"M16.7879 4.43769C16.4774 4.1636 16.0034 4.19315 15.7293 4.5037C15.4552 4.81426 15.4848 5.28821 15.7953 5.56231C17.3017 6.89187 18.25 8.83474 18.25 11C18.25 11.4142 18.5858 11.75 19 11.75C19.4142 11.75 19.75 11.4142 19.75 11C19.75 8.38652 18.6032 6.03991 16.7879 4.43769Z",fill:"currentColor"}),(0,i.jsx)("path",{d:"M9.18694 18.0217C8.7858 17.9184 8.37692 18.1599 8.27367 18.561C8.17043 18.9622 8.41192 19.3711 8.81306 19.4743C9.51285 19.6544 10.2458 19.75 11 19.75C11.7542 19.75 12.4871 19.6544 13.1869 19.4743C13.5881 19.3711 13.8296 18.9622 13.7263 18.561C13.6231 18.1599 13.2142 17.9184 12.8131 18.0217C12.2344 18.1706 11.627 18.25 11 18.25C10.373 18.25 9.76562 18.1706 9.18694 18.0217Z",fill:"currentColor"})]}),C=e=>{let{publication:t}=e,[r,a]=(0,n.useState)(!1),o="Mirror"===t.__typename,[l,c]=(0,n.useState)(o?t.mirrorOf.stats.totalUpvotes:t.stats.totalUpvotes);(0,s.qr)(e=>e.currentProfile);let[d,u]=(0,n.useState)(!1);return(0,i.jsx)("div",{className:"flex gap-6",children:(0,i.jsxs)("div",{className:" flex cursor-pointer flex-col items-center justify-center rounded-full bg-gray-600/50 p-2 dark:bg-gray-600/50 md:mt-2 md:bg-gray-200 md:text-black",onClick:()=>u(!0),children:[(0,i.jsx)(S,{show:d,setShowShare:u,publication:t}),(0,i.jsxs)("p",{children:[(0,i.jsx)(x,{onClick:()=>u(!0),className:"h-3 w-3 cursor-pointer rounded-full"})," "]})]})})};var T=C},7960:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var i=r(85893);let n=[{inputs:[{internalType:"address",name:"hub",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"BlockNumberInvalid",type:"error"},{inputs:[],name:"InitParamsInvalid",type:"error"},{inputs:[],name:"Initialized",type:"error"},{inputs:[],name:"NotHub",type:"error"},{inputs:[],name:"NotOwnerOrApproved",type:"error"},{inputs:[],name:"SignatureExpired",type:"error"},{inputs:[],name:"SignatureInvalid",type:"error"},{inputs:[],name:"TokenDoesNotExist",type:"error"},{inputs:[],name:"ZeroSpender",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"HUB",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{components:[{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct DataTypes.EIP712Signature",name:"sig",type:"tuple"}],name:"burnWithSig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"delegatee",type:"address"}],name:"delegate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"delegator",type:"address"},{internalType:"address",name:"delegatee",type:"address"},{components:[{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct DataTypes.EIP712Signature",name:"sig",type:"tuple"}],name:"delegateBySig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"exists",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"blockNumber",type:"uint256"}],name:"getDelegatedSupplyByBlockNumber",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getDomainSeparator",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"blockNumber",type:"uint256"}],name:"getPowerByBlockNumber",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"profileId",type:"uint256"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"mint",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"mintTimestampOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{components:[{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct DataTypes.EIP712Signature",name:"sig",type:"tuple"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"},{components:[{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct DataTypes.EIP712Signature",name:"sig",type:"tuple"}],name:"permitForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"sigNonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenDataOf",outputs:[{components:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint96",name:"mintTimestamp",type:"uint96"}],internalType:"struct IERC721Time.TokenData",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"}];var s=r(9187),a=r(4242),o=r(92882),l=r(13250),c=r(66214),d=r(67294),u=r(31618),p=r(64911),h=r(86501),m=r(21273),f=r(52942);let g=e=>{let{setFollowing:t,profile:r}=e,g=(0,o.qr)(e=>e.currentProfile),[v,y]=(0,d.useState)(!1),{isLoading:b,signTypedDataAsync:w}=(0,u.yw)({onError:s.Z}),{data:_}=(0,f.Z)(),S=async(e,t)=>{let{tokenId:r,deadline:i}=t.value,{v:s,r:o,s:l}=(0,a.Z)(e),d=new c.CH(t.domain.verifyingContract,n,_);await d.burnWithSig(r,{v:s,r:o,s:l,deadline:i})},{broadcast:x}=(0,l.Z)({onCompleted:()=>{t(!1)}}),[C,{loading:T}]=(0,m.i0)({onCompleted:async e=>{let{createUnfollowTypedData:t}=e;try{let{typedData:r,id:i}=t,n=await w((0,p.Z)(r));y(!0);try{var s;let{data:a}=await x({request:{id:i,signature:n}});(null==a?void 0:null===(s=a.broadcast)||void 0===s?void 0:s.reason)&&await S(n,r),h.Am.success("Unfollowed succesfully")}catch(o){h.Am.error("User rejected request")}finally{y(!1)}}catch(l){}},onError:s.Z}),k=()=>{if(!g)return h.Am.error("Please connect your wallet");C({variables:{request:{profile:null==r?void 0:r.id}}})};return(0,i.jsx)("div",{children:(0,i.jsx)("button",{onClick:k,className:"lg:text-md xl:text-md font-helvetica mt-2 cursor-pointer rounded-full border-2 border-black bg-blue-500 p-3 px-1 py-1 text-xs font-semibold text-[#000000] drop-shadow-xl transition hover:bg-[#57B8FF] hover:text-white active:bg-violet-600",children:"Unfollow"})})};var v=g},21752:function(e,t,r){"use strict";r.d(t,{Z:function(){return V}});var i=r(85893),n=r(41664),s=r.n(n),a=r(25675),o=r.n(a),l=r(67294),c=r(22257),d=r(7960),u=r(92864),p=r(92882),h=r(87184),m=r(40339),f=r(88942),g=r(29451),v=r(8974),y=r(8685),b=r(11163);r(34625);var w=r(86501),_=r(51190),S=r(49117),x=r(92304);let C=e=>{let{publication:t,feedItem:r,showThread:n=!0,profile:s,showType:a=!0,showActions:o=!0,showModActions:l=!1,showMore:c=!0,isFirst:d=!1,isLast:u=!1}=e,p=(null==r?void 0:r.comments)&&r.comments[0],h=r?p||(null==r?void 0:r.root):t;return(0,i.jsx)("div",{className:"vh-88% ml-[20px] mt-2 rounded-xl border-2 border-blue-600 bg-[#F2F6F9] p-3 ",children:(null==t?void 0:t.hidden)?(0,i.jsx)(S.Z,{type:t.__typename}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(x.Z,{publication:h,showMore:c,profile:s})})})};var T=r(24358),k=r(24604),R=r(86010),E=r(59355);let P=l.forwardRef(function({title:e,titleId:t,...r},i){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:i,"aria-labelledby":t},r),e?l.createElement("title",{id:t},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"}))}),D=e=>{let{publication:t}=e,r="Mirror"===t.__typename,n=r?t.mirrorOf.__typename:t.__typename;return(0,i.jsx)(k.v.Item,{as:"div",className:e=>{let{active:t}=e;return(0,R.Z)({"dropdown-active":t},"m-2 block cursor-pointer rounded-lg px-4 py-1.5 text-sm")},onClick:async e=>{var r;(0,E.Z)(e),await navigator.clipboard.writeText((null==t?void 0:null===(r=t.metadata)||void 0===r?void 0:r.content)||""),w.ZP.success("Copied to clipboard!")},children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(P,{className:"h-4 w-4"}),(0,i.jsx)("div",{children:"Comment"===n?"Copy comment text":"Copy post text"})]})})};var L=r(97125),I=r(76249);let M=e=>{let{publication:t}=e,r=(0,L.h)(e=>e.setShowPublicationDeleteAlert);return(0,i.jsx)(k.v.Item,{as:"div",className:e=>{let{active:t}=e;return(0,R.Z)({"dropdown-active":t},"m-2 block cursor-pointer rounded-lg px-4 py-1.5 text-sm text-red-500")},onClick:e=>{(0,E.Z)(e),r(!0,t)},children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(I.Z,{className:"h-4 w-4"}),(0,i.jsx)("div",{children:"Delete"})]})})},j=l.forwardRef(function({title:e,titleId:t,...r},i){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:i,"aria-labelledby":t},r),e?l.createElement("title",{id:t},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.249-8.25-3.286zm0 13.036h.008v.008H12v-.008z"}))});var O=r(96806);let A=e=>{let{publication:t}=e,r=(0,O.u)(e=>e.setShowReportModal);return(0,i.jsx)(k.v.Item,{as:"div",className:e=>{let{active:t}=e;return(0,R.Z)({"dropdown-active":t},"m-2 block cursor-pointer rounded-lg px-4 py-1.5 text-sm text-red-500")},onClick:e=>{(0,E.Z)(e),r(!0,t)},children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(j,{className:"h-4 w-4"}),(0,i.jsx)("div",{children:"Report Post"})]})})},N=e=>{let{publication:t}=e;return(0,i.jsx)(k.v.Item,{as:"div",className:e=>{let{active:t}=e;return(0,R.Z)({"dropdown-active":t},"m-2 block cursor-pointer rounded-lg px-4 py-1.5 text-sm")},onClick:async e=>{(0,E.Z)(e),await navigator.clipboard.writeText("".concat(location.origin,"/post/").concat(null==t?void 0:t.id)),w.ZP.success("Copied to clipboard!")},children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(P,{className:"h-4 w-4"}),(0,i.jsx)("div",{children:"Share"})]})})};var F=r(63750);let q=e=>{var t,r;let{publication:n}=e;return(0,i.jsx)(k.v.Item,{as:s(),className:e=>{let{active:t}=e;return(0,R.Z)({"dropdown-active":t},"m-2 block cursor-pointer rounded-lg px-4 py-1.5 text-sm")},href:(r=null==n?void 0:null===(t=n.metadata)||void 0===t?void 0:t.content,encodeURI("https://translate.google.com/#auto|en|".concat(encodeURIComponent(r)))),onClick:e=>{(0,E.Z)(e)},target:"_blank",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(F.S7c,{className:"h-4 w-4"}),(0,i.jsx)("div",{children:"Translate"})]})})};var B=r(47516),U=r(91158);let H=e=>{var t;let{publication:r}=e,n=(0,p.qr)(e=>e.currentProfile);return(0,i.jsxs)(k.v,{as:"div",className:"relative",children:[(0,i.jsx)(k.v.Button,{as:l.Fragment,children:(0,i.jsx)("button",{className:"rounded-full p-1.5 hover:bg-gray-300/20",onClick:E.Z,"aria-label":"More","data-testid":"publication-".concat(r.id,"-menu"),children:(0,i.jsx)(B.JJP,{className:(0,R.Z)("lt-text-gray-500","w-[15px] sm:w-[18px]")})})}),(0,i.jsx)(U.Z,{children:(0,i.jsxs)(k.v.Items,{static:!0,className:"absolute right-0 cursor-pointer z-[5] mt-1 w-max rounded-xl border bg-white shadow-sm focus:outline-none dark:border-gray-700 dark:bg-gray-300","data-testid":"publication-".concat(r.id,"-menu-items"),children:[(null==n?void 0:n.id)===(null==r?void 0:null===(t=r.profile)||void 0===t?void 0:t.id)?(0,i.jsx)(M,{publication:r}):(0,i.jsx)(A,{publication:r}),(0,i.jsx)(N,{publication:r}),(0,i.jsx)(q,{publication:r}),(0,i.jsx)(D,{publication:r})]})})]})},z=e=>{var t,r,n,a,w,S,x,k,R,E,P;let{publication:D,onDetail:L}=e;(0,b.useRouter)();let[I,M]=(0,l.useState)(!1);(0,l.useRef)(null);let j=(0,p.qr)(e=>e.currentProfile);(0,p.qr)(e=>e.currentviewingId),(0,p.qr)(e=>e.setCurrentviewingId);let[O,A]=(0,l.useState)(),[N,F]=(0,l.useState)(!1),[q,B]=(0,l.useState)(!1),U=D.createdAt,z=U.split("T")[0],V=(null==D?void 0:D.__typename)==="Mirror",$=V?null==D?void 0:null===(t=D.mirrorOf)||void 0===t?void 0:t.profile:null==D?void 0:D.profile,Z=V?null==D?void 0:null===(r=D.mirrorOf)||void 0===r?void 0:null===(n=r.stats)||void 0===n?void 0:n.totalUpvotes:null==D?void 0:null===(a=D.stats)||void 0===a?void 0:a.totalUpvotes,W=V?D.mirrorOf.stats.totalAmountOfComments:D.stats.totalAmountOfComments,K=V?null==D?void 0:null===(w=D.mirrorOf)||void 0===w?void 0:null===(S=w.stats)||void 0===S?void 0:S.totalAmountOfComments:null==D?void 0:null===(x=D.stats)||void 0===x?void 0:x.totalAmountOfComments,G=V?null==D?void 0:null===(k=D.mirrorOf)||void 0===k?void 0:null===(R=k.stats)||void 0===R?void 0:R.totalAmountOfCollects:null==D?void 0:null===(E=D.stats)||void 0===E?void 0:E.totalAmountOfCollects,[Q,Y]=(0,l.useState)(!1),[J,X]=(0,l.useState)(!1),[ee,et]=(0,l.useState)(!1),[er,ei]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{var e;(null===(e=D.metadata)||void 0===e?void 0:e.content.trim().length)>500&&(Y(!0),X(!0))},[null===(P=D.metadata)||void 0===P?void 0:P.content]),(0,p.qr)(e=>e.isMute),(0,l.useEffect)(()=>{(null==$?void 0:$.isFollowedByMe)===!0?M(!0):M(!1),j||M(!1)},[null==$?void 0:$.isFollowedByMe]),(0,i.jsxs)("div",{className:"justify-content break-word m-3 flex flex-col rounded-xl border-2 border-gray-200 bg-[#F2F6F9] pb-0 md:pb-6",children:[(0,i.jsxs)("div",{className:"break-word flex flex-row ",children:[(0,i.jsxs)("div",{className:"break-word mt-4 flex-auto cursor-pointer gap-3 rounded p-2 font-semibold",children:[(0,i.jsx)(s(),{href:"/u/".concat($.id)},$.id),(0,i.jsx)(o(),{itemRef:"/u/".concat($.id),src:(0,c.Z)($),width:62,height:62,alt:$.handle,className:"rounded-full border-2 border-blue-500"}),(0,i.jsxs)("div",{className:"break-word ",children:[(0,i.jsx)(s(),{href:"/u/".concat($.id),children:(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsxs)("p",{className:"text-md flex items-center gap-1 pl-1 pt-3 font-bold capitalize text-primary",children:[$.name," "]})})},$.id),(0,i.jsx)(v.Z,{className:"text-grey-500 pl-1 text-xs ",slug:(0,g.Z)(null==$?void 0:$.handle),prefix:"@"}),(0,i.jsxs)("p",{className:"pl-full block p-1 pl-1 pr-4 pt-2 text-xs font-semibold text-blue-500",children:[" ",z,"~",(0,i.jsx)("span",{className:"pl-2 text-xs text-blue-700 opacity-50",children:(0,_.ni)(D.createdAt)})]})]})]}),(0,i.jsxs)("div",{className:"mr-6 mt-6",children:[(0,i.jsx)("div",{children:(0,i.jsx)("button",{children:(0,i.jsx)(H,{publication:D})})}),I?(0,i.jsx)(d.Z,{setFollowing:M,profile:$}):(0,i.jsx)(u.Z,{setFollowing:M,profile:$})]})]}),(0,i.jsx)("div",{className:"cursor-pointer rounded-xl p-2",children:V?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{className:"text-sm font-semibold text-black",children:["'Mirror from @",null==$?void 0:$.handle,"'"]}),(0,i.jsx)(C,{profile:$,publication:D})]}):(0,i.jsx)(C,{profile:$,publication:D})}),(0,i.jsxs)("div",{className:"ml-4 flex flex-row space-x-3 py-3",children:[(0,i.jsxs)("p",{className:"text-black-400 block pl-1 text-xs font-semibold",children:[" ",Z," Likes"]}),(0,i.jsxs)("p",{className:"text-black-400 block text-xs font-semibold",children:[" ",W," Comments"]}),(0,i.jsxs)("p",{className:"text-black-400 block text-xs font-semibold",children:[" ",K," Mirrors"]}),(0,i.jsxs)("p",{className:"text-black-400 block text-xs font-semibold",children:[" ",G," Collects"]})]}),(0,i.jsxs)("div",{className:"ml-auto flex",children:[(0,i.jsx)("button",{className:"block pb-2 pr-2 ",children:(0,i.jsx)(h.Z,{publication:D})}),(0,i.jsx)("button",{className:"mt-0.5 block pb-2 pr-2",children:(0,i.jsx)(T.Z,{publication:D,showCount:!0})}),(0,i.jsx)("button",{className:"block pb-2 pr-2",children:(0,i.jsx)(m.Z,{publication:D})}),(0,i.jsx)("button",{className:"block pb-2 pr-2 lg:mb-3.5 xl:mb-3.5",children:(0,i.jsx)(f.Z,{publication:D})}),(0,i.jsx)("button",{className:"block pb-2 pr-2 md:mt-2 lg:mb-3 xl:mb-3",onClick:()=>B(!0),children:(0,i.jsx)(y.Z,{publication:D})})]})]})};var V=z},36595:function(e,t,r){"use strict";r.d(t,{Z:function(){return C}});var i=r(85893),n=r(41664),s=r.n(n),a=r(92882),o=r(67294),l=r(73359),c=r(50319),d=r(76781),u=r(34625),p=r(31618),h=r(86501);let m=()=>{let e=(0,a.qr)(e=>e.setProfiles),t=(0,a.qr)(e=>e.setCurrentProfile),r=(0,a.Fc)(e=>e.setProfileId),[n,s]=(0,o.useState)(!1),{chain:m}=(0,p.LN)(),{switchNetwork:f}=(0,p.g0)(),[g,v]=(0,o.useState)(!1),{address:y,connector:b}=(0,p.mA)(),{connectors:w,error:_,connectAsync:S}=(0,p.$4)(),{signMessageAsync:x,isLoading:C}=(0,p.QW)(),[T,{error:k,loading:R}]=(0,l.t)(d.bT,{fetchPolicy:"no-cache"}),[E,{error:P,loading:D}]=(0,c.D)(d.bs),[L,{error:I,loading:M}]=(0,l.t)(d.$);(0,o.useEffect)(()=>{s(!0)},[]);let j=async()=>{try{var i,n,s,a,o,l,c,d,u;let p=await T({variables:{request:{address:y}}});if(!(null==p?void 0:null===(i=p.data)||void 0===i?void 0:null===(n=i.challenge)||void 0===n?void 0:n.text))return h.ZP.error("ERROR_MESSAGE");let m=await x({message:null==p?void 0:null===(s=p.data)||void 0===s?void 0:null===(a=s.challenge)||void 0===a?void 0:a.text}),f=await E({variables:{request:{address:y,signature:m}}});localStorage.setItem("accessToken",null===(o=f.data)||void 0===o?void 0:o.authenticate.accessToken),localStorage.setItem("refreshToken",null===(l=f.data)||void 0===l?void 0:l.authenticate.refreshToken);let{data:g}=await L({variables:{request:{ownedBy:[y]}}});if((null==g?void 0:null===(c=g.profiles)||void 0===c?void 0:null===(d=c.items)||void 0===d?void 0:d.length)===0)return h.ZP.error("You have no lens profile yet, please create one");{let v=null==g?void 0:null===(u=g.profiles)||void 0===u?void 0:u.items,b=v[0];e(v),t(b),r(b.id)}}catch(w){}};return(null==b?void 0:b.id)?(0,i.jsx)("div",{children:(null==m?void 0:m.id)===u.Kj?(0,i.jsx)("button",{className:"flex-1 text-blue-700",onClick:()=>j(),children:n?"Log In":""}):(0,i.jsx)("button",{className:"flex-1 text-blue-700",onClick:()=>{f?f(u.Kj):h.ZP.error("Please change your network!")},children:"Switch Network"})}):(0,i.jsx)("button",{onClick:()=>{h.ZP.error("Log in to view profile",{duration:1e3})},className:"border-gray-800 text-blue-700 hover:text-gray-600 focus:text-black focus:outline-none",children:(0,i.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})};var f=r(93832),g=r(28166),v=r(5434),y=r(14382),b=r(61998),w=r(1257),_=r(10116);let S=()=>{let e=(0,a.qr)(e=>e.currentProfile),t=(0,_.N)(e=>e.clearMessagesBadge),r=(0,_.N)(e=>e.viewedMessagesAtNs),n=(0,_.N)(e=>e.showMessagesBadge),l=(0,_.N)(e=>e.setShowMessagesBadge),{client:c}=(0,y.Z)(!0),d=(e,t)=>{if(!t)return!1;let r=(0,w.nB)(e);return!r||r.getTime()<t.getTime()&&t.getTime()<new Date().getTime()};return(0,o.useEffect)(()=>{let t;if(!c||!e)return;let i=async()=>{let t=await c.conversations.list();if(t.length<=0)return;let i=t.map(e=>e.topic),s=await c.apiClient.batchQuery(i.map(e=>({contentTopic:e,pageSize:1,direction:w.Sr.SORT_DIRECTION_DESCENDING}))),a=s.reduce((e,t)=>{var r,i;return t.length&&(null===(r=t[0])||void 0===r?void 0:r.timestampNs)&&(!e||(null===(i=t[0])||void 0===i?void 0:i.timestampNs)>e)?t[0].timestampNs:e},null),o=(0,w.nB)(null!=a?a:void 0),u=d(r.get(e.id),o);n.set(e.id,u),l(new Map(n))},s=async()=>{t&&await t.return(void 0)},a=t=>!window.location.pathname.startsWith("/messages")&&e.id===t,o=async i=>{for await(let s of t=await c.conversations.streamAllMessages())if(i(e.id)){let a=e.ownedBy!==s.senderAddress;if(a){let o=d(r.get(e.id),s.sent);n.set(e.id,o),l(new Map(n))}}};return i(),o(a),()=>{s()}},[c,null==e?void 0:e.id]),(0,i.jsxs)(s(),{href:"/messages",className:" min-w-[40px] items-start justify-center rounded-md md:flex",onClick:()=>{e&&t(e.id)},children:[(0,i.jsx)(b.Z,{className:"h-6 w-6 pb-1 text-blue-500 "}),n.get(null==e?void 0:e.id)?(0,i.jsx)("span",{className:"z-[6] h-2 w-2 rounded-full bg-red-500 text-red-500"}):null]})},x=()=>{let e=(0,a.qr)(e=>e.currentProfile),[t,r]=(0,o.useState)(!0);return(0,i.jsx)("div",{children:(0,i.jsxs)("nav",{className:"z-999 fixed bottom-0 left-0 right-0 z-[5] m-auto flex h-[70px] items-center justify-around overflow-hidden rounded-lg border-2 border-b-0 border-l border-r border-t border-blue-700 bg-white bg-gradient-to-b from-blue-100 to-transparent px-4 py-3 lg:w-[1100px] xl:w-[1200px]",children:[t?(0,i.jsx)(s(),{href:"/",children:(0,i.jsx)("button",{onClick:()=>{r(!1)},className:"border-gray-800 text-blue-500 hover:text-gray-100 focus:text-gray-100 focus:outline-none",children:(0,i.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})})}):(0,i.jsx)(s(),{href:"/",children:(0,i.jsx)("button",{onClick:()=>{r(!0)},className:"border-gray-800 text-blue-500 hover:text-gray-100 focus:text-gray-100 focus:outline-none",children:(0,i.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})})}),(0,i.jsx)("div",{children:(0,i.jsxs)(s(),{href:"/feed",children:[(0,i.jsx)(v.dnC,{className:"h-6 w-6 pb-1 text-blue-500"})," "]})}),(0,i.jsx)("div",{children:(0,i.jsxs)(s(),{href:"/latest",children:[(0,i.jsx)(f.Z,{className:"h-6 w-6 pb-1 text-blue-500"})," "]})}),(0,i.jsx)("div",{children:(0,i.jsxs)(s(),{href:"/listen",children:[(0,i.jsx)(g.Z,{className:"h-6 w-6 pb-1 text-blue-500"})," "]})}),(0,i.jsx)("div",{children:(0,i.jsx)(S,{})}),e?(0,i.jsx)(s(),{href:"/u/".concat(e.id),children:(0,i.jsx)("button",{className:"border-gray-800 text-blue-500 hover:text-gray-100 focus:text-gray-100 focus:outline-none",children:(0,i.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})},e.id):(0,i.jsx)(m,{})]})})};var C=x},58806:function(e,t,r){"use strict";var i=r(85893),n=r(21273),s=r(25675),a=r.n(s);r(67294);var o=r(9747),l=r(22257),c=r(47445),d=r(58533),u=r(29451),p=r(41664),h=r.n(p);let m=e=>{var t,r,s;let{publicationId:p}=e,m={publicationId:p,limit:10},{data:f,loading:g,error:v,fetchMore:y}=(0,n.BI)({variables:{request:m},skip:!p}),b=null==f?void 0:null===(t=f.whoCollectedPublication)||void 0===t?void 0:t.items,w=null==f?void 0:null===(r=f.whoCollectedPublication)||void 0===r?void 0:r.pageInfo,_=(null==w?void 0:w.next)&&(null==b?void 0:b.length)!==w.totalCount,S=async()=>{await y({variables:{request:{...m,cursor:null==w?void 0:w.next}}})};return g?(0,i.jsx)(o.Z,{message:"Loading collectors"}):(null==b?void 0:b.length)===0?(0,i.jsx)("div",{className:"p-5",children:"No Collectors"}):(0,i.jsx)("div",{className:"display:absolute max-h-[80vh] overflow-auto overflow-y-auto",id:"scrollableDiv",children:(0,i.jsx)(d.Z,{dataLength:null!==(s=null==b?void 0:b.length)&&void 0!==s?s:0,scrollThreshold:.5,hasMore:_,next:S,loader:(0,i.jsx)(c.Z,{}),scrollableTarget:"scrollableDiv",children:(0,i.jsx)("div",{className:"divide-y",children:null==b?void 0:b.map(e=>{var t,r,n,s,o;return(0,i.jsx)(h(),{href:"/u/".concat(null==e?void 0:null===(t=e.defaultProfile)||void 0===t?void 0:t.id),children:(0,i.jsx)("div",{className:"p-5",children:(null==e?void 0:e.defaultProfile)?(0,i.jsxs)("div",{className:"flex cursor-pointer items-center gap-3 rounded p-2 font-semibold",children:[(0,i.jsx)("div",{children:(0,i.jsx)(a(),{width:40,height:40,className:"cursor-pointer rounded-full",src:(0,l.Z)(null==e?void 0:e.defaultProfile),alt:null==e?void 0:null===(r=e.defaultProfile)||void 0===r?void 0:r.handle})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-md flex items-center gap-1 font-bold lowercase text-primary",children:null==e?void 0:null===(n=e.defaultProfile)||void 0===n?void 0:n.name}),(0,i.jsxs)("p",{className:"text-xs capitalize text-gray-400",children:[(0,u.Z)(null==e?void 0:null===(s=e.defaultProfile)||void 0===s?void 0:s.handle)," ",""]})]})]}):null},null==e?void 0:e.address)},null==e?void 0:null===(o=e.defaultProfile)||void 0===o?void 0:o.id)})})})})};t.Z=m},24358:function(e,t,r){"use strict";r.d(t,{Z:function(){return L}});var i=r(85893),n=r(86010),s=r(67294),a=r(37331),o=r(44318),l=r(34625),c=r(41741),d=r(64911),u=r(69125),p=r(68980),h=r(66252),m=r(24604),f=r(86501),g=r(92882),v=r(70769),y=r(31618);let b=e=>{var t,r,b,w,_;let{publication:S,setIsLoading:x,isLoading:C}=e,T="Mirror"===S.__typename,k=(0,v.p)(e=>e.userSigNonce),R=(0,v.p)(e=>e.setUserSigNonce),E=(0,g.qr)(e=>e.currentProfile),[P,D]=(0,s.useState)(T?(null==S?void 0:null===(t=S.mirrorOf)||void 0===t?void 0:null===(r=t.mirrors)||void 0===r?void 0:r.length)>0:(null==S?void 0:null===(b=S.mirrors)||void 0===b?void 0:b.length)>0),{cache:L}=(0,h.x)(),I=null==E?void 0:null===(w=E.dispatcher)||void 0===w?void 0:w.canUseRelay,M=null==E?void 0:null===(_=E.dispatcher)||void 0===_?void 0:_.sponsor,j=()=>{L.modify({id:(0,u.D)(T?null==S?void 0:S.mirrorOf:S),fields:{mirrors:e=>[...e,null==E?void 0:E.id],stats:e=>({...e,totalAmountOfMirrors:e.totalAmountOfMirrors+1})}})},O=e=>{"RelayError"!==e&&(j(),x(!1),D(!0),f.Am.success("Post has been mirrored!"))},A=e=>{x(!1)},{signTypedDataAsync:N}=(0,y.yw)({onError:A}),{write:F}=(0,y.GG)({address:l.Nm,abi:a.g,functionName:"mirror",onSuccess:()=>{O(),R(k+1)},onError:e=>{A(e),R(k-1)}}),[q]=(0,p.lAu)({onCompleted:e=>{let{broadcast:t}=e;return O(t.__typename)}}),[B]=(0,p.CyN)({onCompleted:async e=>{let{createMirrorTypedData:t}=e,{id:r,typedData:i}=t,n=await N((0,d.Z)(i)),{data:s}=await q({variables:{request:{id:r,signature:n}}});if((null==s?void 0:s.broadcast.__typename)==="RelayError")return null==F?void 0:F({args:[i.value]})},onError:A}),[U]=(0,p.VmU)({onCompleted:e=>{let{createDataAvailabilityMirrorViaDispatcher:t}=e;return O(t.__typename)},onError:A}),[H]=(0,p.NFt)({onCompleted:e=>{let{createMirrorViaDispatcher:t}=e;return O(t.__typename)},onError:A}),z=async e=>{await U({variables:{request:e}})},V=async e=>{let{data:t}=await H({variables:{request:e}});if((null==t?void 0:t.createMirrorViaDispatcher.__typename)==="RelayError")return await B({variables:{options:{overrideSigNonce:k},request:e}})},$=async()=>{if(!E)return f.Am.error(c.D.SignWallet);if(S.isDataAvailability&&!M)return f.Am.error("Momoka is currently in beta - during this time certain actions are not available to all profiles.");try{x(!0);let e={profileId:null==E?void 0:E.id,publicationId:null==S?void 0:S.id,referenceModule:{followerOnlyReferenceModule:!1}},t={from:null==E?void 0:E.id,mirror:null==S?void 0:S.id};if(I){if(S.isDataAvailability&&M)return await z(t);return await V(e)}return await B({variables:{options:{overrideSigNonce:k},request:e}})}catch(r){A(r)}};return(0,i.jsx)(m.v.Item,{as:"div",className:e=>{let{active:t}=e;return(0,n.Z)({"dropdown-active":t},P?"text-green-500":"","m-2 block cursor-pointer rounded-lg px-4 py-1.5 text-sm")},onClick:$,disabled:C,children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(o.Z,{className:"h-4 w-4"}),(0,i.jsx)("div",{children:P?"Unmirror":"Mirror"})]})})};var w=r(53854),_=r(96806),S=r(48113);let x=e=>{let{publication:t}=e,r="Mirror"===t.__typename,s=r?t.mirrorOf.__typename:t.__typename,a=(0,_.u)(e=>e.setShowNewPostModal),o=(0,S.l)(e=>e.setQuotedPublication);return(0,i.jsx)(m.v.Item,{as:"div",className:e=>{let{active:t}=e;return(0,n.Z)({"dropdown-active":t},"m-2 block cursor-pointer rounded-lg px-4 py-1.5 text-sm")},onClick:()=>{o(t),a(!0)},children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(w.rz5,{className:"h-4 w-4"}),(0,i.jsx)("div",{children:"Comment"===s?"Quote comment":"Quote post"})]})})};var C=r(59355),T=r(33962),k=r(93300),R=r(622),E=r(91158),P=r(4108);let D=e=>{var t,r,a,l,c,d;let{publication:u,showCount:p}=e,[h,f]=(0,s.useState)(!1),g="Mirror"===u.__typename,v=g?null==u?void 0:null===(t=u.mirrorOf)||void 0===t?void 0:null===(r=t.stats)||void 0===r?void 0:r.totalAmountOfMirrors:null==u?void 0:null===(a=u.stats)||void 0===a?void 0:a.totalAmountOfMirrors,y=g?(null==u?void 0:null===(l=u.mirrorOf)||void 0===l?void 0:null===(c=l.mirrors)||void 0===c?void 0:c.length)>0:(null==u?void 0:null===(d=u.mirrors)||void 0===d?void 0:d.length)>0;return(0,i.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,i.jsxs)(m.v,{as:"div",className:"relative",children:[(0,i.jsx)(m.v.Button,{as:s.Fragment,children:(0,i.jsx)("button",{className:(0,n.Z)(y?"text-green-500":"text-brand","rounded-full  hover:bg-gray-300/20"),onClick:C.Z,"aria-label":"Mirror",children:h?(0,i.jsx)(T.$,{variant:y?"success":"primary",size:"xs",className:"mr-0.5"}):(0,i.jsx)(k.u,{placement:"top",content:v>0?"".concat((0,R.Z)(v)," Mirrors"):"Mirror",withDelay:!0,children:(0,i.jsx)(o.Z,{className:"w-[15px] sm:w-[18px] m-1 "})})})}),(0,i.jsx)(E.Z,{children:(0,i.jsxs)(m.v.Items,{className:"absolute z-[5] mt-1 w-max rounded-xl border bg-white shadow-sm focus:outline-none dark:border-gray-700",static:!0,children:[(0,i.jsx)(b,{publication:u,setIsLoading:f,isLoading:h}),(0,i.jsx)(x,{publication:u})]})})]}),v>0&&!p&&(0,i.jsx)("span",{className:(0,n.Z)(y?"text-green-500":"text-brand","text-[11px] sm:text-xs"),children:(0,P.Z)(v)})]})};var L=D},47422:function(e,t,r){"use strict";var i=r(85893),n=r(21273),s=r(68980);r(67294);var a=r(33962),o=r(25675),l=r.n(o),c=r(22257),d=r(41664),u=r.n(d),p=r(29451),h=r(9507),m=r(5276);let f=e=>{var t,r;let{query:o}=e,d={query:o,type:s.qkC.Profile,limit:5},{data:f,loading:g,error:v,fetchMore:y}=(0,n.Fh)({variables:{request:d},skip:!o}),b=null==f?void 0:null===(t=f.search)||void 0===t?void 0:t.items,w=null==f?void 0:null===(r=f.search)||void 0===r?void 0:r.pageInfo;if((null==w?void 0:w.next)&&(null==b||b.length,w.totalCount),console.log(b),(null==b?void 0:b.length)===0)return(0,i.jsxs)("div",{children:["No profiles for ",(0,i.jsxs)("b",{children:["",o,""]})]});if(v)return(0,i.jsx)("div",{children:"Failed to load profiles"});g&&(i.Fragment,a.$);let{observe:_}=(0,m.Y)({onEnter:async()=>{await y({variables:{request:{cursor:null==w?void 0:w.next,...d}}})}});return(0,i.jsxs)("div",{className:"space-y-3 rounded-xl",children:[null==b?void 0:b.map(e=>(0,i.jsx)("div",{className:"p-5",children:(0,i.jsx)(u(),{href:"/u/".concat(null==e?void 0:e.id),children:(0,i.jsxs)("div",{className:"flex cursor-pointer items-center gap-3 rounded-xl p-2 font-semibold",children:[(0,i.jsx)(l(),{width:62,height:62,className:"cursor-pointer rounded-full",src:(0,c.Z)(e),alt:(0,p.Z)(null==e?void 0:e.handle)}),(0,i.jsx)("div",{className:" lg:block",children:(0,i.jsxs)("p",{className:"text-md flex items-center gap-1 font-bold lowercase text-primary",children:[null==e?void 0:e.name,(0,i.jsxs)("p",{className:"capitalize text-gray-400",children:[(0,p.Z)(null==e?void 0:e.handle),""]})]})})]})})},null==e?void 0:e.id)),(null==w?void 0:w.next)&&(0,i.jsx)("span",{ref:_,className:"flex justify-center border-0 p-10",children:(0,i.jsx)(h.Z,{})})]})};t.Z=f},11021:function(e,t,r){"use strict";var i=r(85893),n=r(92882),s=r(21273),a=r(68980),o=r(67294),l=r(21752),c=r(9507),d=r(5276);let u=e=>{let{query:t}=e;(0,n.qr)(e=>e.currentProfile);let[r,u]=(0,o.useState)(),[p,h]=(0,o.useState)(!1),m={query:t,type:a.qkC.Publication,limit:10},{data:f,loading:g,error:v,fetchMore:y}=(0,s.Ey)({variables:{request:m}}),b=null==f?void 0:f.search,w=null==b?void 0:b.items,_=null==b?void 0:b.pageInfo;(null==_?void 0:_.next)&&(null==w||w.length,_.totalCount);let S=e=>{let t="/".concat(e.id);u(e),history.pushState({path:t},"",t),h(!p)},{observe:x}=(0,d.Y)({onEnter:async()=>{await y({variables:{request:{cursor:null==_?void 0:_.next,...m}}})}});return(0,i.jsxs)("div",{children:[null==w?void 0:w.map(e=>(0,i.jsx)(l.Z,{publication:e,onDetail:S},null==e?void 0:e.id)),(null==_?void 0:_.next)&&(0,i.jsx)("span",{ref:x,className:"flex justify-center border-0 p-10",children:(0,i.jsx)(c.Z,{})})]})};t.Z=u},29350:function(e,t,r){"use strict";var i=r(85893),n=r(44080),s=r(92485),a=r(86010),o=r(67294);let l=e=>{let{show:t,onClose:r,children:l,title:c,panelClassName:d,autoClose:u=!0}=e;return(0,i.jsx)(n.u,{appear:!0,show:t,as:o.Fragment,children:(0,i.jsx)(s.V,{as:"div",className:"relative z-20",onClose:()=>r&&!u?null==r?void 0:r():null,children:(0,i.jsx)("div",{className:"fixed inset-0 ",children:(0,i.jsx)("div",{className:"flex h-full min-h-full items-center justify-center text-center",children:(0,i.jsx)(n.u.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,i.jsx)(s.V.Panel,{className:(0,a.Z)("bg-secondary h-full w-full transform text-left align-middle shadow-xl transition-all",d),children:l})})})})})})};t.Z=l},44318:function(e,t,r){"use strict";var i=r(85893);r(67294);let n=e=>(0,i.jsx)("svg",{...e,viewBox:"0 0 22 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.93077 9.2003C2.00244 4.23968 6.07619 0.25 11.0789 0.25C14.3873 0.25 17.287 1.99427 18.8934 4.60721C19.1103 4.96007 19.0001 5.42199 18.6473 5.63892C18.2944 5.85585 17.8325 5.74565 17.6156 5.39279C16.2727 3.20845 13.8484 1.75 11.0789 1.75C6.8945 1.75 3.50372 5.0777 3.431 9.19817L3.83138 8.80092C4.12542 8.50918 4.60029 8.51105 4.89203 8.80509C5.18377 9.09913 5.18191 9.574 4.88787 9.86574L3.20805 11.5324C2.91565 11.8225 2.44398 11.8225 2.15157 11.5324L0.471757 9.86574C0.177716 9.574 0.17585 9.09913 0.467591 8.80509C0.759331 8.51105 1.2342 8.50918 1.52824 8.80092L1.93077 9.2003ZM18.7864 8.46658C19.0786 8.17781 19.5487 8.17781 19.8409 8.46658L21.5271 10.1333C21.8217 10.4244 21.8245 10.8993 21.5333 11.1939C21.2421 11.4885 20.7673 11.4913 20.4727 11.2001L20.0628 10.7949C19.9934 15.7604 15.9017 19.75 10.8825 19.75C7.56379 19.75 4.65381 18.007 3.0412 15.3939C2.82366 15.0414 2.93307 14.5793 3.28557 14.3618C3.63806 14.1442 4.10016 14.2536 4.31769 14.6061C5.6656 16.7903 8.09999 18.25 10.8825 18.25C15.0887 18.25 18.4922 14.9171 18.5625 10.7969L18.1546 11.2001C17.86 11.4913 17.3852 11.4885 17.094 11.1939C16.8028 10.8993 16.8056 10.4244 17.1002 10.1333L18.7864 8.46658Z",fill:"currentColor"})});t.Z=n},40819:function(e,t,r){"use strict";var i=r(85893),n=r(21273),s=r(67294),a=r(86010),o=r(33962),l=r(75012),c=r(34625),d=r(41664),u=r.n(d);let p=e=>{let{type:t="Transaction",txHash:r,reload:d=!1}=e,[p,h]=(0,s.useState)(!1),[m,f]=(0,s.useState)(500),{data:g,loading:v}=(0,n.BS)({variables:{request:{txHash:r}},pollInterval:m,onCompleted:e=>{var t;"TransactionIndexedResult"===e.hasTxHashBeenIndexed.__typename&&(null==e?void 0:null===(t=e.hasTxHashBeenIndexed)||void 0===t?void 0:t.indexed)&&(f(0),d&&location.reload(),setTimeout(()=>{h(!0)},5e3))}});return(0,i.jsx)(u(),{className:(0,a.Z)({hidden:p},"ml-auto text-sm font-medium"),href:"".concat(c.Bq,"/tx/").concat(r),target:"_blank",rel:"noreferrer noopener",children:!v&&((null==g?void 0:g.hasTxHashBeenIndexed.__typename)!=="TransactionIndexedResult"||(null==g?void 0:g.hasTxHashBeenIndexed.indexed))?(0,i.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,i.jsx)(l.Z,{className:"h-5 w-5 text-green-500"}),(0,i.jsx)("div",{className:"text-black dark:text-white",children:"Index Successful"})]}):(0,i.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,i.jsx)(o.$,{size:"xs"}),(0,i.jsxs)("div",{children:[t," Indexing"]})]})})};t.Z=p},47445:function(e,t,r){"use strict";var i=r(85893),n=r(33962);let s=()=>(0,i.jsx)("span",{className:"flex justify-center p-5",children:(0,i.jsx)(n.$,{size:"sm"})});t.Z=s},91158:function(e,t,r){"use strict";var i=r(85893),n=r(44080),s=r(67294);let a=e=>{let{children:t,show:r}=e;return(0,i.jsx)(n.u,{as:s.Fragment,show:r,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:t})};t.Z=a},10588:function(e,t,r){"use strict";var i=r(34625);let n=e=>{switch(e){case"WMATIC":default:return i.hb;case"WETH":return"0x7ceb23fd6bc0add59e62ac25578270cff1b9f619";case"USDC":return"0x2791bca1f2de4661ed88a30c99a7a9449aa84174";case"DAI":return"0x8f3Cf7ad23Cd3CaDbD9735AFf958023239c6A063";case"NCT":return"0xD838290e877E0188a4A44700463419ED96c16107"}};t.Z=n},2176:function(e,t,r){"use strict";var i=r(6154);let n=async e=>{try{let t=await (0,i.Z)("https://api.coingecko.com/api/v3/simple/token_price/polygon-pos",{method:"GET",params:{contract_addresses:e,vs_currencies:"usd"}});return t.data[e].usd}catch(r){return 0}};t.Z=n},17295:function(e,t,r){"use strict";r.d(t,{rT:function(){return s}});var i=r(34625),n=r(68980);let s=e=>{switch(e){case n.pYo.UnknownCollectModule:return{name:"Unknown Collect",field:"collectModule",helper:"The Unknown Collect Module is unknown and not type supported in the API."};case n.pYo.FeeCollectModule:return{name:"Fee Collect",field:"collectModule",helper:"The Fee Collect Module allows for any follower to collect the associated publication provided they pay a fee set by the poster."};case n.pYo.LimitedFeeCollectModule:return{name:"Limited Fee Collect",field:"collectModule",helper:"The Limited Fee Collect Module allows for any follower to collect the associated publication, provided they pay a fee, up to a specific limit of mints."};case n.pYo.TimedFeeCollectModule:return{name:"Timed Fee Collect",field:"collectModule",helper:"The Timed Fee Collect Module allows for any follower to collect the associated publication, provided they pay a fee, up to a specific time limit. The present whitelisted Timed Fee Collect module only has a 24-hour time limit to reduce gas usage and optimize efficiency."};case n.pYo.LimitedTimedFeeCollectModule:return{name:"Limited Time Fee Collect",field:"collectModule",helper:"The Limited Timed Fee Collect Module allows for any follower to collect the associate publication, provided they pay a fee, up to a specific time limit and mint cap. It is essentially a combination of the Timed Fee Collect Module and the Limited Fee Collect Module."};case n.pYo.FreeCollectModule:return{name:"Free Collect",field:"collectModule",helper:"The Free Collect Module allows any profile to collect the publication this module is attached to."};case n.pYo.RevertCollectModule:return{name:"Revert Collect",field:"collectModule",helper:"The Revert Collect Module causes all collect actions on a given publication to fail, thus making the publication uncollectable."};case n.wKL.FeeFollowModule:return{name:"Fee Follow",field:"followModule",helper:"The Fee Follow Module only allows addresses to follow a given profile, so long as they pay a fee specified by the profile owner. Users can set the currency and amount required to be paid."};case n._9N.FollowerOnlyReferenceModule:return{name:"Follower Only Reference",field:"referenceModule",helper:"The Follower Only Reference Module ensures that only a profile is only allowed to mirror or comment on content."};default:return{name:e,field:"collectModule",helper:"Others"}}};i.Op},52040:function(e,t){"use strict";let r=e=>"".concat("https://asset.lenshareapp.xyz/images","/tokens/").concat(null==e?void 0:e.toLowerCase(),".svg");t.Z=r},622:function(e,t){"use strict";let r=e=>null==e?void 0:e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");t.Z=r},4108:function(e,t,r){"use strict";var i=r(622);t.Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}].reverse().find(function(t){return e>=t.value});return r?e<1e4?(0,i.Z)(e):(e/r.value).toFixed(t).replace(/\.0+$|(\.\d*[1-9])0+$/,"$1")+r.symbol:"0"}},9187:function(e,t,r){"use strict";var i=r(86501),n=r(34625);let s=e=>{var t,r,s;i.ZP.error(null!==(s=null!==(r=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)&&void 0!==r?r:null==e?void 0:e.message)&&void 0!==s?s:n.c9)};t.Z=s},4242:function(e,t,r){"use strict";var i=r(93445);let n=e=>i.splitSignature(e);t.Z=n},91565:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var i=r(85893),n=r(11163),s=r(67294),a=r(47422),o=r(86501),l=r(92882),c=r(41664),d=r.n(c),u=r(8193),p=r(53990);let h=()=>{(0,l.qr)(e=>e.currentProfile);let[e,t]=(0,s.useState)(!0),{query:r}=(0,n.useRouter)(),a="flex items-center gap-3 hover:bg-primary p-3 justify-center lg:justify-start curser-pointer font-semibold text-[#57B8FF] rounded";return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"m-2 ml-4 mt-3 block text-xl lg:hidden",onClick:()=>t(!e),children:e?(0,i.jsx)(p.ZCS,{}):(0,i.jsx)(u.qTj,{})}),e&&(0,i.jsx)("div",{className:"w-100 mb-10 flex flex-col justify-start border-r-2 border-gray-100 p-3 lg:w-400 xl:border-0",children:(0,i.jsxs)("div",{className:"border-gray-200 lg:border-b-2 xl:pb-4",children:[(0,i.jsx)(d(),{href:"/search?q=".concat(r.q,"&type=profiles"),children:(0,i.jsx)("div",{className:a,children:(0,i.jsx)("a",{className:"text-md cursor-pointer lg:block",children:"Profiles"})})}),(0,i.jsx)(d(),{href:"/search?q=".concat(r.q,"&type=pubs"),children:(0,i.jsx)("div",{className:a,children:(0,i.jsx)("a",{className:"text-md cursor-pointer text-[#000000] lg:block",children:"Publications"})})})]})})]})};var m=r(11021),f=r(36595);let g=()=>{let{query:e}=(0,n.useRouter)();return e.q&&["pubs","profiles"].includes(e.type)?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"m-auto h-[100vh] overflow-hidden lg:w-[1100px] xl:w-[1200px]",children:[(0,i.jsx)(o.x7,{position:"bottom-right"}),(0,i.jsxs)("div",{className:"videos mt-2 flex h-[88vh] flex-1 flex-col gap-10 overflow-auto overflow-x-hidden",children:[(0,i.jsx)("div",{className:"flex flex-row gap-4",children:(0,i.jsx)(h,{})}),"profiles"===e.type&&(0,i.jsx)(a.Z,{query:e.q}),"pubs"===e.type&&(0,i.jsx)(m.Z,{query:e.q})]})]}),(0,i.jsx)(f.Z,{})]}):(0,i.jsx)("p",{children:"Error"})};var v=g},97125:function(e,t,r){"use strict";r.d(t,{h:function(){return n}});var i=r(73445);let n=(0,i.Ue)(e=>({showPublicationDeleteAlert:!1,deletingPublication:null,forceDeletePublication:!1,setShowPublicationDeleteAlert:(t,r)=>e(()=>({showPublicationDeleteAlert:t,deletingPublication:r})),showModActionAlert:!1,modingPublication:null,setShowModActionAlert:(t,r)=>e(()=>({showModActionAlert:t,modingPublication:r}))}))},10116:function(e,t,r){"use strict";r.d(t,{N:function(){return d},G:function(){return c}});let i=e=>{let t=[...Array.from(new Map(e.map(e=>[e.id,e])).values())];return t.sort((e,t)=>{var r,i,n,s;return(null!==(n=null===(r=t.sent)||void 0===r?void 0:r.getTime())&&void 0!==n?n:0)-(null!==(s=null===(i=e.sent)||void 0===i?void 0:i.getTime())&&void 0!==s?s:0)}),null!=t?t:[]};var n=r(1257),s=r(73445),a=r(782),o=r(45341),l=r(34625);let c=(0,s.Ue)(e=>({client:void 0,setClient:t=>e(()=>({client:t})),conversations:new Map,setConversations:t=>e(()=>({conversations:t})),addConversation:(t,r)=>{e(e=>{let i=new Map(e.conversations);return i.set(t,r),{conversations:i}})},chatProvider:l.N5.PUSH,setChatProvider:t=>e(()=>({chatProvider:t})),queuedMessages:new Map,addQueuedMessage:(t,r)=>{e(e=>{let i=new Map(e.queuedMessages),n=e.queuedMessages.get(t)||[],s=[...n,r];return s.sort((e,t)=>t.sent.getTime()-e.sent.getTime()),i.set(t,s),{queuedMessages:i}})},removeQueuedMessage:(t,r)=>{e(e=>{let i=new Map(e.queuedMessages),n=e.queuedMessages.get(t)||[],s=n.filter(e=>e.id!==r);return i.set(t,s),{queuedMessages:i}})},updateQueuedMessage:(t,r,i)=>{e(e=>{let n=new Map(e.queuedMessages),s=e.queuedMessages.get(t)||[],a=s.filter(e=>e.id!==r);return s.length!==a.length?(a.push(i),a.sort((e,t)=>t.sent.getTime()-e.sent.getTime()),n.set(t,a),{queuedMessages:n}):{queuedMessages:e.queuedMessages}})},messages:new Map,addMessages:(t,r)=>{let n=0;return e(e=>{let s=new Map(e.messages),a=e.messages.get(t)||[],o=i([...a,...r]);return(n=o.length-a.length)?(s.set(t,o),{messages:s}):{messages:e.messages}}),n},hasSyncedMessages:!1,setHasSyncedMessages:t=>e(()=>({hasSyncedMessages:t})),previewMessages:new Map,setPreviewMessages:t=>e(()=>({previewMessages:t})),ensNames:new Map,setEnsNames:t=>e(()=>({ensNames:t})),previewMessagesNonLens:new Map,setPreviewMessagesNonLens:t=>e(()=>({previewMessagesNonLens:t})),selectedProfileId:"",setSelectedProfileId:t=>e(()=>({selectedProfileId:t})),selectedTab:"All",setSelectedTab:t=>e(()=>({selectedTab:t})),syncedProfiles:new Set,addSyncedProfiles:t=>e(e=>{let{syncedProfiles:r}=e;return{syncedProfiles:new Set([...r,...t])}}),unsyncProfile:t=>e(e=>{let{syncedProfiles:r}=e;return{syncedProfiles:new Set([...r].filter(e=>e!==t))}}),reset:()=>e(e=>({...e,conversations:new Map,messages:new Map,messageProfiles:new Map,previewMessages:new Map,selectedTab:"All",previewMessagesNonLens:new Map,ensNames:new Map}))})),d=(0,s.Ue)((0,a.tJ)(e=>({viewedMessagesAtNs:new Map,showMessagesBadge:new Map,setShowMessagesBadge:t=>e(()=>({showMessagesBadge:t})),clearMessagesBadge:t=>{e(e=>{let r=new Map(e.viewedMessagesAtNs);if(r.set(t,(0,n.$)(new Date)),!e.showMessagesBadge.get(t))return{viewedMessagesAtNs:r};let i=new Map(e.showMessagesBadge);return i.set(t,!1),{viewedMessagesAtNs:r,showMessagesBadge:i}})},unsentMessages:new Map,setUnsentMessage:(t,r)=>e(e=>{let i=new Map(e.unsentMessages);return r?i.set(t,r):i.delete(t),{unsentMessages:i}}),setUnsentMessages:t=>e(()=>({unsentMessages:t}))}),{name:o.d.MessageStore,storage:{setItem(e,t){let r=JSON.stringify({...t,state:{...t.state,viewedMessagesAtNs:Array.from(t.state.viewedMessagesAtNs),showMessagesBadge:Array.from(t.state.showMessagesBadge),unsentMessages:Array.from(t.state.unsentMessages)}});localStorage.setItem(e,r)},getItem:e=>{let t=localStorage.getItem(e);if(!t)return null;let r=JSON.parse(t);return r.state.viewedMessagesAtNs=new Map(r.state.viewedMessagesAtNs),r.state.showMessagesBadge=new Map(r.state.showMessagesBadge),r.state.unsentMessages=new Map(r.state.unsentMessages),r},removeItem(e){localStorage.removeItem(e)}}}))},6528:function(e,t,r){"use strict";var i=r(34625),n=r(23286);let s=(e,t)=>e&&i.XE?t?"".concat(i.XE,"/tr:n-").concat(t,",tr:di-placeholder.webp/").concat((0,n.A)(e)):"".concat(i.XE,"/tr:di-placeholder.webp/").concat((0,n.A)(e)):e;t.Z=s},14382:function(e,t,r){"use strict";r.d(t,{T:function(){return v}});var i=r(45341),n=r(34625),s=r(1257),a=r(67294),o=r(92882),l=r(10116),c=r(88559),d=r(52942),u=r(48764).Buffer;let p="binary",h=e=>"xmtp:".concat(n.Jy,":keys:").concat(e),m=e=>{let t=localStorage.getItem(h(e));return t?u.from(t,p):null},f=(e,t)=>{localStorage.setItem(h(e),u.from(t).toString(p))},g=e=>{localStorage.removeItem(h(e))},v=()=>{let{data:e}=(0,d.Z)(),t=(0,l.G)(e=>e.client),r=(0,l.G)(e=>e.setClient),n=(0,a.useCallback)(async()=>{e&&g(await e.getAddress()),t&&r(void 0),localStorage.removeItem(i.d.MessageStore),localStorage.removeItem(i.d.AttachmentCache),localStorage.removeItem(i.d.AttachmentStore)},[e,t]);return n};t.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,o.qr)(e=>e.currentProfile),r=(0,l.G)(e=>e.client),i=(0,l.G)(e=>e.setClient),[u,p]=(0,a.useState)(),{data:h,isLoading:g}=(0,d.Z)();return(0,a.useEffect)(()=>{let a=async()=>{if(h&&!r&&t){let a=m(await h.getAddress());if(!a){if(e)return;p(!0),a=await s.KU.getKeys(h,{env:n.Jy,appVersion:n.iC+"/"+n.Ji,persistConversations:!1,skipContactPublishing:!0}),f(await h.getAddress(),a)}let o=await s.KU.create(null,{env:n.Jy,appVersion:n.iC+"/"+n.Ji,privateKeyOverride:a,persistConversations:!0});o.registerCodec(new c.AttachmentCodec),o.registerCodec(new c.RemoteAttachmentCodec),i(o),p(!1)}else p(!1)};a(),h&&t||i(void 0)},[t]),{client:r,loading:g||u}}},13250:function(e,t,r){"use strict";var i=r(86501),n=r(50319),s=r(68980);let a=e=>{let{onCompleted:t,update:r}=e,a={notMined:"A previous transaction may not been mined yet or you have passed in a invalid nonce. You must wait for that to be mined before doing another action, please try again in a few moments. Nonce out of sync."},[o,{data:l,loading:c}]=function(e){let t={...e};return n.D(s.VPH,t)}({onCompleted:t,update:r,onError:e=>{e.message===a.notMined&&i.ZP.error(e.message)}});return{broadcast:e=>{let{request:t}=e;return o({variables:{request:t}})},data:l,loading:c}};t.Z=a},44753:function(){},85470:function(){},23106:function(e,t,r){"use strict";r.d(t,{Z:function(){return h}});var i=r(85893),n=r(67294),s=r(21443),a=r.n(s),o=r(45697),l=r.n(o);let c=(e,t)=>{let r=new(a())(".plyr-react",t.options||{});return t.source&&(r.source=t.source),r},d=e=>{e&&e.destroy()},u=()=>{},p=e=>e?()=>({plyr:e}):()=>new Proxy({plyr:{source:null}},{get:(e,t)=>"plyr"===t?e[t]:u}),h=n.forwardRef((e,t)=>{let{source:r,options:s=null,...a}=e,o=function(e,t,r=null){return function(e,t,r=[]){let[i,s]=(0,n.useState)(null),a=(0,n.useRef)(null),{instantiate:o,destroy:l,getAPI:c,params:d}=t;(0,n.useEffect)(()=>{let e=o(a.current,d);return s(e),()=>{l&&l(e,d)}},r);let u=(0,n.useMemo)(()=>c(i,d),[i]);return(0,n.useImperativeHandle)(e,u,[u]),a}(e,{instantiate:c,getAPI:p,destroy:d,params:t},r||[t.options,t.source])}(t,{source:r,options:s});return(0,i.jsx)("video",{ref:o,className:"plyr-react plyr",...a})});h.displayName="Plyr",h.defaultProps={options:{controls:["rewind","play","fast-forward","progress","current-time","duration","mute","volume","settings","fullscreen"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop"}},source:{type:"video",sources:[{src:"https://cdn.plyr.io/static/blank.mp4",type:"video/mp4",size:720},{src:"https://cdn.plyr.io/static/blank.mp4",type:"video/mp4",size:1080}]}},h.propTypes={options:l().object,source:l().any}},21443:function(e,t,r){"object"==typeof navigator&&(e.exports=function(){"use strict";function e(e,t,r){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:String(i))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var i,n;i=e,n=r[t],t in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var s,a,o,l={addCSS:!0,thumbWidth:15,watch:!0},c=function(e){return null!=e?e.constructor:null},d=function(e,t){return!!(e&&t&&e instanceof t)},u=function(e){return null==e},p=function(e){return c(e)===Object},h=function(e){return c(e)===String},m=function(e){return Array.isArray(e)},f=function(e){return d(e,NodeList)},g={nullOrUndefined:u,object:p,number:function(e){return c(e)===Number&&!Number.isNaN(e)},string:h,boolean:function(e){return c(e)===Boolean},function:function(e){return c(e)===Function},array:m,nodeList:f,element:function(e){return d(e,Element)},event:function(e){return d(e,Event)},empty:function(e){return u(e)||(h(e)||m(e)||f(e))&&!e.length||p(e)&&!Object.keys(e).length}},v=function(){var e,r;function i(e,t){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,i),g.element(e)?this.element=e:g.string(e)&&(this.element=document.querySelector(e)),g.element(this.element)&&g.empty(this.element.rangeTouch)&&(this.config=n({},l,{},t),this.init())}return e=[{key:"init",value:function(){i.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){i.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,r=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach(function(e){t.element[r](e,function(e){return t.set(e)},!1)})}},{key:"get",value:function(e){if(!i.enabled||!g.event(e))return null;var t,r=e.target,n=e.changedTouches[0],s=parseFloat(r.getAttribute("min"))||0,a=parseFloat(r.getAttribute("max"))||100,o=parseFloat(r.getAttribute("step"))||1,l=r.getBoundingClientRect(),c=100/l.width*(this.config.thumbWidth/2)/100;return 0>(t=100/l.width*(n.clientX-l.left))?t=0:100<t&&(t=100),50>t?t-=(100-2*t)*c:50<t&&(t+=2*(t-50)*c),s+function(e,t){if(1>t){var r,i=(r="".concat(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(r[1]?r[1].length:0)-(r[2]?+r[2]:0)):0;return parseFloat(e.toFixed(i))}return Math.round(e/t)*t}(t/100*(a-s),o)}},{key:"set",value:function(e){i.enabled&&g.event(e)&&!e.target.disabled&&(e.preventDefault(),e.target.value=this.get(e),function(e,t){if(e&&t){var r=new Event(t,{bubbles:!0});e.dispatchEvent(r)}}(e.target,"touchend"===e.type?"change":"input"))}}],r=[{key:"setup",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=null;if(g.empty(e)||g.string(e)?r=Array.from(document.querySelectorAll(g.string(e)?e:'input[type="range"]')):g.element(e)?r=[e]:g.nodeList(e)?r=Array.from(e):g.array(e)&&(r=e.filter(g.element)),g.empty(r))return null;var s=n({},l,{},t);return g.string(e)&&s.watch&&new MutationObserver(function(t){Array.from(t).forEach(function(t){Array.from(t.addedNodes).forEach(function(t){var r;g.element(t)&&(function(){return Array.from(document.querySelectorAll(r)).includes(this)}).call(t,r=e)&&new i(t,s)})})}).observe(document.body,{childList:!0,subtree:!0}),r.map(function(e){return new i(e,t)})}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}],e&&t(i.prototype,e),r&&t(i,r),i}();let y=e=>null!=e?e.constructor:null,b=(e,t)=>Boolean(e&&t&&e instanceof t),w=e=>null==e,_=e=>y(e)===Object,S=e=>y(e)===String,x=e=>"function"==typeof e,C=e=>Array.isArray(e),T=e=>b(e,NodeList),k=e=>w(e)||(S(e)||C(e)||T(e))&&!e.length||_(e)&&!Object.keys(e).length;var R={nullOrUndefined:w,object:_,number:e=>y(e)===Number&&!Number.isNaN(e),string:S,boolean:e=>y(e)===Boolean,function:x,array:C,weakMap:e=>b(e,WeakMap),nodeList:T,element:e=>null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument,textNode:e=>y(e)===Text,event:e=>b(e,Event),keyboardEvent:e=>b(e,KeyboardEvent),cue:e=>b(e,window.TextTrackCue)||b(e,window.VTTCue),track:e=>b(e,TextTrack)||!w(e)&&S(e.kind),promise:e=>b(e,Promise)&&x(e.then),url:e=>{if(b(e,window.URL))return!0;if(!S(e))return!1;let t=e;e.startsWith("http://")&&e.startsWith("https://")||(t=`http://${e}`);try{return!k(new URL(t).hostname)}catch(r){return!1}},empty:k};let E=(()=>{let e=document.createElement("span"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},r=Object.keys(t).find(t=>void 0!==e.style[t]);return!!R.string(r)&&t[r]})();function P(e,t){setTimeout(()=>{try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(t){}},t)}var D={isIE:Boolean(window.document.documentMode),isEdge:/Edge/g.test(navigator.userAgent),isWebKit:"WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),isIPhone:/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,isIPadOS:"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,isIos:/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1};function L(e,t){return t.split(".").reduce((e,t)=>e&&e[t],e)}function I(e={},...t){if(!t.length)return e;let r=t.shift();return R.object(r)?(Object.keys(r).forEach(t=>{R.object(r[t])?(Object.keys(e).includes(t)||Object.assign(e,{[t]:{}}),I(e[t],r[t])):Object.assign(e,{[t]:r[t]})}),I(e,...t)):e}function M(e,t){let r=e.length?e:[e];Array.from(r).reverse().forEach((e,r)=>{let i=r>0?t.cloneNode(!0):t,n=e.parentNode,s=e.nextSibling;i.appendChild(e),s?n.insertBefore(i,s):n.appendChild(i)})}function j(e,t){R.element(e)&&!R.empty(t)&&Object.entries(t).filter(([,e])=>!R.nullOrUndefined(e)).forEach(([t,r])=>e.setAttribute(t,r))}function O(e,t,r){let i=document.createElement(e);return R.object(t)&&j(i,t),R.string(r)&&(i.innerText=r),i}function A(e,t,r,i){R.element(t)&&t.appendChild(O(e,r,i))}function N(e){R.nodeList(e)||R.array(e)?Array.from(e).forEach(N):R.element(e)&&R.element(e.parentNode)&&e.parentNode.removeChild(e)}function F(e){if(!R.element(e))return;let{length:t}=e.childNodes;for(;t>0;)e.removeChild(e.lastChild),t-=1}function q(e,t){return R.element(t)&&R.element(t.parentNode)&&R.element(e)?(t.parentNode.replaceChild(e,t),e):null}function B(e,t){if(!R.string(e)||R.empty(e))return{};let r={},i=I({},t);return e.split(",").forEach(e=>{let t=e.trim(),n=t.replace(".",""),s=t.replace(/[[\]]/g,"").split("="),[a]=s,o=s.length>1?s[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":R.string(i.class)?r.class=`${i.class} ${n}`:r.class=n;break;case"#":r.id=t.replace("#","");break;case"[":r[a]=o}}),I(i,r)}function U(e,t){if(!R.element(e))return;let r=t;R.boolean(r)||(r=!e.hidden),e.hidden=r}function H(e,t,r){if(R.nodeList(e))return Array.from(e).map(e=>H(e,t,r));if(R.element(e)){let i="toggle";return void 0!==r&&(i=r?"add":"remove"),e.classList[i](t),e.classList.contains(t)}return!1}function z(e,t){return R.element(e)&&e.classList.contains(t)}function V(e,t){let{prototype:r}=Element;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function $(e){return this.elements.container.querySelectorAll(e)}function Z(e){return this.elements.container.querySelector(e)}function W(e=null,t=!1){R.element(e)&&e.focus({preventScroll:!0,focusVisible:t})}let K={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},G={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,t){let r=G[e]||"html5"!==t;return{api:r,ui:r&&G.rangeInput}},pip:!(D.isIPhone||!R.function(O("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||O("video").disablePictureInPicture)),airplay:R.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if(R.empty(e))return!1;let[t]=e.split("/"),r=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(K).includes(r)&&(r+=`; codecs="${K[e]}"`);try{return Boolean(r&&this.media.canPlayType(r).replace(/no/,""))}catch(i){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{let e=document.createElement("input");return e.type="range","range"===e.type})(),touch:"ontouchstart"in document.documentElement,transitions:!1!==E,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},Q=(()=>{let e=!1;try{let t=Object.defineProperty({},"passive",{get:()=>(e=!0,null)});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(r){}return e})();function Y(e,t,r,i=!1,n=!0,s=!1){if(!e||!("addEventListener"in e)||R.empty(t)||!R.function(r))return;let a=t.split(" "),o=s;Q&&(o={passive:n,capture:s}),a.forEach(t=>{this&&this.eventListeners&&i&&this.eventListeners.push({element:e,type:t,callback:r,options:o}),e[i?"addEventListener":"removeEventListener"](t,r,o)})}function J(e,t="",r,i=!0,n=!1){Y.call(this,e,t,r,!0,i,n)}function X(e,t="",r,i=!0,n=!1){Y.call(this,e,t,r,!1,i,n)}function ee(e,t="",r,i=!0,n=!1){let s=(...a)=>{X(e,t,s,i,n),r.apply(this,a)};Y.call(this,e,t,s,!0,i,n)}function et(e,t="",r=!1,i={}){if(!R.element(e)||R.empty(t))return;let n=new CustomEvent(t,{bubbles:r,detail:{...i,plyr:this}});e.dispatchEvent(n)}function er(){this&&this.eventListeners&&(this.eventListeners.forEach(e=>{let{element:t,type:r,callback:i,options:n}=e;t.removeEventListener(r,i,n)}),this.eventListeners=[])}function ei(){return new Promise(e=>this.ready?setTimeout(e,0):J.call(this,this.elements.container,"ready",e)).then(()=>{})}function en(e){R.promise(e)&&e.then(null,()=>{})}function es(e){return R.array(e)?e.filter((t,r)=>e.indexOf(t)===r):e}function ea(e,t){return R.array(e)&&e.length?e.reduce((e,r)=>Math.abs(r-t)<Math.abs(e-t)?r:e):null}function eo(e){return!(!window||!window.CSS)&&window.CSS.supports(e)}let el=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce((e,[t,r])=>({...e,[t/r]:[t,r]}),{});function ec(e){return!!(R.array(e)||R.string(e)&&e.includes(":"))&&(R.array(e)?e:e.split(":")).map(Number).every(R.number)}function ed(e){if(!R.array(e)||!e.every(R.number))return null;let[t,r]=e,i=(e,t)=>0===t?e:i(t,e%t),n=i(t,r);return[t/n,r/n]}function eu(e){let t=e=>ec(e)?e.split(":").map(Number):null,r=t(e);if(null===r&&(r=t(this.config.ratio)),null===r&&!R.empty(this.embed)&&R.array(this.embed.ratio)&&({ratio:r}=this.embed),null===r&&this.isHTML5){let{videoWidth:i,videoHeight:n}=this.media;r=[i,n]}return ed(r)}function ep(e){if(!this.isVideo)return{};let{wrapper:t}=this.elements,r=eu.call(this,e);if(!R.array(r))return{};let[i,n]=ed(r),s=100/i*n;if(eo(`aspect-ratio: ${i}/${n}`)?t.style.aspectRatio=`${i}/${n}`:t.style.paddingBottom=`${s}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){let a=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10);this.fullscreen.active?t.style.paddingBottom=null:this.media.style.transform=`translateY(-${(a-s)/(a/50)}%)`}else this.isHTML5&&t.classList.add(this.config.classNames.videoFixedRatio);return{padding:s,ratio:r}}function eh(e,t,r=.05){let i=e/t,n=ea(Object.keys(el),i);return Math.abs(n-i)<=r?el[n]:[e,t]}let em={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter(e=>{let t=e.getAttribute("type");return!!R.empty(t)||G.mime.call(this,t)}):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:em.getSources.call(this).map(e=>Number(e.getAttribute("size"))).filter(Boolean)},setup(){if(!this.isHTML5)return;let e=this;e.options.speed=e.config.speed.options,R.empty(this.config.ratio)||ep.call(e),Object.defineProperty(e.media,"quality",{get(){let t=em.getSources.call(e).find(t=>t.getAttribute("src")===e.source);return t&&Number(t.getAttribute("size"))},set(t){if(e.quality!==t){if(e.config.quality.forced&&R.function(e.config.quality.onChange))e.config.quality.onChange(t);else{let r=em.getSources.call(e).find(e=>Number(e.getAttribute("size"))===t);if(!r)return;let{currentTime:i,paused:n,preload:s,readyState:a,playbackRate:o}=e.media;e.media.src=r.getAttribute("src"),("none"!==s||a)&&(e.once("loadedmetadata",()=>{e.speed=o,e.currentTime=i,n||en(e.play())}),e.media.load())}et.call(e,e.media,"qualitychange",!1,{quality:t})}}})},cancelRequests(){this.isHTML5&&(N(em.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function ef(e,...t){return R.empty(e)?e:e.toString().replace(/{(\d+)}/g,(e,r)=>t[r].toString())}let eg=(e="",t="",r="")=>e.replace(RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),r.toString()),ev=(e="")=>e.toString().replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase());function ey(e){let t=document.createElement("div");return t.appendChild(e),t.innerHTML}let eb={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},ew={get(e="",t={}){if(R.empty(e)||R.empty(t))return"";let r=L(t.i18n,e);if(R.empty(r))return Object.keys(eb).includes(e)?eb[e]:"";let i={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(i).forEach(([e,t])=>{r=eg(r,e,t)}),r}};class e_{constructor(t){e(this,"get",e=>{if(!e_.supported||!this.enabled)return null;let t=window.localStorage.getItem(this.key);if(R.empty(t))return null;let r=JSON.parse(t);return R.string(e)&&e.length?r[e]:r}),e(this,"set",e=>{if(!e_.supported||!this.enabled||!R.object(e))return;let t=this.get();R.empty(t)&&(t={}),I(t,e);try{window.localStorage.setItem(this.key,JSON.stringify(t))}catch(r){}}),this.enabled=t.config.storage.enabled,this.key=t.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;let e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(t){return!1}}}function eS(e,t="text"){return new Promise((r,i)=>{try{let n=new XMLHttpRequest;if(!("withCredentials"in n))return;n.addEventListener("load",()=>{if("text"===t)try{r(JSON.parse(n.responseText))}catch(e){r(n.responseText)}else r(n.response)}),n.addEventListener("error",()=>{throw Error(n.status)}),n.open("GET",e,!0),n.responseType=t,n.send()}catch(s){i(s)}})}function ex(e,t){if(!R.string(e))return;let r="cache",i=R.string(t),n=()=>null!==document.getElementById(t),s=(e,t)=>{e.innerHTML=t,i&&n()||document.body.insertAdjacentElement("afterbegin",e)};if(!i||!n()){let a=e_.supported,o=document.createElement("div");if(o.setAttribute("hidden",""),i&&o.setAttribute("id",t),a){let l=window.localStorage.getItem(`${r}-${t}`);if(null!==l){let c=JSON.parse(l);s(o,c.content)}}eS(e).then(e=>{if(!R.empty(e)){if(a)try{window.localStorage.setItem(`${r}-${t}`,JSON.stringify({content:e}))}catch(i){}s(o,e)}}).catch(()=>{})}}let eC=e=>Math.trunc(e/60/60%60,10),eT=e=>Math.trunc(e/60%60,10),ek=e=>Math.trunc(e%60,10);function eR(e=0,t=!1,r=!1){if(!R.number(e))return eR(void 0,t,r);let i=e=>`0${e}`.slice(-2),n=eC(e),s=eT(e),a=ek(e);return`${r&&e>0?"-":""}${n=t||n>0?`${n}:`:""}${i(s)}:${i(a)}`}let eE={getIconUrl(){let e=new URL(this.config.iconUrl,window.location),t=window.location.host?window.location.host:window.top.location.host,r=e.host!==t||D.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:r}},findElements(){try{return this.elements.controls=Z.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:$.call(this,this.config.selectors.buttons.play),pause:Z.call(this,this.config.selectors.buttons.pause),restart:Z.call(this,this.config.selectors.buttons.restart),rewind:Z.call(this,this.config.selectors.buttons.rewind),fastForward:Z.call(this,this.config.selectors.buttons.fastForward),mute:Z.call(this,this.config.selectors.buttons.mute),pip:Z.call(this,this.config.selectors.buttons.pip),airplay:Z.call(this,this.config.selectors.buttons.airplay),settings:Z.call(this,this.config.selectors.buttons.settings),captions:Z.call(this,this.config.selectors.buttons.captions),fullscreen:Z.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=Z.call(this,this.config.selectors.progress),this.elements.inputs={seek:Z.call(this,this.config.selectors.inputs.seek),volume:Z.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:Z.call(this,this.config.selectors.display.buffer),currentTime:Z.call(this,this.config.selectors.display.currentTime),duration:Z.call(this,this.config.selectors.display.duration)},R.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,t){let r="http://www.w3.org/2000/svg",i=eE.getIconUrl.call(this),n=`${i.cors?"":i.url}#${this.config.iconPrefix}`,s=document.createElementNS(r,"svg");j(s,I(t,{"aria-hidden":"true",focusable:"false"}));let a=document.createElementNS(r,"use"),o=`${n}-${e}`;return"href"in a&&a.setAttributeNS("http://www.w3.org/1999/xlink","href",o),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),s.appendChild(a),s},createLabel(e,t={}){let r=ew.get(e,this.config);return O("span",{...t,class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")},r)},createBadge(e){if(R.empty(e))return null;let t=O("span",{class:this.config.classNames.menu.value});return t.appendChild(O("span",{class:this.config.classNames.menu.badge},e)),t},createButton(e,t){let r=I({},t),i=function(e=""){let t=e.toString();return(t=function(e=""){let t=e.toString();return t=eg(t,"-"," "),t=ev(t=eg(t,"_"," ")),eg(t," ","")}(t)).charAt(0).toLowerCase()+t.slice(1)}(e),n={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach(e=>{Object.keys(r).includes(e)&&(n[e]=r[e],delete r[e])}),"button"!==n.element||Object.keys(r).includes("type")||(r.type="button"),Object.keys(r).includes("class")?r.class.split(" ").some(e=>e===this.config.classNames.control)||I(r,{class:`${r.class} ${this.config.classNames.control}`}):r.class=this.config.classNames.control,e){case"play":n.toggle=!0,n.label="play",n.labelPressed="pause",n.icon="play",n.iconPressed="pause";break;case"mute":n.toggle=!0,n.label="mute",n.labelPressed="unmute",n.icon="volume",n.iconPressed="muted";break;case"captions":n.toggle=!0,n.label="enableCaptions",n.labelPressed="disableCaptions",n.icon="captions-off",n.iconPressed="captions-on";break;case"fullscreen":n.toggle=!0,n.label="enterFullscreen",n.labelPressed="exitFullscreen",n.icon="enter-fullscreen",n.iconPressed="exit-fullscreen";break;case"play-large":r.class+=` ${this.config.classNames.control}--overlaid`,i="play",n.label="play",n.icon="play";break;default:R.empty(n.label)&&(n.label=i),R.empty(n.icon)&&(n.icon=e)}let s=O(n.element);return n.toggle?(s.appendChild(eE.createIcon.call(this,n.iconPressed,{class:"icon--pressed"})),s.appendChild(eE.createIcon.call(this,n.icon,{class:"icon--not-pressed"})),s.appendChild(eE.createLabel.call(this,n.labelPressed,{class:"label--pressed"})),s.appendChild(eE.createLabel.call(this,n.label,{class:"label--not-pressed"}))):(s.appendChild(eE.createIcon.call(this,n.icon)),s.appendChild(eE.createLabel.call(this,n.label))),I(r,B(this.config.selectors.buttons[i],r)),j(s,r),"play"===i?(R.array(this.elements.buttons[i])||(this.elements.buttons[i]=[]),this.elements.buttons[i].push(s)):this.elements.buttons[i]=s,s},createRange(e,t){let r=O("input",I(B(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":ew.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=r,eE.updateRangeFill.call(this,r),v.setup(r),r},createProgress(e,t){let r=O("progress",I(B(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){r.appendChild(O("span",null,"0"));let i={played:"played",buffer:"buffered"}[e],n=i?ew.get(i,this.config):"";r.innerText=`% ${n.toLowerCase()}`}return this.elements.display[e]=r,r},createTime(e,t){let r=B(this.config.selectors.display[e],t),i=O("div",I(r,{class:`${r.class?r.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":ew.get(e,this.config),role:"timer"}),"00:00");return this.elements.display[e]=i,i},bindMenuItemShortcuts(e,t){J.call(this,e,"keydown keyup",r=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(r.key)||(r.preventDefault(),r.stopPropagation(),"keydown"===r.type))return;let i=V(e,'[role="menuitemradio"]');if(!i&&[" ","ArrowRight"].includes(r.key))eE.showMenuPanel.call(this,t,!0);else{let n;" "!==r.key&&("ArrowDown"===r.key||i&&"ArrowRight"===r.key?(n=e.nextElementSibling,R.element(n)||(n=e.parentNode.firstElementChild)):(n=e.previousElementSibling,R.element(n)||(n=e.parentNode.lastElementChild)),W.call(this,n,!0))}},!1),J.call(this,e,"keyup",e=>{"Return"===e.key&&eE.focusFirstMenuItem.call(this,null,!0)})},createMenuItem({value:e,list:t,type:r,title:i,badge:n=null,checked:s=!1}){let a=B(this.config.selectors.inputs[r]),o=O("button",I(a,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${a.class?a.class:""}`.trim(),"aria-checked":s,value:e})),l=O("span");l.innerHTML=i,R.element(n)&&l.appendChild(n),o.appendChild(l),Object.defineProperty(o,"checked",{enumerable:!0,get:()=>"true"===o.getAttribute("aria-checked"),set(e){e&&Array.from(o.parentNode.children).filter(e=>V(e,'[role="menuitemradio"]')).forEach(e=>e.setAttribute("aria-checked","false")),o.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(o,"click keyup",t=>{if(!R.keyboardEvent(t)||" "===t.key){switch(t.preventDefault(),t.stopPropagation(),o.checked=!0,r){case"language":this.currentTrack=Number(e);break;case"quality":this.quality=e;break;case"speed":this.speed=parseFloat(e)}eE.showMenuPanel.call(this,"home",R.keyboardEvent(t))}},r,!1),eE.bindMenuItemShortcuts.call(this,o,r),t.appendChild(o)},formatTime(e=0,t=!1){return R.number(e)?eR(e,eC(this.duration)>0,t):e},updateTimeDisplay(e=null,t=0,r=!1){R.element(e)&&R.number(t)&&(e.innerText=eE.formatTime(t,r))},updateVolume(){this.supported.ui&&(R.element(this.elements.inputs.volume)&&eE.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),R.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(e,t=0){R.element(e)&&(e.value=t,eE.updateRangeFill.call(this,e))},updateProgress(e){var t,r;if(!this.supported.ui||!R.event(e))return;let i=0;if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":t=this.currentTime,r=this.duration,i=0===t||0===r||Number.isNaN(t)||Number.isNaN(r)?0:(t/r*100).toFixed(2),"timeupdate"===e.type&&eE.setRange.call(this,this.elements.inputs.seek,i);break;case"playing":case"progress":((e,t)=>{let r=R.number(t)?t:0,i=R.element(e)?e:this.elements.display.buffer;if(R.element(i)){i.value=r;let n=i.getElementsByTagName("span")[0];R.element(n)&&(n.childNodes[0].nodeValue=r)}})(this.elements.display.buffer,100*this.buffered)}},updateRangeFill(e){let t=R.event(e)?e.target:e;if(R.element(t)&&"range"===t.getAttribute("type")){if(V(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);let r=eE.formatTime(this.currentTime),i=eE.formatTime(this.duration),n=ew.get("seekLabel",this.config);t.setAttribute("aria-valuetext",n.replace("{currentTime}",r).replace("{duration}",i))}else if(V(t,this.config.selectors.inputs.volume)){let s=100*t.value;t.setAttribute("aria-valuenow",s),t.setAttribute("aria-valuetext",`${s.toFixed(1)}%`)}else t.setAttribute("aria-valuenow",t.value);(D.isWebKit||D.isIPadOS)&&t.style.setProperty("--value",t.value/t.max*100+"%")}},updateSeekTooltip(e){var t,r;if(!this.config.tooltips.seek||!R.element(this.elements.inputs.seek)||!R.element(this.elements.display.seekTooltip)||0===this.duration)return;let i=this.elements.display.seekTooltip,n=`${this.config.classNames.tooltip}--visible`,s=e=>H(i,n,e);if(this.touch)return void s(!1);let a=0,o=this.elements.progress.getBoundingClientRect();if(R.event(e))a=100/o.width*(e.pageX-o.left);else{if(!z(i,n))return;a=parseFloat(i.style.left,10)}a<0?a=0:a>100&&(a=100);let l=this.duration/100*a;i.innerText=eE.formatTime(l);let c=null===(t=this.config.markers)||void 0===t||null===(r=t.points)||void 0===r?void 0:r.find(({time:e})=>e===Math.round(l));c&&i.insertAdjacentHTML("afterbegin",`${c.label}<br>`),i.style.left=`${a}%`,R.event(e)&&["mouseenter","mouseleave"].includes(e.type)&&s("mouseenter"===e.type)},timeUpdate(e){let t=!R.element(this.elements.display.duration)&&this.config.invertTime;eE.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||eE.updateProgress.call(this,e)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=4294967296)return U(this.elements.display.currentTime,!0),void U(this.elements.progress,!0);R.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);let e=R.element(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&eE.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&eE.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&eE.setMarkers.call(this),eE.updateSeekTooltip.call(this)},toggleMenuButton(e,t){U(this.elements.settings.buttons[e],!t)},updateSetting(e,t,r){let i=this.elements.settings.panels[e],n=null,s=t;if("captions"===e)n=this.currentTrack;else{if(n=R.empty(r)?this[e]:r,R.empty(n)&&(n=this.config[e].default),!R.empty(this.options[e])&&!this.options[e].includes(n))return void this.debug.warn(`Unsupported value of '${n}' for ${e}`);if(!this.config[e].options.includes(n))return void this.debug.warn(`Disabled value of '${n}' for ${e}`)}if(R.element(s)||(s=i&&i.querySelector('[role="menu"]')),!R.element(s))return;this.elements.settings.buttons[e].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=eE.getLabel.call(this,e,n);let a=s&&s.querySelector(`[value="${n}"]`);R.element(a)&&(a.checked=!0)},getLabel(e,t){switch(e){case"speed":return 1===t?ew.get("normal",this.config):`${t}&times;`;case"quality":if(R.number(t)){let r=ew.get(`qualityLabel.${t}`,this.config);return r.length?r:`${t}p`}return ev(t);case"captions":return eL.getLabel.call(this);default:return null}},setQualityMenu(e){if(!R.element(this.elements.settings.panels.quality))return;let t="quality",r=this.elements.settings.panels.quality.querySelector('[role="menu"]');R.array(e)&&(this.options.quality=es(e).filter(e=>this.config.quality.options.includes(e)));let i=!R.empty(this.options.quality)&&this.options.quality.length>1;if(eE.toggleMenuButton.call(this,t,i),F(r),eE.checkMenu.call(this),!i)return;let n=e=>{let t=ew.get(`qualityBadge.${e}`,this.config);return t.length?eE.createBadge.call(this,t):null};this.options.quality.sort((e,t)=>{let r=this.config.quality.options;return r.indexOf(e)>r.indexOf(t)?1:-1}).forEach(e=>{eE.createMenuItem.call(this,{value:e,list:r,type:t,title:eE.getLabel.call(this,"quality",e),badge:n(e)})}),eE.updateSetting.call(this,t,r)},setCaptionsMenu(){if(!R.element(this.elements.settings.panels.captions))return;let e="captions",t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),r=eL.getTracks.call(this),i=Boolean(r.length);if(eE.toggleMenuButton.call(this,e,i),F(t),eE.checkMenu.call(this),!i)return;let n=r.map((e,r)=>({value:r,checked:this.captions.toggled&&this.currentTrack===r,title:eL.getLabel.call(this,e),badge:e.language&&eE.createBadge.call(this,e.language.toUpperCase()),list:t,type:"language"}));n.unshift({value:-1,checked:!this.captions.toggled,title:ew.get("disabled",this.config),list:t,type:"language"}),n.forEach(eE.createMenuItem.bind(this)),eE.updateSetting.call(this,e,t)},setSpeedMenu(){if(!R.element(this.elements.settings.panels.speed))return;let e="speed",t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter(e=>e>=this.minimumSpeed&&e<=this.maximumSpeed);let r=!R.empty(this.options.speed)&&this.options.speed.length>1;eE.toggleMenuButton.call(this,e,r),F(t),eE.checkMenu.call(this),r&&(this.options.speed.forEach(r=>{eE.createMenuItem.call(this,{value:r,list:t,type:e,title:eE.getLabel.call(this,"speed",r)})}),eE.updateSetting.call(this,e,t))},checkMenu(){let{buttons:e}=this.elements.settings,t=!R.empty(e)&&Object.values(e).some(e=>!e.hidden);U(this.elements.settings.menu,!t)},focusFirstMenuItem(e,t=!1){if(this.elements.settings.popup.hidden)return;let r=e;R.element(r)||(r=Object.values(this.elements.settings.panels).find(e=>!e.hidden));let i=r.querySelector('[role^="menuitem"]');W.call(this,i,t)},toggleMenu(e){let{popup:t}=this.elements.settings,r=this.elements.buttons.settings;if(!R.element(t)||!R.element(r))return;let{hidden:i}=t,n=i;if(R.boolean(e))n=e;else if(R.keyboardEvent(e)&&"Escape"===e.key)n=!1;else if(R.event(e)){let s=R.function(e.composedPath)?e.composedPath()[0]:e.target,a=t.contains(s);if(a||!a&&e.target!==r&&n)return}r.setAttribute("aria-expanded",n),U(t,!n),H(this.elements.container,this.config.classNames.menu.open,n),n&&R.keyboardEvent(e)?eE.focusFirstMenuItem.call(this,null,!0):n||i||W.call(this,r,R.keyboardEvent(e))},getMenuSize(e){let t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);let r=t.scrollWidth,i=t.scrollHeight;return N(t),{width:r,height:i}},showMenuPanel(e="",t=!1){let r=this.elements.container.querySelector(`#plyr-settings-${this.id}-${e}`);if(!R.element(r))return;let i=r.parentNode,n=Array.from(i.children).find(e=>!e.hidden);if(G.transitions&&!G.reducedMotion){i.style.width=`${n.scrollWidth}px`,i.style.height=`${n.scrollHeight}px`;let s=eE.getMenuSize.call(this,r),a=e=>{e.target===i&&["width","height"].includes(e.propertyName)&&(i.style.width="",i.style.height="",X.call(this,i,E,a))};J.call(this,i,E,a),i.style.width=`${s.width}px`,i.style.height=`${s.height}px`}U(n,!0),U(r,!1),eE.focusFirstMenuItem.call(this,r,t)},setDownloadUrl(){let e=this.elements.buttons.download;R.element(e)&&e.setAttribute("href",this.download)},create(e){let{bindMenuItemShortcuts:t,createButton:r,createProgress:i,createRange:n,createTime:s,setQualityMenu:a,setSpeedMenu:o,showMenuPanel:l}=eE;this.elements.controls=null,R.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(r.call(this,"play-large"));let c=O("div",B(this.config.selectors.controls.wrapper));this.elements.controls=c;let d={class:"plyr__controls__item"};return es(R.array(this.config.controls)?this.config.controls:[]).forEach(a=>{if("restart"===a&&c.appendChild(r.call(this,"restart",d)),"rewind"===a&&c.appendChild(r.call(this,"rewind",d)),"play"===a&&c.appendChild(r.call(this,"play",d)),"fast-forward"===a&&c.appendChild(r.call(this,"fast-forward",d)),"progress"===a){let o=O("div",{class:`${d.class} plyr__progress__container`}),u=O("div",B(this.config.selectors.progress));if(u.appendChild(n.call(this,"seek",{id:`plyr-seek-${e.id}`})),u.appendChild(i.call(this,"buffer")),this.config.tooltips.seek){let p=O("span",{class:this.config.classNames.tooltip},"00:00");u.appendChild(p),this.elements.display.seekTooltip=p}this.elements.progress=u,o.appendChild(this.elements.progress),c.appendChild(o)}if("current-time"===a&&c.appendChild(s.call(this,"currentTime",d)),"duration"===a&&c.appendChild(s.call(this,"duration",d)),"mute"===a||"volume"===a){let{volume:h}=this.elements;if(R.element(h)&&c.contains(h)||(h=O("div",I({},d,{class:`${d.class} plyr__volume`.trim()})),this.elements.volume=h,c.appendChild(h)),"mute"===a&&h.appendChild(r.call(this,"mute")),"volume"===a&&!D.isIos&&!D.isIPadOS){let m={max:1,step:.05,value:this.config.volume};h.appendChild(n.call(this,"volume",I(m,{id:`plyr-volume-${e.id}`})))}}if("captions"===a&&c.appendChild(r.call(this,"captions",d)),"settings"===a&&!R.empty(this.config.settings)){let f=O("div",I({},d,{class:`${d.class} plyr__menu`.trim(),hidden:""}));f.appendChild(r.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${e.id}`,"aria-expanded":!1}));let g=O("div",{class:"plyr__menu__container",id:`plyr-settings-${e.id}`,hidden:""}),v=O("div"),y=O("div",{id:`plyr-settings-${e.id}-home`}),b=O("div",{role:"menu"});y.appendChild(b),v.appendChild(y),this.elements.settings.panels.home=y,this.config.settings.forEach(r=>{let i=O("button",I(B(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));t.call(this,i,r),J.call(this,i,"click",()=>{l.call(this,r,!1)});let n=O("span",null,ew.get(r,this.config)),s=O("span",{class:this.config.classNames.menu.value});s.innerHTML=e[r],n.appendChild(s),i.appendChild(n),b.appendChild(i);let a=O("div",{id:`plyr-settings-${e.id}-${r}`,hidden:""}),o=O("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});o.appendChild(O("span",{"aria-hidden":!0},ew.get(r,this.config))),o.appendChild(O("span",{class:this.config.classNames.hidden},ew.get("menuBack",this.config))),J.call(this,a,"keydown",e=>{"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),l.call(this,"home",!0))},!1),J.call(this,o,"click",()=>{l.call(this,"home",!1)}),a.appendChild(o),a.appendChild(O("div",{role:"menu"})),v.appendChild(a),this.elements.settings.buttons[r]=i,this.elements.settings.panels[r]=a}),g.appendChild(v),f.appendChild(g),c.appendChild(f),this.elements.settings.popup=g,this.elements.settings.menu=f}if("pip"===a&&G.pip&&c.appendChild(r.call(this,"pip",d)),"airplay"===a&&G.airplay&&c.appendChild(r.call(this,"airplay",d)),"download"===a){let w=I({},d,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(w.download="");let{download:_}=this.config.urls;!R.url(_)&&this.isEmbed&&I(w,{icon:`logo-${this.provider}`,label:this.provider}),c.appendChild(r.call(this,"download",w))}"fullscreen"===a&&c.appendChild(r.call(this,"fullscreen",d))}),this.isHTML5&&a.call(this,em.getQualityOptions.call(this)),o.call(this),c},inject(){let e,t;if(this.config.loadSprite){let r=eE.getIconUrl.call(this);r.cors&&ex(r.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let i=null;this.elements.controls=null;let n={id:this.id,seektime:this.config.seekTime,title:this.config.title},s=!0;if(R.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,n)),this.config.controls||(this.config.controls=[]),R.element(this.config.controls)||R.string(this.config.controls)?i=this.config.controls:(i=eE.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:eL.getLabel.call(this)}),s=!1),s&&R.string(this.config.controls)&&(t=i,Object.entries(n).forEach(([e,r])=>{t=eg(t,`{${e}}`,r)}),i=t),R.string(this.config.selectors.controls.container)&&(e=document.querySelector(this.config.selectors.controls.container)),R.element(e)||(e=this.elements.container),e[R.element(i)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",i),R.element(this.elements.controls)||eE.findElements.call(this),!R.empty(this.elements.buttons)){let a=e=>{let t=this.config.classNames.controlPressed;e.setAttribute("aria-pressed","false"),Object.defineProperty(e,"pressed",{configurable:!0,enumerable:!0,get:()=>z(e,t),set(r=!1){H(e,t,r),e.setAttribute("aria-pressed",r?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach(e=>{R.array(e)||R.nodeList(e)?Array.from(e).filter(Boolean).forEach(a):a(e)})}if(D.isEdge&&P(e),this.config.tooltips.controls){let{classNames:o,selectors:l}=this.config,c=`${l.controls.wrapper} ${l.labels} .${o.hidden}`,d=$.call(this,c);Array.from(d).forEach(e=>{H(e,this.config.classNames.hidden,!1),H(e,this.config.classNames.tooltip,!0)})}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch(e){}},setMarkers(){var e,t;if(!this.duration||this.elements.markers)return;let r=null===(e=this.config.markers)||void 0===e||null===(t=e.points)||void 0===t?void 0:t.filter(({time:e})=>e>0&&e<this.duration);if(null==r||!r.length)return;let i=document.createDocumentFragment(),n=document.createDocumentFragment(),s=null,a=`${this.config.classNames.tooltip}--visible`,o=e=>H(s,a,e);r.forEach(e=>{let t=O("span",{class:this.config.classNames.marker},""),r=e.time/this.duration*100+"%";s&&(t.addEventListener("mouseenter",()=>{e.label||(s.style.left=r,s.innerHTML=e.label,o(!0))}),t.addEventListener("mouseleave",()=>{o(!1)})),t.addEventListener("click",()=>{this.currentTime=e.time}),t.style.left=r,n.appendChild(t)}),i.appendChild(n),this.config.tooltips.seek||(s=O("span",{class:this.config.classNames.tooltip},""),i.appendChild(s)),this.elements.markers={points:n,tip:s},this.elements.progress.appendChild(i)}};function eP(e,t=!0){let r=e;if(t){let i=document.createElement("a");i.href=r,r=i.href}try{return new URL(r)}catch(n){return null}}function eD(e){let t=new URLSearchParams;return R.object(e)&&Object.entries(e).forEach(([e,r])=>{t.set(e,r)}),t}let eL={setup(){var e,t;if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!G.textTracks)return void(R.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&eE.setCaptionsMenu.call(this));if(R.element(this.elements.captions)||(this.elements.captions=O("div",B(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),e=this.elements.captions,t=this.elements.wrapper,R.element(e)&&R.element(t)&&t.parentNode.insertBefore(e,t.nextSibling)),D.isIE&&window.URL){let r=this.media.querySelectorAll("track");Array.from(r).forEach(e=>{let t=e.getAttribute("src"),r=eP(t);null!==r&&r.hostname!==window.location.href.hostname&&["http:","https:"].includes(r.protocol)&&eS(t,"blob").then(t=>{e.setAttribute("src",window.URL.createObjectURL(t))}).catch(()=>{N(e)})})}let i=es((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map(e=>e.split("-")[0])),n=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===n&&([n]=i);let s=this.storage.get("captions");if(R.boolean(s)||({active:s}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:s,language:n,languages:i}),this.isHTML5){let a=this.config.captions.update?"addtrack removetrack":"removetrack";J.call(this,this.media.textTracks,a,eL.update.bind(this))}setTimeout(eL.update.bind(this),0)},update(){let e=eL.getTracks.call(this,!0),{active:t,language:r,meta:i,currentTrackNode:n}=this.captions,s=Boolean(e.find(e=>e.language===r));this.isHTML5&&this.isVideo&&e.filter(e=>!i.get(e)).forEach(e=>{this.debug.log("Track added",e),i.set(e,{default:"showing"===e.mode}),"showing"===e.mode&&(e.mode="hidden"),J.call(this,e,"cuechange",()=>eL.updateCues.call(this))}),(s&&this.language!==r||!e.includes(n))&&(eL.setLanguage.call(this,r),eL.toggle.call(this,t&&s)),this.elements&&H(this.elements.container,this.config.classNames.captions.enabled,!R.empty(e)),R.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&eE.setCaptionsMenu.call(this)},toggle(e,t=!0){if(!this.supported.ui)return;let{toggled:r}=this.captions,i=this.config.classNames.captions.active,n=R.nullOrUndefined(e)?!r:e;if(n!==r){if(t||(this.captions.active=n,this.storage.set({captions:n})),!this.language&&n&&!t){let s=eL.getTracks.call(this),a=eL.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=a.language,void eL.set.call(this,s.indexOf(a))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=n),H(this.elements.container,i,n),this.captions.toggled=n,eE.updateSetting.call(this,"captions"),et.call(this,this.media,n?"captionsenabled":"captionsdisabled")}setTimeout(()=>{n&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")})},set(e,t=!0){let r=eL.getTracks.call(this);if(-1!==e){if(R.number(e)){if(e in r){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;let i=r[e],{language:n}=i||{};this.captions.currentTrackNode=i,eE.updateSetting.call(this,"captions"),t||(this.captions.language=n,this.storage.set({language:n})),this.isVimeo&&this.embed.enableTextTrack(n),et.call(this,this.media,"languagechange")}eL.toggle.call(this,!0,t),this.isHTML5&&this.isVideo&&eL.updateCues.call(this)}else this.debug.warn("Track not found",e)}else this.debug.warn("Invalid caption argument",e)}else eL.toggle.call(this,!1,t)},setLanguage(e,t=!0){if(!R.string(e))return void this.debug.warn("Invalid language argument",e);let r=e.toLowerCase();this.captions.language=r;let i=eL.getTracks.call(this),n=eL.findTrack.call(this,[r]);eL.set.call(this,i.indexOf(n),t)},getTracks(e=!1){return Array.from((this.media||{}).textTracks||[]).filter(t=>!this.isHTML5||e||this.captions.meta.has(t)).filter(e=>["captions","subtitles"].includes(e.kind))},findTrack(e,t=!1){let r;let i=eL.getTracks.call(this),n=e=>Number((this.captions.meta.get(e)||{}).default),s=Array.from(i).sort((e,t)=>n(t)-n(e));return e.every(e=>!(r=s.find(t=>t.language===e))),r||(t?s[0]:void 0)},getCurrentTrack(){return eL.getTracks.call(this)[this.currentTrack]},getLabel(e){let t=e;return!R.track(t)&&G.textTracks&&this.captions.toggled&&(t=eL.getCurrentTrack.call(this)),R.track(t)?R.empty(t.label)?R.empty(t.language)?ew.get("enabled",this.config):e.language.toUpperCase():t.label:ew.get("disabled",this.config)},updateCues(e){if(!this.supported.ui)return;if(!R.element(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!R.nullOrUndefined(e)&&!Array.isArray(e))return void this.debug.warn("updateCues: Invalid input",e);let t=e;if(!t){let r=eL.getCurrentTrack.call(this);t=Array.from((r||{}).activeCues||[]).map(e=>e.getCueAsHTML()).map(ey)}let i=t.map(e=>e.trim()).join("\n");if(i!==this.elements.captions.innerHTML){F(this.elements.captions);let n=O("span",B(this.config.selectors.caption));n.innerHTML=i,this.elements.captions.appendChild(n),et.call(this,this.media,"cuechange")}}},eI={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.8/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},eM="picture-in-picture",ej={html5:"html5",youtube:"youtube",vimeo:"vimeo"},eO="video",eA=()=>{};class eN{constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):eA}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):eA}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):eA}}class eF{constructor(t){e(this,"onChange",()=>{if(!this.supported)return;let e=this.player.elements.buttons.fullscreen;R.element(e)&&(e.pressed=this.active);let t=this.target===this.player.media?this.target:this.player.elements.container;et.call(this.player,t,this.active?"enterfullscreen":"exitfullscreen",!0)}),e(this,"toggleFallback",(e=!1)=>{if(e?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",H(this.target,this.player.config.classNames.fullscreen.fallback,e),D.isIos){let t=document.head.querySelector('meta[name="viewport"]'),r="viewport-fit=cover";t||(t=document.createElement("meta")).setAttribute("name","viewport");let i=R.string(t.content)&&t.content.includes(r);e?(this.cleanupViewport=!i,i||(t.content+=`,${r}`)):this.cleanupViewport&&(t.content=t.content.split(",").filter(e=>e.trim()!==r).join(","))}this.onChange()}),e(this,"trapFocus",e=>{if(D.isIos||D.isIPadOS||!this.active||"Tab"!==e.key)return;let t=document.activeElement,r=$.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[i]=r,n=r[r.length-1];t!==n||e.shiftKey?t===i&&e.shiftKey&&(n.focus(),e.preventDefault()):(i.focus(),e.preventDefault())}),e(this,"update",()=>{if(this.supported){let e;e=this.forceFallback?"Fallback (forced)":eF.nativeSupported?"Native":"Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");H(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)}),e(this,"enter",()=>{this.supported&&(D.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!eF.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?R.empty(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))}),e(this,"exit",()=>{if(this.supported){if(D.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),en(this.player.play());else if(!eF.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!R.empty(this.prefix)){let e="moz"===this.prefix?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)}}),e(this,"toggle",()=>{this.active?this.exit():this.enter()}),this.player=t,this.prefix=eF.prefix,this.property=eF.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===t.config.fullscreen.fallback,this.player.elements.fullscreen=t.config.fullscreen.container&&function(e,t){let{prototype:r}=Element;return(r.closest||function(){let e=this;do{if(V.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}(this.player.elements.container,t.config.fullscreen.container),J.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":`${this.prefix}fullscreenchange`,()=>{this.onChange()}),J.call(this.player,this.player.elements.container,"dblclick",e=>{R.element(this.player.elements.controls)&&this.player.elements.controls.contains(e.target)||this.player.listeners.proxy(e,this.toggle,"fullscreen")}),J.call(this,this.player.elements.container,"keydown",e=>this.trapFocus(e)),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return eF.nativeSupported&&!this.forceFallback}static get prefix(){if(R.function(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some(t=>!(!R.function(document[`${t}ExitFullscreen`])&&!R.function(document[`${t}CancelFullScreen`]))&&(e=t,!0)),e}static get property(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,eF.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||eF.nativeSupported||!D.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!eF.nativeSupported||this.forceFallback)return z(this.target,this.player.config.classNames.fullscreen.fallback);let e=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return D.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}}function eq(e,t=1){return new Promise((r,i)=>{let n=new Image,s=()=>{delete n.onload,delete n.onerror,(n.naturalWidth>=t?r:i)(n)};Object.assign(n,{onload:s,onerror:s,src:e})})}let eB={addStyleHook(){H(this.elements.container,this.config.selectors.container.replace(".",""),!0),H(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(e=!1){e&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void eB.toggleNativeControls.call(this,!0);R.element(this.elements.controls)||(eE.inject.call(this),this.listeners.controls()),eB.toggleNativeControls.call(this),this.isHTML5&&eL.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,eE.updateVolume.call(this),eE.timeUpdate.call(this),eE.durationUpdate.call(this),eB.checkPlaying.call(this),H(this.elements.container,this.config.classNames.pip.supported,G.pip&&this.isHTML5&&this.isVideo),H(this.elements.container,this.config.classNames.airplay.supported,G.airplay&&this.isHTML5),H(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout(()=>{et.call(this,this.media,"ready")},0),eB.setTitle.call(this),this.poster&&eB.setPoster.call(this,this.poster,!1).catch(()=>{}),this.config.duration&&eE.durationUpdate.call(this),this.config.mediaMetadata&&eE.setMediaMetadata.call(this)},setTitle(){let e=ew.get("play",this.config);if(R.string(this.config.title)&&!R.empty(this.config.title)&&(e+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach(t=>{t.setAttribute("aria-label",e)}),this.isEmbed){let t=Z.call(this,"iframe");if(!R.element(t))return;let r=R.empty(this.config.title)?"video":this.config.title,i=ew.get("frameTitle",this.config);t.setAttribute("title",i.replace("{title}",r))}},togglePoster(e){H(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e,t=!0){return t&&this.poster?Promise.reject(Error("Poster already set")):(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),ei.call(this).then(()=>eq(e)).catch(t=>{throw e===this.poster&&eB.togglePoster.call(this,!1),t}).then(()=>{if(e!==this.poster)throw Error("setPoster cancelled by later call to setPoster")}).then(()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${e}')`,backgroundSize:""}),eB.togglePoster.call(this,!0),e)))},checkPlaying(e){H(this.elements.container,this.config.classNames.playing,this.playing),H(this.elements.container,this.config.classNames.paused,this.paused),H(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach(e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",ew.get(this.playing?"pause":"play",this.config))}),R.event(e)&&"timeupdate"===e.type||eB.toggleControls.call(this)},checkLoading(e){this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout(()=>{H(this.elements.container,this.config.classNames.loading,this.loading),eB.toggleControls.call(this)},this.loading?250:0)},toggleControls(e){let{controls:t}=this.elements;if(t&&this.config.hideControls){let r=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||r))}},migrateStyles(){Object.values({...this.media.style}).filter(e=>!R.empty(e)&&R.string(e)&&e.startsWith("--plyr")).forEach(e=>{this.elements.container.style.setProperty(e,this.media.style.getPropertyValue(e)),this.media.style.removeProperty(e)}),R.empty(this.media.style)&&this.media.removeAttribute("style")}};class eU{constructor(t){e(this,"firstTouch",()=>{let{player:e}=this,{elements:t}=e;e.touch=!0,H(t.container,e.config.classNames.isTouch,!0)}),e(this,"global",(e=!0)=>{let{player:t}=this;t.config.keyboard.global&&Y.call(t,window,"keydown keyup",this.handleKey,e,!1),Y.call(t,document.body,"click",this.toggleMenu,e),ee.call(t,document.body,"touchstart",this.firstTouch)}),e(this,"container",()=>{let{player:e}=this,{config:t,elements:r,timers:i}=e;!t.keyboard.global&&t.keyboard.focused&&J.call(e,r.container,"keydown keyup",this.handleKey,!1),J.call(e,r.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",t=>{let{controls:n}=r;n&&"enterfullscreen"===t.type&&(n.pressed=!1,n.hover=!1);let s=0;["touchstart","touchmove","mousemove"].includes(t.type)&&(eB.toggleControls.call(e,!0),s=e.touch?3e3:2e3),clearTimeout(i.controls),i.controls=setTimeout(()=>eB.toggleControls.call(e,!1),s)});let n=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;let t=r.wrapper,{active:i}=e.fullscreen,[n,s]=eu.call(e),a=eo(`aspect-ratio: ${n} / ${s}`);if(!i)return void(a?(t.style.width=null,t.style.height=null):(t.style.maxWidth=null,t.style.margin=null));let[o,l]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],c=o/l>n/s;a?(t.style.width=c?"auto":"100%",t.style.height=c?"100%":"auto"):(t.style.maxWidth=c?l/s*n+"px":null,t.style.margin=c?"0 auto":null)},s=()=>{clearTimeout(i.resized),i.resized=setTimeout(n,50)};J.call(e,r.container,"enterfullscreen exitfullscreen",t=>{let{target:i}=e.fullscreen;i===r.container&&(!e.isEmbed&&R.empty(e.config.ratio)||(n(),("enterfullscreen"===t.type?J:X).call(e,window,"resize",s)))})}),e(this,"media",()=>{let{player:e}=this,{elements:t}=e;if(J.call(e,e.media,"timeupdate seeking seeked",t=>eE.timeUpdate.call(e,t)),J.call(e,e.media,"durationchange loadeddata loadedmetadata",t=>eE.durationUpdate.call(e,t)),J.call(e,e.media,"ended",()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())}),J.call(e,e.media,"progress playing seeking seeked",t=>eE.updateProgress.call(e,t)),J.call(e,e.media,"volumechange",t=>eE.updateVolume.call(e,t)),J.call(e,e.media,"playing play pause ended emptied timeupdate",t=>eB.checkPlaying.call(e,t)),J.call(e,e.media,"waiting canplay seeked playing",t=>eB.checkLoading.call(e,t)),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){let r=Z.call(e,`.${e.config.classNames.video}`);if(!R.element(r))return;J.call(e,t.container,"click",i=>{([t.container,r].includes(i.target)||r.contains(i.target))&&(e.touch&&e.config.hideControls||(e.ended?(this.proxy(i,e.restart,"restart"),this.proxy(i,()=>{en(e.play())},"play")):this.proxy(i,()=>{en(e.togglePlay())},"play")))})}e.supported.ui&&e.config.disableContextMenu&&J.call(e,t.wrapper,"contextmenu",e=>{e.preventDefault()},!1),J.call(e,e.media,"volumechange",()=>{e.storage.set({volume:e.volume,muted:e.muted})}),J.call(e,e.media,"ratechange",()=>{eE.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})}),J.call(e,e.media,"qualitychange",t=>{eE.updateSetting.call(e,"quality",null,t.detail.quality)}),J.call(e,e.media,"ready qualitychange",()=>{eE.setDownloadUrl.call(e)});let i=e.config.events.concat(["keyup","keydown"]).join(" ");J.call(e,e.media,i,r=>{let{detail:i={}}=r;"error"===r.type&&(i=e.media.error),et.call(e,t.container,r.type,!0,i)})}),e(this,"proxy",(e,t,r)=>{let{player:i}=this,n=i.config.listeners[r],s=!0;R.function(n)&&(s=n.call(i,e)),!1!==s&&R.function(t)&&t.call(i,e)}),e(this,"bind",(e,t,r,i,n=!0)=>{let{player:s}=this,a=s.config.listeners[i],o=R.function(a);J.call(s,e,t,e=>this.proxy(e,r,i),n&&!o)}),e(this,"controls",()=>{let{player:e}=this,{elements:t}=e,r=D.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach(t=>{this.bind(t,"click",()=>{en(e.togglePlay())},"play")}),this.bind(t.buttons.restart,"click",e.restart,"restart"),this.bind(t.buttons.rewind,"click",()=>{e.lastSeekTime=Date.now(),e.rewind()},"rewind"),this.bind(t.buttons.fastForward,"click",()=>{e.lastSeekTime=Date.now(),e.forward()},"fastForward"),this.bind(t.buttons.mute,"click",()=>{e.muted=!e.muted},"mute"),this.bind(t.buttons.captions,"click",()=>e.toggleCaptions()),this.bind(t.buttons.download,"click",()=>{et.call(e,e.media,"download")},"download"),this.bind(t.buttons.fullscreen,"click",()=>{e.fullscreen.toggle()},"fullscreen"),this.bind(t.buttons.pip,"click",()=>{e.pip="toggle"},"pip"),this.bind(t.buttons.airplay,"click",e.airplay,"airplay"),this.bind(t.buttons.settings,"click",t=>{t.stopPropagation(),t.preventDefault(),eE.toggleMenu.call(e,t)},null,!1),this.bind(t.buttons.settings,"keyup",t=>{[" ","Enter"].includes(t.key)&&("Enter"!==t.key?(t.preventDefault(),t.stopPropagation(),eE.toggleMenu.call(e,t)):eE.focusFirstMenuItem.call(e,null,!0))},null,!1),this.bind(t.settings.menu,"keydown",t=>{"Escape"===t.key&&eE.toggleMenu.call(e,t)}),this.bind(t.inputs.seek,"mousedown mousemove",e=>{let r=t.progress.getBoundingClientRect(),i=100/r.width*(e.pageX-r.left);e.currentTarget.setAttribute("seek-value",i)}),this.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",t=>{let r=t.currentTarget,i="play-on-seeked";if(R.keyboardEvent(t)&&!["ArrowLeft","ArrowRight"].includes(t.key))return;e.lastSeekTime=Date.now();let n=r.hasAttribute(i),s=["mouseup","touchend","keyup"].includes(t.type);n&&s?(r.removeAttribute(i),en(e.play())):!s&&e.playing&&(r.setAttribute(i,""),e.pause())}),D.isIos){let i=$.call(e,'input[type="range"]');Array.from(i).forEach(e=>this.bind(e,r,e=>P(e.target)))}this.bind(t.inputs.seek,r,t=>{let r=t.currentTarget,i=r.getAttribute("seek-value");R.empty(i)&&(i=r.value),r.removeAttribute("seek-value"),e.currentTime=i/r.max*e.duration},"seek"),this.bind(t.progress,"mouseenter mouseleave mousemove",t=>eE.updateSeekTooltip.call(e,t)),this.bind(t.progress,"mousemove touchmove",t=>{let{previewThumbnails:r}=e;r&&r.loaded&&r.startMove(t)}),this.bind(t.progress,"mouseleave touchend click",()=>{let{previewThumbnails:t}=e;t&&t.loaded&&t.endMove(!1,!0)}),this.bind(t.progress,"mousedown touchstart",t=>{let{previewThumbnails:r}=e;r&&r.loaded&&r.startScrubbing(t)}),this.bind(t.progress,"mouseup touchend",t=>{let{previewThumbnails:r}=e;r&&r.loaded&&r.endScrubbing(t)}),D.isWebKit&&Array.from($.call(e,'input[type="range"]')).forEach(t=>{this.bind(t,"input",t=>eE.updateRangeFill.call(e,t.target))}),e.config.toggleInvert&&!R.element(t.display.duration)&&this.bind(t.display.currentTime,"click",()=>{0!==e.currentTime&&(e.config.invertTime=!e.config.invertTime,eE.timeUpdate.call(e))}),this.bind(t.inputs.volume,r,t=>{e.volume=t.target.value},"volume"),this.bind(t.controls,"mouseenter mouseleave",r=>{t.controls.hover=!e.touch&&"mouseenter"===r.type}),t.fullscreen&&Array.from(t.fullscreen.children).filter(e=>!e.contains(t.container)).forEach(r=>{this.bind(r,"mouseenter mouseleave",r=>{t.controls&&(t.controls.hover=!e.touch&&"mouseenter"===r.type)})}),this.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",e=>{t.controls.pressed=["mousedown","touchstart"].includes(e.type)}),this.bind(t.controls,"focusin",()=>{let{config:r,timers:i}=e;H(t.controls,r.classNames.noTransition,!0),eB.toggleControls.call(e,!0),setTimeout(()=>{H(t.controls,r.classNames.noTransition,!1)},0);let n=this.touch?3e3:4e3;clearTimeout(i.controls),i.controls=setTimeout(()=>eB.toggleControls.call(e,!1),n)}),this.bind(t.inputs.volume,"wheel",t=>{let r=t.webkitDirectionInvertedFromDevice,[i,n]=[t.deltaX,-t.deltaY].map(e=>r?-e:e),s=Math.sign(Math.abs(i)>Math.abs(n)?i:n);e.increaseVolume(s/50);let{volume:a}=e.media;(1===s&&a<1||-1===s&&a>0)&&t.preventDefault()},"volume",!1)}),this.player=t,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){var t;let{player:r}=this,{elements:i}=r,{key:n,type:s,altKey:a,ctrlKey:o,metaKey:l,shiftKey:c}=e,d="keydown"===s,u=d&&n===this.lastKey;if(!a&&!o&&!l&&!c&&n){if(d){let p=document.activeElement;if(R.element(p)){let{editable:h}=r.config.selectors,{seek:m}=i.inputs;if(p!==m&&V(p,h)||" "===e.key&&V(p,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(n)&&(e.preventDefault(),e.stopPropagation()),n){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":u||(t=parseInt(n,10),r.currentTime=r.duration/10*t);break;case" ":case"k":u||en(r.togglePlay());break;case"ArrowUp":r.increaseVolume(.1);break;case"ArrowDown":r.decreaseVolume(.1);break;case"m":u||(r.muted=!r.muted);break;case"ArrowRight":r.forward();break;case"ArrowLeft":r.rewind();break;case"f":r.fullscreen.toggle();break;case"c":u||r.toggleCaptions();break;case"l":r.loop=!r.loop}"Escape"===n&&!r.fullscreen.usingNative&&r.fullscreen.active&&r.fullscreen.toggle(),this.lastKey=n}else this.lastKey=null}}toggleMenu(e){eE.toggleMenu.call(this.player,e)}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self&&self;var eH=(s=o={exports:{}},o.exports,s.exports=function(){var e=function(){},t={},r={},i={};function n(e,t){if(e){var n=i[e];if(r[e]=t,n)for(;n.length;)n[0](e,t),n.splice(0,1)}}function s(t,r){t.call&&(t={success:t}),r.length?(t.error||e)(r):(t.success||e)(t)}function a(r,i,a){var o,l;if(i&&i.trim&&(o=i),l=(o?a:i)||{},o){if(o in t)throw"LoadJS";t[o]=!0}function c(t,i){!function(t,r,i){var n,s,a=(t=t.push?t:[t]).length,o=a,l=[];for(n=function(e,t,i){if("e"==t&&l.push(e),"b"==t){if(!i)return;l.push(e)}--a||r(l)},s=0;s<o;s++)!function t(r,i,n,s){var a,o,l=document,c=n.async,d=(n.numRetries||0)+1,u=n.before||e,p=r.replace(/[\?|#].*$/,""),h=r.replace(/^(css|img)!/,"");s=s||0,/(^css!|\.css$)/.test(p)?((o=l.createElement("link")).rel="stylesheet",o.href=h,(a="hideFocus"in o)&&o.relList&&(a=0,o.rel="preload",o.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(p)?(o=l.createElement("img")).src=h:((o=l.createElement("script")).src=r,o.async=void 0===c||c),o.onload=o.onerror=o.onbeforeload=function(e){var l=e.type[0];if(a)try{o.sheet.cssText.length||(l="e")}catch(c){18!=c.code&&(l="e")}if("e"==l){if((s+=1)<d)return t(r,i,n,s)}else if("preload"==o.rel&&"style"==o.as)return o.rel="stylesheet";i(r,l,e.defaultPrevented)},!1!==u(r,o)&&l.head.appendChild(o)}(t[s],n,i)}(r,function(e){s(l,e),t&&s({success:t,error:i},e),n(o,e)},l)}if(l.returnPromise)return new Promise(c);c()}return a.ready=function(e,t){return function(e,t){e=e.push?e:[e];var n,s,a,o=[],l=e.length,c=l;for(n=function(e,r){r.length&&o.push(e),--c||t(o)};l--;)(a=r[s=e[l]])?n(s,a):(i[s]=i[s]||[]).push(n)}(e,function(e){s(t,e)}),a},a.done=function(e){n(e,[])},a.reset=function(){t={},r={},i={}},a.isDefined=function(e){return e in t},a}(),o.exports);function ez(e){return new Promise((t,r)=>{eH(e,{success:t,error:r})})}function eV(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,et.call(this,this.media,e?"play":"pause"))}let e$={setup(){let e=this;H(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,ep.call(e),R.object(window.Vimeo)?e$.ready.call(e):ez(e.config.urls.vimeo.sdk).then(()=>{e$.ready.call(e)}).catch(t=>{e.debug.warn("Vimeo SDK (player.js) failed to load",t)})},ready(){var e;let t=this,r=t.config.vimeo,{premium:i,referrerPolicy:n,...s}=r,a=t.media.getAttribute("src"),o="";R.empty(a)?(a=t.media.getAttribute(t.config.attributes.embed.id),o=t.media.getAttribute(t.config.attributes.embed.hash)):o=function(e){let t=e.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return t&&5===t.length?t[4]:null}(a);let l=o?{h:o}:{};i&&Object.assign(s,{controls:!1,sidedock:!1});let c=eD({loop:t.config.loop.active,autoplay:t.autoplay,muted:t.muted,gesture:"media",playsinline:t.config.playsinline,...l,...s}),d=(e=a,R.empty(e)?null:R.number(Number(e))?e:e.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:e),u=O("iframe"),p=ef(t.config.urls.vimeo.iframe,d,c);if(u.setAttribute("src",p),u.setAttribute("allowfullscreen",""),u.setAttribute("allow","autoplay; fullscreen; picture-in-picture; encrypted-media; accelerometer; gyroscope"),R.empty(n)||u.setAttribute("referrerPolicy",n),i||!r.customControls)u.setAttribute("data-poster",t.poster),t.media=q(u,t.media);else{let h=O("div",{class:t.config.classNames.embedContainer,"data-poster":t.poster});h.appendChild(u),t.media=q(h,t.media)}r.customControls||eS(ef(t.config.urls.vimeo.api,p)).then(e=>{!R.empty(e)&&e.thumbnail_url&&eB.setPoster.call(t,e.thumbnail_url).catch(()=>{})}),t.embed=new window.Vimeo.Player(u,{autopause:t.config.autopause,muted:t.muted}),t.media.paused=!0,t.media.currentTime=0,t.supported.ui&&t.embed.disableTextTrack(),t.media.play=()=>(eV.call(t,!0),t.embed.play()),t.media.pause=()=>(eV.call(t,!1),t.embed.pause()),t.media.stop=()=>{t.pause(),t.currentTime=0};let{currentTime:m}=t.media;Object.defineProperty(t.media,"currentTime",{get:()=>m,set(e){let{embed:r,media:i,paused:n,volume:s}=t,a=n&&!r.hasPlayed;i.seeking=!0,et.call(t,i,"seeking"),Promise.resolve(a&&r.setVolume(0)).then(()=>r.setCurrentTime(e)).then(()=>a&&r.pause()).then(()=>a&&r.setVolume(s)).catch(()=>{})}});let f=t.config.speed.selected;Object.defineProperty(t.media,"playbackRate",{get:()=>f,set(e){t.embed.setPlaybackRate(e).then(()=>{f=e,et.call(t,t.media,"ratechange")}).catch(()=>{t.options.speed=[1]})}});let{volume:g}=t.config;Object.defineProperty(t.media,"volume",{get:()=>g,set(e){t.embed.setVolume(e).then(()=>{g=e,et.call(t,t.media,"volumechange")})}});let{muted:v}=t.config;Object.defineProperty(t.media,"muted",{get:()=>v,set(e){let r=!!R.boolean(e)&&e;t.embed.setMuted(!!r||t.config.muted).then(()=>{v=r,et.call(t,t.media,"volumechange")})}});let y,{loop:b}=t.config;Object.defineProperty(t.media,"loop",{get:()=>b,set(e){let r=R.boolean(e)?e:t.config.loop.active;t.embed.setLoop(r).then(()=>{b=r})}}),t.embed.getVideoUrl().then(e=>{y=e,eE.setDownloadUrl.call(t)}).catch(e=>{this.debug.warn(e)}),Object.defineProperty(t.media,"currentSrc",{get:()=>y}),Object.defineProperty(t.media,"ended",{get:()=>t.currentTime===t.duration}),Promise.all([t.embed.getVideoWidth(),t.embed.getVideoHeight()]).then(e=>{let[r,i]=e;t.embed.ratio=eh(r,i),ep.call(this)}),t.embed.setAutopause(t.config.autopause).then(e=>{t.config.autopause=e}),t.embed.getVideoTitle().then(e=>{t.config.title=e,eB.setTitle.call(this)}),t.embed.getCurrentTime().then(e=>{m=e,et.call(t,t.media,"timeupdate")}),t.embed.getDuration().then(e=>{t.media.duration=e,et.call(t,t.media,"durationchange")}),t.embed.getTextTracks().then(e=>{t.media.textTracks=e,eL.setup.call(t)}),t.embed.on("cuechange",({cues:e=[]})=>{let r=e.map(e=>(function(e){let t=document.createDocumentFragment(),r=document.createElement("div");return t.appendChild(r),r.innerHTML=e,t.firstChild.innerText})(e.text));eL.updateCues.call(t,r)}),t.embed.on("loaded",()=>{t.embed.getPaused().then(e=>{eV.call(t,!e),e||et.call(t,t.media,"playing")}),R.element(t.embed.element)&&t.supported.ui&&t.embed.element.setAttribute("tabindex",-1)}),t.embed.on("bufferstart",()=>{et.call(t,t.media,"waiting")}),t.embed.on("bufferend",()=>{et.call(t,t.media,"playing")}),t.embed.on("play",()=>{eV.call(t,!0),et.call(t,t.media,"playing")}),t.embed.on("pause",()=>{eV.call(t,!1)}),t.embed.on("timeupdate",e=>{t.media.seeking=!1,m=e.seconds,et.call(t,t.media,"timeupdate")}),t.embed.on("progress",e=>{t.media.buffered=e.percent,et.call(t,t.media,"progress"),1===parseInt(e.percent,10)&&et.call(t,t.media,"canplaythrough"),t.embed.getDuration().then(e=>{e!==t.media.duration&&(t.media.duration=e,et.call(t,t.media,"durationchange"))})}),t.embed.on("seeked",()=>{t.media.seeking=!1,et.call(t,t.media,"seeked")}),t.embed.on("ended",()=>{t.media.paused=!0,et.call(t,t.media,"ended")}),t.embed.on("error",e=>{t.media.error=e,et.call(t,t.media,"error")}),r.customControls&&setTimeout(()=>eB.build.call(t),0)}};function eZ(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,et.call(this,this.media,e?"play":"pause"))}let eW={setup(){if(H(this.elements.wrapper,this.config.classNames.embed,!0),R.object(window.YT)&&R.function(window.YT.Player))eW.ready.call(this);else{let e=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{R.function(e)&&e(),eW.ready.call(this)},ez(this.config.urls.youtube.sdk).catch(e=>{this.debug.warn("YouTube API failed to load",e)})}},getTitle(e){eS(ef(this.config.urls.youtube.api,e)).then(e=>{if(R.object(e)){let{title:t,height:r,width:i}=e;this.config.title=t,eB.setTitle.call(this),this.embed.ratio=eh(i,r)}ep.call(this)}).catch(()=>{ep.call(this)})},ready(){var e;let t=this,r=t.config.youtube,i=t.media&&t.media.getAttribute("id");if(!R.empty(i)&&i.startsWith("youtube-"))return;let n=t.media.getAttribute("src");R.empty(n)&&(n=t.media.getAttribute(this.config.attributes.embed.id));let s=(e=n,R.empty(e)?null:e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:e),a=O("div",{id:`${t.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":r.customControls?t.poster:void 0});if(t.media=q(a,t.media),r.customControls){let o=e=>`https://i.ytimg.com/vi/${s}/${e}default.jpg`;eq(o("maxres"),121).catch(()=>eq(o("sd"),121)).catch(()=>eq(o("hq"))).then(e=>eB.setPoster.call(t,e.src)).then(e=>{e.includes("maxres")||(t.elements.poster.style.backgroundSize="cover")}).catch(()=>{})}t.embed=new window.YT.Player(t.media,{videoId:s,host:r.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0,playerVars:I({},{autoplay:t.config.autoplay?1:0,hl:t.config.hl,controls:t.supported.ui&&r.customControls?0:1,disablekb:1,playsinline:t.config.playsinline&&!t.config.fullscreen.iosNative?1:0,cc_load_policy:t.captions.active?1:0,cc_lang_pref:t.config.captions.language,widget_referrer:window?window.location.href:null},r),events:{onError(e){if(!t.media.error){let r=e.data;t.media.error={code:r,message:({2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."})[r]||"An unknown error occurred"},et.call(t,t.media,"error")}},onPlaybackRateChange(e){let r=e.target;t.media.playbackRate=r.getPlaybackRate(),et.call(t,t.media,"ratechange")},onReady(e){if(R.function(t.media.play))return;let i=e.target;eW.getTitle.call(t,s),t.media.play=()=>{eZ.call(t,!0),i.playVideo()},t.media.pause=()=>{eZ.call(t,!1),i.pauseVideo()},t.media.stop=()=>{i.stopVideo()},t.media.duration=i.getDuration(),t.media.paused=!0,t.media.currentTime=0,Object.defineProperty(t.media,"currentTime",{get:()=>Number(i.getCurrentTime()),set(e){t.paused&&!t.embed.hasPlayed&&t.embed.mute(),t.media.seeking=!0,et.call(t,t.media,"seeking"),i.seekTo(e)}}),Object.defineProperty(t.media,"playbackRate",{get:()=>i.getPlaybackRate(),set(e){i.setPlaybackRate(e)}});let{volume:n}=t.config;Object.defineProperty(t.media,"volume",{get:()=>n,set(e){n=e,i.setVolume(100*n),et.call(t,t.media,"volumechange")}});let{muted:a}=t.config;Object.defineProperty(t.media,"muted",{get:()=>a,set(e){let r=R.boolean(e)?e:a;a=r,i[r?"mute":"unMute"](),i.setVolume(100*n),et.call(t,t.media,"volumechange")}}),Object.defineProperty(t.media,"currentSrc",{get:()=>i.getVideoUrl()}),Object.defineProperty(t.media,"ended",{get:()=>t.currentTime===t.duration});let o=i.getAvailablePlaybackRates();t.options.speed=o.filter(e=>t.config.speed.options.includes(e)),t.supported.ui&&r.customControls&&t.media.setAttribute("tabindex",-1),et.call(t,t.media,"timeupdate"),et.call(t,t.media,"durationchange"),clearInterval(t.timers.buffering),t.timers.buffering=setInterval(()=>{t.media.buffered=i.getVideoLoadedFraction(),(null===t.media.lastBuffered||t.media.lastBuffered<t.media.buffered)&&et.call(t,t.media,"progress"),t.media.lastBuffered=t.media.buffered,1===t.media.buffered&&(clearInterval(t.timers.buffering),et.call(t,t.media,"canplaythrough"))},200),r.customControls&&setTimeout(()=>eB.build.call(t),50)},onStateChange(e){let i=e.target;switch(clearInterval(t.timers.playing),t.media.seeking&&[1,2].includes(e.data)&&(t.media.seeking=!1,et.call(t,t.media,"seeked")),e.data){case -1:et.call(t,t.media,"timeupdate"),t.media.buffered=i.getVideoLoadedFraction(),et.call(t,t.media,"progress");break;case 0:eZ.call(t,!1),t.media.loop?(i.stopVideo(),i.playVideo()):et.call(t,t.media,"ended");break;case 1:r.customControls&&!t.config.autoplay&&t.media.paused&&!t.embed.hasPlayed?t.media.pause():(eZ.call(t,!0),et.call(t,t.media,"playing"),t.timers.playing=setInterval(()=>{et.call(t,t.media,"timeupdate")},50),t.media.duration!==i.getDuration()&&(t.media.duration=i.getDuration(),et.call(t,t.media,"durationchange")));break;case 2:t.muted||t.embed.unMute(),eZ.call(t,!1);break;case 3:et.call(t,t.media,"waiting")}et.call(t,t.elements.container,"statechange",!1,{code:e.data})}}})}},eK={setup(){this.media?(H(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),H(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&H(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=O("div",{class:this.config.classNames.video}),M(this.media,this.elements.wrapper),this.elements.poster=O("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?em.setup.call(this):this.isYouTube?eW.setup.call(this):this.isVimeo&&e$.setup.call(this)):this.debug.warn("No media element found!")}};class eG{constructor(t){e(this,"load",()=>{this.enabled&&(R.object(window.google)&&R.object(window.google.ima)?this.ready():ez(this.player.config.urls.googleIMA.sdk).then(()=>{this.ready()}).catch(()=>{this.trigger("error",Error("Google IMA SDK failed to load"))}))}),e(this,"ready",()=>{this.enabled||(this.manager&&this.manager.destroy(),this.elements.displayContainer&&this.elements.displayContainer.destroy(),this.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then(()=>{this.clearSafetyTimer("onAdsManagerLoaded()")}),this.listeners(),this.setupIMA()}),e(this,"setupIMA",()=>{this.elements.container=O("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e=>this.onAdsManagerLoaded(e),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e=>this.onAdError(e),!1),this.requestAds()}),e(this,"requestAds",()=>{let{container:e}=this.player.elements;try{let t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(r){this.onAdError(r)}}),e(this,"pollCountdown",(e=!1)=>{if(!e)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval(()=>{let e=eR(Math.max(this.manager.getRemainingTime(),0)),t=`${ew.get("advertisement",this.player.config)} - ${e}`;this.elements.container.setAttribute("data-badge-text",t)},100)}),e(this,"onAdsManagerLoaded",e=>{if(!this.enabled)return;let t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.manager=e.getAdsManager(this.player,t),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e=>this.onAdError(e)),Object.keys(google.ima.AdEvent.Type).forEach(e=>{this.manager.addEventListener(google.ima.AdEvent.Type[e],e=>this.onAdEvent(e))}),this.trigger("loaded")}),e(this,"addCuePoints",()=>{R.empty(this.cuePoints)||this.cuePoints.forEach(e=>{if(0!==e&&-1!==e&&e<this.player.duration){let t=this.player.elements.progress;if(R.element(t)){let r=100/this.player.duration*e,i=O("span",{class:this.player.config.classNames.cues});i.style.left=`${r.toString()}%`,t.appendChild(i)}}})}),e(this,"onAdEvent",e=>{let{container:t}=this.player.elements,r=e.getAd(),i=e.getAdData();switch((e=>{et.call(this.player,this.player.media,`ads${e.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),r.isLinear()||(r.width=t.offsetWidth,r.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:i.adError&&this.player.debug.warn(`Non-fatal ad error: ${i.adError.getMessage()}`)}}),e(this,"onAdError",e=>{this.cancel(),this.player.debug.warn("Ads error",e)}),e(this,"listeners",()=>{let e;let{container:t}=this.player.elements;this.player.on("canplay",()=>{this.addCuePoints()}),this.player.on("ended",()=>{this.loader.contentComplete()}),this.player.on("timeupdate",()=>{e=this.player.currentTime}),this.player.on("seeked",()=>{let t=this.player.currentTime;R.empty(this.cuePoints)||this.cuePoints.forEach((r,i)=>{e<r&&r<t&&(this.manager.discardAdBreak(),this.cuePoints.splice(i,1))})}),window.addEventListener("resize",()=>{this.manager&&this.manager.resize(t.offsetWidth,t.offsetHeight,google.ima.ViewMode.NORMAL)})}),e(this,"play",()=>{let{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then(()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(t){this.onAdError(t)}}).catch(()=>{})}),e(this,"resumeContent",()=>{this.elements.container.style.zIndex="",this.playing=!1,en(this.player.media.play())}),e(this,"pauseContent",()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()}),e(this,"cancel",()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()}),e(this,"loadAds",()=>{this.managerPromise.then(()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise(e=>{this.on("loaded",e),this.player.debug.log(this.manager)}),this.initialized=!1,this.requestAds()}).catch(()=>{})}),e(this,"trigger",(e,...t)=>{let r=this.events[e];R.array(r)&&r.forEach(e=>{R.function(e)&&e.apply(this,t)})}),e(this,"on",(e,t)=>(R.array(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this)),e(this,"startSafetyTimer",(e,t)=>{this.player.debug.log(`Safety timer invoked from: ${t}`),this.safetyTimer=setTimeout(()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")},e)}),e(this,"clearSafetyTimer",e=>{R.nullOrUndefined(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)}),this.player=t,this.config=t.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise((e,t)=>{this.on("loaded",e),this.on("error",t)}),this.load()}get enabled(){let{config:e}=this;return this.player.isHTML5&&this.player.isVideo&&e.enabled&&(!R.empty(e.publisherId)||R.url(e.tagUrl))}get tagUrl(){let{config:e}=this;return R.url(e.tagUrl)?e.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${eD({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId})}`}}function eQ(e=0,t=0,r=255){return Math.min(Math.max(e,t),r)}let eY=e=>{let t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach(e=>{let r={};e.split(/\r\n|\n|\r/).forEach(e=>{if(R.number(r.startTime)){if(!R.empty(e.trim())&&R.empty(r.text)){let t=e.trim().split("#xywh=");[r.text]=t,t[1]&&([r.x,r.y,r.w,r.h]=t[1].split(","))}}else{let i=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);i&&(r.startTime=60*Number(i[1]||0)*60+60*Number(i[2])+Number(i[3])+Number(`0.${i[4]}`),r.endTime=60*Number(i[6]||0)*60+60*Number(i[7])+Number(i[8])+Number(`0.${i[9]}`))}}),r.text&&t.push(r)}),t},eJ=(e,t)=>{let r={};return e>t.width/t.height?(r.width=t.width,r.height=1/e*t.width):(r.height=t.height,r.width=e*t.height),r};class eX{constructor(t){e(this,"load",()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then(()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)})}),e(this,"getThumbnails",()=>new Promise(e=>{let{src:t}=this.player.config.previewThumbnails;if(R.empty(t))throw Error("Missing previewThumbnails.src config attribute");let r=()=>{this.thumbnails.sort((e,t)=>e.height-t.height),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(R.function(t))t(e=>{this.thumbnails=e,r()});else{let i=(R.string(t)?[t]:t).map(e=>this.getThumbnail(e));Promise.all(i).then(r)}})),e(this,"getThumbnail",e=>new Promise(t=>{eS(e).then(r=>{let i={frames:eY(r),height:null,urlPrefix:""};i.frames[0].text.startsWith("/")||i.frames[0].text.startsWith("http://")||i.frames[0].text.startsWith("https://")||(i.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));let n=new Image;n.onload=()=>{i.height=n.naturalHeight,i.width=n.naturalWidth,this.thumbnails.push(i),t()},n.src=i.urlPrefix+i.frames[0].text})})),e(this,"startMove",e=>{if(this.loaded&&R.event(e)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t,r;let i=this.player.elements.progress.getBoundingClientRect(),n=100/i.width*(e.pageX-i.left);this.seekTime=this.player.media.duration*(n/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=eR(this.seekTime);let s=null===(t=this.player.config.markers)||void 0===t||null===(r=t.points)||void 0===r?void 0:r.find(({time:e})=>e===Math.round(this.seekTime));s&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${s.label}<br>`)}this.showImageAtCurrentTime()}}),e(this,"endMove",()=>{this.toggleThumbContainer(!1,!0)}),e(this,"startScrubbing",e=>{(R.nullOrUndefined(e.button)||!1===e.button||0===e.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))}),e(this,"endScrubbing",()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):ee.call(this.player,this.player.media,"timeupdate",()=>{this.mouseDown||this.toggleScrubbingContainer(!1)})}),e(this,"listeners",()=>{this.player.on("play",()=>{this.toggleThumbContainer(!1,!0)}),this.player.on("seeked",()=>{this.toggleThumbContainer(!1)}),this.player.on("timeupdate",()=>{this.lastTime=this.player.media.currentTime})}),e(this,"render",()=>{this.elements.thumb.container=O("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=O("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);let e=O("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=O("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(e),R.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=O("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)}),e(this,"destroy",()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()}),e(this,"showImageAtCurrentTime",()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();let e=this.thumbnails[0].frames.findIndex(e=>this.seekTime>=e.startTime&&this.seekTime<=e.endTime),t=e>=0,r=0;this.mouseDown||this.toggleThumbContainer(t),t&&(this.thumbnails.forEach((t,i)=>{this.loadedImages.includes(t.frames[e].text)&&(r=i)}),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(r)))}),e(this,"loadImage",(e=0)=>{let t=this.showingThumb,r=this.thumbnails[e],{urlPrefix:i}=r,n=r.frames[t],s=r.frames[t].text,a=i+s;if(this.currentImageElement&&this.currentImageElement.dataset.filename===s)this.showImage(this.currentImageElement,n,e,t,s,!1),this.currentImageElement.dataset.index=t,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);let o=new Image;o.src=a,o.dataset.index=t,o.dataset.filename=s,this.showingThumbFilename=s,this.player.debug.log(`Loading image: ${a}`),o.onload=()=>this.showImage(o,n,e,t,s,!0),this.loadingImage=o,this.removeOldImages(o)}}),e(this,"showImage",(e,t,r,i,n,s=!0)=>{this.player.debug.log(`Showing thumb: ${n}. num: ${i}. qual: ${r}. newimg: ${s}`),this.setImageSizeAndOffset(e,t),s&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(n)||this.loadedImages.push(n)),this.preloadNearby(i,!0).then(this.preloadNearby(i,!1)).then(this.getHigherQuality(r,e,t,n))}),e(this,"removeOldImages",e=>{Array.from(this.currentImageContainer.children).forEach(t=>{if("img"!==t.tagName.toLowerCase())return;let r=this.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;let{currentImageContainer:i}=this;setTimeout(()=>{i.removeChild(t),this.player.debug.log(`Removing thumb: ${t.dataset.filename}`)},r)}})}),e(this,"preloadNearby",(e,t=!0)=>new Promise(r=>{setTimeout(()=>{let i=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===i){let n;n=t?this.thumbnails[0].frames.slice(e):this.thumbnails[0].frames.slice(0,e).reverse();let s=!1;n.forEach(e=>{let t=e.text;if(t!==i&&!this.loadedImages.includes(t)){s=!0,this.player.debug.log(`Preloading thumb filename: ${t}`);let{urlPrefix:n}=this.thumbnails[0],a=new Image;a.src=n+t,a.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${t}`),this.loadedImages.includes(t)||this.loadedImages.push(t),r()}}}),s||r()}},300)})),e(this,"getHigherQuality",(e,t,r,i)=>{if(e<this.thumbnails.length-1){let n=t.naturalHeight;this.usingSprites&&(n=r.h),n<this.thumbContainerHeight&&setTimeout(()=>{this.showingThumbFilename===i&&(this.player.debug.log(`Showing higher quality thumb for: ${i}`),this.loadImage(e+1))},300)}}),e(this,"toggleThumbContainer",(e=!1,t=!1)=>{let r=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(r,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)}),e(this,"toggleScrubbingContainer",(e=!1)=>{let t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)}),e(this,"determineContainerAutoSizing",()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)}),e(this,"setThumbContainerSizeAndPos",()=>{let{imageContainer:e}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){let t=Math.floor(e.clientHeight*this.thumbAspectRatio);e.style.width=`${t}px`}else if(e.clientHeight<20&&e.clientWidth>20){let r=Math.floor(e.clientWidth/this.thumbAspectRatio);e.style.height=`${r}px`}}else{let i=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);e.style.height=`${this.thumbContainerHeight}px`,e.style.width=`${i}px`}this.setThumbContainerPos()}),e(this,"setThumbContainerPos",()=>{let e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),{container:r}=this.elements.thumb,i=t.left-e.left+10,n=t.right-e.left-r.clientWidth-10,s=this.mousePosX-e.left-r.clientWidth/2,a=eQ(s,i,n);r.style.left=`${a}px`,r.style.setProperty("--preview-arrow-offset",s-a+"px")}),e(this,"setScrubbingContainerSize",()=>{let{width:e,height:t}=eJ(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${t}px`}),e(this,"setImageSizeAndOffset",(e,t)=>{if(!this.usingSprites)return;let r=this.thumbContainerHeight/t.h;e.style.height=e.naturalHeight*r+"px",e.style.width=e.naturalWidth*r+"px",e.style.left=`-${t.x*r}px`,e.style.top=`-${t.y*r}px`}),this.player=t,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){let{height:e}=eJ(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}let e0={insertElements(e,t){R.string(t)?A(e,this.media,{src:t}):R.array(t)&&t.forEach(t=>{A(e,this.media,t)})},change(e){L(e,"sources.length")?(em.cancelRequests.call(this),this.destroy.call(this,()=>{this.options.quality=[],N(this.media),this.media=null,R.element(this.elements.container)&&this.elements.container.removeAttribute("class");let{sources:t,type:r}=e,[{provider:i=ej.html5,src:n}]=t;Object.assign(this,{provider:i,type:r,supported:G.check(r,i,this.config.playsinline),media:O("html5"===i?r:"div","html5"===i?{}:{src:n})}),this.elements.container.appendChild(this.media),R.boolean(e.autoplay)&&(this.config.autoplay=e.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),R.empty(e.poster)||(this.poster=e.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),eB.addStyleHook.call(this),this.isHTML5&&e0.insertElements.call(this,"source",t),this.config.title=e.title,eK.setup.call(this),this.isHTML5&&Object.keys(e).includes("tracks")&&e0.insertElements.call(this,"track",e.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&eB.build.call(this),this.isHTML5&&this.media.load(),R.empty(e.previewThumbnails)||(Object.assign(this.config.previewThumbnails,e.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new eX(this))),this.fullscreen.update()},!0)):this.debug.warn("Invalid source format")}};class e1{constructor(t,r){if(e(this,"play",()=>R.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then(()=>this.ads.play()).catch(()=>en(this.media.play())),this.media.play()):null),e(this,"pause",()=>this.playing&&R.function(this.media.pause)?this.media.pause():null),e(this,"togglePlay",e=>(R.boolean(e)?e:!this.playing)?this.play():this.pause()),e(this,"stop",()=>{this.isHTML5?(this.pause(),this.restart()):R.function(this.media.stop)&&this.media.stop()}),e(this,"restart",()=>{this.currentTime=0}),e(this,"rewind",e=>{this.currentTime-=R.number(e)?e:this.config.seekTime}),e(this,"forward",e=>{this.currentTime+=R.number(e)?e:this.config.seekTime}),e(this,"increaseVolume",e=>{let t=this.media.muted?0:this.volume;this.volume=t+(R.number(e)?e:0)}),e(this,"decreaseVolume",e=>{this.increaseVolume(-e)}),e(this,"airplay",()=>{G.airplay&&this.media.webkitShowPlaybackTargetPicker()}),e(this,"toggleControls",e=>{if(this.supported.ui&&!this.isAudio){let t=z(this.elements.container,this.config.classNames.hideControls),r=H(this.elements.container,this.config.classNames.hideControls,void 0===e?void 0:!e);return r&&R.array(this.config.controls)&&this.config.controls.includes("settings")&&!R.empty(this.config.settings)&&eE.toggleMenu.call(this,!1),r!==t&&et.call(this,this.media,r?"controlshidden":"controlsshown"),!r}return!1}),e(this,"on",(e,t)=>{J.call(this,this.elements.container,e,t)}),e(this,"once",(e,t)=>{ee.call(this,this.elements.container,e,t)}),e(this,"off",(e,t)=>{X(this.elements.container,e,t)}),e(this,"destroy",(e,t=!1)=>{if(!this.ready)return;let r=()=>{document.body.style.overflow="",this.embed=null,t?(Object.keys(this.elements).length&&(N(this.elements.buttons.play),N(this.elements.captions),N(this.elements.controls),N(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),R.function(e)&&e()):(er.call(this),em.cancelRequests.call(this),q(this.elements.original,this.elements.container),et.call(this,this.elements.original,"destroyed",!0),R.function(e)&&e.call(this.elements.original),this.ready=!1,setTimeout(()=>{this.elements=null,this.media=null},200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(eB.toggleNativeControls.call(this,!0),r()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&R.function(this.embed.destroy)&&this.embed.destroy(),r()):this.isVimeo&&(null!==this.embed&&this.embed.unload().then(r),setTimeout(r,200))}),e(this,"supports",e=>G.mime.call(this,e)),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=G.touch,this.media=t,R.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||R.nodeList(this.media)||R.array(this.media))&&(this.media=this.media[0]),this.config=I({},eI,e1.defaults,r||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch(e){return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new eN(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",G),R.nullOrUndefined(this.media)||!R.element(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!G.check().api)return void this.debug.error("Setup failed: no support");let i=this.media.cloneNode(!0);i.autoplay=!1,this.elements.original=i;let n=this.media.tagName.toLowerCase(),s=null,a=null;switch(n){case"div":if(s=this.media.querySelector("iframe"),R.element(s)){var o;if(a=eP(s.getAttribute("src")),this.provider=(o=a.toString(),/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(o)?ej.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(o)?ej.vimeo:null),this.elements.container=this.media,this.media=s,this.elements.container.className="",a.search.length){let l=["1","true"];l.includes(a.searchParams.get("autoplay"))&&(this.config.autoplay=!0),l.includes(a.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=l.includes(a.searchParams.get("playsinline")),this.config.youtube.hl=a.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(R.empty(this.provider)||!Object.values(ej).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=eO;break;case"video":case"audio":this.type=n,this.provider=ej.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=G.check(this.type,this.provider),this.supported.api?(this.eventListeners=[],this.listeners=new eU(this),this.storage=new e_(this),this.media.plyr=this,R.element(this.elements.container)||(this.elements.container=O("div"),M(this.media,this.elements.container)),eB.migrateStyles.call(this),eB.addStyleHook.call(this),eK.setup.call(this),this.config.debug&&J.call(this,this.elements.container,this.config.events.join(" "),e=>{this.debug.log(`event: ${e.type}`)}),this.fullscreen=new eF(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&eB.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new eG(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",()=>en(this.play())),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new eX(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===ej.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===ej.youtube}get isVimeo(){return this.provider===ej.vimeo}get isVideo(){return this.type===eO}get isAudio(){return"audio"===this.type}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&0===this.currentTime)}get ended(){return Boolean(this.media.ended)}set currentTime(e){if(!this.duration)return;let t=R.number(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){let{buffered:e}=this.media;return R.number(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){let e=parseFloat(this.config.duration),t=(this.media||{}).duration,r=R.number(t)&&t!==1/0?t:0;return e||r}set volume(e){let t=e;R.string(t)&&(t=Number(t)),R.number(t)||(t=this.storage.get("volume")),R.number(t)||({volume:t}=this.config),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!R.empty(e)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(e){let t=e;R.boolean(t)||(t=this.storage.get("muted")),R.boolean(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let t=null;R.number(e)&&(t=e),R.number(t)||(t=this.storage.get("speed")),R.number(t)||(t=this.config.speed.selected);let{minimumSpeed:r,maximumSpeed:i}=this;t=eQ(t,r,i),this.config.speed.selected=t,setTimeout(()=>{this.media&&(this.media.playbackRate=t)},0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){let t=this.config.quality,r=this.options.quality;if(!r.length)return;let i=[!R.empty(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(R.number),n=!0;if(!r.includes(i)){let s=ea(r,i);this.debug.warn(`Unsupported quality option: ${i}, using ${s} instead`),i=s,n=!1}t.selected=i,this.media.quality=i,n&&this.storage.set({quality:i})}get quality(){return this.media.quality}set loop(e){let t=R.boolean(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return Boolean(this.media.loop)}set source(e){e0.change.call(this,e)}get source(){return this.media.currentSrc}get download(){let{download:e}=this.config.urls;return R.url(e)?e:this.source}set download(e){R.url(e)&&(this.config.urls.download=e,eE.setDownloadUrl.call(this))}set poster(e){this.isVideo?eB.setPoster.call(this,e,!1).catch(()=>{}):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;let e=ed(eu.call(this));return R.array(e)?e.join(":"):e}set ratio(e){this.isVideo?R.string(e)&&ec(e)?(this.config.ratio=ed(e),ep.call(this)):this.debug.error(`Invalid aspect ratio specified (${e})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(e){this.config.autoplay=R.boolean(e)?e:this.config.autoplay}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(e){eL.toggle.call(this,e,!1)}set currentTrack(e){eL.set.call(this,e,!1),eL.setup.call(this)}get currentTrack(){let{toggled:e,currentTrack:t}=this.captions;return e?t:-1}set language(e){eL.setLanguage.call(this,e,!1)}get language(){return(eL.getCurrentTrack.call(this)||{}).language}set pip(e){if(!G.pip)return;let t=R.boolean(e)?e:!this.pip;R.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?eM:"inline"),R.function(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return G.pip?R.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===eM:null}setPreviewThumbnails(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new eX(this))}static supported(e,t){return G.check(e,t)}static loadSprite(e,t){return ex(e,t)}static setup(e,t={}){let r=null;return R.string(e)?r=Array.from(document.querySelectorAll(e)):R.nodeList(e)?r=Array.from(e):R.array(e)&&(r=e.filter(R.element)),R.empty(r)?null:r.map(e=>new e1(e,t))}}return e1.defaults=JSON.parse(JSON.stringify(eI)),e1}())},92703:function(e,t,r){"use strict";var i=r(50414);function n(){}function s(){}s.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,s,a){if(a!==i){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:n};return r.PropTypes=r,r}},45697:function(e,t,r){e.exports=r(92703)()},50414:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},54375:function(e,t,r){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let i;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:r.g):e=>(i||(i=Promise.resolve())).then(e).catch(e=>setTimeout(()=>{throw e},0))},96692:function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=(null!=e.raddr?" raddr %s rport %d":"%v%v")+(null!=e.tcptype?" tcptype %s":"%v"),null!=e.generation&&(t+=" generation %d"),t+=(null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){return"mediaclk:"+((null!=e.id?"id=%s %s":"%v%s")+(null!=e.mediaClockValue?"=%s":"")+(null!=e.rateNumerator?" rate=%s":""))+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach(function(e){t[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},70766:function(e,t,r){var i=r(70962),n=r(95776);t.write=n,t.parse=i.parse,t.parseParams=i.parseParams,t.parseFmtpConfig=i.parseFmtpConfig,t.parsePayloads=i.parsePayloads,t.parseRemoteCandidates=i.parseRemoteCandidates,t.parseImageAttributes=i.parseImageAttributes,t.parseSimulcastStreamList=i.parseSimulcastStreamList},70962:function(e,t,r){var i=function(e){return String(Number(e))===e?Number(e):e},n=function(e,t,r,n){if(n&&!r)t[n]=i(e[1]);else for(var s=0;s<r.length;s+=1)null!=e[s+1]&&(t[r[s]]=i(e[s+1]))},s=function(e,t,r){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var s=e.push?{}:i?t[e.name]:t;n(r.match(e.reg),s,e.names,e.name),e.push&&t[e.push].push(s)},a=r(96692),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],i=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach(function(e){var t=e[0],n=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),i=r[r.length-1]);for(var o=0;o<(a[t]||[]).length;o+=1){var l=a[t][o];if(l.reg.test(n))return s(l,i,n)}}),t.media=r,t};var l=function(e,t){var r=t.split(/=(.+)/,2);return 2===r.length?e[r[0]]=i(r[1]):1===r.length&&t.length>1&&(e[r[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(l,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],r=e.split(" ").map(i),n=0;n<r.length;n+=3)t.push({component:r[n],ip:r[n+1],port:r[n+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(l,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,r=!1;return"~"!==e[0]?t=i(e):(t=i(e.substring(1,e.length)),r=!0),{scid:t,paused:r}})})}},95776:function(e,t,r){var i=r(96692),n=/%[sdv%]/g,s=function(e){var t=1,r=arguments,i=r.length;return e.replace(n,function(e){if(t>=i)return e;var n=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(n);case"%d":return Number(n);case"%v":return""}})},a=function(e,t,r){var i=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var n=0;n<t.names.length;n+=1){var a=t.names[n];t.name?i.push(r[t.name][a]):i.push(r[t.names[n]])}else i.push(r[t.name]);return s.apply(null,i)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],l=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var r=t.outerOrder||o,n=t.innerOrder||l,s=[];return r.forEach(function(t){i[t].forEach(function(r){r.name in e&&null!=e[r.name]?s.push(a(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){s.push(a(t,r,e))})})}),e.media.forEach(function(e){s.push(a("m",i.m[0],e)),n.forEach(function(t){i[t].forEach(function(r){r.name in e&&null!=e[r.name]?s.push(a(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){s.push(a(t,r,e))})})})}),s.join("\r\n")+"\r\n"}},42238:function(e,t,r){var i;!function(n,s){"use strict";var a="function",o="undefined",l="object",c="string",d="major",u="model",p="name",h="type",m="vendor",f="version",g="architecture",v="console",y="mobile",b="tablet",w="smarttv",_="wearable",S="embedded",x="Amazon",C="Apple",T="ASUS",k="BlackBerry",R="Browser",E="Chrome",P="Firefox",D="Google",L="Huawei",I="Microsoft",M="Motorola",j="Opera",O="Samsung",A="Sharp",N="Sony",F="Xiaomi",q="Zebra",B="Facebook",U="Chromium OS",H="Mac OS",z=function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r},V=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},$=function(e,t){return typeof e===c&&-1!==Z(t).indexOf(Z(e))},Z=function(e){return e.toLowerCase()},W=function(e,t){if(typeof e===c)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,350)},K=function(e,t){for(var r,i,n,o,c,d,u=0;u<t.length&&!c;){var p=t[u],h=t[u+1];for(r=i=0;r<p.length&&!c&&p[r];)if(c=p[r++].exec(e))for(n=0;n<h.length;n++)d=c[++i],typeof(o=h[n])===l&&o.length>0?2===o.length?typeof o[1]==a?this[o[0]]=o[1].call(this,d):this[o[0]]=o[1]:3===o.length?typeof o[1]!==a||o[1].exec&&o[1].test?this[o[0]]=d?d.replace(o[1],o[2]):s:this[o[0]]=d?o[1].call(this,d,o[2]):s:4===o.length&&(this[o[0]]=d?o[3].call(this,d.replace(o[1],o[2])):s):this[o]=d||s;u+=2}},G=function(e,t){for(var r in t)if(typeof t[r]===l&&t[r].length>0){for(var i=0;i<t[r].length;i++)if($(t[r][i],e))return"?"===r?s:r}else if($(t[r],e))return"?"===r?s:r;return e},Q={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Y={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,f],[/opios[\/ ]+([\w\.]+)/i],[f,[p,j+" Mini"]],[/\bopr\/([\w\.]+)/i],[f,[p,j]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,f],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[p,"UC"+R]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[f,[p,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[f,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[f,[p,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+R],f],[/\bfocus\/([\w\.]+)/i],[f,[p,P+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[p,j+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[p,j+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[p,"MIUI "+R]],[/fxios\/([-\w\.]+)/i],[f,[p,P]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+R]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+R],f],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[p,f],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,B],f],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[p,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[f,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[p,E+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,E+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[p,"Android "+R]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,f],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[f,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[f,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[f,G,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[p,P+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,f],[/(cobalt)\/([\w\.]+)/i],[p,[f,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,Z]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",Z]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,Z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[m,O],[h,b]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[m,O],[h,y]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[m,C],[h,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[m,C],[h,b]],[/(macintosh);/i],[u,[m,C]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[m,A],[h,y]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[m,L],[h,b]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[m,L],[h,y]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[m,F],[h,y]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[m,F],[h,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[m,"OPPO"],[h,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[m,"Vivo"],[h,y]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[u,[m,"Realme"],[h,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[m,M],[h,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[m,M],[h,b]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[m,"LG"],[h,b]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[m,"LG"],[h,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[m,"Lenovo"],[h,b]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[m,"Nokia"],[h,y]],[/(pixel c)\b/i],[u,[m,D],[h,b]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[m,D],[h,y]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[m,N],[h,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[m,N],[h,b]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[m,"OnePlus"],[h,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[m,x],[h,b]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[m,x],[h,y]],[/(playbook);[-\w\),; ]+(rim)/i],[u,m,[h,b]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[m,k],[h,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[m,T],[h,b]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[m,T],[h,y]],[/(nexus 9)/i],[u,[m,"HTC"],[h,b]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[m,[u,/_/g," "],[h,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[m,"Acer"],[h,b]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[m,"Meizu"],[h,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[m,u,[h,y]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[m,u,[h,b]],[/(surface duo)/i],[u,[m,I],[h,b]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[m,"Fairphone"],[h,y]],[/(u304aa)/i],[u,[m,"AT&T"],[h,y]],[/\bsie-(\w*)/i],[u,[m,"Siemens"],[h,y]],[/\b(rct\w+) b/i],[u,[m,"RCA"],[h,b]],[/\b(venue[\d ]{2,7}) b/i],[u,[m,"Dell"],[h,b]],[/\b(q(?:mv|ta)\w+) b/i],[u,[m,"Verizon"],[h,b]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[m,"Barnes & Noble"],[h,b]],[/\b(tm\d{3}\w+) b/i],[u,[m,"NuVision"],[h,b]],[/\b(k88) b/i],[u,[m,"ZTE"],[h,b]],[/\b(nx\d{3}j) b/i],[u,[m,"ZTE"],[h,y]],[/\b(gen\d{3}) b.+49h/i],[u,[m,"Swiss"],[h,y]],[/\b(zur\d{3}) b/i],[u,[m,"Swiss"],[h,b]],[/\b((zeki)?tb.*\b) b/i],[u,[m,"Zeki"],[h,b]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[m,"Dragon Touch"],u,[h,b]],[/\b(ns-?\w{0,9}) b/i],[u,[m,"Insignia"],[h,b]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[m,"NextBook"],[h,b]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[m,"Voice"],u,[h,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[m,"LvTel"],u,[h,y]],[/\b(ph-1) /i],[u,[m,"Essential"],[h,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[m,"Envizen"],[h,b]],[/\b(trio[-\w\. ]+) b/i],[u,[m,"MachSpeed"],[h,b]],[/\btu_(1491) b/i],[u,[m,"Rotor"],[h,b]],[/(shield[\w ]+) b/i],[u,[m,"Nvidia"],[h,b]],[/(sprint) (\w+)/i],[m,u,[h,y]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[m,I],[h,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[m,q],[h,b]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[m,q],[h,y]],[/smart-tv.+(samsung)/i],[m,[h,w]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[m,O],[h,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[m,"LG"],[h,w]],[/(apple) ?tv/i],[m,[u,C+" TV"],[h,w]],[/crkey/i],[[u,E+"cast"],[m,D],[h,w]],[/droid.+aft(\w)( bui|\))/i],[u,[m,x],[h,w]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[m,A],[h,w]],[/(bravia[\w ]+)( bui|\))/i],[u,[m,N],[h,w]],[/(mitv-\w{5}) bui/i],[u,[m,F],[h,w]],[/Hbbtv.*(technisat) (.*);/i],[m,u,[h,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[m,W],[u,W],[h,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[m,u,[h,v]],[/droid.+; (shield) bui/i],[u,[m,"Nvidia"],[h,v]],[/(playstation [345portablevi]+)/i],[u,[m,N],[h,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[m,I],[h,v]],[/((pebble))app/i],[m,u,[h,_]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[m,C],[h,_]],[/droid.+; (glass) \d/i],[u,[m,D],[h,_]],[/droid.+; (wt63?0{2,3})\)/i],[u,[m,q],[h,_]],[/(quest( 2| pro)?)/i],[u,[m,B],[h,_]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[m,[h,S]],[/(aeobc)\b/i],[u,[m,x],[h,S]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[u,[h,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[h,b]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,b]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,y]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[m,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,f],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[p,[f,G,Q]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,"Windows"],[f,G,Q]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,H],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[f,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,f],[/\(bb(10);/i],[f,[p,k]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[p,P+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[f,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[f,[p,E+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,U],f],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,f],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,f]]},J=function(e,t){if(typeof e===l&&(t=e,e=s),!(this instanceof J))return new J(e,t).getResult();var r=typeof n!==o&&n.navigator?n.navigator:s,i=e||(r&&r.userAgent?r.userAgent:""),v=r&&r.userAgentData?r.userAgentData:s,w=t?z(Y,t):Y,_=r&&r.userAgent==i;return this.getBrowser=function(){var e,t={};return t[p]=s,t[f]=s,K.call(t,i,w.browser),t[d]=typeof(e=t[f])===c?e.replace(/[^\d\.]/g,"").split(".")[0]:s,_&&r&&r.brave&&typeof r.brave.isBrave==a&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[g]=s,K.call(e,i,w.cpu),e},this.getDevice=function(){var e={};return e[m]=s,e[u]=s,e[h]=s,K.call(e,i,w.device),_&&!e[h]&&v&&v.mobile&&(e[h]=y),_&&"Macintosh"==e[u]&&r&&typeof r.standalone!==o&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[u]="iPad",e[h]=b),e},this.getEngine=function(){var e={};return e[p]=s,e[f]=s,K.call(e,i,w.engine),e},this.getOS=function(){var e={};return e[p]=s,e[f]=s,K.call(e,i,w.os),_&&!e[p]&&v&&"Unknown"!=v.platform&&(e[p]=v.platform.replace(/chrome os/i,U).replace(/macos/i,H)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===c&&e.length>350?W(e,350):e,this},this.setUA(i),this};J.VERSION="1.0.35",J.BROWSER=V([p,f,d]),J.CPU=V([g]),J.DEVICE=V([u,m,h,v,y,w,b,_,S]),J.ENGINE=J.OS=V([p,f]),typeof t!==o?(e.exports&&(t=e.exports=J),t.UAParser=J):r.amdO?(i=(function(){return J}).call(t,r,t,e),s!==i&&(e.exports=i)):typeof n!==o&&(n.UAParser=J);var X=typeof n!==o&&(n.jQuery||n.Zepto);if(X&&!X.ua){var ee=new J;X.ua=ee.getResult(),X.ua.get=function(){return ee.getUA()},X.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var r in t)X.ua[r]=t[r]}}}("object"==typeof window?window:this)},95856:function(){},69649:function(){},7801:function(){},86243:function(){},6042:function(){},74801:function(){},18067:function(){},30991:function(){},95286:function(){},40402:function(){},87462:function(e,t,r){"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{Z:function(){return i}})},24604:function(e,t,r){"use strict";r.d(t,{v:function(){return q}});var i,n,s,a,o=r(67294),l=r(32984),c=r(12351),d=r(9362),u=r(94192),p=r(16723),h=r(23784),m=r(19946),f=r(61363),g=((i=g||{})[i.First=0]="First",i[i.Previous=1]="Previous",i[i.Next=2]="Next",i[i.Last=3]="Last",i[i.Specific=4]="Specific",i[i.Nothing=5]="Nothing",i),v=r(64103),y=r(84575),b=r(39650),w=r(15466),_=r(16567),S=r(14157),x=r(51074),C=r(73781);function T(e){return[e.screenX,e.screenY]}let k=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function R(e){var t,r;let i=null!=(t=e.innerText)?t:"",n=e.cloneNode(!0);if(!(n instanceof HTMLElement))return i;let s=!1;for(let a of n.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))a.remove(),s=!0;let o=s?null!=(r=n.innerText)?r:"":i;return k.test(o)&&(o=o.replace(k,"")),o}var E=((n=E||{})[n.Open=0]="Open",n[n.Closed=1]="Closed",n),P=((s=P||{})[s.Pointer=0]="Pointer",s[s.Other=1]="Other",s),D=((a=D||{})[a.OpenMenu=0]="OpenMenu",a[a.CloseMenu=1]="CloseMenu",a[a.GoToItem=2]="GoToItem",a[a.Search=3]="Search",a[a.ClearSearch=4]="ClearSearch",a[a.RegisterItem=5]="RegisterItem",a[a.UnregisterItem=6]="UnregisterItem",a);function L(e,t=e=>e){let r=null!==e.activeItemIndex?e.items[e.activeItemIndex]:null,i=(0,y.z2)(t(e.items.slice()),e=>e.dataRef.current.domRef.current),n=r?i.indexOf(r):null;return -1===n&&(n=null),{items:i,activeItemIndex:n}}let I={1:e=>1===e.menuState?e:{...e,activeItemIndex:null,menuState:1},0:e=>0===e.menuState?e:{...e,__demoMode:!1,menuState:0},2:(e,t)=>{var r;let i=L(e),n=function(e,t){let r=t.resolveItems();if(r.length<=0)return null;let i=t.resolveActiveIndex(),n=null!=i?i:-1,s=(()=>{switch(e.focus){case 0:return r.findIndex(e=>!t.resolveDisabled(e));case 1:{let i=r.slice().reverse().findIndex((e,r,i)=>(-1===n||!(i.length-r-1>=n))&&!t.resolveDisabled(e));return -1===i?i:r.length-1-i}case 2:return r.findIndex((e,r)=>!(r<=n)&&!t.resolveDisabled(e));case 3:{let s=r.slice().reverse().findIndex(e=>!t.resolveDisabled(e));return -1===s?s:r.length-1-s}case 4:return r.findIndex(r=>t.resolveId(r)===e.id);case 5:return null;default:!function(e){throw Error("Unexpected object: "+e)}(e)}})();return -1===s?i:s}(t,{resolveItems:()=>i.items,resolveActiveIndex:()=>i.activeItemIndex,resolveId:e=>e.id,resolveDisabled:e=>e.dataRef.current.disabled});return{...e,...i,searchQuery:"",activeItemIndex:n,activationTrigger:null!=(r=t.trigger)?r:1}},3:(e,t)=>{let r=""!==e.searchQuery?0:1,i=e.searchQuery+t.value.toLowerCase(),n=(null!==e.activeItemIndex?e.items.slice(e.activeItemIndex+r).concat(e.items.slice(0,e.activeItemIndex+r)):e.items).find(e=>{var t;return(null==(t=e.dataRef.current.textValue)?void 0:t.startsWith(i))&&!e.dataRef.current.disabled}),s=n?e.items.indexOf(n):-1;return -1===s||s===e.activeItemIndex?{...e,searchQuery:i}:{...e,searchQuery:i,activeItemIndex:s,activationTrigger:1}},4:e=>""===e.searchQuery?e:{...e,searchQuery:"",searchActiveItemIndex:null},5:(e,t)=>{let r=L(e,e=>[...e,{id:t.id,dataRef:t.dataRef}]);return{...e,...r}},6:(e,t)=>{let r=L(e,e=>{let r=e.findIndex(e=>e.id===t.id);return -1!==r&&e.splice(r,1),e});return{...e,...r,activationTrigger:1}}},M=(0,o.createContext)(null);function j(e){let t=(0,o.useContext)(M);if(null===t){let r=Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,j),r}return t}function O(e,t){return(0,l.E)(t.type,I,e,t)}M.displayName="MenuContext";let A=o.Fragment,N=c.AN.RenderStrategy|c.AN.Static,F=o.Fragment,q=Object.assign((0,c.yV)(function(e,t){let{__demoMode:r=!1,...i}=e,n=(0,o.useReducer)(O,{__demoMode:r,menuState:r?0:1,buttonRef:(0,o.createRef)(),itemsRef:(0,o.createRef)(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:s,itemsRef:a,buttonRef:d},u]=n,p=(0,h.T)(t);(0,b.O)([d,a],(e,t)=>{var r;u({type:1}),(0,y.sP)(t,y.tJ.Loose)||(e.preventDefault(),null==(r=d.current)||r.focus())},0===s);let m=(0,C.z)(()=>{u({type:1})}),f=(0,o.useMemo)(()=>({open:0===s,close:m}),[s,m]);return o.createElement(M.Provider,{value:n},o.createElement(_.up,{value:(0,l.E)(s,{0:_.ZM.Open,1:_.ZM.Closed})},(0,c.sY)({ourProps:{ref:p},theirProps:i,slot:f,defaultTag:A,name:"Menu"})))}),{Button:(0,c.yV)(function(e,t){var r;let i=(0,m.M)(),{id:n=`headlessui-menu-button-${i}`,...s}=e,[a,l]=j("Menu.Button"),d=(0,h.T)(a.buttonRef,t),p=(0,u.G)(),y=(0,C.z)(e=>{switch(e.key){case f.R.Space:case f.R.Enter:case f.R.ArrowDown:e.preventDefault(),e.stopPropagation(),l({type:0}),p.nextFrame(()=>l({type:2,focus:g.First}));break;case f.R.ArrowUp:e.preventDefault(),e.stopPropagation(),l({type:0}),p.nextFrame(()=>l({type:2,focus:g.Last}))}}),b=(0,C.z)(e=>{e.key===f.R.Space&&e.preventDefault()}),w=(0,C.z)(t=>{if((0,v.P)(t.currentTarget))return t.preventDefault();e.disabled||(0===a.menuState?(l({type:1}),p.nextFrame(()=>{var e;return null==(e=a.buttonRef.current)?void 0:e.focus({preventScroll:!0})})):(t.preventDefault(),l({type:0})))}),_=(0,o.useMemo)(()=>({open:0===a.menuState}),[a]),x={ref:d,id:n,type:(0,S.f)(e,a.buttonRef),"aria-haspopup":"menu","aria-controls":null==(r=a.itemsRef.current)?void 0:r.id,"aria-expanded":e.disabled?void 0:0===a.menuState,onKeyDown:y,onKeyUp:b,onClick:w};return(0,c.sY)({ourProps:x,theirProps:s,slot:_,defaultTag:"button",name:"Menu.Button"})}),Items:(0,c.yV)(function(e,t){var r,i;let n=(0,m.M)(),{id:s=`headlessui-menu-items-${n}`,...a}=e,[l,v]=j("Menu.Items"),b=(0,h.T)(l.itemsRef,t),S=(0,x.i)(l.itemsRef),T=(0,u.G)(),k=(0,_.oJ)(),R=null!==k?(k&_.ZM.Open)===_.ZM.Open:0===l.menuState;(0,o.useEffect)(()=>{let e=l.itemsRef.current;e&&0===l.menuState&&e!==(null==S?void 0:S.activeElement)&&e.focus({preventScroll:!0})},[l.menuState,l.itemsRef,S]),function({container:e,accept:t,walk:r,enabled:i=!0}){let n=(0,o.useRef)(t),s=(0,o.useRef)(r);(0,o.useEffect)(()=>{n.current=t,s.current=r},[t,r]),(0,p.e)(()=>{if(!e||!i)return;let t=(0,w.r)(e);if(!t)return;let r=n.current,a=s.current,o=Object.assign(e=>r(e),{acceptNode:r}),l=t.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,o,!1);for(;l.nextNode();)a(l.currentNode)},[e,i,n,s])}({container:l.itemsRef.current,enabled:0===l.menuState,accept:e=>"menuitem"===e.getAttribute("role")?NodeFilter.FILTER_REJECT:e.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT,walk(e){e.setAttribute("role","none")}});let E=(0,C.z)(e=>{var t,r;switch(T.dispose(),e.key){case f.R.Space:if(""!==l.searchQuery)return e.preventDefault(),e.stopPropagation(),v({type:3,value:e.key});case f.R.Enter:if(e.preventDefault(),e.stopPropagation(),v({type:1}),null!==l.activeItemIndex){let{dataRef:i}=l.items[l.activeItemIndex];null==(r=null==(t=i.current)?void 0:t.domRef.current)||r.click()}(0,y.wI)(l.buttonRef.current);break;case f.R.ArrowDown:return e.preventDefault(),e.stopPropagation(),v({type:2,focus:g.Next});case f.R.ArrowUp:return e.preventDefault(),e.stopPropagation(),v({type:2,focus:g.Previous});case f.R.Home:case f.R.PageUp:return e.preventDefault(),e.stopPropagation(),v({type:2,focus:g.First});case f.R.End:case f.R.PageDown:return e.preventDefault(),e.stopPropagation(),v({type:2,focus:g.Last});case f.R.Escape:e.preventDefault(),e.stopPropagation(),v({type:1}),(0,d.k)().nextFrame(()=>{var e;return null==(e=l.buttonRef.current)?void 0:e.focus({preventScroll:!0})});break;case f.R.Tab:e.preventDefault(),e.stopPropagation(),v({type:1}),(0,d.k)().nextFrame(()=>{(0,y.EO)(l.buttonRef.current,e.shiftKey?y.TO.Previous:y.TO.Next)});break;default:1===e.key.length&&(v({type:3,value:e.key}),T.setTimeout(()=>v({type:4}),350))}}),P=(0,C.z)(e=>{e.key===f.R.Space&&e.preventDefault()}),D=(0,o.useMemo)(()=>({open:0===l.menuState}),[l]),L={"aria-activedescendant":null===l.activeItemIndex||null==(r=l.items[l.activeItemIndex])?void 0:r.id,"aria-labelledby":null==(i=l.buttonRef.current)?void 0:i.id,id:s,onKeyDown:E,onKeyUp:P,role:"menu",tabIndex:0,ref:b};return(0,c.sY)({ourProps:L,theirProps:a,slot:D,defaultTag:"div",features:N,visible:R,name:"Menu.Items"})}),Item:(0,c.yV)(function(e,t){let r,i,n,s=(0,m.M)(),{id:a=`headlessui-menu-item-${s}`,disabled:l=!1,...u}=e,[f,v]=j("Menu.Item"),b=null!==f.activeItemIndex&&f.items[f.activeItemIndex].id===a,w=(0,o.useRef)(null),_=(0,h.T)(t,w);(0,p.e)(()=>{if(f.__demoMode||0!==f.menuState||!b||0===f.activationTrigger)return;let e=(0,d.k)();return e.requestAnimationFrame(()=>{var e,t;null==(t=null==(e=w.current)?void 0:e.scrollIntoView)||t.call(e,{block:"nearest"})}),e.dispose},[f.__demoMode,w,b,f.menuState,f.activationTrigger,f.activeItemIndex]);let S=(r=(0,o.useRef)(""),i=(0,o.useRef)(""),(0,C.z)(()=>{let e=w.current;if(!e)return"";let t=e.innerText;if(r.current===t)return i.current;let n=(function(e){let t=e.getAttribute("aria-label");if("string"==typeof t)return t.trim();let r=e.getAttribute("aria-labelledby");if(r){let i=r.split(" ").map(e=>{let t=document.getElementById(e);if(t){let r=t.getAttribute("aria-label");return"string"==typeof r?r.trim():R(t).trim()}return null}).filter(Boolean);if(i.length>0)return i.join(", ")}return R(e).trim()})(e).trim().toLowerCase();return r.current=t,i.current=n,n})),x=(0,o.useRef)({disabled:l,domRef:w,get textValue(){return S()}});(0,p.e)(()=>{x.current.disabled=l},[x,l]),(0,p.e)(()=>(v({type:5,id:a,dataRef:x}),()=>v({type:6,id:a})),[x,a]);let k=(0,C.z)(()=>{v({type:1})}),E=(0,C.z)(e=>{if(l)return e.preventDefault();v({type:1}),(0,y.wI)(f.buttonRef.current)}),P=(0,C.z)(()=>{if(l)return v({type:2,focus:g.Nothing});v({type:2,focus:g.Specific,id:a})}),D=(n=(0,o.useRef)([-1,-1]),{wasMoved(e){let t=T(e);return(n.current[0]!==t[0]||n.current[1]!==t[1])&&(n.current=t,!0)},update(e){n.current=T(e)}}),L=(0,C.z)(e=>D.update(e)),I=(0,C.z)(e=>{D.wasMoved(e)&&(l||b||v({type:2,focus:g.Specific,id:a,trigger:0}))}),M=(0,C.z)(e=>{D.wasMoved(e)&&(l||b&&v({type:2,focus:g.Nothing}))}),O=(0,o.useMemo)(()=>({active:b,disabled:l,close:k}),[b,l,k]);return(0,c.sY)({ourProps:{id:a,ref:_,role:"menuitem",tabIndex:!0===l?void 0:-1,"aria-disabled":!0===l||void 0,disabled:void 0,onClick:E,onFocus:P,onPointerEnter:L,onMouseEnter:L,onPointerMove:I,onMouseMove:I,onPointerLeave:M,onMouseLeave:M},theirProps:u,slot:O,defaultTag:F,name:"Menu.Item"})})})},14157:function(e,t,r){"use strict";r.d(t,{f:function(){return a}});var i=r(67294),n=r(16723);function s(e){var t;if(e.type)return e.type;let r=null!=(t=e.as)?t:"button";if("string"==typeof r&&"button"===r.toLowerCase())return"button"}function a(e,t){let[r,a]=(0,i.useState)(()=>s(e));return(0,n.e)(()=>{a(s(e))},[e.type,e.as]),(0,n.e)(()=>{r||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&a("button")},[r,t]),r}},61998:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 01-.923 1.785A5.969 5.969 0 006 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337z"}))});t.Z=n},10050:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))});t.Z=n},62940:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))});t.Z=n},93832:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))});t.Z=n},23:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"}))});t.Z=n},56186:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"}))});t.Z=n},89814:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z"}))});t.Z=n},28166:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"}))});t.Z=n},83436:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))});t.Z=n},21321:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"}))});t.Z=n},28771:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186l9.566-5.314m-9.566 7.5l9.566 5.314m0 0a2.25 2.25 0 103.935 2.186 2.25 2.25 0 00-3.935-2.186zm0-12.814a2.25 2.25 0 103.933-2.185 2.25 2.25 0 00-3.933 2.185z"}))});t.Z=n},53901:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"}))});t.Z=n},76249:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"}))});t.Z=n},7543:function(e,t,r){"use strict";var i=r(67294);let n=i.forwardRef(function({title:e,titleId:t,...r},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?i.createElement("title",{id:t},e):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"}))});t.Z=n},94464:function(e,t,r){"use strict";let i,n;r.d(t,{m:function(){return eN}});var s,a,o={};r.r(o),r.d(o,{Decoder:function(){return eg},Encoder:function(){return em},PacketType:function(){return a},protocol:function(){return eh}});var l=r(50960);let c=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),""),d=Object.create(null);d.open="0",d.close="1",d.ping="2",d.pong="3",d.message="4",d.upgrade="5",d.noop="6";let u=Object.create(null);Object.keys(d).forEach(e=>{u[d[e]]=e});let p={type:"error",data:"parser error"},h="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),m="function"==typeof ArrayBuffer,f=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,g=({type:e,data:t},r,i)=>h&&t instanceof Blob?r?i(t):v(t,i):m&&(t instanceof ArrayBuffer||f(t))?r?i(t):v(new Blob([t]),i):i(d[e]+(t||"")),v=(e,t)=>{let r=new FileReader;return r.onload=function(){let e=r.result.split(",")[1];t("b"+(e||""))},r.readAsDataURL(e)};function y(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let _=0;_<b.length;_++)w[b.charCodeAt(_)]=_;let S=e=>{let t=.75*e.length,r=e.length,i,n=0,s,a,o,l;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);let c=new ArrayBuffer(t),d=new Uint8Array(c);for(i=0;i<r;i+=4)s=w[e.charCodeAt(i)],a=w[e.charCodeAt(i+1)],o=w[e.charCodeAt(i+2)],l=w[e.charCodeAt(i+3)],d[n++]=s<<2|a>>4,d[n++]=(15&a)<<4|o>>2,d[n++]=(3&o)<<6|63&l;return c},x="function"==typeof ArrayBuffer,C=(e,t)=>{if("string"!=typeof e)return{type:"message",data:k(e,t)};let r=e.charAt(0);if("b"===r)return{type:"message",data:T(e.substring(1),t)};let i=u[r];return i?e.length>1?{type:u[r],data:e.substring(1)}:{type:u[r]}:p},T=(e,t)=>{if(!x)return{base64:!0,data:e};{let r=S(e);return k(r,t)}},k=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,R=(e,t)=>{let r=e.length,i=Array(r),n=0;e.forEach((e,s)=>{g(e,!1,e=>{i[s]=e,++n===r&&t(i.join("\x1e"))})})},E=(e,t)=>{let r=e.split("\x1e"),i=[];for(let n=0;n<r.length;n++){let s=C(r[n],t);if(i.push(s),"error"===s.type)break}return i};function P(e){if(e)return function(e){for(var t in P.prototype)e[t]=P.prototype[t];return e}(e)}P.prototype.on=P.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},P.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},P.prototype.off=P.prototype.removeListener=P.prototype.removeAllListeners=P.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n=0;n<i.length;n++)if((r=i[n])===t||r.fn===t){i.splice(n,1);break}return 0===i.length&&delete this._callbacks["$"+e],this},P.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=Array(arguments.length-1),r=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(r){r=r.slice(0);for(var i=0,n=r.length;i<n;++i)r[i].apply(this,t)}return this},P.prototype.emitReserved=P.prototype.emit,P.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},P.prototype.hasListeners=function(e){return!!this.listeners(e).length};let D="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function L(e,...t){return t.reduce((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t),{})}let I=D.setTimeout,M=D.clearTimeout;function j(e,t){t.useNativeTimers?(e.setTimeoutFn=I.bind(D),e.clearTimeoutFn=M.bind(D)):(e.setTimeoutFn=D.setTimeout.bind(D),e.clearTimeoutFn=D.clearTimeout.bind(D))}class O extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class A extends P{constructor(e){super(),this.writable=!1,j(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new O(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=C(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return -1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){let t=function(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e);return t.length?"?"+t:""}}let N="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),F={},q=0,B=0,U;function H(e){let t="";do t=N[e%64]+t,e=Math.floor(e/64);while(e>0);return t}function z(){let e=H(+new Date);return e!==U?(q=0,U=e):e+"."+H(q++)}for(;B<64;B++)F[N[B]]=B;let V=!1;try{V="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch($){}let Z=V;function W(e){let t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||Z))return new XMLHttpRequest}catch(r){}if(!t)try{return new D[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(i){}}function K(){}let G=function(){let e=new W({xdomain:!1});return null!=e.responseType}();class Q extends P{constructor(e,t){super(),j(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;let t=L(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;let r=this.xhr=new W(t);try{r.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders)for(let i in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this.opts.extraHeaders[i])}catch(n){}if("POST"===this.method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}try{r.setRequestHeader("Accept","*/*")}catch(a){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{var e;3===r.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(r)),4===r.readyState&&(200===r.status||1223===r.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof r.status?r.status:0)},0))},r.send(this.data)}catch(o){this.setTimeoutFn(()=>{this.onError(o)},0);return}"undefined"!=typeof document&&(this.index=Q.requestsCount++,Q.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=K,e)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete Q.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}function Y(){for(let e in Q.requests)Q.requests.hasOwnProperty(e)&&Q.requests[e].abort()}Q.requestsCount=0,Q.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",Y):"function"==typeof addEventListener&&addEventListener("onpagehide"in D?"pagehide":"unload",Y,!1));let J=(()=>{let e="function"==typeof Promise&&"function"==typeof Promise.resolve;return e?e=>Promise.resolve().then(e):(e,t)=>t(e,0)})(),X=D.WebSocket||D.MozWebSocket;r(48764).Buffer;let ee="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),et={websocket:class extends A{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,r=ee?{}:L(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=ee?new X(e,t,r):t?new X(e,t):new X(e)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],i=t===e.length-1;g(r,this.supportsBinary,e=>{try{this.ws.send(e)}catch(t){}i&&J(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=z()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!X}},webtransport:class extends A{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{let t;let r=e.readable.getReader();this.writer=e.writable.getWriter();let i=()=>{r.read().then(({done:e,value:r})=>{e||(t||1!==r.byteLength||54!==r[0]?(this.onPacket(function(e,t,r){n||(n=new TextDecoder);let i=t||e[0]<48||e[0]>54;return C(i?e:n.decode(e),r)}(r,t,"arraybuffer")),t=!1):t=!0,i())}).catch(e=>{})};i();let s=this.query.sid?`0{"sid":"${this.query.sid}"}`:"0";this.writer.write(new TextEncoder().encode(s)).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],n=t===e.length-1;!function(e,t){h&&e.data instanceof Blob?e.data.arrayBuffer().then(y).then(t):m&&(e.data instanceof ArrayBuffer||f(e.data))?t(y(e.data)):g(e,!1,e=>{i||(i=new TextEncoder),t(i.encode(e))})}(r,e=>{"message"===r.type&&"string"!=typeof r.data&&e[0]>=48&&e[0]<=54&&this.writer.write(Uint8Array.of(54)),this.writer.write(e).then(()=>{n&&J(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})})}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}},polling:class extends A{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){let t="https:"===location.protocol,r=location.port;r||(r=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port}let i=e&&e.forceBase64;this.supportsBinary=G&&!i,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)};E(e,this.socket.binaryType).forEach(t),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){let e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,R(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=z()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Q(this.uri(),e)}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}},er=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ei=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function en(e){let t=e,r=e.indexOf("["),i=e.indexOf("]");-1!=r&&-1!=i&&(e=e.substring(0,r)+e.substring(r,i).replace(/:/g,";")+e.substring(i,e.length));let n=er.exec(e||""),s={},a=14;for(;a--;)s[ei[a]]=n[a]||"";return -1!=r&&-1!=i&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){let r=t.replace(/\/{2,9}/g,"/").split("/");return("/"==t.slice(0,1)||0===t.length)&&r.splice(0,1),"/"==t.slice(-1)&&r.splice(r.length-1,1),r}(0,s.path),s.queryKey=function(e,t){let r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,i){t&&(r[t]=i)}),r}(0,s.query),s}class es extends P{constructor(e,t={}){super(),this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=en(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=en(t.host).host),j(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let i=0,n=r.length;i<n;i++){let s=r[i].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){let t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);let r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new et[e](r)}open(){let e;if(this.opts.rememberUpgrade&&es.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else if(0===this.transports.length){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(t){this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",e=>this.onClose("transport close",e))}probe(e){let t=this.createTransport(e),r=!1;es.priorWebsocketSuccess=!1;let i=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!r){if("pong"===e.type&&"probe"===e.data)this.upgrading=!0,this.emitReserved("upgrading",t),t&&(es.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{r||"closed"===this.readyState||(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}));else{let i=Error("probe error");i.transport=t.name,this.emitReserved("upgradeError",i)}}}))};function n(){r||(r=!0,c(),t.close(),t=null)}let s=e=>{let r=Error("probe error: "+e);r.transport=t.name,n(),this.emitReserved("upgradeError",r)};function a(){s("transport closed")}function o(){s("socket closed")}function l(e){t&&e.name!==t.name&&n()}let c=()=>{t.removeListener("open",i),t.removeListener("error",s),t.removeListener("close",a),this.off("close",o),this.off("upgrading",l)};t.once("open",i),t.once("error",s),t.once("close",a),this.once("close",o),this.once("upgrading",l),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onOpen(){if(this.readyState="open",es.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0,t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let t=Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){let e=this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1;if(!e)return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){let i=this.writeBuffer[r].data;if(i&&(t+="string"==typeof i?function(e){let t=0,r=0;for(let i=0,n=e.length;i<n;i++)(t=e.charCodeAt(i))<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(i++,r+=4);return r}(i):Math.ceil(1.33*(i.byteLength||i.size))),r>0&&t>this.maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof r&&(i=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;let n={type:e,data:t,options:r};this.emitReserved("packetCreate",n),this.writeBuffer.push(n),i&&this.once("flush",i),this.flush()}close(){let e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}onError(e){es.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let t=[],r=0,i=e.length;for(;r<i;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}es.protocol=4,es.protocol;let ea="function"==typeof ArrayBuffer,eo=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,el=Object.prototype.toString,ec="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===el.call(Blob),ed="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===el.call(File);function eu(e){return ea&&(e instanceof ArrayBuffer||eo(e))||ec&&e instanceof Blob||ed&&e instanceof File}let ep=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],eh=5;(s=a||(a={}))[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK";class em{constructor(e){this.replacer=e}encode(e){return(e.type===a.EVENT||e.type===a.ACK)&&function e(t,r){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let i=0,n=t.length;i<n;i++)if(e(t[i]))return!0;return!1}if(eu(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1==arguments.length)return e(t.toJSON(),!0);for(let s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e(t[s]))return!0;return!1}(e)?this.encodeAsBinary({type:e.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===a.BINARY_EVENT||e.type===a.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t=function(e){let t=[],r=e.data,i=e;return i.data=function e(t,r){if(!t)return t;if(eu(t)){let i={_placeholder:!0,num:r.length};return r.push(t),i}if(Array.isArray(t)){let n=Array(t.length);for(let s=0;s<t.length;s++)n[s]=e(t[s],r);return n}if("object"==typeof t&&!(t instanceof Date)){let a={};for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&(a[o]=e(t[o],r));return a}return t}(r,t),i.attachments=t.length,{packet:i,buffers:t}}(e),r=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(r),i}}function ef(e){return"[object Object]"===Object.prototype.toString.call(e)}class eg extends P{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);let r=t.type===a.BINARY_EVENT;r||t.type===a.BINARY_ACK?(t.type=r?a.EVENT:a.ACK,this.reconstructor=new ev(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(eu(e)||e.base64){if(this.reconstructor)(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw Error("got binary data when not reconstructing a packet")}else throw Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(void 0===a[r.type])throw Error("unknown packet type "+r.type);if(r.type===a.BINARY_EVENT||r.type===a.BINARY_ACK){let i=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);let n=e.substring(i,t);if(n!=Number(n)||"-"!==e.charAt(t))throw Error("Illegal attachments");r.attachments=Number(n)}if("/"===e.charAt(t+1)){let s=t+1;for(;++t;){let o=e.charAt(t);if(","===o||t===e.length)break}r.nsp=e.substring(s,t)}else r.nsp="/";let l=e.charAt(t+1);if(""!==l&&Number(l)==l){let c=t+1;for(;++t;){let d=e.charAt(t);if(null==d||Number(d)!=d){--t;break}if(t===e.length)break}r.id=Number(e.substring(c,t+1))}if(e.charAt(++t)){let u=this.tryParse(e.substr(t));if(eg.isPayloadValid(r.type,u))r.data=u;else throw Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case a.CONNECT:return ef(t);case a.DISCONNECT:return void 0===t;case a.CONNECT_ERROR:return"string"==typeof t||ef(t);case a.EVENT:case a.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===ep.indexOf(t[0]));case a.ACK:case a.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ev{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t,r;let i=(t=this.reconPack,r=this.buffers,t.data=function e(t,r){if(!t)return t;if(t&&!0===t._placeholder){let i="number"==typeof t.num&&t.num>=0&&t.num<r.length;if(i)return r[t.num];throw Error("illegal attachments")}if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=e(t[n],r);else if("object"==typeof t)for(let s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=e(t[s],r));return t}(t.data,r),delete t.attachments,t);return this.finishedReconstruction(),i}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function ey(e,t,r){return e.on(t,r),function(){e.off(t,r)}}let eb=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ew extends P{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[ey(e,"open",this.onopen.bind(this)),ey(e,"packet",this.onpacket.bind(this)),ey(e,"error",this.onerror.bind(this)),ey(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(eb.hasOwnProperty(e))throw Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let r={type:a.EVENT,data:t};if(r.options={},r.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){let i=this.ids++,n=t.pop();this._registerAckCallback(i,n),r.id=i}let s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,o=this.flags.volatile&&(!s||!this.connected);return o||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){var r;let i=null!==(r=this.flags.timeout)&&void 0!==r?r:this._opts.ackTimeout;if(void 0===i){this.acks[e]=t;return}let n=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let r=0;r<this.sendBuffer.length;r++)this.sendBuffer[r].id===e&&this.sendBuffer.splice(r,1);t.call(this,Error("operation has timed out"))},i);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(n),t.apply(this,[null,...e])}}emitWithAck(e,...t){let r=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((i,n)=>{t.push((e,t)=>r?e?n(e):i(t):i(e)),this.emit(e,...t)})}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...i)=>{if(r===this._queue[0])return null!==e?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...i)),r.pending=!1,this._drainQueue()}),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;let t=this._queue[0];(!t.pending||e)&&(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:a.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){let t=e.nsp===this.nsp;if(t)switch(e.type){case a.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case a.EVENT:case a.BINARY_EVENT:this.onevent(e);break;case a.ACK:case a.BINARY_ACK:this.onack(e);break;case a.DISCONNECT:this.ondisconnect();break;case a.CONNECT_ERROR:this.destroy();let r=Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r)}}onevent(e){let t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,r=!1;return function(...i){r||(r=!0,t.packet({type:a.ACK,id:e,data:i}))}}onack(e){let t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:a.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let r of t)r.apply(this,e.data)}}}function e_(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e_.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=(1&Math.floor(10*t))==0?e-r:e+r}return 0|Math.min(e,this.max)},e_.prototype.reset=function(){this.attempts=0},e_.prototype.setMin=function(e){this.ms=e},e_.prototype.setMax=function(e){this.max=e},e_.prototype.setJitter=function(e){this.jitter=e};class eS extends P{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,j(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=t.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new e_({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;let i=t.parser||o;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new es(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let i=ey(t,"open",function(){r.onopen(),e&&e()}),n=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},s=ey(t,"error",n);if(!1!==this._timeout){let a=this._timeout,o=this.setTimeoutFn(()=>{i(),n(Error("timeout")),t.close()},a);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}return this.subs.push(i),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(ey(e,"ping",this.onping.bind(this)),ey(e,"data",this.ondata.bind(this)),ey(e,"error",this.onerror.bind(this)),ey(e,"close",this.onclose.bind(this)),ey(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){J(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new ew(this,e,t),this.nsps[e]=r),r}_destroy(e){let t=Object.keys(this.nsps);for(let r of t){let i=this.nsps[r];if(i.active)return}this._close()}_packet(e){let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{!e.skipReconnect&&(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}let ex={};function eC(e,t){let r;"object"==typeof e&&(t=e,e=void 0),t=t||{};let i=function(e,t="",r){let i=e;r=r||"undefined"!=typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==r?r.protocol+"//"+e:"https://"+e),i=en(e)),!i.port&&(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let n=-1!==i.host.indexOf(":"),s=n?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+t,i.href=i.protocol+"://"+s+(r&&r.port===i.port?"":":"+i.port),i}(e,t.path||"/socket.io"),n=i.source,s=i.id,a=i.path,o=ex[s]&&a in ex[s].nsps,l=t.forceNew||t["force new connection"]||!1===t.multiplex||o;return l?r=new eS(n,t):(ex[s]||(ex[s]=new eS(n,t)),r=ex[s]),i.query&&!t.query&&(t.query=i.queryKey),r.socket(i.path,t)}Object.assign(eC,{Manager:eS,Socket:ew,io:eC,connect:eC});var eT=r(6154),ek=r(17187),eR=r(1604),eE=async()=>{try{let{data:{result:{data:{json:{accessToken:e}}}}}=await eT.Z.post("https://testing.sdk-iriko.huddle01.com/trpc/auth.guest");return e}catch(t){console.log({error:t})}},eP={cam:[{scaleResolutionDownBy:4,maxBitrate:3e5,rid:"r0",scalabilityMode:"S1T3",maxFramerate:15},{scaleResolutionDownBy:2,maxBitrate:6e5,rid:"r1",scalabilityMode:"S1T3",maxFramerate:30},{scaleResolutionDownBy:1,maxBitrate:9e6,rid:"r2",scalabilityMode:"S1T3",maxFramerate:30}],"share-video":[{maxBitrate:1e6,networkPriority:"high",maxFramerate:30,dtx:!0}],mic:void 0,"share-audio":void 0},eD={audio:{opusStereo:!0,opusFec:!0,opusDtx:!0},video:{videoGoogleStartBitrate:1e3}},eL=class{emitter;constructor(){this.emitter=new ek.EventEmitter}on(e,t){return this.emitter.on(e,t),this}off(e,t){return this.emitter.off(e,t),this}listenerCount(e){return this.emitter.listenerCount(e)}listeners(e){return this.emitter.listeners(e)}emit(e,...t){return this.emitter.emit(e,...t)}safeEmit(e,...t){return this.emitter.emit(e,...t)}once(e,t){return this.emitter.once(e,t),this}removeAllListeners(e){return e?this.emitter.removeAllListeners(e):this.emitter.removeAllListeners(),this}},eI=class{logging=!0;info=(...e)=>{this.logging&&console.info(...e)};warn=(...e)=>{this.logging&&console.warn(...e)};error=(...e)=>{this.logging&&console.error(...e)};disable=()=>this.logging=!1;enable=()=>this.logging=!0};eR.z.object({videoProducer:eR.z.boolean(),audioProducer:eR.z.boolean(),screenShareProducer:eR.z.boolean(),mainChatProducer:eR.z.boolean(),recordingAdmin:eR.z.boolean(),liveStreamingAdmin:eR.z.boolean(),kickUser:eR.z.boolean(),changeRole:eR.z.boolean(),changePermission:eR.z.boolean(),admitPermission:eR.z.boolean(),editName:eR.z.boolean(),editAvatar:eR.z.boolean()});var eM=class{__acl;__logger=new eI;constructor(){this.__acl={videoProducer:!1,audioProducer:!1,screenShareProducer:!1,mainChatProducer:!1,recordingAdmin:!1,liveStreamingAdmin:!1,kickUser:!1,changeRole:!1,changePermission:!1,admitPermission:!1,editName:!1,editAvatar:!1}}setACL=e=>{this.__acl=e,this.__logger.info({this__acl:this.__acl})};updateACL=e=>{this.__acl={...this.__acl,...e}};changePermissionACL=()=>this.__acl.changePermission;getAcl=()=>this.__acl},ej=class extends eL{_me={peerId:"",role:"",displayName:"",avatarUrl:""};_roomId;_socket;_isRecorder=!1;logger=new eI;_acl=new eM;_hostControls={lobbyPreview:!0,audio:!1,roomLock:!0,screenshare:!1,video:!1,chat:!1};constructor(){super()}_handleConnect(){this.emit("lobby:joined",this._roomId),this.logger.info("lobby:joined",this._roomId)}_handleDisconnect(){this.logger.warn("client disconnected")}_handleConnectError=e=>{this.emit("lobby:failed",e),this.logger.error("lobby:failed",e)}},eO=class extends ej{_videoStream;_audioStream;_device;_sendTransport;_recvTransport;_audioProducer;_videoProducer;_shareVideoProducer;_shareAudioProducer;_consumers=new Map;_createConsumersOnJoin=!0;_peers;_peersConsumers=new Map;_turn=[{username:"test-turn",urls:"turn:turn.huddle01.com:443?transport=udp",credential:"test-turn"},{username:"test-turn",urls:"turn:turn.huddle01.com:443?transport=tcp",credential:"test-turn"}];constructor(){super()}_produce=async(e,t,r="*")=>{if(!this._sendTransport){this.logger.warn("produce() | sendTransport is undefined");return}if(!(this._device&&this._device.rtpCapabilities.codecs))return;let i={cam:this._device.rtpCapabilities.codecs.find(e=>"video/h264"===e.mimeType.toLowerCase()&&"42e034"===e.parameters["profile-level-id"]),"share-video":this._device.rtpCapabilities.codecs.find(e=>"video/h264"===e.mimeType.toLowerCase()&&"42e034"===e.parameters["profile-level-id"]),mic:void 0,"share-audio":void 0},n=await this._sendTransport.produce({track:e,encodings:eP[t],codecOptions:eD[e.kind],codec:i[t],stopTracks:!1,zeroRtpOnPause:!0,disableTrackOnPause:!0,appData:{type:t,share:"share-audio"===t||"share-video"===t,targetPeerIds:r}});return n};_produceAudioStream=async(e,t="*")=>{try{if(!e){this.logger.warn("produceAudioStream() | stream is undefined");return}if(this._audioStream||(this._audioStream=e),this._audioProducer){this.logger.warn("handleCreateWebRTC() | Audio Producer already exists");return}let r=e.getAudioTracks()[0];if(!r){this.logger.warn("enableMic() | Track is undefined");return}let i=await this._produce(r,"mic",t);if(!i){this.logger.warn("enableMic() | Producer create error");return}if(!i.track){this.logger.warn("enableMic() | Producer track is undefined");return}this._audioProducer=i,this._audioProducer.on("trackended",()=>{this.logger.warn("produceAudioStream() | trackended for mic"),this._stopAudioProducer().catch(this.logger.error)}),this._audioProducer.on("transportclose",()=>{this.logger.warn("produceAudioStream() | transportclose for mic"),this._stopAudioProducer().catch(this.logger.error)}),this._audioProducer.on("@replacetrack",()=>{this.logger.warn("produceAudioStream() | @replacetrack for mic")}),this._audioProducer.on("@close",()=>{this.logger.warn("produceAudioStream() | @close for mic"),this._stopAudioProducer().catch(this.logger.error)})}catch(n){throw this.logger.error("Error enabling mic",{error:n}),Error("Error enabling mic")}};_produceVideoStream=async(e,t="*")=>{try{if(!e)return this.logger.warn("produceVideoStream() | stream is undefined"),Promise.reject();if(this._videoStream||(this._videoStream=e),this._videoProducer){this.logger.warn("handleCreateWebRTC() | Video Producer already exists");return}let r=e.getVideoTracks()[0];if(!r){this.logger.warn("produceVideoStream() | Track is undefined");return}let i=await this._produce(r,"cam",t);if(!i){this.logger.warn("produceVideoStream() | Producer create error");return}if(!i.track){this.logger.warn("produceVideoStream() | Producer track is undefined");return}this._videoProducer=i,this._videoProducer.on("trackended",()=>{this.logger.warn("enabelCam() | trackended for cam"),this._stopVideoProducer().catch(this.logger.error)}),this._videoProducer.on("transportclose",()=>{this.logger.warn("produceVideoStream() | transportclose for cam"),this._stopVideoProducer().catch(this.logger.error)}),this._videoProducer.on("@replacetrack",(e,t,r)=>{this.logger.warn("produceVideoStream() | @replacetrack for cam")}),this._videoProducer.on("@close",()=>{this.logger.warn("produceVideoStream() | @close for cam"),this._stopVideoProducer().catch(this.logger.error)})}catch(n){this.logger.error("Error enabling cam",{error:n})}};_requestStopAudioProducer=async()=>{try{if(!this._audioProducer){this.logger.error("requestStopAudioProducer() | audioProducer is undefined");return}this._socket.emit("close-producer",{peerId:this._me.peerId,producerId:this._audioProducer.appData.momoProducerId,roomId:this._roomId,appData:{type:"mic"}}),this._audioProducer.close()}catch(e){}};_stopAudioProducer=async()=>{try{if(!this._audioProducer){this.logger.warn("stopAudioProducer() | audioProducer is undefined");return}if(this._audioProducer=void 0,this.emit("room:mic-produce-stop"),!this._audioProducer.appData.momoProducerId){this.logger.warn("stopAudioProducer() | momoProducerId is undefined");return}}catch(e){this.logger.error({error:e})}};_requestStopVideoProducer=async()=>{try{if(!this._videoProducer){this.logger.warn("requestStopVideoProducer() | videoProducer is undefined");return}this._socket.emit("close-producer",{peerId:this._me.peerId,producerId:this._videoProducer.appData.momoProducerId,roomId:this._roomId,appData:{type:"cam"}}),this._videoProducer.close()}catch(e){}};_stopVideoProducer=async()=>{try{if(!this._videoProducer){this.logger.warn("stopVideoProducer() | videoProducer is undefined");return}if(this._videoProducer=void 0,this.emit("room:cam-produce-stop"),this.logger.info("room:cam-produce-stop"),!this._videoProducer.appData.momoProducerId){this.logger.warn("stopVideoProducer() | momoProducerId is undefined");return}}catch(e){}};_handleJoinSuccess=async e=>{this.logger.info("handleJoinSuccess()");try{this._device=new l.Device,await this._device.load({routerRtpCapabilities:e.routerRTPCapabilities}),this._socket.emit("create-webrtc-transport",{peerId:e.peerId,roomId:e.roomId,sctpCapabilities:this._device.sctpCapabilities});let{activeSpeakers:t,roomMetadata:{peerIds:r,peerMetaData:i,roomMetaData:{roomLocked:n,lobbyPreview:s,audioLocked:a,videoLocked:o,chatLocked:c,shareLocked:d,lobbyPeers:u}},permissions:p,role:h}=e;this._me={...this._me,peerId:e.peerId,role:h},this.emit("room:me-role-update",h),this.logger.info("acl() | setACL",p),this._acl.setACL(p),this._hostControls={roomLock:n,audio:a,video:o,chat:c,screenshare:d,lobbyPreview:s};let m={},f={};r.forEach(e=>{let t=i[e];t||this.logger.error("handleJoinSuccess() | No Peer Data Found");let r={peerId:e,role:t.role,displayName:(null==t?void 0:t.displayName)||"No Name Found",avatarUrl:(null==t?void 0:t.avatarUrl)||"/avatars/0.png",joinStatus:"joined:webrtc-creating",isHandRaised:(null==t?void 0:t.isHandRaised)||!1};this._peers.set(r.peerId,r),m={...m,[e]:r},f={...f,[e]:{mic:null,cam:null,"share-audio":null,"share-video":null}}}),this.emit("room:joined",this._peers),this.logger.info("room:joined",this._peers)}catch(g){this.logger.error({err:g})}};_handleProduceSuccess=e=>{let{peerId:t,producerId:r,roomId:i,appData:n}=e;"cam"===n.type?(this._videoProducer.appData.momoProducerId=r,this.emit("room:cam-produce-start"),this.logger.info("room:cam-produce-start")):(this._audioProducer.appData.momoProducerId=r,this.emit("room:mic-produce-start"),this.logger.info("room:mic-produce-start"))};_handleClientConsumer=async e=>{try{if(!this._recvTransport)throw Error("No Recv Transport");let t=e.appData.type,r=`${e.producerId}-${"cam"===e.appData.type||"mic"===e.appData.type?"audio-video":"screenAudio-screenVideo"}`,i=await this._recvTransport.consume({id:e.id,producerId:e.producerId,kind:e.kind,rtpParameters:e.rtpParameters,appData:{...e.appData,peerId:e.producerPeerId},streamId:r});this._consumers.set(i.id,i);let n=this._peersConsumers.get(e.producerPeerId);this._peersConsumers.set(e.producerPeerId,{...n,[e.appData.type]:i.id}),i.id,i.track,e.producerPeerId,e.producerPeerId,e.producerId,i.paused,"cam"===t&&(this.emit("room:peer-produce-start",{peerId:e.producerPeerId,mediaType:"cam",track:i.track}),this.logger.info("room:peer-produce-start",{peerId:e.producerPeerId,mediaType:"cam",track:i.track})),"mic"===t&&(this.emit("room:peer-produce-start",{peerId:e.producerPeerId,mediaType:"mic",track:i.track}),this.logger.info("room:peer-produce-start",{peerId:e.producerPeerId,mediaType:"mic",track:i.track})),this._socket.emit("resume-consumer",{consumerId:i.id,producerPeerId:e.producerPeerId,peerId:this._me.peerId,roomId:this._roomId,mediaType:t}),i.on("transportclose",()=>{this._consumers.delete(i.id),this.logger.warn("client-consumer() | Transport Close"),i.close()}),i.on("trackended",()=>{this.logger.warn("client-consumer() | Tracked Ended")}),i.on("@pause",()=>{this.logger.warn("client-consumer() | @pause")}),i.on("@resume",()=>{this.logger.warn("client-consumer() | @resume")}),i.on("@close",()=>{this.logger.warn("client-consumer() | @close"),this._consumers.delete(i.id)})}catch(s){this.logger.error("Error creating client consumer: ",{error:s,data:e})}};_handleConsumerPaused=e=>{var t;let{appData:r,producerPeerId:i}=e,n=null==(t=this._peersConsumers.get(i))?void 0:t[r.type],s=this._consumers.get(n);if(console.log("handleConsumerPaused",e,{consumer:s}),!s){console.error(`handleConsumerPaused() | No consumer data of type ${r.type} for peer ${i}`);return}s&&s.pause()};_handleConsumerResumed=e=>{var t;let{appData:r,producerPeerId:i}=e,n=null==(t=this._peersConsumers.get(i))?void 0:t[r.type],s=this._consumers.get(n);if(console.log("handleConsumerResumed",e,{consumer:s}),!s){console.error(`handleConsumerResumed() | No consumer data of type ${r.type} for peer ${i}`);return}s&&s.resume()};_handleConsumerClosed=e=>{var t;this.emit("room:peer-produce-stop",{peerId:e.producerPeerId,mediaType:e.appData.type});let{producerPeerId:r,appData:i}=e;if(!e.appData||!e.appData.type){this.logger.error("Need appData and appData.type to close consumer");return}let n=null==(t=this._peersConsumers.get(r))?void 0:t[i.type],s=this._consumers.get(n);if(console.log("_handleConsumerClosed",e,{consumer:s}),s)s.close();else{this.logger.error(`handleConsumerClosed() | No consumer data of type ${i.type} for peer ${r}`);return}};_handleCreateWebRTC=async e=>{if(!this._device){this.logger.error("Device not initialized");return}try{this._sendTransport=this._createDeviceTransport(e,"send"),this._recvTransport=this._createDeviceTransport(e,"recv"),this._videoStream&&this._produceVideoStream(this._videoStream),this._audioStream&&this._produceAudioStream(this._audioStream)}catch(t){console.debug({err:t})}this._createConsumersOnJoin&&this._socket.emit("create-consumers-for-newpeer",{peerId:e.peerId,roomId:e.roomId})};_createDeviceTransport=(e,t)=>{let r;if(void 0===this._device){this.logger.warn("createDeviceTransport() | mediasoup device is undefined");return}if("send"===t?(console.debug("createDeviceTransport() | creating send transport"),r=this._device.createSendTransport({id:e.sendTransportSDPInfo.id,iceParameters:e.sendTransportSDPInfo.iceParameters,iceCandidates:e.sendTransportSDPInfo.iceCandidates,dtlsParameters:e.sendTransportSDPInfo.dtlsParameters,sctpParameters:e.sendTransportSDPInfo.sctpParameters,iceServers:this._turn,proprietaryConstraints:{},appData:{}})):"recv"===t&&(console.debug("createDeviceTransport() | creating recv transport"),r=this._device.createRecvTransport({id:e.recvTransportSDPInfo.id,iceParameters:e.recvTransportSDPInfo.iceParameters,iceCandidates:e.recvTransportSDPInfo.iceCandidates,dtlsParameters:e.recvTransportSDPInfo.dtlsParameters,sctpParameters:e.recvTransportSDPInfo.sctpParameters,iceServers:this._turn,proprietaryConstraints:{},appData:{}})),void 0===r){this.logger.warn("createDeviceTransport() | transport is undefined , transportType is incorrect");return}return r.on("connect",({dtlsParameters:r},i,n)=>{try{this._socket.emit("connect-webrtc-transport",{dtlsParameters:r,transportType:t,peerId:e.peerId,roomId:e.roomId}),i()}catch(s){n(s)}}),r.on("produce",async({kind:t,rtpParameters:i,appData:n},s,a)=>{try{let{id:o}=this._socket.emit("transport-produce",{peerId:e.peerId,roomId:e.roomId,producerData:{kind:t,paused:!1,transportId:null==r?void 0:r.id,rtpParameters:i},appData:{type:n.type,producerPeerId:e.peerId,targetPeerIds:n.targetPeerIds}});s({id:o})}catch(l){console.debug({err:l}),a(l)}}),r.on("producedata",async({sctpStreamParameters:t,label:i,protocol:n,appData:s},a,o)=>{try{let{id:l}=this._socket.emit("transport-produce-data",{peerId:e.peerId,roomId:e.roomId,producerData:{transportId:null==r?void 0:r.id,sctpStreamParameters:{streamId:t.streamId,maxPacketLifeTime:t.maxPacketLifeTime,maxRetransmits:t.maxRetransmits,ordered:t.ordered},label:i,protocol:n,appData:s}});a({id:l})}catch(c){console.debug({error:c}),o(c)}}),r}},eA=class extends eO{constructor(){super(),this._me.peerId=`peerId-${c()}`,this._peers=new Map}async _joinLobby(e,t,r,i="user"){if(this.logger.info("joinLobby() | joining lobby"),!t)throw Error("Error: joinLobby() | No roomId passed");"recorder"===i&&(this._me.peerId=`botId-${c()}`),this._roomId=t;let n=r||await eE();if(!n)throw Error("joinLobby() | HuddleWebClient.ts | No token found");this._socket=eC(`https://testing.sdk-sushi.huddle01.com/${t}`,{reconnectionAttempts:10,auth:t=>t({peerId:this._me.peerId,token:n,projectId:e})}),this._socket.on("connect",()=>this._handleConnect()),this._socket.on("join-success",e=>this._handleJoinSuccess(e)),this._socket.on("disconnect",()=>this._handleDisconnect()),this._socket.on("connect_error",e=>{this._handleConnectError(e)}),this._socket.io.on("reconnect",e=>{this.logger.warn("reconnecting",e)}),this._socket.io.on("reconnect_attempt",e=>{console.log("reconnect_attempt",e)}),this._socket.io.on("reconnect_error",e=>{console.log("reconnect_error",e),this.logger.error({error:e})}),this._socket.io.on("reconnect_failed",()=>{console.log("reconnect_failed")}),this._socket.on("create-webrtc-success",e=>this._handleCreateWebRTC(e)),this._socket.on("transport-produce-success",e=>this._handleProduceSuccess(e)),this._socket.on("create-client-consumer",e=>this._handleClientConsumer(e)),this._socket.on("consumer-closed",e=>this._handleConsumerClosed(e)),this._socket.on("consumer-resumed",e=>this._handleConsumerResumed(e)),this._socket.on("consumer-paused",e=>this._handleConsumerPaused(e)),this._socket.on("new-peer",e=>this._handleNewPeer(e)),this._socket.on("peer-left",e=>this._handlePeerLeft(e)),this._socket.on("meeting-ended",()=>{this._close()}),this._socket.on("kicked",()=>{this._close()}),this._socket.on("recording-started",()=>{console.log("HuddleWebClient | recording-started"),this.emit("room:recording-started")}),this._socket.on("recording-stopped",()=>{console.log("HuddleWebClient | recording-stopped"),console.log("CLIENT_STOPPED_RECORDING"),this.emit("room:recording-stopped")}),this._socket.on("recording-data",e=>{console.log("RECORDING DATA",{data:e}),this.emit("room:recording-data",e)}),this._socket.on("livestream-started",e=>{console.log("LIVESTREAM STARTED",{data:e})}),this._socket.on("livestream-stopped",()=>{}),this._socket.on("peer-updated-displayName",this.__handlePeerUpdatedHandleName),this._socket.on("update-target-peerIds",this._handleUpdateTargetPeerIds)}async _joinRoom(e=!0){return console.info(`roomJoinRequest() | Joining room ${this._roomId}`),this._createConsumersOnJoin=e,await this._setDisplayName(this._me.displayName),new Promise((e,t)=>{this._socket.emit("join-request",r=>{r.success?e(r):(this.logger.error("roomJoinRequest() | Error joining room",r.data),this.emit("room:failed",r.data),t(r))})})}_leaveRoom(){this._socket.emit("endMeeting"),this._close()}_close(){var e,t,r,i,n,s,a,o;this._socket&&(null==(t=null==(e=this._videoProducer)?void 0:e.track)||t.stop(),null==(i=null==(r=this._audioProducer)?void 0:r.track)||i.stop(),this._stopVideoProducer(),this._stopAudioProducer(),null==(n=this._recvTransport)||n.close(),null==(s=this._sendTransport)||s.close(),this._disconnectSocket(),null==(a=this._audioStream)||a.getTracks().forEach(e=>e.stop()),null==(o=this._videoStream)||o.getTracks().forEach(e=>e.stop()),this._audioStream=null,this._videoStream=null)}_disconnectSocket(){this._socket.disconnect()}_handlePeerLeft=({peerId:e})=>{this._peers.delete(e),console.info("_handlePeerLeft() | Peer Left",{peerId:e}),this.emit("room:peer-left",e)};_handleNewPeer=e=>{if(e.peerId===this._me.peerId)return;let t={peerId:e.peerId,displayName:e.displayName,avatarUrl:e.avatarUrl||"",joinStatus:"joined:webrtc-creating",isHandRaised:e.isHandRaised||!1,role:e.role};this.emit("room:peer-joined",t),this._peers.set(e.peerId,t),console.log(e.peerId,{newPeer:t,peers:this._peers})};_handleUpdateTargetPeerIds=e=>{let t;switch(e.mediaType){case"cam":t=this._videoProducer;break;case"mic":t=this._audioProducer}if(t&&Array.isArray(t.appData.targetPeerIds)){if("add"===e.operation)t.appData.targetPeerIds.push(e.consumingPeerId);else if("remove"===e.operation){let r=t.appData.targetPeerIds.indexOf(e.consumingPeerId);r>-1&&t.appData.targetPeerIds.splice(r,1)}}};_startRecording=async e=>{if(!e)throw Error("startRecording() | No sourceUrl provided.");if(e.includes("localhost"))throw Error("startRecording() | Recording cannot be started on localhost.");return console.log("HuddleWebClient | startRecording() | Starting recording",{sourceUrl:e}),new Promise((t,r)=>{this._socket.emit("start-recording",{sourceUrl:e},e=>{e.success?t(e):(this.logger.error("startRecording() | Error starting recording",e.error),r(e))})})};_stopRecording=async(e=!1)=>new Promise((t,r)=>{this._socket.emit("stop-recording",{ipfs:e},e=>{e.success?t(e):(this.logger.error("stopRecording() | Error in stopping recording",e.data),r(e))})});_startStreaming=async e=>{if(!e.sourceUrl)throw Error("startStreaming() | No sourceUrl provided.");if(e.sourceUrl.includes("localhost"))throw Error("startStreaming() | Streaming cannot be started on localhost.");return new Promise((t,r)=>{this._socket.emit("start-livestream",e,e=>{e.success?t(e):(this.logger.error("startStreaming() | Error in starting streaming",e.data),r(e))})})};_stopStreaming=async()=>new Promise((e,t)=>{this._socket.emit("stop-livestream",null,r=>{r.success?e(r):(this.logger.error("stopStreaming() | Error in stopping streaming",r.data),t(r))})});_setDisplayName=e=>{let t={data:{displayName:{name:e}},peerId:this._me.peerId};return new Promise((r,i)=>{this._socket.emit("peer-set-displayName",t,t=>{t.success?r(e):i(t)})})};_createSingleConsumer=e=>{e.producerPeerId!==this._me.peerId&&(console.log("createSingleConsumer() |",e),this._socket.emit("create-single-consumer",e))};_closeSingleConsumer=e=>{let t=this._peersConsumers.get(e.producerPeerId);t&&t[e.mediaType]&&(console.log("HuddleWebCLient | closeSingleConsumer() |",{consumerIdtoCLose:t[e.mediaType]}),this._socket.emit("close-consumer",{peerId:this._me.peerId,roomId:this._roomId,consumerId:t[e.mediaType],mediaType:e.mediaType,producerPeerId:e.producerPeerId}),console.log("closeSingleConsumer() | sent"))};__handlePeerUpdatedHandleName=e=>{this.emit("room:peer-name-update",e.peerId,e.data.displayName.name),this.logger.info("room:peer-name-update",e.peerId,e.data.displayName.name)};handlePeerControls=async e=>{if(!this._acl.getAcl().changePermission){this.logger.error("You do not have the required permissions");return}return await new Promise((t,r)=>{this._socket.emit("peer-controls",e,e=>{e.success?(this.logger.info("Peer Control, Request Success"),t(e)):r(e)})})};handleRoomControls=async e=>{if(!this._acl.getAcl().changePermission){this.logger.error("You do not have permission to change room settings");return}return await new Promise((t,r)=>{this._socket.emit("room-controls",e,i=>{i.success?(this.setIndividualControl(e.type,e.value),t(i)):r(i)})})};setIndividualControl=(e,t)=>{let r={audioLocked:"audio",videoLocked:"video",shareLocked:"screenshare",chatLocked:"chat",roomLocked:"roomLock"};this._hostControls[r[e]]=t}},eN=new class extends eA{_projectId;constructor(){super()}getMeId=()=>this._me.peerId;initialize=e=>{if(!e)throw Error("projectId is missing");this._projectId=e,this.emit("app:initialized"),this.logger.info("app:initialized")};joinLobby=async(e,t)=>{if(!this._projectId)throw Error("projectId is missing, please initialize the SDK first");if(!e)throw Error("roomId is missing");await this._joinLobby(this._projectId,e),this._socket.on("peer-control-success",this.handlePeerControlResponse),this._socket.on("room-control-success",this.handleRoomControlResponse),this._socket.on("role-control-success",this.handleRoleControlResponse),this._socket.on("role-change-success",this.handleRoleChangeResponse)};leaveLobby=()=>{this._disconnectSocket()};joinRoom=(e=!0)=>{if(!this._socket)throw Error("Lobby not joined yet, please join lobby first");this._joinRoom(e)};leaveRoom=()=>{this._leaveRoom()};enumerateMicDevices=async()=>navigator.mediaDevices.enumerateDevices().then(e=>{let t=e.filter(e=>"audioinput"===e.kind);return t});fetchAudioStream=async e=>{if(this._audioStream)return console.info("Audio stream already exists, returning the same"),this._audioStream;try{return this._audioStream=await navigator.mediaDevices.getUserMedia({audio:!e||{deviceId:{ideal:e}}}),this._audioProducer&&(console.log("Replacing video track..."),this._audioProducer.replaceTrack({track:this._audioStream.getAudioTracks()[0]})),this.emit("app:mic-on",this._audioStream),this.logger.info("app:cam-on",this._audioStream),this._audioStream}catch(t){throw console.error("Audio Request Error; Reason:",t),Error("Unable to fetch audio stream")}};stopAudioStream=()=>{if(this._audioProducer&&(console.log("Audio producer found, stopping audio producer first"),this.stopProducingAudio()),this._audioStream){this._audioStream.getTracks().forEach(e=>e.stop()),this._audioStream=null,this.emit("app:mic-off"),this.logger.info("app:mic-off");return}throw Error("Audio stream not found, fetch audio stream first")};produceAudio(e,t){if(!this._acl.getAcl().audioProducer)throw Error("ACL | produceAudio() | Audio producer not allowed");if(!this._socket)throw Error("Room not joined yet, please join room first");this._produceAudioStream(e,t)}stopProducingAudio=()=>{if(!this._audioProducer)throw Error("Audio producer not found, produce audio first");if(!this._socket)throw Error("Room not joined yet, please join room first");this._requestStopAudioProducer()};createMicConsumer=e=>{if(!this._socket)throw Error("Room not joined yet, please join room first");this._createSingleConsumer({mediaType:"mic",producerPeerId:e})};closeMicConsumer=e=>{if(!e)throw Error("peerId is missing");this._closeSingleConsumer({mediaType:"mic",producerPeerId:e})};enumerateCamDevices=()=>navigator.mediaDevices.enumerateDevices().then(e=>{let t=e.filter(e=>"videoinput"===e.kind);return t});fetchVideoStream=async e=>{if(this._videoStream)return console.info("Video stream already exists, returning the same"),this._videoStream;try{return this._videoStream=await navigator.mediaDevices.getUserMedia({video:!e||{deviceId:{ideal:e}}}),this._videoProducer&&(console.log("Replacing video track..."),this._videoProducer.replaceTrack({track:this._videoStream.getVideoTracks()[0]})),this.emit("app:cam-on",this._videoStream),this.logger.info("app:cam-on",this._videoStream),this._videoStream}catch(t){throw console.error("Video Request Error; Reason:",t),Error("Unable to fetch video stream")}};stopVideoStream=()=>{if(this._videoProducer&&(console.log("Video producer found, stopping video producer first"),this.stopProducingVideo()),this._videoStream){this._videoStream.getTracks().forEach(e=>e.stop()),this._videoStream=null,this.emit("app:cam-off"),this.logger.info("app:cam-off");return}throw Error("Video stream not found, fetch video stream first")};produceVideo(e,t){if(!this._acl.getAcl().videoProducer)throw Error("ACL | produceVideo() | Video producer not allowed");if(!this._socket)throw Error("Room not joined yet, please join room first");this._produceVideoStream(e,t)}stopProducingVideo(){if(!this._videoProducer){console.log("Video not producing yet");return}if(!this._socket)throw Error("Room not joined yet, please join room first");this._requestStopVideoProducer()}createCamConsumer(e){if(!e)throw Error("peerId is missing");this._createSingleConsumer({mediaType:"cam",producerPeerId:e})}closeCamConsumer=e=>{if(!e)throw Error("peerId is missing");this._closeSingleConsumer({mediaType:"cam",producerPeerId:e})};getPeers=()=>{let e=Array.from(this._peers,([e,t])=>t);return console.log("thisPeers:",this._peers),e};getPeer=e=>{let t=this._peers.get(e);if(!t)throw Error("Peer not found");return t};getPeerTracks=e=>{var t,r;let i=this._peers.get(e);if(!i)throw Error(` Peer not found with peerId ${e}`);let n=this._peersConsumers.get(e);console.log({peerConsumerIds:n,_peersConsumers:this._peersConsumers,_consumers:this._consumers});let s=null==(t=this._consumers.get(n.mic))?void 0:t.track,a=null==(r=this._consumers.get(n.cam))?void 0:r.track;return{audio:s,video:a}};startRecording=async e=>{if(!e)throw Error("sourceUrl is missing");return await this._startRecording(e)};stopRecording=(e=!1)=>{this._stopRecording(e)};setDisplayName=async e=>{if(!e)throw Error("displayName is missing");await this._setDisplayName(e)};changePeerControls=async e=>{if(!this._acl.getAcl().changePermission){this.logger.error("ACL | changePeerControls() | You do not have the required permissions");return}return await new Promise((t,r)=>{this._socket.emit("peer-controls",e,e=>{e.success?(this.logger.info("Peer Control, Request Success"),t(e)):r(e)})})};changeRoomControls=async e=>{if(!this._acl.getAcl().changePermission){this.logger.error("ACL | changeRoomControls() | You do not have permission to change room settings");return}return await new Promise((t,r)=>{this._socket.emit("room-controls",e,i=>{i.success?(this.setIndividualControl(e.type,e.value),t(i)):r(i)})})};changePeerRole=async e=>{if(console.log("changePeerRole"),!this._acl.getAcl().changeRole){this.logger.error("ACL | changePeerRole() | You do not have permission to change peer role");return}return await new Promise((t,r)=>{this._socket.emit("role-controls",e,e=>{e.success?t(e):(this.logger.error("You do not have permission to change peer role"),r(e))})})};handlePeerControlResponse=async e=>{let{media:t,type:r}=e,i="locked"===r;"video"===t&&(this.stopVideoStream(),i&&this._acl.updateACL({videoProducer:!1})),"audio"===t&&(this.stopAudioStream(),i&&this._acl.updateACL({audioProducer:!1}))};handleRoomControlResponse=async e=>{if(this.setIndividualControl(e.type,e.value),this._acl.getAcl().changePermission)return;if("muteEveryone"===e.type){this.stopAudioStream(),this.logger.info("ACL | Host has Muted Everyone. You Have Been Muted.");return}let{type:t}=e;"audioLocked"===t&&(this._acl.updateACL({audioProducer:!e.value}),e.value&&(this.logger.info("ACL | Host Only Audio Enabled. You Have Been Muted."),this.stopAudioStream())),"videoLocked"===t&&(this._acl.updateACL({videoProducer:!e.value}),e.value&&(this.stopVideoStream(),this.logger.info("ACL | Host Only Video Enabled. Your Video has been Disabled.")))};handleRoleControlResponse=async e=>{this.emit("room:peer-role-update",e.peerId,e.role)};handleRoleChangeResponse=async e=>{console.log("ACL | Me Role Changed Response",e),this._me.role=e.role,this._acl.updateACL(e.acl),this.emit("room:me-role-update",e.role)}}},93189:function(e,t,r){"use strict";r.d(t,{a:function(){return b}});var i=r(30065),n=r(19005),s=r(67294),a=r(14034),o=r(464),l=r(91784),c=r(85945),d=r(37122),u=r(24798);let p=(e,t)=>{(e.suspense||e.useErrorBoundary)&&!t.isReset()&&(e.retryOnMount=!1)},h=e=>{s.useEffect(()=>{e.clearReset()},[e])},m=({result:e,errorResetBoundary:t,useErrorBoundary:r,query:i})=>e.isError&&!t.isReset()&&!e.isFetching&&(0,u.L)(r,[e.error,i]),f=e=>{e.suspense&&"number"!=typeof e.staleTime&&(e.staleTime=1e3)},g=(e,t)=>e.isLoading&&e.isFetching&&!t,v=(e,t,r)=>(null==e?void 0:e.suspense)&&g(t,r),y=(e,t,r)=>t.fetchOptimistic(e).then(({data:t})=>{null==e.onSuccess||e.onSuccess(t),null==e.onSettled||e.onSettled(t,null)}).catch(t=>{r.clearReset(),null==e.onError||e.onError(t),null==e.onSettled||e.onSettled(void 0,t)});function b(e,t,r){let u=(0,i._v)(e,t,r);return function(e,t){let r=(0,c.NL)({context:e.context}),i=(0,d.S)(),n=(0,l._)(),u=r.defaultQueryOptions(e);u._optimisticResults=i?"isRestoring":"optimistic",u.onError&&(u.onError=a.V.batchCalls(u.onError)),u.onSuccess&&(u.onSuccess=a.V.batchCalls(u.onSuccess)),u.onSettled&&(u.onSettled=a.V.batchCalls(u.onSettled)),f(u),p(u,n),h(n);let[g]=s.useState(()=>new t(r,u)),b=g.getOptimisticResult(u);if((0,o.$)(s.useCallback(e=>{let t=i?()=>void 0:g.subscribe(a.V.batchCalls(e));return g.updateResult(),t},[g,i]),()=>g.getCurrentResult(),()=>g.getCurrentResult()),s.useEffect(()=>{g.setOptions(u,{listeners:!1})},[u,g]),v(u,b,i))throw y(u,g,n);if(m({result:b,errorResetBoundary:n,useErrorBoundary:u.useErrorBoundary,query:g.getCurrentQuery()}))throw b.error;return u.notifyOnChangeProps?b:g.trackResult(b)}(u,n.z)}},48583:function(e,t,r){"use strict";r.d(t,{KO:function(){return c}});var i=r(67294),n=r(15103);let s=(0,i.createContext)(void 0),a=e=>{let t=(0,i.useContext)(s);return(null==e?void 0:e.store)||t||(0,n.K7)()},o=e=>"function"==typeof(null==e?void 0:e.then),l=i.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;if("rejected"===e.status)throw e.reason;throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e});function c(e,t){return[function(e,t){let r=a(t),[[n,s,c],d]=(0,i.useReducer)(t=>{let i=r.get(e);return Object.is(t[0],i)&&t[1]===r&&t[2]===e?t:[i,r,e]},void 0,()=>[r.get(e),r,e]),u=n;(s!==r||c!==e)&&(d(),u=r.get(e));let p=null==t?void 0:t.delay;return(0,i.useEffect)(()=>{let t=r.sub(e,()=>{if("number"==typeof p){setTimeout(d,p);return}d()});return d(),t},[r,e,p]),(0,i.useDebugValue)(u),o(u)?l(u):u}(e,t),function(e,t){let r=a(t),n=(0,i.useCallback)((...t)=>{if(!("write"in e))throw Error("not writable atom");return r.set(e,...t)},[r,e]);return n}(e,t)]}},15103:function(e,t,r){"use strict";let i;r.d(t,{K7:function(){return w},cn:function(){return s}});let n=0;function s(e,t){let r=`atom${++n}`,i={toString:()=>r};return"function"==typeof e?i.read=e:(i.init=e,i.read=e=>e(i),i.write=(e,t,r)=>t(i,"function"==typeof r?r(e(i)):r)),t&&(i.write=t),i}let a=e=>"init"in e,o=e=>!!e.write,l=new WeakMap,c=(e,t)=>{l.set(e,t),e.catch(()=>{}).finally(()=>l.delete(e))},d=(e,t)=>{let r=l.get(e);r&&(l.delete(e),r(t))},u=(e,t)=>{e.status="fulfilled",e.value=t},p=(e,t)=>{e.status="rejected",e.reason=t},h=e=>"function"==typeof(null==e?void 0:e.then),m=(e,t)=>"v"in e&&"v"in t&&Object.is(e.v,t.v),f=(e,t)=>"e"in e&&"e"in t&&Object.is(e.e,t.e),g=e=>"v"in e&&e.v instanceof Promise,v=(e,t)=>"v"in e&&"v"in t&&e.v.orig&&e.v.orig===t.v.orig,y=e=>{if("e"in e)throw e.e;return e.v},b=()=>{let e,t,r;let i=new WeakMap,n=new WeakMap,s=new Map;e=new Set,t=new Set,r=new Set;let l=e=>i.get(e),b=(e,t)=>{Object.freeze(t);let r=i.get(e);if(i.set(e,t),s.has(e)||s.set(e,r),r&&g(r)){let n="v"in t?t.v instanceof Promise?t.v:Promise.resolve(t.v):Promise.reject(t.e);d(r.v,n)}},w=(e,t,r)=>{let i=new Map,n=!1;r.forEach((r,s)=>{r||s!==e||(r=t),r?(i.set(s,r),t.d.get(s)!==r&&(n=!0)):console.warn("[Bug] atom state not found")}),(n||t.d.size!==i.size)&&(t.d=i)},_=(e,t,r)=>{let i=l(e),n={d:(null==i?void 0:i.d)||new Map,v:t};if(r&&w(e,n,r),i&&m(i,n)&&i.d===n.d)return i;if(i&&g(i)&&g(n)&&v(i,n)){if(i.d===n.d)return i;n.v=i.v}return b(e,n),n},S=(e,t,r,i)=>{if(h(t)){let n;let s=new Promise((i,a)=>{let o=!1;t.then(t=>{if(!o){o=!0;let n=l(e),a=_(e,s,r);u(s,t),i(t),(null==n?void 0:n.d)!==a.d&&j(e,a,null==n?void 0:n.d)}},t=>{if(!o){o=!0;let i=l(e),n=_(e,s,r);p(s,t),a(t),(null==i?void 0:i.d)!==n.d&&j(e,n,null==i?void 0:i.d)}}),n=e=>{o||(o=!0,e.then(e=>u(s,e),e=>p(s,e)),i(e))}});return s.orig=t,s.status="pending",c(s,e=>{e&&n(e),null==i||i()}),_(e,s,r)}return _(e,t,r)},x=(e,t,r)=>{let i=l(e),n={d:(null==i?void 0:i.d)||new Map,e:t};return(r&&w(e,n,r),i&&f(i,n)&&i.d===n.d)?i:(b(e,n),n)},C=e=>{let t,r;let i=l(e);if(i&&(i.d.forEach((t,r)=>{r===e||n.has(r)||C(r)}),Array.from(i.d).every(([t,r])=>{let i=l(t);return t===e||i===r||i&&!g(i)&&m(i,r)})))return i;let s=new Map,c=!0,d=t=>{if(t===e){let r=l(t);if(r)return s.set(t,r),y(r);if(a(t))return s.set(t,void 0),t.init;throw Error("no atom init")}let i=C(t);return s.set(t,i),y(i)},u={get signal(){return t||(t=new AbortController),t.signal},get setSelf(){return o(e)||console.warn("setSelf function cannot be used with read-only atom"),!r&&o(e)&&(r=(...t)=>{if(c&&console.warn("setSelf function cannot be called in sync"),!c)return L(e,...t)}),r}};try{let p=e.read(d,u);return S(e,p,s,()=>null==t?void 0:t.abort())}catch(h){return x(e,h,s)}finally{c=!1}},T=e=>y(C(e)),k=e=>{let t=n.get(e);return t||(t=I(e)),t},R=(e,t)=>!t.l.size&&(!t.t.size||1===t.t.size&&t.t.has(e)),E=e=>{let t=n.get(e);t&&R(e,t)&&M(e)},P=e=>{let t=new Map,r=new WeakMap,i=e=>{let s=n.get(e);null==s||s.t.forEach(n=>{n!==e&&(t.set(n,(t.get(n)||new Set).add(e)),r.set(n,(r.get(n)||0)+1),i(n))})};i(e);let s=e=>{let i=n.get(e);null==i||i.t.forEach(i=>{var n;if(i!==e){let a=r.get(i);if(a&&r.set(i,--a),!a){let o=!!(null==(n=t.get(i))?void 0:n.size);if(o){let c=l(i),d=C(i);o=!c||!m(c,d)}o||t.forEach(e=>e.delete(i))}s(i)}})};s(e)},D=(e,...r)=>{let i=!0,n=e=>y(C(e)),s=(r,...n)=>{let s;if(r===e){if(!a(r))throw Error("atom not writable");let o=l(r),c=S(r,n[0]);o&&m(o,c)||P(r)}else s=D(r,...n);if(!i){let d=O();t.forEach(e=>e({type:"async-write",flushed:d}))}return s},o=e.write(n,s,...r);return i=!1,o},L=(e,...r)=>{let i=D(e,...r),n=O();return t.forEach(e=>e({type:"write",flushed:n})),i},I=(e,t)=>{let i={t:new Set(t&&[t]),l:new Set};if(n.set(e,i),r.add(e),C(e).d.forEach((t,r)=>{let i=n.get(r);i?i.t.add(e):r!==e&&I(r,e)}),C(e),o(e)&&e.onMount){let s=e.onMount((...t)=>L(e,...t));s&&(i.u=s)}return i},M=e=>{var t;let i=null==(t=n.get(e))?void 0:t.u;i&&i(),n.delete(e),r.delete(e);let s=l(e);s?(g(s)&&d(s.v),s.d.forEach((t,r)=>{if(r!==e){let i=n.get(r);i&&(i.t.delete(e),R(r,i)&&M(r))}})):console.warn("[Bug] could not find atom state to unmount",e)},j=(e,t,r)=>{let i=new Set(t.d.keys());null==r||r.forEach((t,r)=>{if(i.has(r)){i.delete(r);return}let s=n.get(r);s&&(s.t.delete(e),R(r,s)&&M(r))}),i.forEach(t=>{let r=n.get(t);r?r.t.add(e):n.has(e)&&I(t,e)})},O=()=>{let t;for(t=new Set;s.size;){let r=Array.from(s);s.clear(),r.forEach(([e,r])=>{let i=l(e);if(i){i.d!==(null==r?void 0:r.d)&&j(e,i,null==r?void 0:r.d);let s=n.get(e);s&&!(r&&!g(r)&&(m(r,i)||f(r,i)))&&(s.l.forEach(e=>e()),t.add(e))}else console.warn("[Bug] no atom state to flush")})}return e.forEach(e=>e("state")),t},A=(r,i)=>{let n=k(r),s=O(),a=n.l;return a.add(i),e.forEach(e=>e("sub")),t.forEach(e=>e({type:"sub",flushed:s})),()=>{a.delete(i),E(r),e.forEach(e=>e("unsub")),t.forEach(e=>e({type:"unsub"}))}};return{get:T,set:L,sub:A,dev_subscribe_store:(r,i)=>2!==i?(console.warn("The current StoreListener revision is 2. The older ones are deprecated."),e.add(r),()=>{e.delete(r)}):(t.add(r),()=>{t.delete(r)}),dev_get_mounted_atoms:()=>r.values(),dev_get_atom_state:e=>i.get(e),dev_get_mounted:e=>n.get(e),dev_restore_atoms:e=>{for(let[r,i]of e)a(r)&&(S(r,i),P(r));let n=O();t.forEach(e=>e({type:"restore",flushed:n}))}}},w=()=>(i||(i=b()),i)}},function(e){e.O(0,[9498,1228,3874,6556,8179,4355,5937,9412,4617,3609,1664,1618,1098,1257,5675,2697,8451,1889,3775,2438,5678,1318,8476,4156,2400,6214,6781,7635,7331,8439,4638,9774,2888,179],function(){return e(e.s=8266)}),_N_E=e.O()}]);